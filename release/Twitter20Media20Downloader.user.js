// ==UserScript==
// @name        Twitter Media Downloader
// @version     1.27
// @author      AMANE
// @namespace   none
// @match       https://twitter.com/*
// @match       https://mobile.twitter.com/*
// @grant       GM_registerMenuCommand
// @grant       GM_setValue
// @grant       GM_getValue
// @grant       GM_download
// @compatible  Chrome
// @compatible  Firefox
// @license     MIT
// @downloadURL https://raw.githubusercontent.com/FiorenMas/Userscripts/release/release/Twitter20Media20Downloader.user.js
// @updateURL https://raw.githubusercontent.com/FiorenMas/Userscripts/release/release/Twitter20Media20Downloader.meta.js
// ==/UserScript==
const filename="twitter_{user-name}(@{user-id})_{date-time}_{status-id}_{file-type}",TMD=function(){let m,M,_,x,A;return{init:async function(){GM_registerMenuCommand((this.language[navigator.language]||this.language.en).settings,this.settings),m=this.language[document.querySelector("html").lang]||this.language.en,M=location.hostname,A=M.indexOf("tweetdeck")>=0,_=this.storage_obsolete(),_.length?(this.storage(_),this.storage_obsolete(!0)):_=await this.storage(),x=GM_getValue("show_sensitive",!1),document.head.insertAdjacentHTML("beforeend","<style>"+this.css+(x?this.css_ss:"")+"</style>"),new MutationObserver(t=>t.forEach(l=>l.addedNodes.forEach(i=>this.detect(i)))).observe(document.body,{childList:!0,subtree:!0})},detect:function(e){let t=e.tagName=="ARTICLE"&&e||e.tagName=="DIV"&&(e.querySelector("article")||e.closest("article"));t&&this.addButtonTo(t);let l=e.tagName=="LI"&&e.getAttribute("role")=="listitem"&&[e]||e.tagName=="DIV"&&e.querySelectorAll('li[role="listitem"]');l&&this.addButtonToMedia(l)},addButtonTo:function(e){if(e.dataset.detected)return;e.dataset.detected="true";let t=['a[href*="/photo/1"]','div[role="progressbar"]','div[data-testid="playButton"]','a[href="/settings/content_you_see"]',"div.media-image-container","div.media-preview-container",'div[aria-labelledby]>div:first-child>div[role="button"][tabindex="0"]'];if(e.querySelector(t.join(","))){let n=e.querySelector('a[href*="/status/"]').href.split("/status/").pop().split("/").shift(),r=e.querySelector('div[role="group"]:last-of-type, ul.tweet-actions, ul.tweet-detail-actions'),o=Array.from(r.querySelectorAll(":scope>div>div, li.tweet-action-item>a, li.tweet-detail-action-item>a")).pop().parentNode,s=o.cloneNode(!0);A?(s.firstElementChild.innerHTML='<svg viewBox="0 0 24 24" style="width: 18px; height: 18px;">'+this.svg+"</svg>",s.firstElementChild.removeAttribute("rel"),s.classList.replace("pull-left","pull-right")):s.querySelector("svg").innerHTML=this.svg;let a=_.indexOf(n)>=0;if(this.status(s,"tmd-down"),this.status(s,a?"completed":"download",a?m.completed:m.download),r.insertBefore(s,o.nextSibling),s.onclick=()=>this.click(s,n,a),x){let h=e.querySelector('div[aria-labelledby] div[role="button"][tabindex="0"]:not([data-testid]) > div[dir] > span > span');h&&h.click()}}let i=e.querySelectorAll('a[href*="/photo/"]');if(i.length>1){let n=e.querySelector('a[href*="/status/"]').href.split("/status/").pop().split("/").shift(),r=e.querySelector('div[role="group"]:last-of-type'),o=Array.from(r.querySelectorAll(":scope>div>div")).pop().parentNode;i.forEach(s=>{let a=s.href.split("/status/").pop().split("/").pop(),h=_.indexOf(n)>=0,c=document.createElement("div");c.innerHTML='<div><div><svg viewBox="0 0 24 24" style="width: 18px; height: 18px;">'+this.svg+"</svg></div></div>",c.classList.add("tmd-down","tmd-img"),this.status(c,"download"),s.parentNode.appendChild(c),c.onclick=d=>{d.preventDefault(),this.click(c,n,h,a)}})}},addButtonToMedia:function(e){e.forEach(t=>{if(t.dataset.detected)return;t.dataset.detected="true";let l=t.querySelector('a[href*="/status/"]').href.split("/status/").pop().split("/").shift(),i=_.indexOf(l)>=0,n=document.createElement("div");n.innerHTML='<div><div><svg viewBox="0 0 24 24" style="width: 18px; height: 18px;">'+this.svg+"</svg></div></div>",n.classList.add("tmd-down","tmd-media"),this.status(n,i?"completed":"download",i?m.completed:m.download),t.appendChild(n),n.onclick=()=>this.click(n,l,i)})},click:async function(e,t,l,i){if(e.classList.contains("loading"))return;this.status(e,"loading");let n=(await GM_getValue("filename",filename)).split(`
`).join(""),r=await GM_getValue("save_history",!0),o=await this.fetchJson(t),s=o.legacy,a=o.core.user_results.result.legacy,h={"\\":"\uFF3C","/":"\uFF0F","|":"\uFF5C","<":"\uFF1C",">":"\uFF1E",":":"\uFF1A","*":"\uFF0A","?":"\uFF1F",'"':"\uFF02","\u200B":"","\u200C":"","\u200D":"","\u2060":"","\uFEFF":"","\u{1F51E}":""},c=n.match(/{date-time(-local)?:[^{}]+}/)?n.match(/{date-time(?:-local)?:([^{}]+)}/)[1].replace(/[\\/|<>*?:"]/g,u=>h[u]):"YYYYMMDD-hhmmss",d={};d["status-id"]=t,d["user-name"]=a.name.replace(/([\\/|*?:"]|[\u200b-\u200d\u2060\ufeff]|ðŸ”ž)/g,u=>h[u]),d["user-id"]=a.screen_name,d["date-time"]=this.formatDate(s.created_at,c),d["date-time-local"]=this.formatDate(s.created_at,c,!0),d["full-text"]=s.full_text.split(`
`).join(" ").replace(/\s*https:\/\/t\.co\/\w+/g,"").replace(/[\\/|<>*?:"]|[\u200b-\u200d\u2060\ufeff]/g,u=>h[u]);let f=s.extended_entities&&s.extended_entities.media;if(i&&(f=[f[i-1]]),f.length>0){let u=f.length,b=[];f.forEach((y,p)=>{d.url=y.type=="photo"?y.media_url_https+":orig":y.video_info.variants.filter(g=>g.content_type=="video/mp4").sort((g,v)=>v.bitrate-g.bitrate)[0].url,d.file=d.url.split("/").pop().split(/[:?]/).shift(),d["file-name"]=d.file.split(".").shift(),d["file-ext"]=d.file.split(".").pop(),d["file-type"]=y.type.replace("animated_",""),d.out=(n.replace(/\.?{file-ext}/,"")+((f.length>1||i)&&!n.match("{file-name}")?"-"+(i?i-1:p):"")+".{file-ext}").replace(/{([^{}:]+)(:[^{}]+)?}/g,(g,v)=>d[v]),this.downloader.add({url:d.url,name:d.out,onload:()=>{u-=1,b.push((f.length>1||i?(i||p+1)+": ":"")+m.completed),this.status(e,null,b.sort().join(`
`)),u===0&&(this.status(e,"completed",m.completed),r&&!l&&(_.push(t),this.storage(t)))},onerror:g=>{u=-1,b.push((f.length>1?p+1+": ":"")+g.details.current),this.status(e,"failed",b.sort().join(`
`))}})})}else this.status(e,"failed","MEDIA_NOT_FOUND")},status:function(e,t,l,i){t&&(e.classList.remove("download","completed","loading","failed"),e.classList.add(t)),l&&(e.title=l),i&&(e.style.cssText=i)},settings:async function(){const e=(p,g,v,k,T)=>{let w=document.createElement(g);return v&&(w.style.cssText=v),typeof k<"u"&&(g=="input"?k=="checkbox"?w.type=k:w.value=k:w.innerHTML=k),T&&T.split(" ").forEach(C=>w.classList.add(C)),p.appendChild(w),w};let t=e(document.body,"div","position: fixed; left: 0px; top: 0px; width: 100%; height: 100%; background-color: #0009; z-index: 10;"),l;t.onmousedown=p=>{l=p.target==t},t.onmouseup=p=>{l&&p.target==t&&t.remove()};let i=e(t,"div","position: absolute; left: 50%; top: 50%; transform: translateX(-50%) translateY(-50%); width: fit-content; width: -moz-fit-content; background-color: #f3f3f3; border: 1px solid #ccc; border-radius: 10px; color: black;"),n=e(i,"h3","margin: 10px 20px;",m.dialog.title),r=e(i,"div","margin: 10px; border: 1px solid #ccc; border-radius: 5px;"),o=e(r,"label","display: block; margin: 10px;",m.dialog.save_history),s=e(o,"input","float: left;","checkbox");s.checked=await GM_getValue("save_history",!0),s.onchange=()=>{GM_setValue("save_history",s.checked)};let a=e(o,"label","display: inline-block; margin: 0 10px; color: blue;",m.dialog.clear_history);a.onclick=()=>{confirm(m.dialog.clear_confirm)&&(_=[],GM_setValue("download_history",[]))};let h=e(r,"label","display: block; margin: 10px;",m.dialog.show_sensitive),c=e(h,"input","float: left;","checkbox");c.checked=await GM_getValue("show_sensitive",!1),c.onchange=()=>{x=c.checked,GM_setValue("show_sensitive",x)};let d=e(i,"div","margin: 10px; border: 1px solid #ccc; border-radius: 5px;"),f=e(d,"label","display: block; margin: 10px 15px;",m.dialog.pattern),u=e(f,"textarea","display: block; min-width: 500px; max-width: 500px; min-height: 100px; font-size: inherit; background: white; color: black;",await GM_getValue("filename",filename)),b=e(d,"label","display: table; margin: 10px;",`
<span class="tmd-tag" title="user name">{user-name}</span>
<span class="tmd-tag" title="The user name after @ sign.">{user-id}</span>
<span class="tmd-tag" title="example: 1234567890987654321">{status-id}</span>
<span class="tmd-tag" title="{date-time} : Posted time in UTC.
{date-time-local} : Your local time zone.

Default:
YYYYMMDD-hhmmss => 20201231-235959

Example of custom:
{date-time:DD-MMM-YY hh.mm} => 31-DEC-21 23.59">{date-time}</span><br>
<span class="tmd-tag" title="Text content in tweet.">{full-text}</span>
<span class="tmd-tag" title="Type of &#34;video&#34; or &#34;photo&#34; or &#34;gif&#34;.">{file-type}</span>
<span class="tmd-tag" title="Original filename from URL.">{file-name}</span>
`);u.selectionStart=u.value.length,b.querySelectorAll(".tmd-tag").forEach(p=>{p.onclick=()=>{let g=u.selectionStart,v=u.selectionEnd;u.value=u.value.substring(0,g)+p.innerText+u.value.substring(v),u.selectionStart=g+p.innerText.length,u.selectionEnd=g+p.innerText.length,u.focus()}});let y=e(n,"label","float: right;",m.dialog.save,"tmd-btn");y.onclick=async()=>{await GM_setValue("filename",u.value),t.remove()}},fetchJson:async function(e){let t=`https://${M}/i/api/graphql/NmCeCgkVlsRGS1cAwqtgmw/TweetDetail`,l={focalTweetId:e,with_rux_injections:!1,includePromotedContent:!0,withCommunity:!0,withQuickPromoteEligibilityTweetFields:!0,withBirdwatchNotes:!0,withVoice:!0,withV2Timeline:!0},i={rweb_lists_timeline_redesign_enabled:!0,responsive_web_graphql_exclude_directive_enabled:!0,verified_phone_label_enabled:!1,creator_subscriptions_tweet_preview_api_enabled:!0,responsive_web_graphql_timeline_navigation_enabled:!0,responsive_web_graphql_skip_user_profile_image_extensions_enabled:!1,tweetypie_unmention_optimization_enabled:!0,responsive_web_edit_tweet_api_enabled:!0,graphql_is_translatable_rweb_tweet_is_translatable_enabled:!0,view_counts_everywhere_api_enabled:!0,longform_notetweets_consumption_enabled:!0,responsive_web_twitter_article_tweet_consumption_enabled:!1,tweet_awards_web_tipping_enabled:!1,freedom_of_speech_not_reach_fetch_enabled:!0,standardized_nudges_misinfo:!0,tweet_with_visibility_results_prefer_gql_limited_actions_policy_enabled:!0,longform_notetweets_rich_text_read_enabled:!0,longform_notetweets_inline_media_enabled:!0,responsive_web_media_download_video_enabled:!1,responsive_web_enhance_cards_enabled:!1},n=encodeURI(`${t}?variables=${JSON.stringify(l)}&features=${JSON.stringify(i)}`),r=this.getCookie(),o={authorization:"Bearer AAAAAAAAAAAAAAAAAAAAANRILgAAAAAAnNwIzUejRCOuH5E6I8xnZz4puTs%3D1Zv7ttfk8LF81IUq16cHjhLTvJu4FA33AGWWjCpTnA","x-twitter-active-user":"yes","x-twitter-client-language":r.lang,"x-csrf-token":r.ct0};r.ct0.length==32&&(o["x-guest-token"]=r.gt);let h=(await fetch(n,{headers:o}).then(c=>c.json())).data.threaded_conversation_with_injections_v2.instructions[0].entries.find(c=>c.entryId==`tweet-${e}`).content.itemContent.tweet_results.result;return h.tweet||h},getCookie:function(e){let t={};return document.cookie.split(";").filter(l=>l.indexOf("=")>0).forEach(l=>{l.replace(/^([^=]+)=(.+)$/,(i,n,r)=>{t[n.trim()]=r.trim()})}),e?t[e]:t},storage:async function(e){let t=await GM_getValue("download_history",[]),l=t.length;if(e)Array.isArray(e)?t=t.concat(e):t.indexOf(e)<0&&t.push(e);else return t;t.length>l&&GM_setValue("download_history",t)},storage_obsolete:function(e){let t=JSON.parse(localStorage.getItem("history")||"[]");if(e)localStorage.removeItem("history");else return t},formatDate:function(e,t,l){let i=new Date(e);l&&i.setMinutes(i.getMinutes()-i.getTimezoneOffset());let n=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],r={YYYY:i.getUTCFullYear().toString(),YY:i.getUTCFullYear().toString(),MM:i.getUTCMonth()+1,MMM:n[i.getUTCMonth()],DD:i.getUTCDate(),hh:i.getUTCHours(),mm:i.getUTCMinutes(),ss:i.getUTCSeconds(),h2:i.getUTCHours()%12,ap:i.getUTCHours()<12?"AM":"PM"};return t.replace(/(YY(YY)?|MMM?|DD|hh|mm|ss|h2|ap)/g,o=>("0"+r[o]).substr(-o.length))},downloader:function(){let e=[],t=0,l=2,i=0,n=2,r=0,o,s=!1;return{add:function(a){e.push(a),t<l?(t+=1,this.next()):this.update()},next:async function(){let a=e.shift();await this.start(a),e.length>0&&t<=l?this.next():t-=1,this.update()},start:function(a){return this.update(),new Promise(h=>{GM_download({url:a.url,name:a.name,onload:c=>{a.onload(),h()},onerror:c=>{this.retry(a,c),h()},ontimeout:c=>{this.retry(a,c),h()}})})},retry:function(a,h){i+=1,i==3&&(l=1),a.retry&&a.retry>=n||h.details&&h.details.current=="USER_CANCELED"?(a.onerror(h),r+=1):(l==1&&(a.retry=(a.retry||0)+1),this.add(a))},update:function(){if(o||(o=document.createElement("div"),o.title="Twitter Media Downloader",o.classList.add("tmd-notifier"),o.innerHTML="<label>0</label>|<label>0</label>",document.body.appendChild(o)),r>0&&!s){s=!0,o.innerHTML+="|";let a=document.createElement("label");o.appendChild(a),a.onclick=()=>{o.innerHTML="<label>0</label>|<label>0</label>",r=0,s=!1,this.update()}}o.firstChild.innerText=t,o.firstChild.nextElementSibling.innerText=e.length,r>0&&(o.lastChild.innerText=r),t>0||e.length>0||r>0?o.classList.add("running"):o.classList.remove("running")}}}(),language:{en:{download:"Download",completed:"Download Completed",settings:"Settings",dialog:{title:"Download Settings",save:"Save",save_history:"Remember download history",clear_history:"(Clear)",clear_confirm:"Clear download history?",show_sensitive:"Always show sensitive content",pattern:"File Name Pattern"}},ja:{download:"\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9",completed:"\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9\u5B8C\u4E86",settings:"\u8A2D\u5B9A",dialog:{title:"\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9\u8A2D\u5B9A",save:"\u4FDD\u5B58",save_history:"\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9\u5C65\u6B74\u3092\u4FDD\u5B58\u3059\u308B",clear_history:"(\u30AF\u30EA\u30A2)",clear_confirm:"\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9\u5C65\u6B74\u3092\u524A\u9664\u3059\u308B\uFF1F",show_sensitive:"\u30BB\u30F3\u30B7\u30C6\u30A3\u30D6\u306A\u5185\u5BB9\u3092\u5E38\u306B\u8868\u793A\u3059\u308B",pattern:"\u30D5\u30A1\u30A4\u30EB\u540D\u30D1\u30BF\u30FC\u30F3"}},zh:{download:"\u4E0B\u8F7D",completed:"\u4E0B\u8F7D\u5B8C\u6210",settings:"\u8BBE\u7F6E",dialog:{title:"\u4E0B\u8F7D\u8BBE\u7F6E",save:"\u4FDD\u5B58",save_history:"\u4FDD\u5B58\u4E0B\u8F7D\u8BB0\u5F55",clear_history:"(\u6E05\u9664)",clear_confirm:"\u786E\u8BA4\u8981\u6E05\u9664\u4E0B\u8F7D\u8BB0\u5F55\uFF1F",show_sensitive:"\u81EA\u52A8\u663E\u793A\u654F\u611F\u7684\u5185\u5BB9",pattern:"\u6587\u4EF6\u540D\u683C\u5F0F"}},"zh-Hant":{download:"\u4E0B\u8F09",completed:"\u4E0B\u8F09\u5B8C\u6210",settings:"\u8A2D\u7F6E",dialog:{title:"\u4E0B\u8F09\u8A2D\u7F6E",save:"\u4FDD\u5B58",save_history:"\u4FDD\u5B58\u4E0B\u8F09\u8A18\u9304",clear_history:"(\u6E05\u9664)",clear_confirm:"\u78BA\u8A8D\u8981\u6E05\u9664\u4E0B\u8F09\u8A18\u9304\uFF1F",show_sensitive:"\u81EA\u52D5\u986F\u793A\u654F\u611F\u7684\u5185\u5BB9",pattern:"\u6587\u4EF6\u540D\u898F\u5247"}}},css:`
.tmd-down {margin-left: 12px; order: 99;}
.tmd-down:hover > div > div > div > div {color: rgba(29, 161, 242, 1.0);}
.tmd-down:hover > div > div > div > div > div {background-color: rgba(29, 161, 242, 0.1);}
.tmd-down:active > div > div > div > div > div {background-color: rgba(29, 161, 242, 0.2);}
.tmd-down:hover svg {color: rgba(29, 161, 242, 1.0);}
.tmd-down:hover div:first-child:not(:last-child) {background-color: rgba(29, 161, 242, 0.1);}
.tmd-down:active div:first-child:not(:last-child) {background-color: rgba(29, 161, 242, 0.2);}
.tmd-down.tmd-media {position: absolute; right: 0;}
.tmd-down.tmd-media > div {display: flex; border-radius: 99px; margin: 2px;}
.tmd-down.tmd-media > div > div {display: flex; margin: 6px; color: #fff;}
.tmd-down.tmd-media:hover > div {background-color: rgba(255,255,255, 0.6);}
.tmd-down.tmd-media:hover > div > div {color: rgba(29, 161, 242, 1.0);}
.tmd-down.tmd-media:not(:hover) > div > div {filter: drop-shadow(0 0 1px #000);}
.tmd-down g {display: none;}
.tmd-down.download g.download, .tmd-down.completed g.completed, .tmd-down.loading g.loading,.tmd-down.failed g.failed {display: unset;}
.tmd-down.loading svg {animation: spin 1s linear infinite;}
@keyframes spin {0% {transform: rotate(0deg);} 100% {transform: rotate(360deg);}}
.tmd-btn {display: inline-block; background-color: #1DA1F2; color: #FFFFFF; padding: 0 20px; border-radius: 99px;}
.tmd-tag {display: inline-block; background-color: #FFFFFF; color: #1DA1F2; padding: 0 10px; border-radius: 10px; border: 1px solid #1DA1F2;  font-weight: bold; margin: 5px;}
.tmd-btn:hover {background-color: rgba(29, 161, 242, 0.9);}
.tmd-tag:hover {background-color: rgba(29, 161, 242, 0.1);}
.tmd-notifier {display: none; position: fixed; left: 16px; bottom: 16px; color: #000; background: #fff; border: 1px solid #ccc; border-radius: 8px; padding: 4px;}
.tmd-notifier.running {display: flex; align-items: center;}
.tmd-notifier label {display: inline-flex; align-items: center; margin: 0 8px;}
.tmd-notifier label:before {content: " "; width: 32px; height: 16px; background-position: center; background-repeat: no-repeat;}
.tmd-notifier label:nth-child(1):before {background-image:url("data:image/svg+xml;charset=utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2216%22 height=%2216%22 viewBox=%220 0 24 24%22><path d=%22M3,14 v5 q0,2 2,2 h14 q2,0 2,-2 v-5 M7,10 l4,4 q1,1 2,0 l4,-4 M12,3 v11%22 fill=%22none%22 stroke=%22%23666%22 stroke-width=%222%22 stroke-linecap=%22round%22 /></svg>");}
.tmd-notifier label:nth-child(2):before {background-image:url("data:image/svg+xml;charset=utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2216%22 height=%2216%22 viewBox=%220 0 24 24%22><path d=%22M12,2 a1,1 0 0 1 0,20 a1,1 0 0 1 0,-20 M12,5 v7 h6%22 fill=%22none%22 stroke=%22%23999%22 stroke-width=%222%22 stroke-linejoin=%22round%22 stroke-linecap=%22round%22 /></svg>");}
.tmd-notifier label:nth-child(3):before {background-image:url("data:image/svg+xml;charset=utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2216%22 height=%2216%22 viewBox=%220 0 24 24%22><path d=%22M12,0 a2,2 0 0 0 0,24 a2,2 0 0 0 0,-24%22 fill=%22%23f66%22 stroke=%22none%22 /><path d=%22M14.5,5 a1,1 0 0 0 -5,0 l0.5,9 a1,1 0 0 0 4,0 z M12,17 a2,2 0 0 0 0,5 a2,2 0 0 0 0,-5%22 fill=%22%23fff%22 stroke=%22none%22 /></svg>");}
.tmd-down.tmd-img {position: absolute; right: 0; bottom: 0; display: none !important;}
.tmd-down.tmd-img > div {display: flex; border-radius: 99px; margin: 2px; background-color: rgba(255,255,255, 0.6);}
.tmd-down.tmd-img > div > div {display: flex; margin: 6px; color: #fff !important;}
.tmd-down.tmd-img:not(:hover) > div > div {filter: drop-shadow(0 0 1px #000);}
.tmd-down.tmd-img:hover > div > div {color: rgba(29, 161, 242, 1.0);}
:hover > .tmd-down.tmd-img, .tmd-img.loading, .tmd-img.completed, .tmd-img.failed {display: block !important;}
.tweet-detail-action-item {width: 20% !important;}
`,css_ss:`
/* show sensitive in media tab */
li[role="listitem"]>div>div>div>div:not(:last-child) {filter: none;}
li[role="listitem"]>div>div>div>div+div:last-child {display: none;}
`,svg:`
<g class="download"><path d="M3,14 v5 q0,2 2,2 h14 q2,0 2,-2 v-5 M7,10 l4,4 q1,1 2,0 l4,-4 M12,3 v11" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" /></g>
<g class="completed"><path d="M3,14 v5 q0,2 2,2 h14 q2,0 2,-2 v-5 M7,10 l3,4 q1,1 2,0 l8,-11" fill="none" stroke="#1DA1F2" stroke-width="2" stroke-linecap="round" /></g>
<g class="loading"><circle cx="12" cy="12" r="10" fill="none" stroke="#1DA1F2" stroke-width="4" opacity="0.4" /><path d="M12,2 a10,10 0 0 1 10,10" fill="none" stroke="#1DA1F2" stroke-width="4" stroke-linecap="round" /></g>
<g class="failed"><circle cx="12" cy="12" r="11" fill="#f33" stroke="currentColor" stroke-width="2" opacity="0.8" /><path d="M14,5 a1,1 0 0 0 -4,0 l0.5,9.5 a1.5,1.5 0 0 0 3,0 z M12,17 a2,2 0 0 0 0,4 a2,2 0 0 0 0,-4" fill="#fff" stroke="none" /></g>
`}}();TMD.init();
