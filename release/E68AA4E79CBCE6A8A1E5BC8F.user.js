// ==UserScript==
// @name         Dark Mode
// @version      1.5.5
// @author       X.I.U
// @match        *://*/*
// @icon         data:image/png;base64,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
// @grant        GM_registerMenuCommand
// @grant        GM_unregisterMenuCommand
// @grant        GM_openInTab
// @grant        GM_getValue
// @grant        GM_setValue
// @grant        GM_notification
// @sandbox      JavaScript
// @noframes
// @license      GPL-3.0 License
// @run-at       document-start
// @namespace    https://github.com/XIU2/UserScript
// @supportURL   https://github.com/XIU2/UserScript
// @homepageURL  https://github.com/XIU2/UserScript
// @downloadURL https://raw.githubusercontent.com/FiorenMas/Userscripts/release/release/E68AA4E79CBCE6A8A1E5BC8F.user.js
// @updateURL https://raw.githubusercontent.com/FiorenMas/Userscripts/release/release/E68AA4E79CBCE6A8A1E5BC8F.meta.js
// ==/UserScript==
(function(){"use strict";var o=[["menu_disable","\u2705 \u5DF2\u542F\u7528 (\u70B9\u51FB\u5BF9\u5F53\u524D\u7F51\u7AD9\u7981\u7528)","\u274C \u5DF2\u7981\u7528 (\u70B9\u51FB\u5BF9\u5F53\u524D\u7F51\u7AD9\u542F\u7528)",[]],["menu_runDuringTheDay","\u767D\u5929\u4FDD\u6301\u5F00\u542F (\u6BD4\u665A\u4E0A\u4EAE\u4E00\u70B9\u70B9)","\u767D\u5929\u4FDD\u6301\u5F00\u542F",!0],["menu_darkModeAuto","\u62A4\u773C\u6A21\u5F0F\u8DDF\u968F\u6D4F\u89C8\u5668","\u62A4\u773C\u6A21\u5F0F\u8DDF\u968F\u6D4F\u89C8\u5668",!1],["menu_autoRecognition","\u667A\u80FD\u6392\u9664\u81EA\u5E26\u6697\u9ED1\u6A21\u5F0F\u7684\u7F51\u9875 (beta)","\u667A\u80FD\u6392\u9664\u81EA\u5E26\u6697\u9ED1\u6A21\u5F0F\u7684\u7F51\u9875 (beta)",!0],["menu_forcedToEnable","\u2705 \u5DF2\u5F3A\u5236\u5F53\u524D\u7F51\u7AD9\u542F\u7528\u62A4\u773C\u6A21\u5F0F (\u{1F446})","\u274C \u672A\u5F3A\u5236\u5F53\u524D\u7F51\u7AD9\u542F\u7528\u62A4\u773C\u6A21\u5F0F (\u{1F446})",[]],["menu_darkModeType","\u70B9\u51FB\u5207\u6362\u6A21\u5F0F","\u70B9\u51FB\u5207\u6362\u6A21\u5F0F",2],["menu_customMode","\u81EA\u5B9A\u4E49\u5F53\u524D\u6A21\u5F0F","\u81EA\u5B9A\u4E49\u5F53\u524D\u6A21\u5F0F",!0],["menu_customMode1",,,"60|50"],["menu_customMode2",,,"60|40|50|50"],["menu_customMode3",,,"90"],["menu_customMode3_exclude",,,'img, .img, video, [style*="background"][style*="url"], svg'],["menu_customTime","\u81EA\u5B9A\u4E49\u663C\u591C\u65F6\u95F4","\u81EA\u5B9A\u4E49\u663C\u591C\u65F6\u95F4","6:00|18:00"],["menu_autoSwitch","\u665A\u4E0A\u81EA\u52A8\u5207\u6362\u6A21\u5F0F","\u665A\u4E0A\u81EA\u52A8\u5207\u6362\u6A21\u5F0F",""]],l=[];for(let e=0;e<o.length;e++)GM_getValue(o[e][0])==null&&GM_setValue(o[e][0],o[e][3]);m(),GM_getValue("menu_customTime","").indexOf(":")===-1&&GM_setValue("menu_customTime",GM_getValue("menu_customTime","6|18").replace("|",":00|")+":00"),l.length>1&&_();function m(){if(l.length!=[])for(let e=0;e<l.length;e++)GM_unregisterMenuCommand(l[e]);for(let e=0;e<o.length;e++)if(o[e][3]=GM_getValue(o[e][0]),o[e][0]==="menu_disable")if(M("check")){l[e]=GM_registerMenuCommand(`${o[e][2]}`,function(){M("del")});return}else{if(GM_getValue("menu_darkModeAuto")&&!window.matchMedia("(prefers-color-scheme: dark)").matches){l[e]=GM_registerMenuCommand("\u274C \u5F53\u524D\u6D4F\u89C8\u5668\u4E3A\u767D\u5929\u6A21\u5F0F (\u70B9\u51FB\u5173\u95ED [\u62A4\u773C\u6A21\u5F0F\u8DDF\u968F\u6D4F\u89C8\u5668])",function(){GM_setValue("menu_darkModeAuto",!1),location.reload()});return}l[e]=GM_registerMenuCommand(`${o[e][1]}`,function(){M("add")})}else if(o[e][0]==="menu_darkModeType"){o[e][3]>3&&(o[e][3]=1,GM_setValue(o[e][0],o[e][3]));let t=g();l[e]=GM_registerMenuCommand(`${G(t)} ${o[e][1]}`,function(){V(`${o[e][3]}`,`${o[e][0]}`)})}else o[e][0]==="menu_customMode"?(GM_setValue(o[e][0],o[e][3]),l[e]=GM_registerMenuCommand(`#\uFE0F\u20E3 ${o[e][1]}`,function(){$()})):o[e][0]==="menu_customTime"?(GM_setValue(o[e][0],o[e][3]),l[e]=GM_registerMenuCommand(`#\uFE0F\u20E3 ${o[e][1]}`,function(){I()})):o[e][0]==="menu_customMode1"||o[e][0]==="menu_customMode2"||o[e][0]==="menu_customMode3"||o[e][0]==="menu_customMode3_exclude"?GM_setValue(o[e][0],o[e][3]):o[e][0]==="menu_autoSwitch"?l[e]=GM_registerMenuCommand(`#\uFE0F\u20E3 ${o[e][1]}`,function(){v()}):o[e][0]==="menu_forcedToEnable"?r("menu_autoRecognition")&&(p("check")?l[e]=GM_registerMenuCommand(`${o[e][1]}`,function(){p("del")}):l[e]=GM_registerMenuCommand(`${o[e][2]}`,function(){p("add")})):l[e]=GM_registerMenuCommand(`${o[e][3]?"\u2705":"\u274C"} ${o[e][1]}`,function(){x(`${o[e][3]}`,`${o[e][0]}`,`${o[e][2]}`)});l[l.length]=GM_registerMenuCommand("\u{1F4AC} \u53CD\u9988 & \u5EFA\u8BAE",function(){window.GM_openInTab("https://github.com/XIU2/UserScript#xiu2userscript",{active:!0,insert:!0,setParent:!0}),window.GM_openInTab("https://greasyfork.org/zh-CN/scripts/426377/feedback",{active:!0,insert:!0,setParent:!0})})}function G(e){return["0\uFE0F\u20E3","1\uFE0F\u20E3","2\uFE0F\u20E3","3\uFE0F\u20E3","4\uFE0F\u20E3","5\uFE0F\u20E3","6\uFE0F\u20E3","7\uFE0F\u20E3","8\uFE0F\u20E3","9\uFE0F\u20E3","\u{1F51F}"][e]}function v(){let e=prompt(`\u767D\u5929\u3001\u665A\u4E0A\u4F7F\u7528\u4E0D\u540C\u6A21\u5F0F\uFF0C\u4FEE\u6539\u540E\u7ACB\u5373\u751F\u6548~
\u683C\u5F0F\uFF1A\u767D\u5929\u6A21\u5F0F|\u665A\u4E0A\u6A21\u5F0F
\u4F8B\u5982\uFF1A1|3\uFF08\u5373\u767D\u5929\u6A21\u5F0F 1 \u665A\u4E0A\u6A21\u5F0F 3\uFF09
\u9ED8\u8BA4\uFF1A\u7559\u7A7A\uFF08\u5373\u5173\u95ED\u8BE5\u529F\u80FD\uFF09`,GM_getValue("menu_autoSwitch"));e===""?GM_setValue("menu_autoSwitch",""):e!=null&&(e.split("|").length==2?GM_setValue("menu_autoSwitch",e):alert("\u586B\u5165\u5185\u5BB9\u683C\u5F0F\u9519\u8BEF...")),m(),document.getElementById("XIU2DarkMode")&&(document.getElementById("XIU2DarkMode").remove(),_())}function g(){let e=GM_getValue("menu_darkModeType"),t=new Date().getHours(),a=GM_getValue("menu_customTime").split("|").map(Number);return GM_getValue("menu_autoSwitch")!=""&&(k()?e=GM_getValue("menu_autoSwitch").split("|")[0]:e=GM_getValue("menu_autoSwitch").split("|")[1]),parseInt(e)}function $(){let e,t,a,i;switch(g()){case 1:t=`\u81EA\u5B9A\u4E49 [\u6A21\u5F0F 1]\uFF0C\u4FEE\u6539\u540E\u7ACB\u5373\u751F\u6548 (\u90E8\u5206\u7F51\u9875\u53EF\u80FD\u9700\u8981\u5237\u65B0)~
\u683C\u5F0F\uFF1A\u4EAE\u5EA6 (\u767D\u5929)|\u4EAE\u5EA6 (\u665A\u4E0A)
\u9ED8\u8BA4\uFF1A60|50\uFF08\u5747\u4E3A\u767E\u5206\u6BD4 1~100\uFF0C\u4E0D\u9700\u8981 % \u7B26\u53F7\uFF09`,a="60|50",i="menu_customMode1";break;case 2:t=`\u81EA\u5B9A\u4E49 [\u6A21\u5F0F 2]\uFF0C\u4FEE\u6539\u540E\u7ACB\u5373\u751F\u6548 (\u90E8\u5206\u7F51\u9875\u53EF\u80FD\u9700\u8981\u5237\u65B0)~
\u683C\u5F0F\uFF1A\u4EAE\u5EA6 (\u767D\u5929)|\u6696\u8272 (\u767D\u5929)|\u4EAE\u5EA6 (\u665A\u4E0A)|\u6696\u8272 (\u665A\u4E0A)
\u9ED8\u8BA4\uFF1A60|40|50|50\uFF08\u5747\u4E3A\u767E\u5206\u6BD4 1~100\uFF0C\u4E0D\u9700\u8981 % \u7B26\u53F7\uFF09`,a="60|40|50|50",i="menu_customMode2";break;case 3:t=`\u81EA\u5B9A\u4E49 [\u6A21\u5F0F 3]\uFF0C\u4FEE\u6539\u540E\u7ACB\u5373\u751F\u6548 (\u90E8\u5206\u7F51\u9875\u53EF\u80FD\u9700\u8981\u5237\u65B0)~
\u683C\u5F0F\uFF1A\u53CD\u8272
\u9ED8\u8BA4\uFF1A90\uFF08\u5747\u4E3A\u767E\u5206\u6BD4 50~100\uFF0C\u4E0D\u9700\u8981 % \u7B26\u53F7\uFF09`,a="90",i="menu_customMode3";break}e=prompt(t,GM_getValue(`${i}`)),e===""?(GM_setValue(`${i}`,a),m()):e!=null&&(GM_setValue(`${i}`,e),m()),g()==3&&(t=`\u81EA\u5B9A\u4E49 [\u6A21\u5F0F 3] \u6392\u9664\u76EE\u6807\uFF0C\u4FEE\u6539\u540E\u7ACB\u5373\u751F\u6548 (\u90E8\u5206\u7F51\u9875\u53EF\u80FD\u9700\u8981\u5237\u65B0)~
\u683C\u5F0F\uFF1ACSS \u9009\u62E9\u5668 (\u5982\u679C\u4E0D\u4F1A\u5199\u53EF\u4EE5\u627E\u6211)
\u9ED8\u8BA4\uFF1Aimg, .img, video, [style*="background"][style*="url"], svg
 (\u4F7F\u7528\u82F1\u6587\u9017\u53F7\u95F4\u9694\uFF0C\u672B\u5C3E\u4E0D\u8981\u6709\u9017\u53F7)`,a='img, .img, video, [style*="background"][style*="url"], svg',i="menu_customMode3_exclude",e=prompt(t,GM_getValue(`${i}`)),e===""?(GM_setValue(`${i}`,a),m()):e!=null&&(GM_setValue(`${i}`,e),m())),document.getElementById("XIU2DarkMode")&&(document.getElementById("XIU2DarkMode").remove(),_())}function I(){let e=prompt(`\u81EA\u5B9A\u4E49\u811A\u672C\u5185\u548C\u767D\u5929/\u665A\u4E0A\u76F8\u5173\u7684\u65F6\u95F4\uFF0C\u4FEE\u6539\u540E\u5237\u65B0\u7F51\u9875\u751F\u6548~
\u683C\u5F0F\uFF1A6:00|18:30 (\u5373 6:00 ~ 18:30 \u4E4B\u95F4\u662F\u767D\u5929\u65F6\u95F4)
\u4E5F\u652F\u6301\u53CD\u5411\u8BBE\u7F6E\uFF1A14:00|12:00 (\u5373 12:00 ~ 14:00 \u4E4B\u95F4\u662F\u591C\u665A\u65F6\u95F4)`,GM_getValue("menu_customTime"));e===""?(GM_setValue("menu_customTime","6:00|18:00"),m()):e!=null&&(GM_setValue("menu_customTime",e),m())}function p(e){switch(e){case"check":return!!t();case"add":a();break;case"del":i();break}function t(){return r("menu_forcedToEnable").indexOf(location.host)!==-1}function a(){if(t())return;let n=r("menu_forcedToEnable");n.push(location.host),GM_setValue("menu_forcedToEnable",n),location.reload()}function i(){if(!t())return;let n=r("menu_forcedToEnable"),s=n.indexOf(location.host);n.splice(s,1),GM_setValue("menu_forcedToEnable",n),location.reload()}}function M(e){switch(e){case"check":return!!t();case"add":a();break;case"del":i();break}function t(){return r("menu_disable").indexOf(location.host)!==-1}function a(){if(t())return;let n=r("menu_disable");n.push(location.host),GM_setValue("menu_disable",n),location.reload()}function i(){if(!t())return;let n=r("menu_disable"),s=n.indexOf(location.host);n.splice(s,1),GM_setValue("menu_disable",n),location.reload()}}function V(e,t){e=parseInt(e),e>=3?e=1:e+=1,GM_setValue(`${t}`,e),m(),document.getElementById("XIU2DarkMode")&&(document.getElementById("XIU2DarkMode").remove(),_())}function x(e,t,a){e=="true"?(GM_setValue(`${t}`,!1),GM_notification({text:`\u5DF2\u5173\u95ED [${a}] \u529F\u80FD
\uFF08\u70B9\u51FB\u5237\u65B0\u7F51\u9875\u540E\u751F\u6548\uFF09`,timeout:3500,onclick:function(){location.reload()}})):(GM_setValue(`${t}`,!0),GM_notification({text:`\u5DF2\u5F00\u542F [${a}] \u529F\u80FD
\uFF08\u70B9\u51FB\u5237\u65B0\u7F51\u9875\u540E\u751F\u6548\uFF09`,timeout:3500,onclick:function(){location.reload()}})),t==="menu_autoRecognition"&&location.reload(),m()}function r(e){for(let t of o)if(t[0]==e)return t[3]}function _(){let e=!1,t=document.createElement("style"),a=new Date().getHours(),i=r("menu_customMode1").split("|"),n=r("menu_customMode2").split("|"),s=r("menu_customMode3").split("|"),d="",E="html, body {background-color: #ffffff !important;}",y=`html {filter: brightness(${i[0]}%) !important;}`,T=`html {filter: brightness(${i[0]}%) !important; background-image: url();}`,h=`html {filter: brightness(${i[1]}%) !important;}`,S=`html {filter: brightness(${i[1]}%) !important; background-image: url();}`,w=`html {filter: brightness(${n[0]}%) sepia(${n[1]}%) !important;}`,D=`html {filter: brightness(${n[0]}%) sepia(${n[1]}%) !important; background-image: url();}`,b=`html {filter: brightness(${n[2]}%) sepia(${n[3]}%) !important;}`,U=`html {filter: brightness(${n[2]}%) sepia(${n[3]}%) !important; background-image: url();}`,C=`html {filter: invert(${s[0]}%) !important; text-shadow: 0 0 0 !important;}
            ${r("menu_customMode3_exclude")} {filter: invert(1) !important;}
            img[alt="[\u516C\u5F0F]"] {filter: none !important;}`,X=`html {filter: invert(${s[0]}%) !important; background-image: url(); text-shadow: 0 0 0 !important;}
            ${r("menu_customMode3_exclude")} {filter: invert(1) !important;}
            img[alt="[\u516C\u5F0F]"] {filter: none !important;}`,B=`::-webkit-scrollbar {height: 12px !important;}
::-webkit-scrollbar-thumb {border-radius: 0;border-color: transparent;border-style: dashed;background-color: #3f4752 !important;background-clip: padding-box;transition: background-color .32s ease-in-out;}
::-webkit-scrollbar-corner {background: #202020 !important;}
::-webkit-scrollbar-track {background-color: #22272e !important;}
::-webkit-scrollbar-thumb:hover {background: #3f4752 !important;}`;switch(navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(y=T,h=S,w=D,b=U,C=X),k()&&(r("menu_runDuringTheDay")?(h=y,b=w):h=b=""),g()){case 1:d+=h;break;case 2:d+=b;break;case 3:d+=C+B,location.hostname.indexOf("search.bilibili.com")>-1?d+="ul.video-list img, ul.video-list .video-item .img .mask-video, ul.video-list .video-item .img .van-danmu, ul.video-list .video-item .img .van-framepreview {filter: none !important;}":location.hostname.indexOf(".bilibili.com")>-1?d+=`
.bpx-player-container[data-screen="full"] .bpx-player-video-wrap {filter: invert(1) !important;}
.bpx-player-container[data-screen="web"] {filter: invert(1) !important;}
.bpx-player-container[data-screen="web"] video {filter: none !important;}
* {font-weight: bold !important;}`:location.hostname.indexOf(".huya.com")>-1&&(d+='#player-wrap[style="height: 100%;"], .player-loading, .sidebar-show, #player-ctrl-wrap {filter: invert(1) !important;}');break}if(t.id="XIU2DarkMode",t.type="text/css",document.lastElementChild)document.lastElementChild.appendChild(t).textContent=d;else{let u=setInterval(function(){document.lastElementChild&&(clearInterval(u),document.lastElementChild.appendChild(t).textContent=d)})}let f=[];r("menu_autoRecognition")&&(f=r("menu_forcedToEnable"));let L=setInterval(function(){document.body&&(clearInterval(L),setTimeout(function(){if(console.log("[\u62A4\u773C\u6A21\u5F0F] html:",window.getComputedStyle(document.lastElementChild).backgroundColor,"body:",window.getComputedStyle(document.body).backgroundColor),window.getComputedStyle(document.body).backgroundColor==="rgba(0, 0, 0, 0)"&&window.getComputedStyle(document.lastElementChild).backgroundColor==="rgba(0, 0, 0, 0)"&&!(document.querySelector('head>meta[name="color-scheme"],head>link[href^="resource:"]')&&window.matchMedia("(prefers-color-scheme: dark)").matches)){let u=document.createElement("style");u.id="XIU2DarkMode2",document.lastElementChild.appendChild(u).textContent=E}else if((document.querySelector('head>meta[name="color-scheme"],head>link[href^="resource:"]')&&window.matchMedia("(prefers-color-scheme: dark)").matches||document.querySelector("html[class*=dark], html[data-dark-theme*=dark], html[data-theme*=dark], html[data-color-mode*=dark], body[class*=dark]")||window.getComputedStyle(document.body).backgroundColor==="rgb(0, 0, 0)"||c(document.body)>0&&c(document.body)<898989||c(document.lastElementChild)>0&&c(document.lastElementChild)<898989||window.getComputedStyle(document.body).backgroundColor==="rgba(0, 0, 0, 0)"&&window.getComputedStyle(document.lastElementChild).backgroundColor==="rgb(0, 0, 0)")&&r("menu_autoRecognition")){for(let u=0;u<f.length;u++)if(f[u]===location.host)return;console.log("[\u62A4\u773C\u6A21\u5F0F] \u68C0\u6D4B\u5230\u5F53\u524D\u7F51\u9875\u81EA\u5E26\u6697\u9ED1\u6A21\u5F0F\uFF0C\u505C\u7528\u672C\u811A\u672C\u6EE4\u955C..."),document.getElementById("XIU2DarkMode").remove(),e=!0}},150),setTimeout(function(){if(console.log("[\u62A4\u773C\u6A21\u5F0F] html:",window.getComputedStyle(document.lastElementChild).backgroundColor,"body:",window.getComputedStyle(document.body).backgroundColor),(document.querySelector('head>meta[name="color-scheme"],head>link[href^="resource:"]')&&window.matchMedia("(prefers-color-scheme: dark)").matches||document.querySelector("html[class*=dark], html[data-dark-theme*=dark], html[data-theme*=dark], html[data-color-mode*=dark], body[class*=dark]")||window.getComputedStyle(document.body).backgroundColor==="rgb(0, 0, 0)"||c(document.body)>0&&c(document.body)<898989||c(document.lastElementChild)>0&&c(document.lastElementChild)<898989||window.getComputedStyle(document.body).backgroundColor==="rgba(0, 0, 0, 0)"&&window.getComputedStyle(document.lastElementChild).backgroundColor==="rgb(0, 0, 0)")&&r("menu_autoRecognition")){for(let u=0;u<f.length;u++)if(f[u]===location.host)return;if(e)return;console.log("[\u62A4\u773C\u6A21\u5F0F] \u68C0\u6D4B\u5230\u5F53\u524D\u7F51\u9875\u81EA\u5E26\u6697\u9ED1\u6A21\u5F0F\uFF0C\u505C\u7528\u672C\u811A\u672C\u6EE4\u955C...."),document.getElementById("XIU2DarkMode")&&document.getElementById("XIU2DarkMode").remove(),document.getElementById("XIU2DarkMode2")&&document.getElementById("XIU2DarkMode2").remove()}},1500))});if(location.hostname==="bbs.pcbeta.com"){let u=setInterval(function(){document.getElementById("XIU2DarkMode")||(document.lastElementChild.appendChild(t).textContent=d,clearInterval(u))})}}function c(e){let t=window.getComputedStyle(e).backgroundColor.replace(/rgba|rgb|\(|\)| /g,"").split(",");return parseInt(t[0]+t[1]+t[2])}function k(){let e=new Date("2022/03/07 "+new Date().getHours()+":"+new Date().getMinutes()+":00").getTime()/1e3,t=GM_getValue("menu_customTime").split("|");return t[0]=new Date("2022/03/07 "+t[0]+":00").getTime()/1e3,t[1]=new Date("2022/03/07 "+t[1]+":00").getTime()/1e3,t[0]<t[1]?e>t[0]&&e<t[1]:e>t[0]||e<t[1]}})();
