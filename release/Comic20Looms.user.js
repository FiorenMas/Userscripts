// ==UserScript==
// @name               Comic Looms
// @namespace          https://github.com/MapoMagpie/eh-view-enhance
// @version            4.10.23
// @author             MapoMagpie
// @license            MIT
// @icon               data:image/x-icon;base64,AAABAAEAQEAAAAEAIAAoQgAAFgAAACgAAABAAAAAgAAAAAEAIAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAADF2+r/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/F3Of/xdzn/8Xc5//F3Oj/xdzo/8Xc6P/F3Oj/xdzo/8Tb5//E2+f/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/E2+f/xNvn/8Xb6P/E3Of/xNvn/8Tb5//F3Oj/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/F3Oj/xNvn/8Tb5//E2+f/xNvn/8Xc6P/F3Oj/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/F3Oj/xdzo/8Xc6P/F3Oj/xdvp/8Xd5//F3eb/xd3m/8Xd5//F3ef/xd3n/8Xd5//F3ef/xd3n/8Xd5//F3ef/xd3n/8Xd5//F3eb/xd3m/8Xd5v/F3eb/xd3m/8Xe5//F3eb/xd3m/8Xd5v/F3eb/xd3m/8Xd5//F3eb/xd3m/8Xd5//F3eb/xd3m/8Xd5v/F3eb/xd3n/8Xd5//F3ef/xd3n/8Xd5//E3OX/w9vm/8Tc5//D2+X/wtvk/8Xd5//F3eb/xd3m/8Xd5v/F3eb/xd3m/8Xd5v/F3ef/xd3n/8Xe5v/F3uf/xd3m/8Xe5v/F3eb/xd3n/8Xd5v/F3eb/xd3n/8Xd5//F3ef/xdzo/8Xb6f/F3eb/xd7l/8Xe5f/D3uX/xN7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xN7l/8Te5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5P/F3uT/xd3k/8Xd5P/F3eT/xd3k/8Xd5P/E3OP/zeXr/9Dm6//N4uf/0uju/9Hq8f/H4On/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5v/F3ef/xd3n/8Xd6f/F2ur/xd3n/8Xe5f/E3uX/w97l/8Pe5f/F3uX/xN3k/8Xd5P/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uT/xd3k/8Xd5P/F3eT/xd3k/8Xd5P/F3eP/xN3j/8Td4//E3eT/xN3k/8Td5P/E3eT/xN3l/8Pe5f/D3ub/xN/n/8Tf6P/E4Oj/xOHp/8Xh6//F4Or/0ez2/5aquv9YZ4X/YXGQ/1Jbd/+LmKj/yd3l/8be5//F3uT/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/E3uX/xd7m/8Xd5//F3ej/xdrq/8Xd5//F3uX/xd7l/8Te5f/F3uX/xd7l/8ji6v/G4Oj/xN3l/8Tc5P/E3eT/xN3k/8Pd5f/E3uf/xN/o/8Tf6P/E3+r/xOHq/8bi7P/G4+z/x+Tu/8jl7v/J5e//y+Xv/8vl7v/M5e3/zeXs/87k6v/P4uj/z+Dj/9De3//O2dr/zdXV/8zRzv/IysX/xMK8/8rEvv+Ng4P/T2yk/01spv8ZKmj/DCBs/3yFmP/b8fj/w93p/8Td5f/E3eT/xd7l/8Td5P/E3eT/xN3k/8Xe5f/F3uX/xd7l/8Xe5f/E3uX/w97l/8Te5f/F3uX/xd7l/8Xe5f/F3ef/xd3n/8Xb6v/F3ef/xd7l/8Xe5f/F3uX/xt7m/8fd5P+6ztP/xNnd/8zj6f/N5/D/zubu/87l7P/O4+j/z+Hk/8/e3//O2tr/ztXU/8vQzv/Iy8f/xcS+/8K7tP+9s6v/uayj/7Okmv+unZL/p5WK/6CNg/+ZhXz/kn14/4p2dP+CcXT/e21y/3Rpcv9vZXL/aWRy/2Nhdf9hZH3/VFNn/0BSf/9JZqf/IjNy/x45jf9DP1f/tqid/9DT0P/P4+r/yePv/8Pd5v/G4Oj/yuTs/8rj6//D3eT/xN3k/8Xe5f/E3uX/w97l/8Te5f/F3uX/xd7l/8Xe5f/F3uX/xd3n/8Xd6P/F2ur/xd3n/8Xe5f/F3uX/w9zj/8/n7/+Il6v/QVF8/y07af9laHv/r6KZ/5+Ph/+Zh3//kH95/4l4dP+EdHT/fW9z/3drcv9yaXP/bGZ1/2Zjd/9fYHj/Wl99/1phg/9VYYf/UWGN/1BklP9PZpr/T2mi/01sqf9NcLD/UXS5/1F4vv9Te8P/VX3H/1eAzP9Ygc3/XojX/0lpr/8+Tnv/VXOv/yU1dv8eLWn/GiZT/y8zWP9uW2H/n4yE/8XAuf/V4uT/xNnf/7HEyf+2yM3/0eXq/8ri6f/E3eT/xd7l/8Te5f/E3uX/xd7l/8Xe5f/F3uX/xd7l/8Xd5//G3ef/xdrq/8Xd5//F3uX/xd7l/8Lb4//Q6e//gJGo/0dlqf8fOIf/GSNY/0ZRfv9RaKD/UWqi/1Bvq/9Rc7P/U3e8/1R7w/9Vf8j/V4HN/1qF0/9dh9b/XorZ/12K2/9hjN7/Y47f/2SQ3v9lk97/aJLg/2mT3/9pkt3/aJHd/2iR3f9pkdz/aJHa/2qR2v9pkdn/Z47X/2WN2P9IZrH/RVqK/1t8t/82S4n/HShZ/zdLi/8iNnf/FS99/x4ua/87Oln/alxk/0BGYf9DWpD/OUuC/0tTcv++0dr/x+Hp/8Td5P/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3ef/xt3o/8Xb6v/F3ef/xd7l/8Xe5f/D3OP/z+nv/5qruP9HZab/Ijp9/xcgUP9QcLf/apbl/2OO2/9kj9v/Y47a/2SP2v9jj9n/ZI3W/2OJ0v9hhs7/XILJ/1t/xP9ZfL//V3i7/1Rzs/9TcK7/T2yo/0tnof9GYZr/Q1qT/z9Vi/86T4P/OEp7/zVEdP8xQG3/LDpl/ys1Xv8pMlj/ICJD/zE8Xv9KYpX/MEN2/x8rV/8fLl7/IzBq/yk+h/8kPoz/GzmN/xUxfv8ZLW7/Kjx7/yU5eP8XJF//sMHJ/8vl7P/E3eT/xd7l/8Xe5f/F3uX/xd7l/8Te5f/F3uX/xd3n/8be6P/F2ur/xd3n/8Xe5f/F3uX/xd7l/8fh6f+90df/Wnaj/zFHf/8YH07/MkN+/z9UiP9CVor/P1OG/z5Pf/8xPm3/KzVg/y43X/8zOl7/NDpa/zE0VP8sLkz/LS1I/zAtR/8yL0b/MzBH/zYyR/84NUr/PTpL/0I/T/9JRlb/UU5a/1lXYP9iXmf/aWdu/3Nyd/99fYD/hIWJ/5manP9iZ3b/S2qq/1iAyf84SYH/Z1df/0xJZf8sM2D/KjZv/yo1cf8hMXL/JD2H/yU/jv8WJGH/Qklo/8zi6P/E3eX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xd5//F3ej/xdrq/8Xd5//F3uX/xd7l/8Xe5f/D2+P/0Onv/4mcrv9JZaL/JC9i/xosbv8aLnX/FiFU/x4pZv8ZIFH/aGl2/42Pl/+Dgoj/dXB3/3V0ev+Pj5D/rLGx/663uv+zvMD/usPH/77Kzv/C0NT/xtXY/8ra3f/M3uH/zuHl/9Dk6f/S5+z/0unv/9Tq8f/V6/L/0+zz/9Dq8v/e+P3/hJar/1V+xv9gj9z/Mz9v/7Oonv/SzML/xMnJ/2x4kv85T47/QlyX/yMwaf8hM3f/DRdL/4yZo//R6/L/wtvi/8Xe5f/F3uX/xd7l/8Xe5f/E3uX/xd7l/8Xe5f/F3ef/xd3n/8Xa6v/F3ef/xd7l/8Xe5f/F3uX/xd7l/8Xf5v/H3OT/W2uM/zE/c/8mNGz/IjRy/xooXv8aJ2j/IC1g/8XY3v/g+v//cIKc/0pop/8xRYH/Hy9v/217lv/X8ff/y+Xt/8rm7v/J5O3/yOPr/8fh6v/G4On/xd/n/8Te5f/D3eX/w9zk/8Lb4//B2uL/wdrh/8HZ4f++19//zeTr/3yNof9Se8P/XofM/yIya/8rPHL/VGKI/56ruP97hJT/YozU/3er+P8nP4n/MT1q/56stf/I4Of/xN7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd3n/8bd6P/F2ur/xd3n/8Xe5f/F3uX/xd7l/8Xe5f/C2+P/0Oft/3SHov9Vgcv/PFeY/x0ucf8gM3j/EyVr/3N7kf/P5u3/zOPp/36Nof9Sdrz/M0qL/w4gbf9KVXX/zuTp/8DY4P/C2+P/xNzl/8Xe5//G4Of/yeLp/8ni6//L5Oz/zufu/8/o7//Q6vD/0uvx/9Ts8f/U7PH/0unv/9/2+f+Glqn/UnzD/12Hzf8lPH//HDiJ/xUuf/8TKXP/HCxo/y9Ad/9XdrX/IjyH/0dWgP/Z7/H/w93l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xN7l/8Te5f/F3uX/xd7l/8Xd5//F3ej/xdrq/8Xd5//F3uX/w97l/8Pe5f/F3uX/w9zk/83l6/9zh6X/V4bR/z1cof8fOIf/IDN4/w8bWP+hqbb/2fL4/8/n8P/C1tv/W3Sr/0Fdo/8TJGb/orC9/973+//R6O7/0enu/8zh5v/J3eL/xtjc/8LS1v+7zNL/tcXM/66+xP+pt8D/oK65/5elsf+Om6z/g5Gl/3iGnv94hZ7/Ul5+/1qEyf9bhsr/Jjt//yI/kP8lQI//JUGR/yM/kf8aM4H/LUKG/yQ8hP9DU33/zOHl/8Td5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Te5f/D3uX/xd7l/8Xe5f/F3ef/xt3n/8Xa6v/F3ef/xd7l/8Pe5f/D3uX/xd7l/8Pc5P/O5ev/c4el/1eF0P89W5//HzN+/x0qaf8TIWT/XWJ2/8PS0v+1xMj/pa+1/0tcif8xRH7/Eh1R/2x2i/97iqD/aHSM/2Fuif9jdpn/Wm2U/1Fmk/9MZZT/R2GV/0pkmv9OaqH/Q1+Z/0JenP9CYJ//RmOi/0hmpf9Ka6r/T3Ct/0FWh/9chMj/XIfM/yM1cv8XKWL/HTJz/yE4f/8jO4X/ITyL/y9JkP8iN3//RVSA/87k5//E3eX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/E3uX/xd7l/8Xe5f/F3uX/xd3n/8bd6P/F2ur/xd3n/8Xe5f/D3uX/w97l/8Xe5f/D3OT/zuXr/3OHpP9WhM//PVqd/xwvef8bKGr/JDVx/zhPgv9OZZj/R2Gb/0tnoP9KZ6P/VHKx/1p7u/9Qc7X/VXe6/1Zzrv9ge6//Y4TD/3CPw/+HptL/iqjR/5q22f97lLr/YXag/7LH3P+yyNv/t8ve/7vP3v+90d3/zODm/56tuP83QGD/XojM/1mDyf8iLVf/ICta/yIvZf8eLWr/Hi1r/xstcP8pPHn/IjZ8/0VUgP/O4+f/xN3l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xd5//F3ej/xdrq/8Xd5//F3uX/w97l/8Pe5f/F3uX/w9zk/83l6/9yhqP/VoPP/0Jdnf8iL2D/GCNX/yg4av9be7n/WnKf/4OWrf9ccpT/TGij/yw/eP9KVnj/t8LE/3qElv9PW3P/u8PC/1Rbcv9dY3P/sre2/5ykqP+hqaz/eYGN/y82Uv+Bh5L/fYSR/3J5iP9pcYP/YWl+/1xmfP9JUW3/Ji1Q/1+Kzv9Xgcb/PVCE/zBFgf8kMWX/JDuF/yQ/jv8gN4H/JDl//xoveP9HV4H/z+Pn/8Pd5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3ef/xd3n/8Xa6v/F3ef/xN7l/8Pe5f/D3uX/xN7l/8Lb4//R6O7/eY2p/1F+zP9LaKX/PFCA/xohS/8gLF3/Kjt0/y84Yf9HTm7/Ljll/yw9d/8hLmb/LDlq/0JOe/89S33/MUB2/zpJfP85Sn7/MkN6/zJDef8wQ3n/Lj93/zNCe/84SH7/LD12/y0+ef8vPnv/MEB9/zJAfv8xP3//MEGC/zE/dv9dhsn/WobM/yAzdP83Snr/JjNg/xooZ/8gN37/IjqI/yQ+jf8TJ3H/SVmD/83k5//D3eX/xd7l/8Te5f/D3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd3n/8Xd6P/E2ur/xd3n/8Te5f/D3uX/w97l/8Td5P/G4Of/wtXd/1Jggv9YhtT/RF6a/yo5bP8sPHH/Qluc/zxVkv9BWpn/P1ST/0VZlf9GWI7/Q1WK/zVIfP85SoD/NkV4/zZEc/83Q3D/OENs/ztEa/86RGf/OkVm/z9JZ/9CS2n/RE1r/0dQbf9JUm3/TVZw/1Nbcv9ZYXb/XWV5/2Rtf/9OV3H/WoXL/1mFyf8lO4D/JTx+/1dmiv9FTGf/Nj1Y/y43Yf8kMmj/FSRo/0pahf/M5Of/w93l/8Xe5f/E3uX/w97l/8Xe5f/F3uX/xN7l/8Te5f/E3uX/xd7l/8Xd5//F3ej/xdrq/8Xd5//E3uX/w97l/8Pe5f/D3OP/zujv/5uuuf8xQWv/YI7Z/0Jdm/82UI3/GShc/x4rZP8WH0r/FxxB/wYCAv8ODyb/DA86/zU2Tf+PkJb/Jyk0/0BBTP+WmqD/maCl/5adov+Yn6T/maGn/5miqP+boqr/m6Or/5qkrP+apKz/mKKr/5ehqv+XoKr/lp+q/5Gcp/+Un6v/aHGJ/1eDyP9ahsr/Jz2B/xcxhP9QVnf/VFlr/z1BV/8vNEz/KjZp/xknZP9LWob/y+Ll/8Lb4//F3uX/xd7l/8Te5f/D3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3ef/xd3n/8Xa6v/F3ef/xd7l/8Pe5f/D3uX/w9zk/8zm7f+ou8P/M0Bm/1+N2v9BW5L/GyRL/wwSOP8VHEb/JC9d/xYaOP8SEyf/IidN/yEoWP8zOl3/aW+J/01VcP9VXHn/WmKB/1Jaef9OVnj/S1R2/0hTc/9IUnL/SVNz/0lSdP9HUXP/RU9y/0NMcf9CTHL/Qkxy/z9KcP8/SW7/Pkhu/zY/Zf9bh8v/WobL/yY9gP8eOIf/NT5m/zY9W/83P1v/OUFd/yg1a/8VI2H/TVyF/9rw8//K4uz/xNzj/8Xe5f/F3uX/xN7l/8Xe5P/F3uX/xN3k/8Xe5f/F3uX/xd3n/8bd6P/F2ur/xd3n/8Te5f/D3uX/w97l/8Xe5f/F3+b/xNrg/1Rjgv9Zh9X/PlmV/ztPiP8tPG3/KTVg/yY4df8XGT3/RE9z/1Bfhf9UYoj/UV+H/0VRef9LVXz/SVR5/0RQdv9CT3f/QU14/0FNev8/Tnr/P096/0BPef8/Tnn/PEp5/zlIdf82RXX/NEJ2/zFBc/8uPnD/LTxv/yc3av8nM2L/XYjM/1uHy/8mPX//HTmH/yQxY/8kMFf/HCNI/ykqPP8fIDj/EBY+/yAmTP9MUWD/sMHL/8vj7f/B2uP/xN7l/8Xe5//G3+j/xuDo/8nj6//F3+b/xN3k/8Xd5//G3ef/xNvq/8Xd5//E3uX/w97l/8Pe5f/F3uX/wtri/87k6v91iab/U4LP/0RfoP8pQIP/JTyB/zhKhf8tPXf/IjR8/xolXP8UGTj/GiRO/xQeRv8qNVz/LTpg/zA9Zf8yPmb/Mz9n/zRAZ/81QGb/OD9j/zk/X/87QFz/PEFa/z5CWf89QVb/Pj9U/0FBVv9JR1z/UExf/1RRYf9jXmv/UFFm/1iDyf9ahcn/JTt//yA7if8cJU//FBpB/xQZNf8cJlD/IzNx/yM0bf8bJFn/Bgs8/0NJYv/R5Or/0Obs/8zi5//J3uT/xtrf/8TY2v+4ytD/x93k/8rj6v/F3Ob/x97o/8Xa6v/F3ef/xd7l/8Te5f/E3uX/w9zj/8jh6f/a8vf/domn/1SDz/8/Wp//GS12/xs2g/8mPoL/Fidb/wogaP8cJ0//DxIl/x4hM/9iXFz/e3R0/4F5eP+Cenj/h3x5/4p9ev+Mfnn/jH55/4+Aef+Sg3r/lYV8/5eGfP+aiX3/nIt+/5yNf/+fj4H/opKF/6SVif+snZD/hn13/1hbav9ij9j/YI/U/ylDiP8ZM4P/SE9r/3yBiP8pNV3/OVOU/0tpq/8zTI3/Hixp/xwiVv8cIk7/S1Vx/1Nef/9LVnr/RlN5/0FOeP8+S3j/HShO/2Bqff/J3uf/xt3n/8bd5//F2ur/xd3n/8Xe5f/E3uX/xNzk/8/m7/+zxc7/nKmw/2Jxjv9Yh9H/Plqe/x0weP8dNoT/SVJ5/46Pk/+UlJv/rKur/7Kxr/+5trX/1c3I/9TMx//X0Mr/29XP/9/a1f/i3tj/5uLb/+jj3v/p5uL/7enk/+/r5//u7Oj/8O7r//Hv6//y8Oz/8vDt//Lw7f/x8O3/9/Xu/05Taf8FDS3/OlCK/zRLi/8QFz//DRNA/z1CWP+DiZL/PU+A/0dlqv9Sb6//JzZs/zxXoP9WftT/VHzO/094zP9OeM7/U3zT/1aA2P9diN//XYfc/05wqP9JZ4n/hpen/9Hn8f/E2+X/xdvq/8Xd5//F3uX/w9vj/9Dn8P+QoLL/HydJ/wsMMf8vP23/Zprh/z9ep/8bLXX/GiJP/6yrqf/d3NX/0c/M/8zKx//Ry8j/zsrF/8bCvv/FwLz/w765/7+5tP+8ta7/uK+n/7Kqov+tpJz/qJ+X/5+blP+clY7/mZCH/5WLgf+RhXv/jIB2/4h7cv+Ddm//f3Ns/3NoZf9DTm7/OEp2/zdIef86TH//RFeH/zdGdf8HDDH/JStL/0daiv9DYKn/SmSl/xohSP9AU3X/aoy4/2OArP9kgqz/aISr/2mFqv9th6r/aYKi/1pzk/80RGb/ZXWH/77T3f/J3+n/xt3n/8Xa6v/F3ef/xN3j/8vk7P+zw87/Kzlj/yAybf8fLGD/Fxw7/zhOhv8xQW//FhxE/xkZMf8sLD3/NDVI/yIpRf8fIjb/Qj1H/09IUP9OSE//T0lQ/1BLUv9RS1X/UU1X/1JPW/9SUF//UVFj/05QZ/9LUWn/T1Vs/1Rab/9VXHP/V113/1hhev9YZX//WGaG/1tskf9OXYT/WXu4/2+f7f9rmeH/Z5La/2qX4f9Naab/DxM2/z5IYf9TZpD/ZYzK/2GCtP82RHD/IzVs/yU1a/8fKU//HyZE/6Ovuv+0xs//tsbO/7DAyf+cqrb/iJCd/8PX4f/L4uv/xN3k/8fe5//E2ur/xd3n/8Lb4v/T7PP/dYGT/yU6df8kNXf/LTtw/0xmlv9PaqH/U2+g/1d0pf9ee7L/X321/2B+tv9ggLz/YoLB/1+Bwf9fgML/XYDD/11/w/9bfsb/W3/G/1x+yP9afcf/W37G/1p/yP9Xfsr/VX7K/1V9yv9VfMf/UnrF/1F5xf9RecP/TnjB/092vf9Rd7v/S2yu/zFAav9GVXX/XXaj/1Ztmf9FUnj/PUp1/xgiT/+DjZ7/dIOh/16FwP9vk8b/PU5//01bhf9iea3/NUhx/zE5V//H2+T/zefu/8nj6v/M5u3/zeXt/6a2wf/K4ur/xNvl/8Xe5f/H3uf/xdrq/8Xd5//C2+L/0erw/2dziP8tQX3/JDh7/0BVgv9PZpj/U3Co/1BqoP9RaqD/TWSa/01jmf9KYZb/R12U/0ZZkf9GWI7/R1iM/0ZYjP9HWIv/SFmK/0dZiP9LW4f/Tl2H/1Ngif9WY4r/WWaM/11pj/9ebY//ZHCQ/2p0kv9teZX/cnuX/3Z+mf95gpr/f4ea/4eNn/8hLFL/CxQ2/2GJ0f9XgMn/Jzd1/zFFif8aJ1b/XGV6/zI5U/8vQn3/T3C3/zdKhP94f5b/bXmS/wsUPf9FTWz/y+Do/8Tc5P/E3eT/xd7l/8Pa4v+drLj/yN7n/8Xd5f/F3uX/xt7n/8Xa6v/F3ef/wtzi/9Hq8f+DkaL/Okt4/y8/dP8qN2T/JSxO/zNBb/8vPm//M0Ny/1h2vv8qNmf/GCBV/0JGX/+QjIn/2dfR/+3s5P/t7OX/8vDs//X07//49vH/+vjz//389/////n////7/////v//////////////////////////////////////////////////////1M/K/3Byf/9ahc3/XIXK/y9Hj/8fOI3/UFdy/5eao/9RV2n/GSBJ/yozWP8kL1f/KDJi/z1DXv8eIz//eIWV/9Lr8f/C2+L/xd7l/8Xe5f/E3eX/m6y3/8fd5f/F3uX/xd3n/8Xd6P/E2ur/xd3n/8Td5P/H4Of/wNXg/1FZcf80P2H/GyZg/ys8av9chsn/OFGR/zZKgf9fiNr/GyVS/w0UPf88PFP/g3x6/7ewrP/Fvrj/wLmz/761r/+6saz/uK6o/7Sqpf+wpqL/rKKf/6ifnP+km5j/n5eU/5yUkP+XkIz/lI2J/5KLhv+NhYH/iYF//4Z/fv+DfHz/fnp6/4yHhf9dX23/WYXN/1qDx/8zTpf/HDKC/1xecf/IyMn/Zml9/yEmRf8/PEH/LCxF/1hjgP/M4ej/vtHZ/8Tb4//G4Ob/xd7l/8Xe5f/F3uX/xt/m/5ytuP/F2+T/xd/m/8Xe5v/H3ef/xdrq/8Xd5//F3uX/w93k/8vj6/+90Nn/a3eK/01Taf9EU3j/YJLc/zlSj/8qPHD/WH3H/yEnT/8hJj//HyIx/zM1Qv9CQUz/QUBL/0A+Sv8+PEn/PTxJ/0A9R/9BP0f/QT9I/0JARv9DQkf/RURJ/0ZETP9GR03/R0hO/0lLUv9NTVT/TU5U/01OU/9MTlT/S01W/1BSWv8gJTv/FiFE/2CLz/9bhcz/JTRv/xceTP8IEUD/ISZD/1BVZv9DQ1H/S0tX/09UY//F2eP/xd7l/8ji6f/G3+b/xd7l/8Xe5f/F3uX/xN3k/8fg5/+gsLr/xNri/8Xf5v/F3uX/x97n/8Xa6v/F3ef/xd7l/8Xe5f/E3eT/yePq/8/p7//Y7/L/doun/1aFzv89WJP/IzBf/yg5av8XHT7/MkFu/1JSXv+Bf4H/qqip/6Sgof+loqb/pqar/6mprP+qqq3/q6qr/6yqqv+urKv/r6yp/7Ctqf+xrqz/sK+u/7Gxsf+0s7H/trOw/7eysP+3s7H/tbGv/7a0sv+jo6X/KS9R/xwkRP9hjNL/WYPI/zdLfP9FYZX/FShp/3+Opv/P3uH/S0pU/01NV/9eZG//0ejy/8Td5P/E3eT/xd7l/8Xe5f/E3uX/xd7l/8Td5P/I4ej/obC7/8PZ4P/G4Ob/xd7l/8fe5//F2+r/xd3n/8Xe5f/F3uX/xd7l/8Td5P/A2uL/zOTo/3GGov9YhtL/OlGK/yMyXf8iLFf/CQom/xQYM/8eHCf/Qz0+/2pmZP9oZGX/Z2Zo/2Nmav9lZ2n/Z2dp/2ppaf9ramf/a2pm/2xpaf9raWf/amlm/2poZv9qaGX/a2Zi/2tmYP9rZV//aGNf/2ZhXv9jXln/TlFb/yk7bv8dJU7/Yo7T/1mDxv9GXI3/VnKp/xMmaP91g53/vs7T/0pKVP9QUVj/X2Vw/83k7P/D3eP/xd7l/8Xe5f/F3uX/xN7l/8Xe5f/E3eT/yuPq/5+vuf/B1t7/xuDn/8Xe5f/G3uf/xdrq/8Xd5//F3uX/xd7l/8Xe5f/F3uX/w9zk/87m6v90iKb/UXzG/zZHd/9GXY7/Iy1c/zlKgf9AUoX/PlB9/0hZgv9CU3v/QlN7/0RWfv9FWH//Sl+B/09ggv9JWoD/SVl+/0lZff9MXID/TF6B/01fgv9OYIX/TWCG/05hhv9OYof/TmGH/05ihf9OY4b/T2KG/0pegf9OaZj/HCZI/2CLz/9bic//Ii1f/xwwdv8TLX3/doSb/8HR1f9KSVT/UE9X/15lb//O5e3/xNzj/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xN3k/8zj6v+er7n/vdPb/8fh6P/F3uX/xt7n/8Xa6v/F3ef/xd7l/8Xe5f/F3uX/xd7l/8Pc5P/O5ur/c4mm/1N+yP9BV4//UGaV/yo0Yv85SXv/QVOA/0Vclf9RYpL/jpey/5Kbtf+Rm7T/kpq0/5igtv+fprf/lp2y/5Scsv+UnbP/lp60/5ees/+Yn7P/mJ+0/5iftP+YoLb/mKC2/5aftv+XobX/lqC0/5mluf9+jKH/Wnik/yApTP9gi83/WojP/yg4dv8jNXj/FC18/3WEm//C0db/SUlT/09OV/9dZG3/zeXt/8Pc4//F3uX/xd7l/8Xe5f/F3uX/xd7l/8Td5P/L5ev/na23/7rQ2P/H4ej/xd3l/8fe5//F2ur/xd3n/8Xe5f/F3uX/xd7l/8Xe5f/D3OT/zubq/3KGpf9Wgs3/OlWa/yMwa/86R3P/AwQh/xccO/8TH07/PkNl///+7P////T////y////8/////L////y////8/////L////z////8v////L////z////8v////L////w////8P////H////y////8f////b/+vLo/09ehv8ZIEn/Yo7Q/1mGyv8pQIT/Jjh4/xMpdP90g5v/wM/U/0dHUv9PTlf/XGJr/8zj6v/D3OP/xd7l/8Xe5f/F3uX/xN7l/8Te5f/E3OP/yuTr/5mps/+4zdX/yOLp/8Td5f/H3uf/xdrq/8Xd5//F3uX/xd7l/8Xe5f/F3uX/w9zk/87m6v90hqb/VX/N/z9Znv8aLHL/Lz9+/y03af8aHjv/Fxsz/zQ8W/92eoz/e3+P/3x/j/+AgI//g4KQ/4SDkv+FhJL/h4aT/4mHk/+LhpP/jYiU/42Klv+OjJb/kI2Y/5KPmv+UkZz/lpOd/5aUnf+Wlpz/lJOc/5+do/9dX3T/JzRc/2CL0P9ahsn/KUCF/yo+gv8TK3b/fo6l/8vb4P9JSVT/UlJb/2Jnb//c8ff/xN3l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/wtvi/9Pt9P+is77/tMjS/8rj6v/E3eT/xt7n/8Xa6v/F3ef/xd7l/8Xe5f/F3uX/w9zj/8DZ4f/M5Oj/c4Wl/1SAzf89WJ7/HC5z/yE6hf8uPXj/JixN/x0kRf85QWf/lZSe/5eXo/+TlJ//k5Kf/5KQof+RkKD/j4+e/42Onf+Mjpz/jIuc/4uLnP+Jipr/h4iZ/4WHmf+FiJn/hYeX/4SGlv+DhpX/gYWU/4GEk/9+gJD/jo6a/2RpgP9YhMv/XIfM/yg/hf8oPoX/EiRj/1phb/+fpaj/OzY8/09MUv9MTlb/rLe9/8fc5f/E3ub/xN3k/8Te5f/F3uX/xN3k/8vh6v+0xs//eYOM/7fK1P/L4+z/xd3k/8fd5//F2ur/xd3n/8Xe5f/F3uX/w9zj/9Do8P/S6fL/3PHz/3yOq/9Rf8z/PVqf/xwudP8kQI3/HChk/zc+Y/8dJ1H/SVB5////+f///////////////////////////////////////////////////////////////////////////////v////7////9/////f////z////6//////+np7D/T3vD/1+Jzv8pQIb/HSth/xcdQ/8YJVn/Jzx4/0Rem/8uOmX/GiNL/xMfWv+Jlaf/0+30/8Te5v/H4Oj/xd3n/9Dp8v+errz/GiFB/yk3Xf+Mmqf/0eny/8Pb5P/G3uf/xdvq/8Xd5//F3uX/xN3k/9Dm8P+hrrj/XGJw/0VJXP8/TW3/W4rW/zxZn/8aKGf/FyFP/w8SL/8cHzr/GyE+/zlAZP+LjJT/lZSZ/5qWlP+emJX/oJqW/6Gbl/+jm5n/ppya/6eem/+ooJ3/q6Kf/66lov+xqaX/tKun/7ewqv+5sqz/vrWw/8K4sv/CurX/xLy3/8O7tv/Z0Mb/h4aT/1N/x/9fidD/Kzx3/yMvX/8mNnH/M1Gn/zpguf9Ca8P/LTx2/zBKlP8qTKX/WmJ8/9Hj4//D1Nn/xdba/8LU2P/P4OH/XmqF/xknWP8xQXb/R1F0/8vg5P/G3Of/xt3n/8Xa6v/F3ef/wtvi/9Lr8/97hZT/BwkS/xAZPf8JDS3/Kzdc/1+N2v86VZn/GyZV/xcgT/8UG0H/GB42/xIVK/8yOVH/bnB9/25we/9oaGn/bmpo/25raP9va2r/b2pq/3Brav9saGf/amRk/2VgYf9iXV//Ylxf/2BcXv9dWlv/XFha/1xXWf9bVlf/WlRW/1hSVf9cVlj/Lyk0/yAkQP9gi9L/XIbM/yo3Y/8wQXj/M0N6/zdOjv82U5//QV+j/zJAc/8hMGz/M0+e/zA7Zv9IXY7/Sl+R/0ldj/9MX5D/R1iK/zxRhv8iMWX/IC5Q/09xh/+4ytP/yuLs/8bc5//E2ur/xNvl/8vl7P+sv8v/Exkp/xsqQf84RGr/pqyu/0BNbv9bitj/PViW/zdKf/8dMHX/b3GI/9DOy/++vL3/v769/8vJxf/KycT/yMbC/8fEwP/Ewb3/wb65/7+7tv+/u7X/vbmz/7q2sf+2tK//tbOu/7Wyrv+zsav/sK6p/7Ctqf+tqqf/qqmk/6elov+urKf/iYyQ/x4qVP8jLFz/YYzT/1uFyv8uPGj/O0+J/0RZj/9EXZb/MEiO/0tmpv9AT3z/LkWN/zZUqf9BS3L/b4ey/2uEsv9pg7L/aYS0/2R9rf9bdKb/Ljts/yYxYf88Unj/uczV/8nh6//F3ef/xdrq/8La5P/V7PP/ZG+C/xAePP8pO2H/NENx/2Bqfv9cZ4H/VITT/0Jdm/9feqX/MU+b/8PDyv////////////////////////////////////////////////////////////////////////////////////7////9/////P////v///76///9+f/7+vb////+/56ptP83Uof/Lzx6/2CM0v9ahMj/O057/0FXk/85S4L/Lj5u/yU6fP9NaKr/VmaI/zBIkf8cMYD/e4aU/9rx8v/J3uP/zOHl/8vf4//R5Ob/cIKb/y8+a/85T43/SFWA/8nd4v/G3ej/xt3n/8Xa6f/G3Of/y+Dn/0BJZ/8hNF3/KThp/1Rffv80R33/NUBh/12M2v84UpP/aYCi/y9Gi/9hZ4X/p6Wm/6Ojqv+trbD/t7e5/7u6vP++vb//wcDC/8XExf/Jycn/zc3N/9DQ0P/S0tL/1tXW/9rZ2f/d3Nz/4N/e/+Tj4f/n5eT/6ujn/+3s6v/w7+7/8PDv//36+P+grLj/U22a/yw6df9gjNP/WYPH/z1Qe/89U4z/HilS/z5Siv8vS5v/UG2s/1Vrjf8UGDf/VVtw/7nO1v/H4en/w9zk/8Td5f/C2+P/zOft/5iouf8sOmD/M0Nr/4KRov/R6fH/xNvk/8bd6P/E2un/yd/q/77S2f84RWf/KkBq/yo4av9KVHf/Jzdu/yk5af9ijtj/MUmO/0VYfv8+T3f/DxhT/xQgV/8ULH7/QU11/9LNyP/X0tH/0c3L/9DMyv/Mysb/ycbD/8XDv//Dwb7/wL68/768uv+9urn/vbm3/7u4tv+4t7T/trWy/7Sysv+ysK//sLCu/66urv+xsK//lpqg/01olP8fK1r/YIzR/1mDyv8+UHv/RFmN/yU2Z/8wQXb/MEF2/0Vckf8+UoD/Gh00/8bY3f/N5+7/w9zj/8Xe5f/F3uX/xd7l/8Td5P/L4+r/nq+6/5Skrf/J4uj/xd7m/8Xd5//H3ef/xNrp/8ng6v+80dj/PElp/ylAav9IVYT/p621/xokUP8nNWP/ZI7Y/zZPlP8uPnT/Ok58/xkfSP8YH0L/Ex5F/zg7Tf+WjYH/oJOI/6SVif+rmIz/sJyN/7ehkP+6ppP/vqqX/8Owmv/Isp3/zbWh/9C6pf/Svqn/1sKt/9rIsf/czbb/38+8/+PTwP/l1sT/5tnJ/+3ezv+enaL/RE5t/1yIy/9bhsv/RliF/05ilP8rPHb/LD58/x8pVP8bI0v/KTRs/yQrUP+zxMr/yePq/8Td5P/F3uX/xd7l/8Xe5f/F3uX/xN3k/87o7v/Q6vH/xd7l/8Xe5f/F3ef/xt3o/8Xa6f/H3ef/x93m/1Bbcv8vRm3/MUFw/ycuUv8YIVP/NkNq/2KL2f82TpH/MUWC/zBBgP8pNWv/JC9j/yIrWv8nMV3/LDhi/y04Yv8uOGH/LTdd/y41XP8uNVr/LzdY/zE3Vv8yNlP/NDdS/zY5Uf83O0//OzxP/zw8Tv8+PU3/QT9N/0NCTf9IRE7/S0ZP/0xIT/9RTFT/U0pO/zY4SP9ei9H/XIjM/0JVhv9QZZn/Lj5v/yQvXf8sO3b/MUB1/yo6ef9NVXX/zuLo/8Te5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/D3OP/w9zj/8Xe5f/F3uX/xd3n/8Xd6P/F2+r/xNrk/9Lp8f9zgJH/KDlT/y5Dcv8bJVD/gIyd/3SFov9Vf8//OFGW/y5Bfv87UJT/Q1ik/0Rdp/9HZK3/Smat/0hlqf9JZKj/SGGm/0VepP9EXaP/Q1yi/0Baof89WJz/O1SZ/ztTlf88UJH/Ok6Q/zlMjv82Sor/NEeG/zRGhv8yRYX/LkJ//yw/ev8rPnn/JjZt/yk9dP81S4H/XojM/16L0f83TYP/SFuO/ztPh/8rNmL/KjNV/zM+bf8lM2//aHSR/9Xt8//C2+L/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xd5//F3ej/xtvq/8Tc5f/J4+n/uMvX/yw2Sf8cLFL/V2KB/+7++/93iqr/U3/M/zhTlv8vQn//Ok+Q/0Vcov9JZKr/Wnu//2GDx/9kiMz/ZYnO/2WL0P9mjNL/ZozU/2SO1P9lj9X/ZI7V/2WN0/9ljNL/Y4rR/2OJz/9ih83/YIbK/1+Fyv9eg8v/XYPN/1yCzP9agcr/WXzH/0BfrP84U5z/RV+f/12Gy/9gjdL/OlKI/ys3aP81RHL/IitY/y05Zf8wO2X/GCJe/2t3lP/R6u7/wtvj/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/w97l/8Xe5f/F3uX/xd7l/8Xe5f/F3ef/xd3n/8Xb6v/G3ef/w9zj/87n7v+ktcH/P0ha/yErVP9SVWf/T1x4/12I1P85UpX/LT1v/yY2aP8gKlb/LDhn/0tXe/9GU3j/P050/0VUev9HWYH/RVmE/0Vahv9FW4n/RVuN/0ZdkP9JX5H/S2GU/0tilv9MZZv/S2ac/0xnoP9OaKT/Tmmk/09qpv9Sban/U2+r/05sqv83Upj/NkyM/z1Of/9fiM7/YYzU/zpPgv8hLWT/LTt0/y46cP8zPGH/Lzhb/xYgXv94hqD/0uvw/8Lb4v/F3uX/xd7l/8Xe5f/D3uX/w97l/8Pe5f/F3uX/xd7l/8Xe5f/F3uX/xd3n/8Xd6P/E2ur/xd3n/8Xe5f/D3OP/zeft/8/l7f+Xp7T/eISS/2Bxj/9Zgcr/NUuO/zI9ZP86Rmj/SVVw/x4tX/99hJn/eX6S/wUNQP+HlKL/s8XO/6O0v/+gsLz/nKu4/5eltP+SoLD/jZus/4iVqf+BjqP/fImf/3eEm/90gJb/cHqR/2x1jP9ncIj/YmyF/1xng/9WYoH/S1Nw/0ZYh/9DV4r/YorM/12Kz/9FW4//MTpd/y09ef8zQnf/Pkx9/y4zWP8XIWD/j52x/9Dq7//C2+P/xd7l/8Xe5f/F3uX/w97l/8Pe5f/F3uX/xd7l/8Xe5f/F3uX/xd7m/8Xd5//F3uf/xdrq/8Xd5//F3uX/xd7l/8Pc4//E3eT/zObt/9/4+/98kKr/T3a7/y1Agv8bKFr/h5Oj/258mf98iaD/R1Fz/yovTP8fKVz/tsjQ/9Tt9P/M5uz/zuju/87p7//P6vD/0Orw/9Hr8P/R6/H/0urw/9Pr8P/S6/D/0urv/9Hp7v/Q6O3/z+fs/8/l6//O5er/zeTq/8/g5P9keaf/FCVc/0tspv9kkNT/Ok6D/yMsVf8rN2X/LDtq/zVGff8hJkr/ICtm/6e3xf/M5u3/w9zj/8Xe5f/F3uX/w97l/8Pe5f/E3uX/xd7l/8Xe5f/E3uX/xN7l/8Xe5v/F3ef/xd3o/8Xa6v/F3ef/xd7l/8Xe5f/F3uX/xd7l/8HZ4f/N5uz/jJ6u/1R4t/80SpH/Hyhb/8XQ0P9ebYv/wtDZ/4OOnP8EDD//P0lw/8fd4f/D3OT/w9zj/8Pc4//D3OP/w9zj/8Pb4//D2+P/wtvj/8Lb4//C2+P/wtvj/8Pc4//D3OP/w9zj/8Pc5P/E3eT/xd7l/8Td5P/K4ur/g5Sq/256kv9Zcpn/YIjK/ztUjv8uOGX/V112/0lVff9MWXr/ERlG/zZDd/+/09v/yOHo/8Td5P/F3uX/xd7l/8Pe5f/D3uX/w97l/8Pe5f/D3uX/w97l/8Xe5f/F3uX/xd3n/8Xc6f/F2ur/xd3m/8Xe5f/F3uX/xd7l/8Xe5f/E3eT/yeTr/7PGzv9cean/RF+j/xolZ/90fpT/aHSJ/3+Hlf86Q2v/ER1a/3N/kv/T7PH/wtvi/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8vj6v/a8PX/d4um/1l+u/9IY6P/Rk1x/5CWpP9aaI3/cneE/xEfZv9bZ4v/0Obt/8Pc5P/F3uX/xd7l/8Pe5f/E3uX/w97l/8Pe5f/D3uX/w97l/8Pe5f/E3uX/xd7l/8Xd5//F3ej/xdvq/8Xd5v/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Pc4//O5uz/fpCn/0prrP8rOXn/Hi9w/yYyW/8cJVD/FSJf/yQsVP+7zdT/yePq/8Td5P/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/B2uL/y+Tr/6Cwvv9ScaH/XHy3/z5Nff9naXj/JCxG/y86bf8aKGj/kaCv/9Hp8v/D2+P/xd7l/8Xe5f/D3uX/xd7l/8Te5f/D3uX/w97l/8Pe5f/D3uX/w97l/8Xe5f/F3ef/xd3n/8Xa6v/F3ef/xd7l/8Pe5f/D3uX/w97l/8Xe5f/E3eT/x+Ho/7/T2/9ieJ7/PE+F/xkiWv8WJmf/FyVi/yMrUf+Wo67/zufu/8DZ4f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Te5f/D3uX/w97l/8Xe5f/F3uX/xd7l/8Xe5f/E3uX/xN7l/8Te5f/E3uX/xd7l/8Xe5f/F3uX/xd7l/8Td5P/M4+r/eImf/1Jtov86T4n/Ex1O/xQbS/8QG1j/R09u/8vg6P/F3eX/xd7l/8Xe5f/E3uX/w97l/8Xe5f/F3uX/xd7l/8Pe5f/D3uX/w97l/8Pe5f/F3uX/xd3n/8Xd5//F2ur/xd3n/8Xe5f/D3uX/w97l/8Pe5f/E3uX/xd7l/8Lb4v/S7PL/kqKt/z5Vhf9DTXT/l6Gq/7G/x//G2OD/2fD3/8/n7f/Q6e7/xt/m/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xN7l/8Te5f/E3uX/xd7l/8Xe5f/F3uX/xN7l/8Xe5f/E3uX/xN7l/8Xe5f/F3uX/xd7l/8Xe5f/F3eT/xuDn/8bd5P+ClKn/XGuM/zxHbv8rOWj/Ult1/7vO1//J4+r/xN3k/8Xe5f/F3uX/xd7l/8Te5f/E3uX/xd7l/8Te5f/D3uX/w97l/8Pe5f/D3uX/xd7l/8Xd5//F3ej/xdvp/8Xd5//F3uX/w97l/8Pe5f/D3uX/w97l/8Te5f/E3eT/yuTr/6/Dzf84TX//bXyY/5+quf9rdYv/prfE/6O2xv+Yqbz/nK2+/8Tc5f/G3+b/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xN7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Td5P/G3+b/zebs/8rg5f/E2N3/v9PX/9Dn7P/J4un/w93k/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Te5f/D3uX/w97l/8Pe5f/D3uX/xd7l/8Xe5f/F3ef/xd3o/8Xb6f/F3ef/xd7l/8Xe5f/E3uX/w97l/8Pe5f/D3uX/xN3k/8rk6/+vw8v/SWWb/z9QeP8hNXL/HjR5/zlBZv9JWYL/R1iB/05cff+4zNb/yeLq/8Td5P/E3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xN7l/8Pe5f/E3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Pc5P/E3uX/xuDn/8jh6f/D3OT/xN3k/8Xe5f/F3uX/xd7l/8Xe5v/F3uX/xd7l/8Xe5f/E3uX/xN7l/8Te5f/D3uX/xN7l/8Xe5f/F3uX/xd3n/8Xd6P/F2+j/xd3n/8Xe5f/F3uX/xd7l/8Xe5f/E3uX/xd7l/8Xe5f/G4Of/w9nh/26Dnf+Qn7L/lqa5/4iZrf/D1t//wNbc/8Ta3//H3eP/yODn/8Xe5f/G3+b/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/E3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xd5f/E3eT/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/G3+b/xd7l/8Xe5f/F3uX/xN7l/8Te5f/F3uX/xN7l/8Xe5f/F3uX/xd7l/8Xd5//F3ej/xdvp/8Xd5//F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7k/8fg5//K4eb/zuXs/8/o7f/P5+z/yeHo/8jh6P/I4ej/x+Dn/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xt/l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3uX/xd7l/8Xe5f/F3ef/xd3o/8Xc6P/F3ef/xd7m/8Xe5v/F3uf/xd7m/8Xe5v/F3ub/xd7m/8Xe5v/F3ub/xN3m/8Td5f/D3OX/w9zk/8Td5f/F3ef/xd7n/8be5v/F3ub/xd7m/8Xe5//F3ub/xd7m/8Xe5//F3ub/xd7m/8Xe5//F3ub/xd7n/8Xe5v/F3ub/xd7n/8Xe5v/F3ub/xd7n/8Xe5//F3ub/xd7n/8Xe5//F3uf/xd7m/8Xe5//F3uf/xd7m/8Xe5//F3uf/xd7m/8Xe5v/F3uf/xd7n/8be5//F3uf/xd7m/8Xe5v/F3uf/xd7n/8Xe5//F3uf/xd7n/8Xe5//F3ub/xd3m/8bd6v/F3Of/xt3n/8bd5v/G3ub/x97n/8fe5v/H3ub/x97o/8fe5//H3uj/xt/n/8bf5v/G3uf/xt7n/8fe5//H3+b/x97m/8fe5//G3uf/xt7n/8be6P/G3uf/xt7n/8be5v/G3uf/x97m/8fe5v/H3+b/xt7m/8fe5//H3+f/x9/m/8bf5v/G3ub/x9/m/8fe5v/H3uf/xt7n/8be5v/G3uj/xt/n/8bf5v/H3+f/x9/n/8fe5//G3+f/xt/m/8be5v/H3ub/xt7m/8be5//G3uf/xt7n/8bf5//G3+f/x97o/8bf5//G3uf/xt7n/8be5//G3uf/xt7n/8bd6P/G3un/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=
// @supportURL         https://github.com/MapoMagpie/eh-view-enhance/issues
// @match              https://*.pixiv.net/*
// @match              https://steamcommunity.com/*
// @match              https://twitter.com/*
// @match              https://x.com/*
// @match              https://*.instagram.com/*
// @match              https://*.manhuagui.com/*
// @match              https://*.mangacopy.com/*
// @match              https://*.copymanga.tv/*
// @match              https://*.artstation.com/*
// @match              *://*/*
// @require            https://cdn.jsdelivr.net/npm/@zip.js/zip.js@2.7.57/dist/zip-full.min.js
// @require            https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js
// @require            https://cdn.jsdelivr.net/npm/pica@9.0.1/dist/pica.min.js
// @connect            *
// @grant              GM_getValue
// @grant              GM_setValue
// @grant              GM_xmlhttpRequest
// @downloadURL https://raw.githubusercontent.com/FiorenMas/Userscripts/release/release/Comic20Looms.user.js
// @updateURL https://raw.githubusercontent.com/FiorenMas/Userscripts/release/release/Comic20Looms.meta.js
// ==/UserScript==
(function(gt,mt,ft){"use strict";var J=typeof document<"u"?document.currentScript:null;function bt(o){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(o){for(const t in o)if(t!=="default"){const i=Object.getOwnPropertyDescriptor(o,t);Object.defineProperty(e,t,i.get?i:{enumerable:!0,get:()=>o[t]})}}return e.default=o,Object.freeze(e)}const Q=bt(ft);var Ne=typeof GM_getValue<"u"?GM_getValue:void 0,$e=typeof GM_setValue<"u"?GM_setValue:void 0,me=typeof GM_xmlhttpRequest<"u"?GM_xmlhttpRequest:void 0;const wt=o=>o.startsWith("zh")?1:o.startsWith("ko")?2:o.startsWith("es")?3:0,vt=navigator.language,yt=wt(vt);class Ct extends Array{constructor(e){super(...e)}get(){return this[yt]}}const It={imageScale:["SCALE","\u7F29\u653E","\uBC30\uC728","Escala"],config:["CONF","\u914D\u7F6E","\uC124\uC815","Ajustes"],chapters:["CHAPTERS","\u7AE0\u8282","\uCC55\uD130","Cap\xEDtulos"],autoPagePlay:["PLAY","\u64AD\u653E","\uC7AC\uC0DD","Reproducir"],autoPagePause:["PAUSE","\u6682\u505C","\uC77C\uC2DC \uC911\uC9C0","Pausar"],collapse:["FOLD","\u6536\u8D77","\uC811\uAE30","Plegar"],colCount:["Columns","\u6BCF\u884C\u6570\u91CF","\uC5F4 \uC218","Columnas"],colCountTooltip:["The number of images per row in the thumbnail list. If the layout is Flow Vision, the final number of images per row will be influenced by the specific aspect ratio of the images.","\u7F29\u7565\u56FE\u5217\u8868\u7684\u6BCF\u884C\u56FE\u7247\u6570\u91CF\u3002\u5982\u679C\u5E03\u5C40\u4E3A\u81EA\u9002\u5E94\u89C6\u56FE\uFF0C\u6700\u7EC8\u6BCF\u884C\u56FE\u7247\u6570\u91CF\u53D7\u56FE\u7247\u7684\u5177\u4F53\u5BBD\u9AD8\u6BD4\u5F71\u54CD\u3002","\uC378\uB124\uC77C \uBAA9\uB85D\uC5D0\uC11C \uD55C \uC904\uC5D0 \uD45C\uC2DC\uB418\uB294 \uC774\uBBF8\uC9C0\uC758 \uAC1C\uC218\uC785\uB2C8\uB2E4. \uB808\uC774\uC544\uC6C3\uC774 \uBC18\uC751\uD615\uC778 \uACBD\uC6B0, \uCD5C\uC885 \uD55C \uC904\uC5D0 \uD45C\uC2DC\uB418\uB294 \uC774\uBBF8\uC9C0\uC758 \uAC1C\uC218\uB294 \uC774\uBBF8\uC9C0\uC758 \uAD6C\uCCB4\uC801\uC778 \uAC00\uB85C\uC138\uB85C \uBE44\uC728\uC5D0 \uC601\uD5A5\uC744 \uBC1B\uC2B5\uB2C8\uB2E4.","El n\xFAmero de im\xE1genes por fila en la lista de miniaturas. Si el dise\xF1o es adaptable, el n\xFAmero final de im\xE1genes por fila estar\xE1 influenciado por la proporci\xF3n de aspecto espec\xEDfica de las im\xE1genes."],rowHeight:["Row Height","\u6BCF\u884C\u9AD8\u5EA6","\uD589 \uB192\uC774","Altura de fila"],rowHeightTooltip:["This option is only effective when the layout of the thumbnail list is Flow Vision. The reference height per row, along with the number of images per row, jointly influences the final display effect.","\u6B64\u9879\u4EC5\u5728\u7F29\u7565\u56FE\u5217\u8868\u7684\u5E03\u5C40\u4E3A\u81EA\u9002\u5E94\u89C6\u56FE\u65F6\u6709\u6548\u3002\u6BCF\u884C\u7684\u53C2\u8003\u9AD8\u5EA6\uFF0C\u548C\u6BCF\u884C\u6570\u91CF\u5171\u540C\u5F71\u54CD\u6700\u7EC8\u7684\u5C55\u793A\u6548\u679C\u3002","\uC774 \uC635\uC158\uC740 \uC378\uB124\uC77C \uBAA9\uB85D\uC758 \uB808\uC774\uC544\uC6C3\uC774 \uBC18\uC751\uD615\uC77C \uB54C\uB9CC \uC720\uD6A8\uD569\uB2C8\uB2E4. \uAC01 \uD589\uC758 \uAE30\uC900 \uB192\uC774\uB294 \uD589\uB2F9 \uC774\uBBF8\uC9C0 \uAC1C\uC218\uC640 \uD568\uAED8 \uCD5C\uC885 \uD45C\uC2DC \uACB0\uACFC\uC5D0 \uC601\uD5A5\uC744 \uBBF8\uCE69\uB2C8\uB2E4.","Esta opci\xF3n solo es efectiva cuando el dise\xF1o de la lista de miniaturas es adaptable. La altura de referencia por fila, junto con el n\xFAmero de im\xE1genes por fila, influye en el efecto final de la visualizaci\xF3n."],threads:["Preload Threads","\u6700\u5927\u540C\u65F6\u52A0\u8F7D","\uB3D9\uC2DC \uB85C\uB4DC \uC218","Hilos de pre-carga"],threadsTooltip:["Max Preload Threads","\u5927\u56FE\u6D4F\u89C8\u65F6\uFF0C\u6BCF\u6B21\u6EDA\u52A8\u5230\u4E0B\u4E00\u5F20\u65F6\uFF0C\u9884\u52A0\u8F7D\u7684\u56FE\u7247\u6570\u91CF\uFF0C\u5927\u4E8E1\u65F6\u4F53\u73B0\u4E3A\u8D8A\u770B\u52A0\u8F7D\u7684\u56FE\u7247\u8D8A\u591A\uFF0C\u5C06\u63D0\u5347\u6D4F\u89C8\u4F53\u9A8C\u3002","\uD070 \uC774\uBBF8\uC9C0 \uBAA8\uB4DC\uC5D0\uC11C \uB2E4\uC74C \uC774\uBBF8\uC9C0\uB85C \uC774\uB3D9\uD560 \uB54C \uBBF8\uB9AC \uB85C\uB4DC\uD560 \uC774\uBBF8\uC9C0 \uC218\uC785\uB2C8\uB2E4.<br>\uC774 \uAC12\uC774 1\uBCF4\uB2E4 \uD074 \uACBD\uC6B0, \uB3D9\uC2DC\uC5D0 \uB85C\uB4DC\uB418\uB294 \uC774\uBBF8\uC9C0\uAC00 \uB354 \uB9CE\uC544\uC838\uC11C \uC0AC\uC6A9 \uACBD\uD5D8\uC774 \uD5A5\uC0C1\uB429\uB2C8\uB2E4.","Hilos m\xE1ximos de pre-carga"],downloadThreads:["Download Threads","\u6700\u5927\u540C\u65F6\u4E0B\u8F7D","\uCD5C\uB300 \uB3D9\uC2DC \uB2E4\uC6B4\uB85C\uB4DC","Hilos de descarga"],downloadThreadsTooltip:["Max Download Threads, suggest: <5","\u4E0B\u8F7D\u6A21\u5F0F\u4E0B\uFF0C\u540C\u65F6\u52A0\u8F7D\u7684\u56FE\u7247\u6570\u91CF\uFF0C\u5EFA\u8BAE\u5C0F\u4E8E\u7B49\u4E8E5","\uB2E4\uC6B4\uB85C\uB4DC \uBAA8\uB4DC\uC5D0\uC11C \uB3D9\uC2DC\uC5D0 \uB2E4\uC6B4\uB85C\uB4DC\uD560 \uC774\uBBF8\uC9C0 \uC218\uC785\uB2C8\uB2E4. 5 \uC774\uD558\uB85C \uC124\uC815\uD558\uB294 \uAC83\uC774 \uC88B\uC2B5\uB2C8\uB2E4.","Hilos m\xE1ximos de descarga, sugerido: <5"],paginationIMGCount:["Images Per Page","\u6BCF\u9875\u56FE\u7247\u6570\u91CF","\uD398\uC774\uC9C0\uB2F9 \uC774\uBBF8\uC9C0 \uC218","Im\xE1genes por p\xE1gina"],paginationIMGCountTooltip:["In Pagination Read mode, the number of images displayed on each page","\u5F53\u9605\u8BFB\u6A21\u5F0F\u4E3A\u7FFB\u9875\u6A21\u5F0F\u65F6\uFF0C\u6BCF\u9875\u5C55\u793A\u7684\u56FE\u7247\u6570\u91CF","\uD398\uC774\uC9C0 \uB118\uAE40 \uBAA8\uB4DC\uC5D0\uC11C \uAC01 \uD398\uC774\uC9C0\uC5D0 \uD45C\uC2DC\uB420 \uC774\uBBF8\uC9C0 \uC218\uC785\uB2C8\uB2E4.","En el modo de lectura por paginaci\xF3n, el n\xFAmero de im\xE1genes mostradas en cada p\xE1gina"],timeout:["Timeout(second)","\u8D85\u65F6\u65F6\u95F4(\u79D2)","\uC774\uBBF8\uC9C0 \uB85C\uB529 \uC2DC\uB3C4 \uC2DC\uAC04 (\uCD08)","Tiempo de espera (segundos)"],preventScrollPageTime:["Min Paging Time","\u6700\u5C0F\u7FFB\u9875\u65F6\u95F4","\uCD5C\uC18C \uD398\uC774\uC9C0 \uB118\uAE40 \uC2DC\uAC04","Tiempo m\xEDnimo de paginaci\xF3n"],preventScrollPageTimeTooltip:["In Pagination read mode, prevent immediate page flipping when scrolling to the bottom/top to improve the reading experience.<br>Set to 0 to disable this feature,<br>If set to less than 0, page-flipping via scrolling is always disabled, except for the spacebar.<br>measured in milliseconds.","\u5F53\u9605\u8BFB\u6A21\u5F0F\u4E3A\u7FFB\u9875\u6A21\u5F0F\u65F6\uFF0C\u6EDA\u52A8\u6D4F\u89C8\u65F6\uFF0C\u963B\u6B62\u6EDA\u52A8\u5230\u5E95\u90E8\u65F6\u7ACB\u5373\u7FFB\u9875\uFF0C\u63D0\u5347\u9605\u8BFB\u4F53\u9A8C\u3002<br>\u8BBE\u7F6E\u4E3A0\u65F6\u5219\u7981\u7528\u6B64\u529F\u80FD\uFF0C\u5355\u4F4D\u4E3A\u6BEB\u79D2\u3002<br>\u8BBE\u7F6E\u5C0F\u4E8E0\u65F6\u5219\u6C38\u8FDC\u7981\u6B62\u901A\u8FC7\u6EDA\u52A8\u7684\u65B9\u5F0F\u7FFB\u9875\u3002\u7A7A\u683C\u952E\u9664\u5916\u3002","\uD398\uC774\uC9C0 \uB118\uAE40 \uBAA8\uB4DC\uC5D0\uC11C \uC544\uB798/\uC704\uB85C \uC2A4\uD06C\uB864 \uC2DC \uB108\uBB34 \uBE68\uB9AC \uD398\uC774\uC9C0\uAC00 \uB118\uC5B4\uAC00\uB294 \uAC83\uC744 \uBC29\uC9C0\uD558\uC5EC \uC77D\uAE30 \uACBD\uD5D8\uC744 \uAC1C\uC120\uD569\uB2C8\uB2E4.<br>0\uC73C\uB85C \uC124\uC815\uD558\uBA74 \uC774 \uAE30\uB2A5\uC774 \uBE44\uD65C\uC131\uD654\uB429\uB2C8\uB2E4.<br>0\uBCF4\uB2E4 \uC791\uC740 \uAC12\uC73C\uB85C \uC124\uC815\uD558\uBA74 \uB2E8\uCD95\uD0A4\uB97C \uC81C\uC678\uD558\uACE0 \uC2A4\uD06C\uB864\uC744 \uD1B5\uD55C \uD398\uC774\uC9C0 \uB118\uAE40\uC774 \uD56D\uC0C1 \uBE44\uD65C\uC131\uD654\uB429\uB2C8\uB2E4. (\uBC00\uB9AC\uCD08 \uB2E8\uC704)","En el modo de lectura por paginaci\xF3n, evita el cambio inmediato de p\xE1gina al desplazarse hacia el fondo o la parte superior para mejorar la experiencia de lectura.<br>Establezca en 0 para desactivar esta funci\xF3n,<br>Si se establece en menos de 0, el cambio de p\xE1gina mediante desplazamiento siempre est\xE1 desactivado, excepto para la barra espaciadora.<br>Medido en milisegundos."],autoPageSpeed:["Auto Paging Speed","\u81EA\u52A8\u7FFB\u9875\u901F\u5EA6","\uC790\uB3D9 \uD398\uC774\uC9C0 \uB118\uAE40 \uC18D\uB3C4","Velocidad de paginaci\xF3n autom\xE1tica"],autoPageSpeedTooltip:["In Pagination read mode, Auto Page Speed means how many seconds it takes to flip the page automatically.<br>In Continuous read mode, Auto Page Speed means the scrolling speed.","\u5F53\u9605\u8BFB\u6A21\u5F0F\u4E3A\u7FFB\u9875\u6A21\u5F0F\u65F6\uFF0C\u81EA\u52A8\u7FFB\u9875\u901F\u5EA6\u8868\u793A\u4E3A\u591A\u5C11\u79D2\u540E\u7FFB\u9875\u3002<br>\u5F53\u9605\u8BFB\u6A21\u5F0F\u4E3A\u8FDE\u7EED\u6A21\u5F0F\u65F6\uFF0C\u81EA\u52A8\u7FFB\u9875\u901F\u5EA6\u8868\u793A\u4E3A\u6EDA\u52A8\u901F\u5EA6\u3002","\uD398\uC774\uC9C0 \uB118\uAE40 \uBAA8\uB4DC\uC5D0\uC11C \uC790\uB3D9 \uD398\uC774\uC9C0 \uB118\uAE40 \uC18D\uB3C4\uB294 \uBA87 \uCD08 \uD6C4\uC5D0 \uC790\uB3D9\uC73C\uB85C \uD398\uC774\uC9C0\uAC00 \uB118\uC5B4\uAC08\uC9C0\uB97C \uC758\uBBF8\uD569\uB2C8\uB2E4.<br>\uC5F0\uC18D \uC77D\uAE30 \uBAA8\uB4DC\uC5D0\uC11C \uC790\uB3D9 \uD398\uC774\uC9C0 \uB118\uAE40 \uC18D\uB3C4\uB294 \uC790\uB3D9 \uC2A4\uD06C\uB864 \uC18D\uB3C4\uB97C \uC758\uBBF8\uD569\uB2C8\uB2E4.","En el modo de lectura por paginaci\xF3n, la velocidad de p\xE1gina autom\xE1tica indica cu\xE1ntos segundos toma cambiar la p\xE1gina autom\xE1ticamente.<br>En el modo de lectura continua, la velocidad de p\xE1gina autom\xE1tica indica la velocidad de desplazamiento."],scrollingDelta:["Scrolling Delta","\u6EDA\u52A8\u8DDD\u79BB","Scrolling Delta","Scrolling Delta"],scrollingDeltaTooltip:["During non-native scrolling (custom keyboard scrolling, horizontal scrolling), the distance of each scroll.","\u975E\u6D4F\u89C8\u5668\u539F\u751F\u7684\u6EDA\u52A8\u65F6\uFF08\u6309\u952E\u6EDA\u52A8\u3001\u6A2A\u5411\u6EDA\u52A8\uFF09\uFF0C\u6BCF\u6B21\u6EDA\u52A8\u7684\u8DDD\u79BB\u3002","\uBE44\uAE30\uBCF8 \uC2A4\uD06C\uB864(\uC0AC\uC6A9\uC790 \uC815\uC758 \uD0A4\uBCF4\uB4DC \uC2A4\uD06C\uB864, \uAC00\uB85C \uC2A4\uD06C\uB864) \uC911 \uAC01 \uC2A4\uD06C\uB864\uC758 \uAC70\uB9AC\uC785\uB2C8\uB2E4.","Durante el desplazamiento no nativo (desplazamiento con teclado personalizado, desplazamiento horizontal), la distancia de cada desplazamiento."],scrollingSpeed:["Scrolling Speed","\u6EDA\u52A8\u901F\u5EA6","\uC2A4\uD06C\uB864 \uC18D\uB3C4","Velocidad de desplazamiento"],scrollingSpeedTooltip:["During non-native scrolling (custom keyboard scrolling, horizontal scrolling), the speed of scrolling.","\u975E\u6D4F\u89C8\u5668\u539F\u751F\u7684\u6EDA\u52A8\u65F6\uFF08\u6309\u952E\u6EDA\u52A8\u3001\u6A2A\u5411\u6EDA\u52A8\uFF09\uFF0C\u6EDA\u52A8\u7684\u901F\u5EA6\u3002","\uBE44\uAE30\uBCF8 \uC2A4\uD06C\uB864(\uC0AC\uC6A9\uC790 \uC815\uC758 \uD0A4\uBCF4\uB4DC \uC2A4\uD06C\uB864, \uAC00\uB85C \uC2A4\uD06C\uB864) \uC911 \uC2A4\uD06C\uB864 \uC18D\uB3C4\uC785\uB2C8\uB2E4.","Durante el desplazamiento no nativo (desplazamiento con teclado personalizado, desplazamiento horizontal), la velocidad de desplazamiento."],fetchOriginal:["Raw Image","\u6700\u4F73\u8D28\u91CF","\uC6D0\uBCF8 \uC774\uBBF8\uC9C0","Imagen sin procesar"],fetchOriginalTooltip:["enable will download the original source, cost more traffic and quotas","\u542F\u7528\u540E\uFF0C\u5C06\u52A0\u8F7D\u672A\u7ECF\u8FC7\u538B\u7F29\u7684\u539F\u6863\u6587\u4EF6\uFF0C\u4E0B\u8F7D\u6253\u5305\u540E\u7684\u4F53\u79EF\u4E5F\u4E0E\u753B\u5ECA\u6240\u6807\u4F53\u79EF\u4E00\u81F4\u3002<br>\u6CE8\u610F\uFF1A\u8FD9\u5C06\u6D88\u8017\u66F4\u591A\u7684\u6D41\u91CF\u4E0E\u914D\u989D\uFF0C\u8BF7\u914C\u60C5\u542F\u7528\u3002","\uD65C\uC131\uD654\uD558\uBA74 \uC6D0\uBCF8 \uD30C\uC77C\uC774 \uB2E4\uC6B4\uB85C\uB4DC\uB429\uB2C8\uB2E4. \uB354 \uB9CE\uC740 \uD2B8\uB798\uD53D\uACFC \uD560\uB2F9\uB7C9\uC774 \uC18C\uBE44\uB429\uB2C8\uB2E4.","Activar descargar\xE1 la fuente original, lo que consumir\xE1 m\xE1s tr\xE1fico y cuotas"],autoLoad:["Auto Load","\u81EA\u52A8\u52A0\u8F7D","\uC790\uB3D9 \uB85C\uB4DC","Carga autom\xE1tica"],autoLoadTooltip:["Automatically start loading images after entering this script's view","\u8FDB\u5165\u672C\u811A\u672C\u7684\u6D4F\u89C8\u6A21\u5F0F\u540E\uFF0C\u5373\u4F7F\u4E0D\u6D4F\u89C8\u4E5F\u4F1A\u4E00\u5F20\u63A5\u4E00\u5F20\u7684\u52A0\u8F7D\u56FE\u7247\u3002\u76F4\u81F3\u6240\u6709\u56FE\u7247\u52A0\u8F7D\u5B8C\u6BD5\u3002","\uBCF4\uAE30 \uBAA8\uB4DC\uC5D0 \uC9C4\uC785\uD558\uBA74, \uC0AC\uC6A9\uC790\uAC00 \uD0D0\uC0C9 \uC911\uC774 \uC544\uB2D0 \uB54C\uB3C4 \uC774\uBBF8\uC9C0\uAC00 \uD558\uB098\uC529 \uC790\uB3D9\uC73C\uB85C \uB85C\uB4DC\uB429\uB2C8\uB2E4. \uBAA8\uB4E0 \uC774\uBBF8\uC9C0\uAC00 \uB85C\uB4DC\uB420 \uB54C\uAE4C\uC9C0 \uACC4\uC18D\uB429\uB2C8\uB2E4.","Comience a cargar im\xE1genes autom\xE1ticamente despu\xE9s de ingresar a la vista de este script."],reversePages:["Reverse Pages","\u53CD\u5411\u7FFB\u9875","\uD398\uC774\uC9C0 \uC21C\uC11C \uB4A4\uC9D1\uAE30","Revertir p\xE1ginas"],reversePagesTooltip:["Clicking on the side navigation, if enable then reverse paging, which is a reading style similar to Japanese manga where pages are read from right to left.","\u70B9\u51FB\u4FA7\u8FB9\u5BFC\u822A\u65F6\uFF0C\u662F\u5426\u53CD\u5411\u7FFB\u9875\uFF0C\u53CD\u5411\u7FFB\u9875\u7C7B\u4F3C\u65E5\u672C\u6F2B\u753B\u90A3\u6837\u7684\u4ECE\u53F3\u5230\u5DE6\u7684\u9605\u8BFB\u65B9\u5F0F\u3002","\uCE21\uBA74 \uB0B4\uBE44\uAC8C\uC774\uC158\uC744 \uD074\uB9AD\uD588\uC744 \uB54C \uC774\uBBF8\uC9C0\uB4E4\uC744 \uAC70\uAFB8\uB85C \uBC30\uCE58\uD560 \uC9C0 \uC120\uD0DD\uD569\uB2C8\uB2E4. \uC77C\uBCF8 \uB9CC\uD654\uCC98\uB7FC \uC624\uB978\uCABD\uC5D0\uC11C \uC67C\uCABD\uC73C\uB85C \uC77D\uB294 \uC2A4\uD0C0\uC77C\uC758 \uC774\uBBF8\uC9C0\uC5D0 \uC801\uC6A9\uD558\uBA74 \uC88B\uC2B5\uB2C8\uB2E4.","Hacer clic en la navegaci\xF3n lateral, si est\xE1 habilitado, revertir\xE1 la paginaci\xF3n, que es un estilo de lectura similar al manga japon\xE9s, donde las p\xE1ginas se leen de derecha a izquierda."],autoPlay:["Auto Page","\u81EA\u52A8\u7FFB\u9875","\uC790\uB3D9 \uD398\uC774\uC9C0 \uB118\uAE40","Paginaci\xF3n autom\xE1tica"],autoPlayTooltip:["Auto Page when entering the big image readmode.","\u5F53\u9605\u8BFB\u5927\u56FE\u65F6\uFF0C\u5F00\u542F\u81EA\u52A8\u64AD\u653E\u6A21\u5F0F\u3002","\uC774\uBBF8\uC9C0 \uD06C\uAC8C \uBCF4\uAE30 \uBAA8\uB4DC\uC5D0 \uB4E4\uC5B4\uAC00\uBA74 \uBC14\uB85C \uC790\uB3D9 \uD398\uC774\uC9C0 \uB118\uAE40\uC744 \uD65C\uC131\uD654\uD569\uB2C8\uB2E4.","Paginaci\xF3n autom\xE1tica al entrar en el modo de lectura de imagen grande."],autoLoadInBackground:["Keep Loading","\u540E\u53F0\u52A0\u8F7D","\uBC31\uADF8\uB77C\uC6B4\uB4DC \uB85C\uB529","Sigue cargando"],autoLoadInBackgroundTooltip:["Keep Auto-Loading after the tab loses focus","\u5F53\u6807\u7B7E\u9875\u5931\u53BB\u7126\u70B9\u540E\u4FDD\u6301\u81EA\u52A8\u52A0\u8F7D\u3002","\uC0AC\uC6A9\uC790\uAC00 \uB2E4\uB978 \uCC3D\uC744 \uBCFC \uB54C\uB3C4 \uC790\uB3D9 \uB85C\uB529\uC744 \uACC4\uC18D\uD569\uB2C8\uB2E4.","Mantener la carga autom\xE1tica despu\xE9s de que la pesta\xF1a pierda el enfoque"],autoOpen:["Auto Open","\u81EA\u52A8\u5C55\u5F00","\uC790\uB3D9 \uC774\uBBF8\uC9C0 \uC5F4\uAE30","Abrir autom\xE1ticamente"],autoOpenTooltip:["Automatically open after the gallery page is loaded","\u8FDB\u5165\u753B\u5ECA\u9875\u9762\u540E\uFF0C\u81EA\u52A8\u5C55\u5F00\u9605\u8BFB\u89C6\u56FE\u3002","\uAC24\uB7EC\uB9AC \uD398\uC774\uC9C0\uAC00 \uB85C\uB4DC\uB41C \uD6C4 \uCCAB \uD398\uC774\uC9C0\uB97C \uC790\uB3D9\uC73C\uB85C \uC5FD\uB2C8\uB2E4.","Abrir autom\xE1ticamente despu\xE9s de que la p\xE1gina de la galer\xEDa se cargue"],autoCollapsePanel:["Auto Fold Control Panel","\u81EA\u52A8\u6536\u8D77\u63A7\u5236\u9762\u677F","\uC124\uC815 \uCC3D \uC790\uB3D9\uC73C\uB85C \uB2EB\uAE30","Plegar autom\xE1ticamente el panel de control"],autoCollapsePanelTooltip:["When the mouse is moved out of the control panel, the control panel will automatically fold. If disabled, the display of the control panel can only be toggled through the button on the control bar.","\u5F53\u9F20\u6807\u79FB\u51FA\u63A7\u5236\u9762\u677F\u65F6\uFF0C\u81EA\u52A8\u6536\u8D77\u63A7\u5236\u9762\u677F\u3002\u7981\u7528\u6B64\u9009\u9879\u540E\uFF0C\u53EA\u80FD\u901A\u8FC7\u63A7\u5236\u680F\u4E0A\u7684\u6309\u94AE\u5207\u6362\u63A7\u5236\u9762\u677F\u7684\u663E\u793A\u3002","\uB9C8\uC6B0\uC2A4\uAC00 \uC124\uC815 \uCC3D\uC774\uB098 \uCEE8\uD2B8\uB864 \uBC14\uB97C \uBC97\uC5B4\uB098\uBA74 \uC124\uC815 \uCC3D\uC774 \uC790\uB3D9\uC73C\uB85C \uB2EB\uD799\uB2C8\uB2E4. \uBE44\uD65C\uC131\uD654\uB41C \uACBD\uC6B0, \uCEE8\uD2B8\uB864 \uBC14\uC758 \uBC84\uD2BC\uC744 \uD1B5\uD574\uC11C\uB9CC \uCC3D\uC744 \uC5EC\uB2EB\uC744 \uC218 \uC788\uC2B5\uB2C8\uB2E4.","Cuando el mouse se mueve fuera del panel de control, este se plegar\xE1 autom\xE1ticamente. Si est\xE1 desactivado, la visualizaci\xF3n del panel de control solo se puede alternar mediante el bot\xF3n en la barra de control."],magnifier:["Magnifier","\u653E\u5927\u955C","\uB3CB\uBCF4\uAE30","Lupa"],magnifierTooltip:["In the pagination reading mode, you can temporarily zoom in on an image by dragging it with the mouse click, and the image will follow the movement of the cursor.","\u5728\u7FFB\u9875\u9605\u8BFB\u6A21\u5F0F\u4E0B\uFF0C\u4F60\u53EF\u4EE5\u901A\u8FC7\u9F20\u6807\u5DE6\u952E\u62D6\u52A8\u56FE\u7247\u4E34\u65F6\u653E\u5927\u56FE\u7247\u4EE5\u53CA\u56FE\u7247\u8DDF\u968F\u6307\u9488\u79FB\u52A8\u3002","Pagination \uC77D\uAE30 \uBAA8\uB4DC\uC5D0\uC11C \uB9C8\uC6B0\uC2A4 \uD074\uB9AD\uC73C\uB85C \uC774\uBBF8\uC9C0\uB97C \uB4DC\uB798\uADF8\uD558\uBA74 \uC77C\uC2DC\uC801\uC73C\uB85C \uC774\uBBF8\uC9C0\uB97C \uD655\uB300\uD560 \uC218 \uC788\uC73C\uBA70, \uC774\uBBF8\uC9C0\uAC00 \uB9C8\uC6B0\uC2A4 \uCEE4\uC11C\uC758 \uC6C0\uC9C1\uC784\uC744 \uB530\uB77C \uC774\uB3D9\uD569\uB2C8\uB2E4.","En el modo de lectura por paginaci\xF3n, puedes hacer un zoom temporal en una imagen arrastr\xE1ndola con el clic del mouse, y la imagen seguir\xE1 el movimiento del cursor."],autoEnterBig:["Auto Big","\u81EA\u52A8\u5927\u56FE","\uC774\uBBF8\uC9C0 \uBC14\uB85C \uBCF4\uAE30","Auto Grande"],dragImageOut:["Drag Image Out","\u62D6\u62FD\u56FE\u7247\u5230\u5916\u90E8","\uC774\uBBF8\uC9C0\uB97C \uBC16\uC73C\uB85C \uB4DC\uB798\uADF8","Arrastrar imagen hacia afuera"],dragImageOutTooltip:[`Enabling this option will restore the browser's default dragging behavior for images (saving the image to the directory where it was dragged), 
but will disable the magnifier and the ability to drag and move images.`,"\u542F\u7528\u6B64\u9879\u5C06\u6062\u590D\u6D4F\u89C8\u5668\u9ED8\u8BA4\u5BF9\u56FE\u7247\u7684\u62D6\u62FD\u884C\u4E3A(\u4FDD\u5B58\u56FE\u7247\u5230\u6240\u62D6\u62FD\u5230\u7684\u76EE\u5F55)\uFF0C\u4F46\u4F1A\u7981\u7528\u653E\u5927\u955C\u529F\u80FD\u4EE5\u53CA\u62D6\u62FD\u79FB\u52A8\u56FE\u7247\u4F4D\u7F6E\u7684\u529F\u80FD\u3002",`\uC774 \uC635\uC158\uC744 \uD65C\uC131\uD654\uD558\uBA74 \uC774\uBBF8\uC9C0\uC5D0 \uB300\uD55C \uBE0C\uB77C\uC6B0\uC800\uC758 \uAE30\uBCF8 \uB4DC\uB798\uADF8 \uB3D9\uC791(\uC774\uBBF8\uC9C0\uB97C \uB4DC\uB798\uADF8\uD55C \uB514\uB809\uD1A0\uB9AC\uC5D0 \uC774\uBBF8\uC9C0 \uC800\uC7A5)\uC774 \uBCF5\uC6D0\uB429\uB2C8\uB2E4. 
\uD558\uC9C0\uB9CC \uB3CB\uBCF4\uAE30\uC640 \uC774\uBBF8\uC9C0 \uB4DC\uB798\uADF8 \uBC0F \uC774\uB3D9 \uAE30\uB2A5\uC740 \uBE44\uD65C\uC131\uD654\uB429\uB2C8\uB2E4.`,`Habilitar esta opci\xF3n restaurar\xE1 el comportamiento de arrastre predeterminado del navegador para im\xE1genes (guardando la imagen en el directorio donde fue arrastrada). 
pero desactivar\xE1 la lupa y la capacidad de arrastrar y mover im\xE1genes.`],autoEnterBigTooltip:["Directly enter the Big image view when the script's entry is clicked or auto-opened","\u70B9\u51FB\u811A\u672C\u5165\u53E3\u6216\u81EA\u52A8\u6253\u5F00\u811A\u672C\u540E\u76F4\u63A5\u8FDB\u5165\u5927\u56FE\u9605\u8BFB\u89C6\u56FE\u3002","\uC774\uBBF8\uC9C0 \uBDF0\uC5B4\uAC00 \uC5F4\uB9AC\uBA74 \uC989\uC2DC \uD070 \uC774\uBBF8\uC9C0 \uBCF4\uAE30 \uBAA8\uB4DC\uB85C \uC804\uD658\uB429\uB2C8\uB2E4.","Entrar directamente en la vista de imagen grande cuando se haga clic en la entrada del script o se abra autom\xE1ticamente"],hdThumbnails:["HD Thumbnails","\u9AD8\u6E05\u7F29\u7565\u56FE","HD \uC378\uB124\uC77C","Miniaturas HD"],hdThumbnailsTooltip:["When the large image is loaded, whether to resample a clearer image from the large image as a thumbnail, will affect performance.","\u5F53\u56FE\u7247\u52A0\u8F7D\u5B8C\u6BD5\u540E\uFF0C\u662F\u5426\u4ECE\u6E90\u56FE\u91CD\u65B0\u91C7\u6837\u66F4\u52A0\u6E05\u6670\u7684\u56FE\u7247\u4F5C\u4E3A\u7F29\u7565\u56FE\uFF0C\u6B64\u9879\u4F1A\u5F71\u54CD\u6027\u80FD\u3002","\uD070 \uC774\uBBF8\uC9C0\uAC00 \uB85C\uB4DC\uB420 \uB54C \uD070 \uC774\uBBF8\uC9C0\uC5D0\uC11C \uBCF4\uB2E4 \uC120\uBA85\uD55C \uC774\uBBF8\uC9C0\uB97C \uC378\uB124\uC77C\uB85C \uB9AC\uC0D8\uD50C\uB9C1\uD560\uC9C0 \uC5EC\uBD80\uAC00 \uC131\uB2A5\uC5D0 \uC601\uD5A5\uC744 \uBBF8\uCE69\uB2C8\uB2E4.","Cuando se carga la imagen grande, el hecho de volver a muestrear una imagen m\xE1s clara de la imagen grande como miniatura afectar\xE1 el rendimiento."],pixivJustCurrPage:["Pixiv Only Load Current Page","Pixiv\u4EC5\u52A0\u8F7D\u5F53\u524D\u4F5C\u54C1\u9875","Pixiv \uD604\uC7AC \uD398\uC774\uC9C0\uB9CC \uB85C\uB4DC","Pixiv: Cargar solo la p\xE1gina actual"],pixivJustCurrPageTooltip:[`In Pixiv, if the current page is on a artwork page, only load the images from current page. Disable this option or the current page is on the artist's homepage, all images by that author will be loaded. <br>Note: You can continue loading all the remaining images by the author by scrolling on the page or pressing "Try Fetch Next Page" key after disabling this option.`,"\u5728Pixiv\u4E2D\uFF0C\u5982\u679C\u5F53\u524D\u9875\u662F\u4F5C\u54C1\u9875\u5219\u53EA\u52A0\u8F7D\u5F53\u524D\u9875\u4E2D\u7684\u56FE\u7247\uFF0C\u5982\u679C\u8BE5\u9009\u9879\u7981\u7528\u6216\u8005\u5F53\u524D\u9875\u662F\u4F5C\u8005\u4E3B\u9875\uFF0C\u5219\u52A0\u8F7D\u8BE5\u4F5C\u8005\u6240\u6709\u7684\u4F5C\u54C1\u3002<br>\u6CE8\uFF1A\u4F60\u53EF\u4EE5\u7981\u7528\u8BE5\u9009\u9879\u540E\uFF0C\u7136\u540E\u901A\u8FC7\u9875\u9762\u6EDA\u52A8\u6216\u6309\u4E0BShift+n\u6765\u7EE7\u7EED\u52A0\u8F7D\u8BE5\u4F5C\u8005\u6240\u6709\u7684\u56FE\u7247\u3002",'Pixiv\uC5D0\uC11C \uD604\uC7AC \uD398\uC774\uC9C0\uAC00 \uC791\uD488 \uD398\uC774\uC9C0\uC77C \uACBD\uC6B0, \uD574\uB2F9 \uD398\uC774\uC9C0\uC758 \uC774\uBBF8\uC9C0\uB4E4\uB9CC \uB85C\uB4DC\uD569\uB2C8\uB2E4. \uC774 \uC635\uC158\uC744 \uBE44\uD65C\uC131\uD654\uD558\uAC70\uB098 \uD604\uC7AC \uD398\uC774\uC9C0\uAC00 \uC791\uAC00\uC758 \uD648 \uD398\uC774\uC9C0\uC77C \uACBD\uC6B0, \uD574\uB2F9 \uC791\uAC00\uC758 \uBAA8\uB4E0 \uC774\uBBF8\uC9C0\uB97C \uB85C\uB4DC\uD569\uB2C8\uB2E4. <br>\uCC38\uACE0: \uC774 \uC635\uC158\uC744 \uBE44\uD65C\uC131\uD654\uD55C \uD6C4, \uD398\uC774\uC9C0\uB97C \uC2A4\uD06C\uB864\uD558\uAC70\uB098 "\uB2E4\uC74C \uD398\uC774\uC9C0 \uB85C\uB529 \uC7AC\uC2DC\uB3C4" \uD0A4\uB97C \uB20C\uB7EC \uC791\uAC00\uC758 \uB098\uBA38\uC9C0 \uC774\uBBF8\uC9C0\uB97C \uACC4\uC18D \uB85C\uB4DC\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.','En Pixiv, si la p\xE1gina actual est\xE1 en una p\xE1gina de una obra, solo se cargar\xE1n las im\xE1genes de la p\xE1gina actual. Desactive esta opci\xF3n si la p\xE1gina actual est\xE1 en la p\xE1gina de inicio del artista; en ese caso, se cargar\xE1n todas las im\xE1genes de ese autor. <br>Nota: Puedes continuar cargando todas las im\xE1genes restantes del autor desplaz\xE1ndote por la p\xE1gina o presionando la tecla "Intentar cargar la siguiente p\xE1gina" despu\xE9s de desactivar esta opci\xF3n.'],readMode:["Read Mode","\u9605\u8BFB\u6A21\u5F0F","\uC77D\uAE30 \uBAA8\uB4DC","Modo de lectura"],readModeTooltip:["Switch to the next picture when scrolling, otherwise read continuously","\u6EDA\u52A8\u65F6\u5207\u6362\u5230\u4E0B\u4E00\u5F20\u56FE\u7247\uFF0C\u5426\u5219\u8FDE\u7EED\u9605\u8BFB","\uC2A4\uD06C\uB864 \uC2DC \uB2E4\uC74C \uC774\uBBF8\uC9C0\uB85C \uC804\uD658\uD558\uAC70\uB098, \uC774\uBBF8\uC9C0\uB4E4\uC744 \uC5F0\uC18D\uC73C\uB85C \uBC30\uCE58\uD569\uB2C8\uB2E4.","Cambiar a la siguiente imagen al desplazarse, de lo contrario, leer de manera continua"],stickyMouse:["Sticky Mouse","\u9ECF\u7CCA\u7CCA\u9F20\u6807","\uB9C8\uC6B0\uC2A4 \uACE0\uC815","Mouse adhesivo"],stickyMouseTooltip:["In pagination reading mode, scroll a single image automatically by moving the mouse.","\u975E\u8FDE\u7EED\u9605\u8BFB\u6A21\u5F0F\u4E0B\uFF0C\u901A\u8FC7\u9F20\u6807\u79FB\u52A8\u6765\u81EA\u52A8\u6EDA\u52A8\u5355\u5F20\u56FE\u7247\u3002","\uD398\uC774\uC9C0 \uC77D\uAE30 \uBAA8\uB4DC\uC5D0\uC11C \uB9C8\uC6B0\uC2A4 \uCEE4\uC11C\uB97C \uC6C0\uC9C1\uC5EC \uD558\uB098\uC758 \uC774\uBBF8\uC9C0\uB97C \uC790\uB3D9\uC73C\uB85C \uC2A4\uD06C\uB864\uD569\uB2C8\uB2E4.","En el modo de lectura por paginaci\xF3n, desplaza una sola imagen autom\xE1ticamente moviendo el mouse."],minifyPageHelper:["Minify Control Bar","\u6700\u5C0F\u5316\u63A7\u5236\u680F","\uCEE8\uD2B8\uB864 \uBC14 \uCD5C\uC18C\uD654","Minimizar barra de control"],minifyPageHelperTooltip:["Minify Control Bar","\u6700\u5C0F\u5316\u63A7\u5236\u680F","\uC5B8\uC81C \uCEE8\uD2B8\uB864 \uBC14\uB97C \uCD5C\uC18C\uD654\uD560\uC9C0 \uC120\uD0DD\uD569\uB2C8\uB2E4.","Minimizar barra de control"],hitomiFormat:["Hitomi Image Format","Hitomi \u56FE\u7247\u683C\u5F0F","Hitomi \uC774\uBBF8\uC9C0 \uD615\uC2DD","Formato de imagen de Hitomi"],hitomiFormatTooltip:["In Hitomi, Fetch images by the format.<br>if Auto then try Avif > Jxl > Webp, Requires Refresh","\u5728Hitomi\u4E2D\u7684\u6E90\u56FE\u683C\u5F0F\u3002<br>\u5982\u679C\u662FAuto\uFF0C\u5219\u4F18\u5148\u83B7\u53D6Avif > Jxl > Webp\uFF0C\u4FEE\u6539\u540E\u9700\u8981\u5237\u65B0\u751F\u6548\u3002","Hitomi\uC5D0\uC11C \uC774\uBBF8\uC9C0\uB97C \uC5B4\uB5A4 \uC885\uB958\uC758 \uD30C\uC77C\uB85C \uAC00\uC838\uC62C \uC9C0 \uC120\uD0DD\uD569\uB2C8\uB2E4.<br>Auto \uC124\uC815 \uC2DC Avif > Jxl > Webp \uC21C\uC73C\uB85C \uC2DC\uB3C4\uD558\uBA70, \uBCC0\uACBD \uD6C4 \uC0C8\uB85C\uACE0\uCE68\uC774 \uD544\uC694\uD569\uB2C8\uB2E4.","En Hitomi, obtener im\xE1genes por formato.<br>Si est\xE1 en autom\xE1tico, intentar\xE1 Avif > Jxl > Webp. Requiere actualizaci\xF3n."],ehentaiTitlePrefer:["EHentai Prefer Title","EHentai\u6807\u9898\u8BED\u8A00","EHentai \uC120\uD638 \uC81C\uBAA9","Preferir t\xEDtulo en EHentai"],ehentaiTitlePreferTooltip:["Many galleries have both an English/Romanized title and a title in Japanese script. <br>Which one do you want to use as the archive filename?","\u8BB8\u591A\u56FE\u5E93\u90FD\u540C\u65F6\u62E5\u6709\u82F1\u6587/\u7F57\u9A6C\u97F3\u6807\u9898\u548C\u65E5\u6587\u6807\u9898\uFF0C<br>\u60A8\u5E0C\u671B\u4E0B\u8F7D\u65F6\u54EA\u4E2A\u4F5C\u4E3A\u6587\u4EF6\u540D\uFF1F","\uB9CE\uC740 \uAC24\uB7EC\uB9AC\uAC00 \uC601\uC5B4/\uB85C\uB9C8\uC790 \uC81C\uBAA9\uACFC \uC77C\uBCF8\uC5B4 \uC81C\uBAA9\uC744 \uBAA8\uB450 \uAC00\uC9C0\uACE0 \uC788\uC2B5\uB2C8\uB2E4. <br>\uC5B4\uB5A4 \uAC83\uC744 \uC544\uCE74\uC774\uBE0C \uD30C\uC77C \uC774\uB984\uC73C\uB85C \uC0AC\uC6A9\uD560\uC9C0 \uC120\uD0DD\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.","Muchas galer\xEDas tienen tanto un t\xEDtulo en ingl\xE9s/romanizado como un t\xEDtulo en script japon\xE9s.<br>\xBFCu\xE1l quieres usar como nombre de archivo?"],reverseMultipleImagesPost:["Descending Images In Post","\u53CD\u8F6C\u63A8\u6587\u56FE\u7247\u987A\u5E8F","\uD3EC\uC2A4\uD2B8 \uC774\uBBF8\uC9C0 \uB0B4\uB9BC\uCC28\uC21C \uC815\uB82C","Im\xE1genes descendentes en la publicaci\xF3n"],reverseMultipleImagesPostTooltip:["Reverse order for post with multiple images attatched","\u53CD\u8F6C\u63A8\u6587\u56FE\u7247\u987A\u5E8F","\uC5EC\uB7EC \uC774\uBBF8\uC9C0\uAC00 \uCCA8\uBD80\uB41C \uD3EC\uC2A4\uD2B8 \uB0B4 \uC774\uBBF8\uC9C0\uB4E4\uC758 \uC21C\uC11C\uB97C \uC5ED\uC21C\uC73C\uB85C \uC815\uB82C\uD569\uB2C8\uB2E4.","Orden inverso para publicaciones con m\xFAltiples im\xE1genes adjuntas"],excludeVideo:["Exclude Videos","\u6392\u9664\u89C6\u9891","\uBE44\uB514\uC624 \uC81C\uC678","Excluir videos"],excludeVideoTooltip:["Exclude videos, now only applies to x.com and kemono.su.","\u6392\u9664\u89C6\u9891\uFF0C\u73B0\u5728\u4EC5\u4F5C\u7528\u4E8Ex.com\u548Ckemono.su","\uBE44\uB514\uC624 \uC81C\uC678, \uD604\uC7AC x.com\uACFC kemono.su\uC5D0\uB9CC \uC801\uC6A9\uB429\uB2C8\uB2E4.","Excluir videos, ahora solo se aplica a x.com y kemono.su."],filenameOrder:["Filename Order","\u6587\u4EF6\u540D\u6392\u5E8F","\uD30C\uC77C\uBA85 \uC21C\uC11C","Orden de nombres de archivo"],filenameOrderTooltip:[`Filename Sorting Rules for Downloaded Files:
<br>  Auto: Detect whether the original filenames are consistent with the reading order under natural sorting (Windows). If consistent, keep the original filenames; otherwise, prepend a number to the original filenames to ensure the correct order.
<br>  Numbers: Ignore the original filenames and rename the files directly according to the reading order.
<br>  Original: Keep only the original filenames without ensuring the reading order, which may result in overwriting files with the same name.
<br>  Alphabetically: Detect whether the original filenames are consistent with the reading order under alphabetical sorting (Linux). If consistent, keep the original filenames; otherwise, prepend a number to the original filenames to ensure the correct order. `,`\u4E0B\u8F7D\u6587\u4EF6\u5185\u7684\u6587\u4EF6\u540D\u6392\u5E8F\u89C4\u5219\uFF1A
<br>  Auto: \u68C0\u6D4B\u539F\u6587\u4EF6\u540D\u5728\u81EA\u7136\u6392\u5E8F(Windows)\u4E0B\u662F\u5426\u4E0E\u9605\u8BFB\u987A\u5E8F\u4E00\u81F4\uFF0C\u5982\u679C\u4E00\u81F4\u4FDD\u7559\u539F\u6587\u4EF6\u540D\uFF0C\u5426\u5219\u5C06\u5728\u539F\u6587\u4EF6\u540D\u524D\u6DFB\u52A0\u5E8F\u53F7\u4EE5\u4FDD\u8BC1\u987A\u5E8F\u3002
<br>  Numbers: \u5FFD\u7565\u539F\u6587\u4EF6\u540D\uFF0C\u76F4\u63A5\u4EE5\u9605\u8BFB\u987A\u5E8F\u4E3A\u6587\u4EF6\u547D\u540D\u3002
<br>  Original: \u53EA\u4FDD\u7559\u539F\u6587\u4EF6\u540D\uFF0C\u4E0D\u80FD\u4FDD\u8BC1\u9605\u8BFB\u987A\u5E8F\u4EE5\u53CA\u540C\u540D\u6587\u4EF6\u8986\u76D6\u3002
<br>  Alphabetically: \u68C0\u6D4B\u539F\u6587\u4EF6\u540D\u5728\u5B57\u6BCD\u6392\u5E8F\u4E0B(Linux)\u662F\u5426\u4E0E\u9605\u8BFB\u987A\u5E8F\u4E00\u81F4\uFF0C\u5982\u679C\u4E00\u81F4\u4FDD\u7559\u539F\u6587\u4EF6\u540D\uFF0C\u5426\u5219\u5C06\u5728\u539F\u6587\u4EF6\u540D\u524D\u6DFB\u52A0\u5E8F\u53F7\u4EE5\u4FDD\u8BC1\u987A\u5E8F\u3002`,`\uB2E4\uC6B4\uB85C\uB4DC \uD30C\uC77C\uC758 \uD30C\uC77C\uBA85 \uC815\uB82C \uADDC\uCE59:
<br>  Auto: \uC6D0\uBCF8 \uD30C\uC77C\uBA85\uC774 \uAE30\uBCF8 \uC815\uB82C(Windows)\uC5D0\uC11C \uC77D\uAE30 \uC21C\uC11C\uC640 \uC77C\uCE58\uD558\uB294\uC9C0 \uAC10\uC9C0\uD569\uB2C8\uB2E4. \uC77C\uCE58\uD558\uB294 \uACBD\uC6B0 \uC6D0\uBCF8 \uD30C\uC77C\uBA85\uC744 \uC720\uC9C0\uD558\uACE0, \uADF8\uB807\uC9C0 \uC54A\uC73C\uBA74 \uC21C\uC11C\uB97C \uBCF4\uC7A5\uD558\uAE30 \uC704\uD574 \uD30C\uC77C\uBA85 \uC55E\uC5D0 \uBC88\uD638\uB97C \uCD94\uAC00\uD569\uB2C8\uB2E4.
<br>  Numbers: \uC6D0\uBCF8 \uD30C\uC77C\uBA85\uC744 \uBB34\uC2DC\uD558\uACE0 \uC77D\uAE30 \uC21C\uC11C\uC5D0 \uB530\uB77C \uD30C\uC77C\uBA85\uC744 \uC9C1\uC811 \uC9C0\uC815\uD569\uB2C8\uB2E4.
<br>  Original: \uC6D0\uBCF8 \uD30C\uC77C\uBA85\uB9CC \uC720\uC9C0\uD558\uBA70, \uC77D\uAE30 \uC21C\uC11C\uAC00 \uBCF4\uC7A5\uB418\uC9C0 \uC54A\uC73C\uBA70 \uB3D9\uC77C\uD55C \uC774\uB984\uC758 \uD30C\uC77C\uC774 \uB36E\uC5B4\uC4F0\uC77C \uC218 \uC788\uC2B5\uB2C8\uB2E4.
<br>  Alphabetically: \uC6D0\uBCF8 \uD30C\uC77C\uBA85\uC774 \uC54C\uD30C\uBCB3 \uC815\uB82C(Linux)\uC5D0\uC11C \uC77D\uAE30 \uC21C\uC11C\uC640 \uC77C\uCE58\uD558\uB294\uC9C0 \uAC10\uC9C0\uD569\uB2C8\uB2E4. \uC77C\uCE58\uD558\uB294 \uACBD\uC6B0 \uC6D0\uBCF8 \uD30C\uC77C\uBA85\uC744 \uC720\uC9C0\uD558\uACE0, \uADF8\uB807\uC9C0 \uC54A\uC73C\uBA74 \uC21C\uC11C\uB97C \uBCF4\uC7A5\uD558\uAE30 \uC704\uD574 \uD30C\uC77C\uBA85 \uC55E\uC5D0 \uBC88\uD638\uB97C \uCD94\uAC00\uD569\uB2C8\uB2E4. `,`Reglas de ordenamiento de nombres de archivos para archivos descargados:
<br>  Auto: Detecta si los nombres de archivo originales son consistentes con el orden de lectura bajo el ordenamiento natural (Windows). Si son consistentes, conserva los nombres de archivo originales; de lo contrario, antepone un n\xFAmero a los nombres originales para garantizar el orden correcto.
<br>  Numbers: Ignora los nombres de archivo originales y renombra los archivos directamente seg\xFAn el orden de lectura.
<br>  Original: Conserva \xFAnicamente los nombres de archivo originales sin garantizar el orden de lectura, lo que puede resultar en sobrescribir archivos con el mismo nombre.
<br>  Alphabetically: Detecta si los nombres de archivo originales son consistentes con el orden de lectura bajo el orden alfab\xE9tico (Linux). Si son consistentes, conserva los nombres de archivo originales; de lo contrario, antepone un n\xFAmero a los nombres originales para garantizar el orden correcto. `],dragToMove:["Drag to Move the control bar","\u62D6\u52A8\u79FB\u52A8","\uB4DC\uB798\uADF8\uD574\uC11C \uCEE8\uD2B8\uB864 \uBC14 \uC774\uB3D9","Arrastra para mover la barra de control"],resetDownloaded:["Reset Downloaded Images","\u91CD\u7F6E\u5DF2\u4E0B\u8F7D\u7684\u56FE\u7247","\uB2E4\uC6B4\uB85C\uB4DC\uD55C \uC774\uBBF8\uC9C0 \uCD08\uAE30\uD654","Restablecer im\xE1genes descargadas"],resetDownloadedConfirm:["You will reset Downloaded Images!","\u5DF2\u4E0B\u8F7D\u7684\u56FE\u7247\u5C06\u4F1A\u88AB\u91CD\u7F6E\u4E3A\u672A\u4E0B\u8F7D\uFF01","\uC774\uBBF8\uC9C0\uB4E4\uC740 \uB2E4\uC6B4\uB85C\uB4DC\uD558\uC9C0 \uC54A\uC740 \uC0C1\uD0DC\uB85C \uCD08\uAE30\uD654\uB429\uB2C8\uB2E4!","\xA1Vas a restablecer las im\xE1genes descargadas!"],resetFailed:["Reset Failed Images","\u91CD\u7F6E\u4E0B\u8F7D\u9519\u8BEF\u7684\u56FE\u7247","\uB85C\uB529 \uC2E4\uD328\uD55C \uC774\uBBF8\uC9C0 \uCD08\uAE30\uD654","Restablecer im\xE1genes fallidas"],showHelp:["Help","\u5E2E\u52A9","\uB3C4\uC6C0\uB9D0","Ayuda"],showKeyboard:["Keyboard","\u5FEB\u6377\u952E","\uB2E8\uCD95\uD0A4","Teclado"],showSiteProfiles:["Site Profiles","\u7AD9\u70B9\u914D\u7F6E","\uC0AC\uC774\uD2B8 \uC124\uC815","Perfiles del sitio"],showStyleCustom:["Style","\u6837\u5F0F","\uC2A4\uD0C0\uC77C","Estilo"],controlBarStyleTooltip:["Click on an item to modify its display text, such as emoji or personalized text. Changes will take effect after restarting.","\u70B9\u51FB\u67D0\u9879\u540E\u4FEE\u6539\u5176\u663E\u793A\u6587\u672C\uFF0C\u6BD4\u5982emoji\u6216\u4E2A\u6027\u6587\u5B57\uFF0C\u4E5F\u8BB8svg\uFF0C\u91CD\u542F\u540E\u751F\u6548\u3002","\uC544\uC774\uD15C\uC744 \uD074\uB9AD\uD558\uC5EC \uC774\uBAA8\uD2F0\uCF58\uC774\uB098 \uD14D\uC2A4\uD2B8 \uB4F1\uC744 \uC218\uC815\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4. \uBCC0\uACBD \uC0AC\uD56D\uC740 \uC7AC\uC2DC\uC791 \uD6C4 \uC801\uC6A9\uB429\uB2C8\uB2E4.","Haga clic en un elemento para modificar el texto que se muestra, como emoji o texto personalizado. Los cambios entrar\xE1n en vigor despu\xE9s de reiniciar."],resetConfig:["Reset Config","\u91CD\u7F6E\u914D\u7F6E","\uAD6C\uC131 \uC7AC\uC124\uC815","Restablecer configuraci\xF3n"],letUsStar:["Let's Star","\u70B9\u661F","\uBCC4 \uB20C\uB7EC\uC918","Presiona la estrella"],download:["DL","\u4E0B\u8F7D","\uB2E4\uC6B4\uB85C\uB4DC","Descargar"],forceDownload:["Take Loaded","\u83B7\u53D6\u5DF2\u4E0B\u8F7D\u7684","\uB2E4\uC6B4\uB85C\uB4DC\uB41C \uC774\uBBF8\uC9C0 \uAC00\uC838\uC624\uAE30","Tomar cargado"],downloadStart:["Start Download","\u5F00\u59CB\u4E0B\u8F7D","\uB2E4\uC6B4\uB85C\uB4DC \uC2DC\uC791","Comenzar descarga"],downloading:["Downloading...","\u4E0B\u8F7D\u4E2D...","\uB2E4\uC6B4\uB85C\uB4DC \uC911...","Descargando..."],downloadFailed:["Failed(Retry)","\u4E0B\u8F7D\u5931\u8D25(\u91CD\u8BD5)","\uC2E4\uD328(\uC7AC\uC2DC\uB3C4)","Fallido(Reintentar)"],downloaded:["Downloaded","\u4E0B\u8F7D\u5B8C\u6210","\uB2E4\uC6B4\uB85C\uB4DC \uC644\uB8CC","Descargado"],packaging:["Packaging...","\u6253\u5305\u4E2D...","\uC555\uCD95 \uC911...","Empaquetando..."],status:["Status","\u72B6\u6001","\uC0C1\uD0DC","Estado"],selectChapters:["Chapters","\u7AE0\u8282","\uCC55\uD130","cap\xEDtulos"],cherryPick:["Cherry Pick","\u8303\u56F4\u9009\u62E9","\uBC94\uC704 \uC120\uD0DD","Seleccionar individualmente"],enable:["Enable","\u542F\u7528","\uD65C\uC131\uD654","Habilitar"],enableTooltips:["Enable the script on this site.","\u5728\u6B64\u7AD9\u70B9\u4E0A\u542F\u7528\u672C\u811A\u672C\u7684\u529F\u80FD\u3002","\uC120\uD0DD\uB41C \uC0AC\uC774\uD2B8\uC5D0\uC11C\uB9CC \uC2A4\uD06C\uB9BD\uD2B8\uB97C \uD65C\uC131\uD654\uD569\uB2C8\uB2E4.","Habilitar el script en este sitio."],enableAutoOpen:["Auto Open","\u81EA\u52A8\u6253\u5F00","\uC790\uB3D9 \uD06C\uAC8C \uBCF4\uAE30","Apertura autom\xE1tica"],enableAutoOpenTooltips:["Automatically open the interface of this script when entering the corresponding page.","\u5F53\u8FDB\u5165\u5BF9\u5E94\u7684\u751F\u6548\u9875\u9762\u540E\uFF0C\u81EA\u52A8\u6253\u5F00\u672C\u811A\u672C\u754C\u9762\u3002","\uD574\uB2F9 \uD398\uC774\uC9C0\uC5D0 \uB4E4\uC5B4\uAC08 \uB54C \uC774 \uC2A4\uD06C\uB9BD\uD2B8\uC758 \uC778\uD130\uD398\uC774\uC2A4\uB97C \uC790\uB3D9\uC73C\uB85C \uC5FD\uB2C8\uB2E4.","Abrir autom\xE1ticamente la interfaz de este script al ingresar a la p\xE1gina correspondiente."],enableFlowVision:["Flow Vision","\u81EA\u9002\u5E94\u89C6\u56FE","Flow Vision","Flow Vision"],enableFlowVisionTooltips:[`Enable a new thumbnail list layout where the images in each row have uniform height, but the number of images per row is automatically adjusted. 
    <br>The overall appearance is more compact and comfortable, suitable for illustration-based websites with irregular image aspect ratios.
    <br>Note: Since some websites cannot retrieve image aspect ratio information, the effect may be impacted.`,`\u542F\u7528\u4E00\u79CD\u65B0\u7684\u7F29\u7565\u56FE\u5217\u8868\u5E03\u5C40\uFF0C\u4F7F\u6BCF\u884C\u7684\u56FE\u7247\u9AD8\u5EA6\u4E00\u81F4\uFF0C\u4F46\u81EA\u52A8\u5206\u914D\u6BCF\u884C\u7684\u56FE\u7247\u6570\u91CF\u3002
    <br>\u6574\u4F53\u770B\u8D77\u6765\u66F4\u7D27\u51D1\u8212\u9002\uFF0C\u9002\u5408\u56FE\u7247\u5BBD\u9AD8\u6BD4\u4E0D\u89C4\u5219\u7684\u63D2\u753B\u7C7B\u7AD9\u70B9\u3002
    <br>\u6CE8\u610F\uFF1A\u7531\u4E8E\u4E00\u4E9B\u7AD9\u70B9\u65E0\u6CD5\u63D0\u53D6\u5F97\u77E5\u56FE\u7247\u7684\u5BBD\u9AD8\u6BD4\uFF0C\u56E0\u6B64\u6548\u679C\u53EF\u80FD\u4F1A\u53D7\u5230\u5F71\u54CD\u3002`,`\uC0C8\uB85C\uC6B4 \uC378\uB124\uC77C \uB9AC\uC2A4\uD2B8 \uB808\uC774\uC544\uC6C3\uC744 \uD65C\uC131\uD654\uD558\uC5EC \uAC01\uAC01\uC758 \uD589\uC5D0 \uC788\uB294 \uC774\uBBF8\uC9C0\uB4E4\uC774 \uB3D9\uC77C\uD55C \uB192\uC774\uB97C \uAC00\uC9C0\uB3C4\uB85D \uD569\uB2C8\uB2E4. \uB300\uC2E0 \uD589\uB2F9 \uC774\uBBF8\uC9C0\uC758 \uC218\uB294 \uC790\uB3D9\uC73C\uB85C \uC870\uC815\uB429\uB2C8\uB2E4. 
    <br>\uC804\uCCB4\uC801\uC778 \uC678\uAD00\uC740 \uB354 \uAC04\uACB0\uD558\uACE0 \uD3B8\uC548\uD558\uBA70, \uBD88\uADDC\uCE59\uD55C \uC774\uBBF8\uC9C0 \uBE44\uC728\uC744 \uAC00\uC9C4 \uC77C\uB7EC\uC2A4\uD2B8 \uAE30\uBC18 \uC6F9\uC0AC\uC774\uD2B8\uC5D0 \uC801\uD569\uD569\uB2C8\uB2E4. 
    <br>\uCC38\uACE0: \uC77C\uBD80 \uC6F9\uC0AC\uC774\uD2B8\uB294 \uC774\uBBF8\uC9C0 \uBE44\uC728 \uC815\uBCF4\uB97C \uAC00\uC838\uC62C \uC218 \uC5C6\uC73C\uBBC0\uB85C, \uC774\uB85C \uC778\uD574 \uD6A8\uACFC\uC5D0 \uC601\uD5A5\uC744 \uBC1B\uC744 \uC218 \uC788\uC2B5\uB2C8\uB2E4.`,`Activar un nuevo dise\xF1o de lista de miniaturas donde las im\xE1genes en cada fila tienen altura uniforme, pero el n\xFAmero de im\xE1genes por fila se ajusta autom\xE1ticamente. 
    <br>La apariencia general es m\xE1s compacta y c\xF3moda, adecuada para sitios web basados en ilustraciones con relaciones de aspecto de imagen irregulares.
    <br>Nota: Dado que algunos sitios web no pueden recuperar la informaci\xF3n de la relaci\xF3n de aspecto de las im\xE1genes, el efecto puede verse afectado.`],addRegexp:["Add Work URL Regexp","\u6DFB\u52A0\u751F\u6548\u5730\u5740\u89C4\u5219","URL \uC815\uADDC\uC2DD \uCD94\uAC00","Agregar expresi\xF3n regular de URL"],failFetchReason1:["Refused to connect {{domain}}(origin image url), Please check the domain blacklist: Tampermonkey > Comic Looms > Settings > XHR Security > User domain blacklist","\u88AB\u62D2\u7EDD\u8FDE\u63A5{{domain}}(\u5927\u56FE\u5730\u5740)\uFF0C\u8BF7\u68C0\u67E5\u57DF\u540D\u9ED1\u540D\u5355: Tampermonkey(\u7BE1\u6539\u7334) > \u6F2B\u753B\u7EC7\u673A > \u8BBE\u7F6E > XHR Security >  User domain blacklist","Refused to connect {{domain}}(origin image url), Please check the domain blacklist: Tampermonkey > Comic Looms > Settings > XHR Security > User domain blacklist","Refused to connect {{domain}}(origin image url), Please check the domain blacklist: Tampermonkey > Comic Looms > Settings > XHR Security > User domain blacklist"],help:[`
<h2>[How to Use? Where is the Entry?]</h2>
<p>The script typically activates on gallery homepages or artist homepages. For example, on E-Hentai, it activates on the gallery detail page, or on Twitter, it activates on the user&#39;s homepage or tweets.</p>
<p>When active, a <strong>&lt;\u{1F391}&gt;</strong> icon will appear at the bottom left of the page. Click it to enter the script&#39;s reading interface.</p>
<h2 style="color:red;">[Some existing issues and their solutions.]</h2>
<ul>
<li>When using Firefox to browse Twitter|X, after navigating to some pages, you need to refresh the page for this script to work on that page.</li>
<li>When using Firefox to browse Twitter|X, the download function of this script may not work.</li>
</ul>
<h4>Solution:</h4>
<p>These issues are caused by Twitter|X&#39;s Content Security Policy (CSP), which disables URL mutation detection and the Zip creation functionality.</p>
<p>You can modify Twitter|X&#39;s response header <strong>Content-Security-Policy</strong> to <strong>Content-Security-Policy: object-src '*'</strong> using other extensions.</p>
<p>For example, in the extension <strong>Header Editor</strong>, click the Add button:</p>
<ul>
<li>Name: csp-remove(any name)</li>
<li>Rule type: Modify response header</li>
<li>Match type: domain</li>
<li>Match rules: x.com</li>
<li>Execute type: normal</li>
<li>Header name: content-security-policy</li>
<li>Header value: object-src '*'</li>
</ul>
<h2>[Can the Script&#39;s Entry Point or Control Bar be Relocated?]</h2>
<p>Yes! At the bottom of the configuration panel, there&#39;s a <strong>Drag to Move</strong> option. Drag the icon to reposition the control bar anywhere on the page.</p>
<h2>[Can the Script Auto-Open When Navigating to the Corresponding Page?]</h2>
<p>Yes! There is an <strong>Auto Open</strong> option in the configuration panel. Enable it to activate this feature.</p>
<h2>[How to Zoom Images?]</h2>
<p>There are several ways to zoom images in big image reading mode:</p>
<ul>
<li>Right-click + mouse wheel</li>
<li>Keyboard shortcuts</li>
<li>Zoom controls on the control bar: click the -/+ buttons, scroll the mouse wheel over the numbers, or drag the numbers left or right.</li>
</ul>
<h2>[How to maintain spacing between large images?]</h2>
<p>In CONF > Style, modify or add: .ehvp-root { --ehvp-big-images-gap: 2px; }</p>
<h2>[How to Open Images from a Specific Page?]</h2>
<p>In the thumbnail list interface, simply type the desired page number on your keyboard (without any prompt) and press Enter or your custom shortcuts.</p>
<h2>[About the Thumbnail List]</h2>
<p>The thumbnail list interface is the script&#39;s most important feature, allowing you to quickly get an overview of the entire gallery.</p>
<p>Thumbnails are also lazy-loaded, typically loading about 20 images, which is comparable to or even fewer requests than normal browsing.</p>
<p>Pagination is also lazy-loaded, meaning not all gallery pages load at once. Only when you scroll near the bottom does the next page load.</p>
<p>Don&#39;t worry about generating a lot of requests by quickly scrolling through the thumbnail list; the script is designed to handle this efficiently.</p>
<h2>[About Auto-Loading and Pre-Loading]</h2>
<p>By default, the script automatically and slowly loads large images one by one.</p>
<p>You can still click any thumbnail to start loading and reading from that point, at which time auto-loading will stop and pre-load 3 images from the reading position.</p>
<p>Just like the thumbnail list, you don&#39;t need to worry about generating a lot of loading requests by fast scrolling.</p>
<h2>[About Downloading]</h2>
<p>Downloading is integrated with large image loading. When you finish browsing a gallery and want to save and download the images, you can click <strong>Start Download</strong> in the download panel. don&#39;t worry about re-downloading already loaded images.</p>
<p>You can also directly click <strong>Start Download</strong> in the download panel without reading.</p>
<p>Alternatively, click the <strong>Take Loaded</strong> button in the download panel if some images consistently fail to load. This will save the images that have already been loaded.</p>
<p>The download panel&#39;s status indicators provide a clear view of image loading progress.</p>
<p><strong>Note:</strong> When the download file size exceeds 1.2GB, split compression will be automatically enabled. If you encounter errors while extracting the files, please update your extraction software or use 7-Zip.</p>
<h2>[Can I Select the Download Range?]</h2>
<p>Yes, the download panel has an option to select the download range(Cherry Pick), which applies to downloading, auto-loading, and pre-loading.</p>
<p>Even if an image is excluded from the download range, you can still click its thumbnail to view it, which will load the corresponding large image.</p>
<h2>[How to Select Images on Some Illustration Sites?]</h2>
<p>In the thumbnail list, you can use some hotkeys to select images:</p>
<ul>
<li><strong>Ctrl + Left Click:</strong> Selects the image. The first selection will exclude all other images.</li>
<li><strong>Ctrl + Shift + Left Click:</strong> Selects the range of images between this image and the last selected image.</li>
<li><strong>Alt + Left Click:</strong> Excludes the image. The first exclusion will select all other images.</li>
<li><strong>Alt + Shift + Left Click:</strong> Excludes the range of images between this image and the last excluded image.</li>
</ul>
<p>In addition, there are several other methods:</p>
<ul>
<li>Middle-click on a thumbnail to open the original image url, then right-click to save the image.</li>
<li>Set the download range to 1 in the download panel. This excludes all images except the first one. Then, click on thumbnails of interest in the list, which will load the corresponding large images. After selecting, clear the download range and click <strong>Take Loaded</strong> to package and download your selected images.</li>
<li>Turn off auto-loading and set pre-loading to 1 in the configuration panel, then proceed as described above.</li>
</ul>
<h2>[Can I Operate the Script via Keyboard?]</h2>
<p>Yes! There&#39;s a <strong>Keyboard</strong> button at the bottom of the configuration panel. Click it to view or configure keyboard operations.</p>
<p>You can even configure it for one-handed full keyboard operation, freeing up your other hand!</p>
<h2>[How to Disable Auto-Open on Certain Sites?]</h2>
<p>There&#39;s a <strong>Site Profiles</strong> button at the bottom of the configuration panel. Click it to exclude certain sites from auto-opening. For example, Twitter or Booru-type sites.</p>
<h2>[How to Disable This Script on Certain Sites?]</h2>
<p>There&#39;s a <strong>Site Profiles</strong> button at the bottom of the configuration panel to exclude specific sites. Once excluded, the script will no longer activate on those sites.</p>
<p>To re-enable a site, you need to do so from a site that hasn&#39;t been excluded.</p>
<h2>[How to Feed the Author]</h2>
<p>Give me a star on <a target="_blank" href="https://github.com/MapoMagpie/eh-view-enhance">Github</a> or a good review on <a target="_blank" href="https://greasyfork.org/scripts/397848-e-hentai-view-enhance">Greasyfork</a>.</p>
<p>Please do not review on Greasyfork, as its notification system cannot track subsequent feedback. Many people leave an issue and never back.
Report issues here: <a target="_blank" href="https://github.com/MapoMagpie/eh-view-enhance/issues">issue</a></p>
<h2>[How to Reopen the Guide?]</h2>
<p>Click the <strong>Help</strong> button at the bottom of the configuration panel.</p>
`,`
<h2>[\u5982\u4F55\u4F7F\u7528\uFF1F\u5165\u53E3\u5728\u54EA\u91CC\uFF1F]</h2>
<p>\u811A\u672C\u4E00\u822C\u751F\u6548\u4E8E\u753B\u5ECA\u8BE6\u60C5\u9875\u6216\u753B\u5BB6\u7684\u4E3B\u9875\u6216\u4F5C\u54C1\u9875\u3002\u6BD4\u5982\u5728E-Hentai\u4E0A\uFF0C\u751F\u6548\u4E8E\u753B\u5ECA\u8BE6\u60C5\u9875\uFF0C\u6216\u8005\u5728Twitter\u4E0A\uFF0C\u751F\u6548\u4E8E\u63A8\u4E3B\u7684\u4E3B\u9875\u6216\u63A8\u6587\u3002</p>
<p>\u751F\u6548\u65F6\uFF0C\u5728\u9875\u9762\u7684\u5DE6\u4E0B\u65B9\u4F1A\u6709\u4E00\u4E2A<strong>&lt;\u{1F391}&gt;</strong>\u56FE\u6807\uFF0C\u70B9\u51FB\u540E\u5373\u53EF\u8FDB\u5165\u811A\u672C\u7684\u9605\u8BFB\u754C\u9762\u3002</p>
<h2 style="color:red;">[\u4E00\u4E9B\u73B0\u5B58\u7684\u95EE\u9898\uFF0C\u4EE5\u53CA\u89E3\u51B3\u65B9\u5F0F\u3002]</h2>
<ul>
<li>\u4F7F\u7528Firefox\u6D4F\u89C8Twitter|X\u65F6\uFF0C\u8DF3\u8F6C\u5230\u5176\u4ED6\u9875\u9762\u540E\uFF0C\u9700\u8981\u5237\u65B0\u624D\u53EF\u4EE5\u4F7F\u6B64\u811A\u672C\u5728\u8BE5\u9875\u9762\u751F\u6548\u3002</li>
<li>\u4F7F\u7528Firefox\u6D4F\u89C8Twitter|X\u65F6\uFF0C\u6B64\u811A\u672C\u7684\u4E0B\u8F7D\u529F\u80FD\u53EF\u80FD\u65E0\u6CD5\u4F7F\u7528\u3002</li>
</ul>
<h4>\u89E3\u51B3\u65B9\u5F0F:</h4>
<p>\u8FD9\u4E9B\u95EE\u9898\u662F\u7531\u4E8ETwitter|X\u7684\u5185\u5BB9\u5B89\u5168\u7B56\u7565(CSP)\u5BFC\u81F4\uFF0C\u5B83\u4F7FURL\u7684\u53D8\u52A8\u68C0\u6D4B\u548C\u521B\u5EFAZip\u529F\u80FD\u5931\u6548\u3002</p>
<p>\u53EF\u4EE5\u901A\u8FC7\u5176\u4ED6\u62D3\u5C55\u4FEE\u6539Twitter|X\u7684\u54CD\u5E94\u5934<strong>Content-Security-Policy</strong>\u4E3A<strong>Content-Security-Policy: object-src '*'</strong></p>
<p>\u4F8B\u5982\u5728\u62D3\u5C55<strong>Header Editor</strong>\u4E2D\uFF0C\u70B9\u51FB\u6DFB\u52A0\u6309\u94AE:</p>
<ul>
<li>Name: csp-remove(\u968F\u610F)</li>
<li>Rule type: Modify response header</li>
<li>Match type: domain</li>
<li>Match rules: x.com</li>
<li>Execute type: normal</li>
<li>Header name: content-security-policy</li>
<li>Header value: object-src '*'</li>
</ul>
<h2>[\u811A\u672C\u7684\u5165\u53E3\u6216\u63A7\u5236\u680F\u53EF\u4EE5\u66F4\u6539\u4F4D\u7F6E\u5417\uFF1F]</h2>
<p>\u53EF\u4EE5\uFF01\u5728\u914D\u7F6E\u9762\u677F\u7684\u4E0B\u65B9\uFF0C\u6709\u4E00\u4E2A<strong>\u62D6\u62FD\u79FB\u52A8</strong>\u7684\u9009\u9879\uFF0C\u5BF9\u7740\u56FE\u6807\u8FDB\u884C\u62D6\u52A8\uFF0C\u4F60\u53EF\u4EE5\u5C06\u63A7\u5236\u680F\u79FB\u52A8\u5230\u9875\u9762\u4E0A\u7684\u4EFB\u610F\u4F4D\u7F6E\u3002</p>
<h2>[\u8FDB\u5165\u5BF9\u5E94\u7684\u9875\u9762\u7684\uFF0C\u53EF\u4EE5\u81EA\u52A8\u6253\u5F00\u811A\u672C\u5417\uFF1F]</h2>
<p>\u53EF\u4EE5\uFF01\u5728\u914D\u7F6E\u9762\u677F\u4E2D\uFF0C\u6709\u4E00\u4E2A<strong>\u81EA\u52A8\u6253\u5F00</strong>\u7684\u9009\u9879\uFF0C\u542F\u7528\u5373\u53EF\u3002</p>
<h2>[\u5982\u4F55\u7F29\u653E\u56FE\u7247\uFF1F]</h2>
<p>\u6709\u51E0\u79CD\u65B9\u5F0F\u53EF\u4EE5\u5728\u5927\u56FE\u9605\u8BFB\u6A21\u5F0F\u4E2D\u7F29\u653E\u56FE\u7247\uFF1A</p>
<ul>
<li>\u9F20\u6807\u53F3\u952E+\u6EDA\u8F6E</li>
<li>\u952E\u76D8\u5FEB\u6377\u952E</li>
<li>\u63A7\u5236\u680F\u4E0A\u7684\u7F29\u653E\u63A7\u5236\uFF0C\u70B9\u51FB-/+\u6309\u94AE\uFF0C\u6216\u8005\u5728\u6570\u5B57\u4E0A\u6EDA\u52A8\u6EDA\u8F6E\uFF0C\u6216\u8005\u5DE6\u53F3\u62D6\u52A8\u6570\u5B57\u3002</li>
</ul>
<h2>[\u5982\u4F55\u8BA9\u5927\u56FE\u4E4B\u95F4\u4FDD\u6301\u95F4\u9694\uFF1F]</h2>
<p>\u5728CONF > Style\u4E2D\uFF0C\u4FEE\u6539\u6216\u6DFB\u52A0 .ehvp-root { --ehvp-big-images-gap: 2px; }</p>
<h2>[\u5982\u4F55\u6253\u5F00\u6307\u5B9A\u9875\u6570\u7684\u56FE\u7247\uFF1F]</h2>
<p>\u5728\u7F29\u7565\u56FE\u5217\u8868\u754C\u9762\u4E2D\uFF0C\u76F4\u63A5\u5728\u952E\u76D8\u4E0A\u8F93\u5165\u6570\u5B57(\u6CA1\u6709\u63D0\u793A)\uFF0C\u7136\u540E\u6309\u4E0B\u56DE\u8F66\u6216\u81EA\u5B9A\u4E49\u7684\u5FEB\u6377\u952E\u3002</p>
<h2>[\u5173\u4E8E\u7F29\u7565\u56FE\u5217\u8868\u3002]</h2>
<p>\u7F29\u7565\u56FE\u5217\u8868\u662F\u811A\u672C\u6700\u91CD\u8981\u7684\u7279\u6027\uFF0C\u53EF\u4EE5\u8BA9\u4F60\u5FEB\u901F\u5730\u4E86\u89E3\u6574\u4E2A\u753B\u5ECA\u7684\u60C5\u51B5\u3002</p>
<p>\u5E76\u4E14\u7F29\u7565\u56FE\u4E5F\u662F\u5EF6\u8FDF\u52A0\u8F7D\u7684\uFF0C\u901A\u5E38\u4F1A\u52A0\u8F7D20\u5F20\u5DE6\u53F3\uFF0C\u4E0E\u6B63\u5E38\u6D4F\u89C8\u6240\u53D1\u51FA\u7684\u8BF7\u6C42\u76F8\u5F53\uFF0C\u751A\u81F3\u66F4\u4F4E\u3002</p>
<p>\u5E76\u4E14\u5206\u9875\u4E5F\u662F\u5EF6\u8FDF\u52A0\u8F7D\u7684\uFF0C\u5E76\u4E0D\u4F1A\u4E00\u6B21\u6027\u52A0\u8F7D\u753B\u5ECA\u7684\u6240\u6709\u5206\u9875\uFF0C\u53EA\u6709\u6EDA\u52A8\u5230\u63A5\u8FD1\u5E95\u90E8\u65F6\uFF0C\u624D\u4F1A\u52A0\u8F7D\u4E0B\u4E00\u9875\u3002</p>
<p>\u4E0D\u7528\u62C5\u5FC3\u56E0\u4E3A\u5728\u7F29\u7565\u56FE\u5217\u8868\u4E2D\u5FEB\u901F\u6EDA\u52A8\u800C\u5BFC\u81F4\u53D1\u51FA\u5927\u91CF\u7684\u8BF7\u6C42\uFF0C\u811A\u672C\u5145\u5206\u8003\u8651\u5230\u4E86\u8FD9\u4E00\u70B9\u3002</p>
<h2>[\u5173\u4E8E\u81EA\u52A8\u52A0\u8F7D\u548C\u9884\u52A0\u8F7D\u3002]</h2>
<p>\u9ED8\u8BA4\u914D\u7F6E\u4E0B\uFF0C\u811A\u672C\u4F1A\u81EA\u52A8\u4E14\u7F13\u6162\u5730\u4E00\u5F20\u63A5\u4E00\u5F20\u5730\u52A0\u8F7D\u5927\u56FE\u3002</p>
<p>\u4F60\u4ECD\u7136\u53EF\u4EE5\u70B9\u51FB\u4EFB\u610F\u4F4D\u7F6E\u7684\u7F29\u7565\u56FE\uFF0C\u5E76\u4ECE\u8BE5\u5904\u5F00\u59CB\u52A0\u8F7D\u5E76\u9605\u8BFB\uFF0C\u6B64\u65F6\u4F1A\u81EA\u52A8\u52A0\u8F7D\u4F1A\u505C\u6B62\u5E76\u4ECE\u9605\u8BFB\u7684\u4F4D\u7F6E\u9884\u52A0\u8F7D3\u5F20\u56FE\u7247\u3002</p>
<p>\u540C\u7F29\u7565\u56FE\u5217\u8868\u4E00\u6837\uFF0C\u65E0\u9700\u62C5\u5FC3\u56E0\u4E3A\u5FEB\u901F\u6EDA\u52A8\u800C\u5BFC\u81F4\u53D1\u51FA\u5927\u91CF\u7684\u52A0\u8F7D\u8BF7\u6C42\u3002</p>
<h2>[\u5173\u4E8E\u4E0B\u8F7D\u3002]</h2>
<p>\u4E0B\u8F7D\u4E0E\u5927\u56FE\u52A0\u8F7D\u662F\u4E00\u4F53\u7684\uFF0C\u5F53\u4F60\u6D4F\u89C8\u5B8C\u753B\u5ECA\u65F6\uFF0C\u7A81\u7136\u60F3\u8D77\u6765\u8981\u4FDD\u5B58\u4E0B\u8F7D\uFF0C\u6B64\u65F6\u4F60\u53EF\u4EE5\u5728\u4E0B\u8F7D\u9762\u677F\u4E2D\u70B9\u51FB<strong>\u5F00\u59CB\u4E0B\u8F7D</strong>\uFF0C\u4E0D\u5FC5\u62C5\u5FC3\u4F1A\u91CD\u590D\u4E0B\u8F7D\u5DF2\u7ECF\u52A0\u8F7D\u8FC7\u7684\u56FE\u7247\u3002</p>
<p>\u5F53\u7136\u4F60\u4E5F\u53EF\u4EE5\u4E0D\u6D4F\u89C8\uFF0C\u76F4\u63A5\u5728\u4E0B\u8F7D\u9762\u677F\u4E2D\u70B9\u51FB<strong>\u5F00\u59CB\u4E0B\u8F7D</strong>\u3002</p>
<p>\u6216\u8005\u70B9\u51FB\u4E0B\u8F7D\u9762\u677F\u4E2D\u7684<strong>\u83B7\u53D6\u5DF2\u4E0B\u8F7D\u7684</strong>\u6309\u94AE\uFF0C\u5F53\u4E00\u4E9B\u56FE\u7247\u603B\u662F\u52A0\u8F7D\u5931\u8D25\u7684\u65F6\u5019\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528\u6B64\u529F\u80FD\u6765\u4FDD\u5B58\u5DF2\u7ECF\u52A0\u8F7D\u8FC7\u7684\u56FE\u7247\u3002</p>
<p>\u901A\u8FC7\u4E0B\u8F7D\u9762\u677F\u4E2D\u7684\u72B6\u6001\u53EF\u4EE5\u76F4\u89C2\u5730\u770B\u5230\u56FE\u7247\u52A0\u8F7D\u7684\u60C5\u51B5\u3002</p>
<p><strong>\u6CE8\u610F\uFF1A</strong>\u5F53\u4E0B\u8F7D\u6587\u4EF6\u5927\u5C0F\u8D85\u8FC71.2G\u540E\uFF0C\u4F1A\u81EA\u52A8\u542F\u7528\u5206\u5377\u538B\u7F29\u3002\u5F53\u4F7F\u7528\u89E3\u538B\u8F6F\u4EF6\u89E3\u538B\u51FA\u9519\u65F6\uFF0C\u8BF7\u66F4\u65B0\u89E3\u538B\u8F6F\u4EF6\u6216\u4F7F\u75287-Zip\u3002</p>
<h2>[\u53EF\u4EE5\u9009\u62E9\u4E0B\u8F7D\u8303\u56F4\u5417\uFF1F]</h2>
<p>\u53EF\u4EE5\uFF0C\u5728\u4E0B\u8F7D\u9762\u677F\u4E2D\u6709\u9009\u62E9\u4E0B\u8F7D\u8303\u56F4\u7684\u529F\u80FD\uFF0C\u8BE5\u529F\u80FD\u5BF9\u4E0B\u8F7D\u3001\u81EA\u52A8\u52A0\u8F7D\u3001\u9884\u52A0\u8F7D\u90FD\u751F\u6548\u3002</p>
<p>\u53E6\u5916\uFF0C\u5982\u679C\u4E00\u5F20\u56FE\u7247\u88AB\u6392\u9664\u5728\u4E0B\u8F7D\u8303\u56F4\u4E4B\u5916\uFF0C\u4F60\u4ECD\u7136\u53EF\u4EE5\u70B9\u51FB\u8BE5\u56FE\u7247\u7684\u7F29\u7565\u56FE\u8FDB\u884C\u6D4F\u89C8\uFF0C\u8FD9\u4F1A\u52A0\u8F7D\u5BF9\u5E94\u7684\u5927\u56FE\u3002</p>
<h2>[\u5982\u4F55\u5728\u4E00\u4E9B\u63D2\u753B\u7F51\u7AD9\u4E0A\u6311\u9009\u56FE\u7247\uFF1F]</h2>
<p>\u5728\u7F29\u7565\u56FE\u5217\u8868\u4E2D\u4F7F\u7528\u4E00\u4E9B\u5FEB\u6377\u952E\u53EF\u4EE5\u8FDB\u884C\u56FE\u7247\u7684\u6311\u9009\u3002</p>
<ul>
<li><strong>Ctrl+\u9F20\u6807\u5DE6\u952E\uFF1A</strong> \u9009\u4E2D\u8BE5\u56FE\u7247\uFF0C\u5F53\u7B2C\u4E00\u6B21\u9009\u4E2D\u65F6\uFF0C\u5176\u4ED6\u7684\u56FE\u7247\u90FD\u4F1A\u88AB\u6392\u9664\u3002</li>
<li><strong>Ctrl+Shift+\u9F20\u6807\u5DE6\u952E\uFF1A</strong> \u9009\u4E2D\u8BE5\u56FE\u7247\u4E0E\u4E0A\u4E00\u5F20\u9009\u4E2D\u7684\u56FE\u7247\u4E4B\u95F4\u7684\u8303\u56F4\u3002</li>
<li><strong>Alt+\u9F20\u6807\u5DE6\u952E\uFF1A</strong> \u6392\u9664\u8BE5\u56FE\u7247\uFF0C\u5F53\u7B2C\u4E00\u6B21\u6392\u9664\u65F6\uFF0C\u5176\u4ED6\u7684\u56FE\u7247\u90FD\u4F1A\u88AB\u9009\u4E2D\u3002</li>
<li><strong>Alt+Shift+\u9F20\u6807\u5DE6\u952E\uFF1A</strong> \u6392\u9664\u8BE5\u56FE\u7247\u4E0E\u4E0A\u4E00\u5F20\u6392\u9664\u7684\u56FE\u7247\u4E4B\u95F4\u7684\u8303\u56F4\u3002</li>
</ul>
<p>\u9664\u6B64\u4E4B\u5916\u8FD8\u6709\u51E0\u79CD\u65B9\u5F0F\uFF1A</p>
<ul>
<li>\u5728\u7F29\u7565\u56FE\u4E0A\u6309\u4E0B\u9F20\u6807\u4E2D\u952E\uFF0C\u5373\u53EF\u6253\u5F00\u56FE\u7247\u7684\u539F\u59CB\u5730\u5740\uFF0C\u4E4B\u540E\u4F60\u53EF\u4EE5\u53F3\u952E\u4FDD\u5B58\u56FE\u7247\u3002</li>
<li>\u5728\u4E0B\u8F7D\u9762\u677F\u4E2D\u8BBE\u7F6E\u4E0B\u8F7D\u8303\u56F4\u4E3A1\uFF0C\u8FD9\u6837\u4F1A\u6392\u9664\u7B2C\u4E00\u5F20\u56FE\u7247\u4EE5\u5916\u7684\u6240\u6709\u56FE\u7247\uFF0C\u4E4B\u540E\u5728\u7F29\u7565\u56FE\u5217\u8868\u4E0A\u70B9\u51FB\u4F60\u611F\u5174\u8DA3\u7684\u56FE\u7247\uFF0C\u5BF9\u5E94\u7684\u5927\u56FE\u4F1A\u88AB\u52A0\u8F7D\uFF0C\u6700\u7EC8\u6311\u9009\u5B8C\u6BD5\u540E\uFF0C\u5220\u9664\u6389\u4E0B\u8F7D\u8303\u56F4\u5E76\u70B9\u51FB<strong>\u83B7\u53D6\u5DF2\u4E0B\u8F7D\u7684</strong>\uFF0C\u8FD9\u6837\u4F60\u6311\u9009\u7684\u56FE\u7247\u4F1A\u88AB\u6253\u5305\u4E0B\u8F7D\u3002</li>
<li>\u5728\u914D\u7F6E\u9762\u677F\u4E2D\u5173\u95ED\u81EA\u52A8\u52A0\u8F7D\uFF0C\u5E76\u8BBE\u7F6E\u9884\u52A0\u8F7D\u6570\u91CF\u4E3A1\uFF0C\u4E4B\u540E\u4E0E\u4E0A\u9762\u7684\u65B9\u6CD5\u7C7B\u4F3C\u3002</li>
</ul>
<h2>[\u53EF\u4EE5\u901A\u8FC7\u952E\u76D8\u6765\u64CD\u4F5C\u5417\uFF1F]</h2>
<p>\u53EF\u4EE5\uFF01\u5728\u914D\u7F6E\u9762\u677F\u7684\u4E0B\u65B9\uFF0C\u6709\u4E00\u4E2A<strong>\u5FEB\u6377\u952E</strong>\u6309\u94AE\uFF0C\u70B9\u51FB\u540E\u53EF\u4EE5\u67E5\u770B\u952E\u76D8\u64CD\u4F5C\uFF0C\u6216\u8FDB\u884C\u914D\u7F6E\u3002</p>
<p>\u751A\u81F3\u53EF\u4EE5\u914D\u7F6E\u4E3A\u5355\u624B\u5168\u952E\u76D8\u64CD\u4F5C\uFF0C\u89E3\u653E\u53E6\u4E00\u53EA\u624B\uFF01</p>
<h2>[\u4E0D\u60F3\u5728\u67D0\u4E9B\u7F51\u7AD9\u542F\u7528\u81EA\u52A8\u6253\u5F00\u529F\u80FD\uFF1F]</h2>
<p>\u5728\u914D\u7F6E\u9762\u677F\u7684\u4E0B\u65B9\uFF0C\u6709\u4E00\u4E2A<strong>\u7AD9\u70B9\u914D\u7F6E</strong>\u6309\u94AE\uFF0C\u70B9\u51FB\u540E\u53EF\u4EE5\u5BF9\u4E00\u4E9B\u4E0D\u9002\u5408\u81EA\u52A8\u6253\u5F00\u7684\u7F51\u7AD9\u8FDB\u884C\u6392\u9664\u3002\u6BD4\u5982Twitter\u6216Booru\u7C7B\u7684\u7F51\u7AD9\u3002</p>
<h2>[\u4E0D\u60F3\u5728\u67D0\u4E9B\u7F51\u7AD9\u4F7F\u7528\u8FD9\u4E2A\u811A\u672C\uFF1F]</h2>
<p>\u5728\u914D\u7F6E\u9762\u677F\u7684\u4E0B\u65B9\uFF0C\u6709\u4E00\u4E2A<strong>\u7AD9\u70B9\u914D\u7F6E</strong>\u7684\u6309\u94AE\uFF0C\u53EF\u5BF9\u4E00\u4E9B\u7AD9\u70B9\u8FDB\u884C\u6392\u9664\uFF0C\u6392\u9664\u540E\u811A\u672C\u4E0D\u4F1A\u518D\u751F\u6548\u3002</p>
<p>\u5982\u679C\u60F3\u91CD\u65B0\u542F\u7528\u8BE5\u7AD9\u70B9\uFF0C\u9700\u8981\u5728\u5176\u4ED6\u672A\u6392\u9664\u7684\u7AD9\u70B9\u4E2D\u542F\u7528\u88AB\u7981\u7528\u7684\u7AD9\u70B9\u3002</p>
<h2>[\u5982\u4F55Feed\u4F5C\u8005\u3002]</h2>
<p>\u7ED9\u6211<a target="_blank" href="https://github.com/MapoMagpie/eh-view-enhance">Github</a>\u661F\u661F\uFF0C\u6216\u8005<a target="_blank" href="https://greasyfork.org/scripts/397848-e-hentai-view-enhance">Greasyfork</a>\u4E0A\u597D\u8BC4\u3002</p>
<p>\u8BF7\u52FF\u5728Greasyfork\u4E0A\u53CD\u9988\u95EE\u9898\uFF0C\u56E0\u4E3A\u8BE5\u7AD9\u70B9\u7684\u901A\u77E5\u7CFB\u7EDF\u65E0\u6CD5\u8DDF\u8E2A\u540E\u7EED\u7684\u53CD\u9988\u3002\u5F88\u591A\u4EBA\u53EA\u662F\u7559\u4E0B\u4E00\u4E2A\u95EE\u9898\uFF0C\u518D\u4E5F\u6CA1\u6709\u56DE\u6765\u8FC7\u3002
\u8BF7\u5728\u6B64\u53CD\u9988\u95EE\u9898: <a target="_blank" href="https://github.com/MapoMagpie/eh-view-enhance/issues">issue</a></p>
<h2>[\u5982\u4F55\u518D\u6B21\u6253\u5F00\u6307\u5357\uFF1F]</h2>
<p>\u5728\u914D\u7F6E\u9762\u677F\u7684\u4E0B\u65B9\uFF0C\u70B9\u51FB<strong>\u5E2E\u52A9</strong>\u6309\u94AE\u3002</p>
`,`
<h2>[\uC0AC\uC6A9 \uBC29\uBC95? \uC2A4\uD06C\uB9BD\uD2B8\uB294 \uC5B4\uB5BB\uAC8C \uC2E4\uD589\uB418\uB098\uC694?]</h2>
<p>\uC774 \uC2A4\uD06C\uB9BD\uD2B8\uB294 \uC8FC\uB85C \uAC24\uB7EC\uB9AC \uD648\uD398\uC774\uC9C0\uB098 \uC544\uD2F0\uC2A4\uD2B8 \uD648\uD398\uC774\uC9C0\uC5D0\uC11C \uD65C\uC131\uD654\uB429\uB2C8\uB2E4. \uC608\uB97C \uB4E4\uC5B4, E-Hentai\uC5D0\uC11C\uB294 \uAC24\uB7EC\uB9AC \uC0C1\uC138 \uD398\uC774\uC9C0\uC5D0\uC11C, Twitter\uC5D0\uC11C\uB294 \uC0AC\uC6A9\uC790\uC758 \uD648 \uB610\uB294 \uD2B8\uC717\uC5D0\uC11C, arca.live\uC5D0\uC11C\uB294 \uC791\uC131\uB41C \uAE00\uC5D0\uC11C \uD65C\uC131\uD654\uB429\uB2C8\uB2E4.</p>
<p>\uC2A4\uD06C\uB9BD\uD2B8\uAC00 \uD65C\uC131\uD654\uB418\uBA74 \uD398\uC774\uC9C0\uC758 \uC67C\uCABD \uD558\uB2E8\uC5D0 <strong>&lt;\u{1F391}&gt;</strong> \uC544\uC774\uCF58\uC774 \uB098\uD0C0\uB0A9\uB2C8\uB2E4. \uC774 \uC544\uC774\uCF58\uC744 \uD074\uB9AD\uD558\uBA74 \uC2A4\uD06C\uB9BD\uD2B8\uC758 \uC77D\uAE30 \uD654\uBA74\uC73C\uB85C \uC9C4\uC785\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p>

<h2>[\uC2A4\uD06C\uB9BD\uD2B8\uC758 \uC9C4\uC785\uC810 \uB610\uB294 \uCEE8\uD2B8\uB864 \uBC14\uB97C \uC774\uB3D9\uD560 \uC218 \uC788\uB098\uC694?]</h2>
<p>\uB124! \uC124\uC815 \uD328\uB110 \uD558\uB2E8\uC5D0 <strong>\uB4DC\uB798\uADF8\uD574\uC11C \uCEE8\uD2B8\uB864 \uBC14 \uC774\uB3D9</strong> \uC635\uC158\uC774 \uC788\uC2B5\uB2C8\uB2E4. \uC774 \uC544\uC774\uCF58\uC744 \uB4DC\uB798\uADF8\uD558\uC5EC \uD398\uC774\uC9C0 \uB0B4 \uC6D0\uD558\uB294 \uC704\uCE58\uB85C \uCEE8\uD2B8\uB864 \uBC14\uB97C \uC774\uB3D9\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p>

<h2>[\uD574\uB2F9 \uD398\uC774\uC9C0\uB85C \uC774\uB3D9\uD560 \uB54C \uC2A4\uD06C\uB9BD\uD2B8\uAC00 \uC790\uB3D9\uC73C\uB85C \uC5F4\uB9AC\uAC8C \uD560 \uC218 \uC788\uB098\uC694?]</h2>
<p>\uB124! \uC124\uC815 \uD328\uB110\uC5D0\uC11C <strong>\uC790\uB3D9\uC73C\uB85C \uC774\uBBF8\uC9C0 \uC5F4\uAE30</strong> \uC635\uC158\uC744 \uD65C\uC131\uD654\uD558\uBA74 \uC774 \uAE30\uB2A5\uC774 \uCF1C\uC9D1\uB2C8\uB2E4.</p>

<h2>[\uC774\uBBF8\uC9C0\uB97C \uD655\uB300\uD558\uB824\uBA74 \uC5B4\uB5BB\uAC8C \uD574\uC57C \uD558\uB098\uC694?]</h2>
<p>\uD070 \uC774\uBBF8\uC9C0 \uBCF4\uAE30 \uBAA8\uB4DC\uC5D0\uC11C \uC774\uBBF8\uC9C0\uB97C \uD655\uB300\uD558\uB294 \uBC29\uBC95\uC740 \uC5EC\uB7EC \uAC00\uC9C0\uAC00 \uC788\uC2B5\uB2C8\uB2E4:</p>
<ul>
<li>\uC624\uB978\uCABD \uD074\uB9AD + \uB9C8\uC6B0\uC2A4 \uD720</li>
<li>\uD0A4\uBCF4\uB4DC \uB2E8\uCD95\uD0A4</li>
<li>\uCEE8\uD2B8\uB864 \uBC14\uC758 \uD655\uB300/\uCD95\uC18C \uCEE8\uD2B8\uB864: -/+ \uBC84\uD2BC\uC744 \uD074\uB9AD\uD558\uAC70\uB098, \uC22B\uC790 \uC704\uC5D0\uC11C \uB9C8\uC6B0\uC2A4 \uD720\uC744 \uC2A4\uD06C\uB864\uD558\uAC70\uB098, \uC22B\uC790\uB97C \uC88C\uC6B0\uB85C \uB4DC\uB798\uADF8\uD558\uC138\uC694.</li>
</ul>

<h2>[\uD070 \uC774\uBBF8\uC9C0 \uAC04\uC758 \uAC04\uACA9\uC744 \uC720\uC9C0\uD558\uB824\uBA74 \uC5B4\uB5BB\uAC8C \uD574\uC57C \uD558\uB098\uC694?]</h2>
<p>CONF > Style\uC5D0\uC11C \uB2E4\uC74C\uC744 \uC218\uC815\uD558\uAC70\uB098 \uCD94\uAC00\uD558\uC138\uC694: .ehvp-root { --ehvp-big-images-gap: 2px; }</p>

<h2>[\uD2B9\uC815 \uD398\uC774\uC9C0\uC758 \uC774\uBBF8\uC9C0\uB97C \uC5F4\uB824\uBA74 \uC5B4\uB5BB\uAC8C \uD574\uC57C \uD558\uB098\uC694?]</h2>
<p>\uC378\uB124\uC77C \uB9AC\uC2A4\uD2B8 \uD654\uBA74\uC5D0\uC11C \uC6D0\uD558\uB294 \uD398\uC774\uC9C0 \uBC88\uD638\uB97C \uD0A4\uBCF4\uB4DC\uB85C \uC785\uB825\uD558\uACE0 Enter \uD0A4\uB098 \uC0AC\uC6A9\uC790 \uC9C0\uC815 \uB2E8\uCD95\uD0A4\uB97C \uB204\uB974\uC138\uC694.</p>

<h2>[\uC378\uB124\uC77C \uB9AC\uC2A4\uD2B8\uC5D0 \uB300\uD558\uC5EC]</h2>
<p>\uC378\uB124\uC77C \uB9AC\uC2A4\uD2B8 \uD654\uBA74\uC740 \uC2A4\uD06C\uB9BD\uD2B8\uC758 \uAC00\uC7A5 \uC911\uC694\uD55C \uAE30\uB2A5\uC73C\uB85C, \uC804\uCCB4 \uAC24\uB7EC\uB9AC\uB97C \uBE60\uB974\uAC8C \uB458\uB7EC\uBCFC \uC218 \uC788\uAC8C \uD574\uC90D\uB2C8\uB2E4.</p>
<p>\uC378\uB124\uC77C\uC740 \uC9C0\uC5F0 \uB85C\uB529\uB418\uBA70, \uC77C\uBC18\uC801\uC73C\uB85C \uC57D 20\uAC1C\uC758 \uC774\uBBF8\uC9C0\uB97C \uB85C\uB4DC\uD569\uB2C8\uB2E4. \uC774\uB294 \uC77C\uBC18\uC801\uC778 \uBE0C\uB77C\uC6B0\uC9D5\uBCF4\uB2E4 \uC694\uCCAD \uC218\uAC00 \uC801\uAC70\uB098 \uBE44\uC2B7\uD55C \uC815\uB3C4\uC785\uB2C8\uB2E4.</p>
<p>\uD398\uC774\uC9D5 \uB610\uD55C \uC9C0\uC5F0 \uB85C\uB529\uB429\uB2C8\uB2E4. \uC989, \uBAA8\uB4E0 \uAC24\uB7EC\uB9AC\uC758 \uD398\uC774\uC9C0\uAC00 \uD55C \uBC88\uC5D0 \uB85C\uB4DC\uB418\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4. \uD558\uB2E8 \uADFC\uCC98\uB85C \uC2A4\uD06C\uB864\uD560 \uB54C\uB9CC \uB2E4\uC74C \uD398\uC774\uC9C0\uAC00 \uB85C\uB4DC\uB429\uB2C8\uB2E4.</p>
<p>\uC378\uB124\uC77C \uB9AC\uC2A4\uD2B8\uB97C \uBE60\uB974\uAC8C \uC2A4\uD06C\uB864\uD574\uB3C4 \uAD1C\uCC2E\uC2B5\uB2C8\uB2E4. \uC774 \uC2A4\uD06C\uB9BD\uD2B8\uB294 \uADF8\uB7F0 \uACBD\uC6B0\uC5D0\uB3C4 \uB9CE\uC740 \uC694\uCCAD\uC774 \uBC1C\uC0DD\uD558\uC9C0 \uC54A\uB3C4\uB85D \uD6A8\uC728\uC801\uC73C\uB85C \uC124\uACC4\uB418\uC5B4 \uC788\uC2B5\uB2C8\uB2E4.</p>

<h2>[\uC790\uB3D9 \uB85C\uB529 \uBC0F \uC0AC\uC804 \uB85C\uB529\uC5D0 \uB300\uD558\uC5EC]</h2>
<p>\uAE30\uBCF8\uC801\uC73C\uB85C \uC2A4\uD06C\uB9BD\uD2B8\uB294 \uD070 \uC774\uBBF8\uC9C0\uB97C \uD558\uB098\uC529 \uC790\uB3D9\uC73C\uB85C \uCC9C\uCC9C\uD788 \uB85C\uB4DC\uD569\uB2C8\uB2E4.</p>
<p>\uC6D0\uD558\uB294 \uC378\uB124\uC77C\uC744 \uD074\uB9AD\uD558\uC5EC \uADF8 \uC9C0\uC810\uC5D0\uC11C \uB85C\uB529 \uBC0F \uC77D\uAE30\uB97C \uC2DC\uC791\uD560 \uC218 \uC788\uC73C\uBA70, \uC774\uB54C \uC790\uB3D9 \uB85C\uB529\uC774 \uC911\uC9C0\uB418\uACE0 \uC77D\uAE30 \uC704\uCE58\uC5D0\uC11C 3\uAC1C\uC758 \uC774\uBBF8\uC9C0\uB97C \uC0AC\uC804 \uB85C\uB529\uD569\uB2C8\uB2E4.</p>
<p>\uC378\uB124\uC77C \uB9AC\uC2A4\uD2B8\uC640 \uB9C8\uCC2C\uAC00\uC9C0\uB85C \uBE60\uB974\uAC8C \uC2A4\uD06C\uB864\uD574\uB3C4 \uB9CE\uC740 \uB85C\uB529 \uC694\uCCAD\uC774 \uBC1C\uC0DD\uD558\uC9C0 \uC54A\uB3C4\uB85D \uC124\uACC4\uB418\uC5B4 \uC788\uC73C\uB2C8 \uAC71\uC815\uD558\uC9C0 \uC54A\uC73C\uC154\uB3C4 \uB429\uB2C8\uB2E4.</p>

<h2>[\uB2E4\uC6B4\uB85C\uB4DC\uC5D0 \uB300\uD558\uC5EC]</h2>
<p>\uB2E4\uC6B4\uB85C\uB4DC\uB294 \uD070 \uC774\uBBF8\uC9C0 \uB85C\uB529\uACFC \uD1B5\uD569\uB418\uC5B4 \uC788\uC2B5\uB2C8\uB2E4. \uAC24\uB7EC\uB9AC\uB97C \uBAA8\uB450 \uBCF8 \uD6C4 \uC774\uBBF8\uC9C0\uB97C \uC800\uC7A5\uD558\uACE0 \uB2E4\uC6B4\uB85C\uB4DC\uD558\uB824\uBA74 \uB2E4\uC6B4\uB85C\uB4DC \uD328\uB110\uC5D0\uC11C <strong>\uB2E4\uC6B4\uB85C\uB4DC \uC2DC\uC791</strong>\uC744 \uD074\uB9AD\uD558\uC138\uC694. \uC774\uBBF8 \uB85C\uB4DC\uB41C \uC774\uBBF8\uC9C0\uB97C \uB2E4\uC2DC \uB2E4\uC6B4\uB85C\uB4DC\uD558\uB294 \uAC83\uC5D0 \uB300\uD574\uC11C\uB294 \uAC71\uC815 \uC548 \uD558\uC154\uB3C4 \uB429\uB2C8\uB2E4.</p>
<p>\uC774\uBBF8\uC9C0\uB97C \uBCF4\uC9C0 \uC54A\uACE0 \uBC14\uB85C \uB2E4\uC6B4\uB85C\uB4DC \uD328\uB110\uC5D0\uC11C <strong>\uB2E4\uC6B4\uB85C\uB4DC \uC2DC\uC791</strong>\uC744 \uD074\uB9AD\uD560 \uC218\uB3C4 \uC788\uC2B5\uB2C8\uB2E4.</p>
<p>\uB610\uD55C \uC77C\uBD80 \uC774\uBBF8\uC9C0\uAC00 \uB85C\uB4DC\uB418\uC9C0 \uC54A\uC744 \uB54C\uB294 \uB2E4\uC6B4\uB85C\uB4DC \uD328\uB110\uC5D0\uC11C <strong>\uC774\uBBF8 \uB2E4\uC6B4\uB85C\uB4DC\uD55C \uC774\uBBF8\uC9C0 \uAC00\uC838\uC624\uAE30</strong> \uBC84\uD2BC\uC744 \uD074\uB9AD\uD558\uC5EC \uC774\uBBF8 \uB85C\uB4DC\uB41C \uC774\uBBF8\uC9C0\uB97C \uC800\uC7A5\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p>
<p>\uB2E4\uC6B4\uB85C\uB4DC \uD328\uB110\uC758 \uC0C1\uD0DC \uD45C\uC2DC\uAE30\uB97C \uD1B5\uD574 \uC774\uBBF8\uC9C0 \uB85C\uB529 \uC9C4\uD589 \uC0C1\uD669\uC744 \uBA85\uD655\uD788 \uBCFC \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p>
<p><strong>\uCC38\uACE0:</strong> \uB2E4\uC6B4\uB85C\uB4DC \uD30C\uC77C \uD06C\uAE30\uAC00 1.2GB\uB97C \uCD08\uACFC\uD560 \uACBD\uC6B0, \uBD84\uD560 \uC555\uCD95\uC774 \uC790\uB3D9\uC73C\uB85C \uD65C\uC131\uD654\uB429\uB2C8\uB2E4. \uD30C\uC77C\uC744 \uCD94\uCD9C\uD558\uB294 \uB3D9\uC548 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uBA74 \uCD94\uCD9C \uC18C\uD504\uD2B8\uC6E8\uC5B4\uB97C \uC5C5\uB370\uC774\uD2B8\uD558\uAC70\uB098 7-Zip\uC744 \uC0AC\uC6A9\uD558\uC138\uC694.</p>

<h2>[\uB2E4\uC6B4\uB85C\uB4DC \uBC94\uC704\uB97C \uC120\uD0DD\uD560 \uC218 \uC788\uB098\uC694?]</h2>
<p>\uB124, \uB2E4\uC6B4\uB85C\uB4DC \uD328\uB110\uC5D0\uB294 \uB2E4\uC6B4\uB85C\uB4DC \uBC94\uC704\uB97C \uC120\uD0DD\uD560 \uC218 \uC788\uB294 \uC635\uC158(Cherry Pick)\uC774 \uC788\uC73C\uBA70, \uC774\uB294 \uB2E4\uC6B4\uB85C\uB4DC, \uC790\uB3D9 \uB85C\uB529 \uBC0F \uC0AC\uC804 \uB85C\uB529\uC5D0 \uC801\uC6A9\uB429\uB2C8\uB2E4.</p>
<p>\uB2E4\uC6B4\uB85C\uB4DC \uBC94\uC704\uC5D0\uC11C \uC81C\uC678\uB41C \uC774\uBBF8\uC9C0\uB77C\uB3C4 \uC378\uB124\uC77C\uC744 \uD074\uB9AD\uD558\uC5EC \uD574\uB2F9 \uD070 \uC774\uBBF8\uC9C0\uB97C \uB85C\uB4DC\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p>

<h2>[\uC77C\uB7EC\uC2A4\uD2B8 \uC0AC\uC774\uD2B8\uC5D0\uC11C \uC774\uBBF8\uC9C0\uB97C \uC120\uD0DD\uD558\uB824\uBA74 \uC5B4\uB5BB\uAC8C \uD574\uC57C \uD558\uB098\uC694?]</h2>
<p>\uC378\uB124\uC77C \uB9AC\uC2A4\uD2B8\uC5D0\uC11C \uB2E4\uC74C \uD56B\uD0A4\uB97C \uC0AC\uC6A9\uD558\uC5EC \uC774\uBBF8\uC9C0\uB97C \uC120\uD0DD\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4:</p>
<ul>
<li><strong>Ctrl + \uC67C\uCABD \uD074\uB9AD:</strong> \uC774\uBBF8\uC9C0\uB97C \uC120\uD0DD\uD569\uB2C8\uB2E4. \uCCAB \uBC88\uC9F8 \uC120\uD0DD\uC740 \uB2E4\uB978 \uBAA8\uB4E0 \uC774\uBBF8\uC9C0\uB97C \uC81C\uC678\uD569\uB2C8\uB2E4.</li>
<li><strong>Ctrl + Shift + \uC67C\uCABD \uD074\uB9AD:</strong> \uC774 \uC774\uBBF8\uC9C0\uC640 \uB9C8\uC9C0\uB9C9\uC73C\uB85C \uC120\uD0DD\uB41C \uC774\uBBF8\uC9C0 \uC0AC\uC774\uC758 \uC774\uBBF8\uC9C0\uB97C \uC120\uD0DD\uD569\uB2C8\uB2E4.</li>
<li><strong>Alt + \uC67C\uCABD \uD074\uB9AD:</strong> \uC774\uBBF8\uC9C0\uB97C \uC81C\uC678\uD569\uB2C8\uB2E4. \uCCAB \uBC88\uC9F8 \uC81C\uC678\uB294 \uB2E4\uB978 \uBAA8\uB4E0 \uC774\uBBF8\uC9C0\uB97C \uC120\uD0DD\uD569\uB2C8\uB2E4.</li>
<li><strong>Alt + Shift + \uC67C\uCABD \uD074\uB9AD:</strong> \uC774 \uC774\uBBF8\uC9C0\uC640 \uB9C8\uC9C0\uB9C9\uC73C\uB85C \uC81C\uC678\uB41C \uC774\uBBF8\uC9C0 \uC0AC\uC774\uC758 \uC774\uBBF8\uC9C0\uB97C \uC81C\uC678\uD569\uB2C8\uB2E4.</li>
</ul>
<p>\uCD94\uAC00\uC801\uC73C\uB85C \uBA87 \uAC00\uC9C0 \uBC29\uBC95\uC774 \uB354 \uC788\uC2B5\uB2C8\uB2E4:</p>
<ul>
<li>\uC378\uB124\uC77C\uC5D0\uC11C \uC911\uAC04 \uD074\uB9AD\uC73C\uB85C \uC6D0\uBCF8 \uC774\uBBF8\uC9C0 URL\uC744 \uC5F4\uACE0, \uADF8 \uD6C4 \uC624\uB978\uCABD \uD074\uB9AD\uD558\uC5EC \uC774\uBBF8\uC9C0\uB97C \uC800\uC7A5\uD569\uB2C8\uB2E4.</li>
<li>\uB2E4\uC6B4\uB85C\uB4DC \uD328\uB110\uC5D0\uC11C \uB2E4\uC6B4\uB85C\uB4DC \uBC94\uC704\uB97C 1\uB85C \uC124\uC815\uD558\uC138\uC694. \uC774\uB294 \uCCAB \uBC88\uC9F8 \uC774\uBBF8\uC9C0 \uC774\uC678\uC758 \uBAA8\uB4E0 \uC774\uBBF8\uC9C0\uB97C \uC81C\uC678\uD569\uB2C8\uB2E4. \uADF8\uB7F0 \uB2E4\uC74C \uBAA9\uB85D\uC5D0\uC11C \uAD00\uC2EC \uC788\uB294 \uC378\uB124\uC77C\uC744 \uD074\uB9AD\uD558\uC5EC \uD574\uB2F9 \uD070 \uC774\uBBF8\uC9C0\uB97C \uB85C\uB4DC\uD569\uB2C8\uB2E4. \uC120\uD0DD\uD55C \uD6C4, \uB2E4\uC6B4\uB85C\uB4DC \uBC94\uC704\uB97C \uD574\uC81C\uD558\uACE0 <strong>\uC774\uBBF8 \uB2E4\uC6B4\uB85C\uB4DC\uD55C \uC774\uBBF8\uC9C0 \uAC00\uC838\uC624\uAE30</strong>\uB97C \uD074\uB9AD\uD558\uC5EC \uC120\uD0DD\uD55C \uC774\uBBF8\uC9C0\uB97C \uD328\uD0A4\uC9D5\uD558\uACE0 \uB2E4\uC6B4\uB85C\uB4DC\uD569\uB2C8\uB2E4.</li>
<li>\uC790\uB3D9 \uB85C\uB529\uC744 \uB044\uACE0 \uC124\uC815 \uD328\uB110\uC5D0\uC11C \uC0AC\uC804 \uB85C\uB529\uC744 1\uB85C \uC124\uC815\uD55C \uB2E4\uC74C, \uC704\uC758 \uBC29\uBC95\uB300\uB85C \uC9C4\uD589\uD569\uB2C8\uB2E4.</li>
</ul>

<h2>[\uD0A4\uBCF4\uB4DC\uB85C \uC2A4\uD06C\uB9BD\uD2B8\uB97C \uC870\uC791\uD560 \uC218 \uC788\uB098\uC694?]</h2>
<p>\uB124! \uC124\uC815 \uD328\uB110 \uD558\uB2E8\uC5D0 <strong>\uB2E8\uCD95\uD0A4</strong> \uBC84\uD2BC\uC774 \uC788\uC2B5\uB2C8\uB2E4. \uC774 \uBC84\uD2BC\uC744 \uD074\uB9AD\uD558\uC5EC \uD0A4\uBCF4\uB4DC \uC870\uC791\uC744 \uD655\uC778\uD558\uAC70\uB098 \uC124\uC815\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p>
<p>\uD55C \uC190\uC73C\uB85C \uBAA8\uB4E0 \uD0A4\uBCF4\uB4DC \uC870\uC791\uC744 \uD560 \uC218 \uC788\uB3C4\uB85D \uC124\uC815\uD560 \uC218\uB3C4 \uC788\uC5B4, \uB2E4\uB978 \uC190\uC744 \uC790\uC720\uB86D\uAC8C \uC4F8 \uC218 \uC788\uC2B5\uB2C8\uB2E4!</p>

<h2>[\uD2B9\uC815 \uC0AC\uC774\uD2B8\uC5D0\uC11C \uC790\uB3D9 \uC5F4\uAE30\uB97C \uBE44\uD65C\uC131\uD654\uD558\uB824\uBA74 \uC5B4\uB5BB\uAC8C \uD574\uC57C \uD558\uB098\uC694?]</h2>
<p>\uC124\uC815 \uD328\uB110 \uD558\uB2E8\uC5D0 \uC788\uB294 <strong>\uC0AC\uC774\uD2B8 \uC124\uC815</strong> \uBC84\uD2BC\uC744 \uD074\uB9AD\uD558\uC5EC \uD2B9\uC815 \uC0AC\uC774\uD2B8\uC5D0\uC11C \uC790\uB3D9 \uC5F4\uAE30\uB97C \uC81C\uC678\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4. \uC608\uB97C \uB4E4\uC5B4, Twitter\uB098 Booru \uD0C0\uC785\uC758 \uC0AC\uC774\uD2B8\uB97C \uC81C\uC678\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p>

<h2>[\uD2B9\uC815 \uC0AC\uC774\uD2B8\uC5D0\uC11C \uC774 \uC2A4\uD06C\uB9BD\uD2B8\uB97C \uBE44\uD65C\uC131\uD654\uD558\uB824\uBA74 \uC5B4\uB5BB\uAC8C \uD574\uC57C \uD558\uB098\uC694?]</h2>
<p>\uC124\uC815 \uD328\uB110 \uD558\uB2E8\uC758 <strong>\uC0AC\uC774\uD2B8 \uC124\uC815</strong> \uBC84\uD2BC\uC744 \uD074\uB9AD\uD558\uC5EC \uD2B9\uC815 \uC0AC\uC774\uD2B8\uB97C \uC81C\uC678\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4. \uC81C\uC678\uB41C \uC0AC\uC774\uD2B8\uC5D0\uC11C\uB294 \uB354 \uC774\uC0C1 \uC2A4\uD06C\uB9BD\uD2B8\uAC00 \uD65C\uC131\uD654\uB418\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4.</p>
<p>\uC0AC\uC774\uD2B8\uB97C \uB2E4\uC2DC \uD65C\uC131\uD654\uD558\uB824\uBA74 \uC81C\uC678\uB418\uC9C0 \uC54A\uC740 \uC0AC\uC774\uD2B8\uC5D0\uC11C \uC124\uC815\uD574\uC57C \uD569\uB2C8\uB2E4.</p>

<h2>[\uAC1C\uBC1C\uC790\uC5D0\uAC8C \uB3C4\uC6C0\uC744 \uC8FC\uACE0 \uC2F6\uB2E4\uBA74?]</h2>
<p><a target="_blank" href="https://github.com/MapoMagpie/eh-view-enhance">Github</a>\uC5D0 \uBCC4\uC744 \uC8FC\uC2DC\uAC70\uB098, <a target="_blank" href="https://greasyfork.org/scripts/397848-e-hentai-view-enhance">Greasyfork</a>\uC5D0\uC11C \uC88B\uC740 \uB9AC\uBDF0\uB97C \uB0A8\uACA8\uC8FC\uC138\uC694.</p>
<p>\uB2E8, Greasyfork\uC5D0 \uBC84\uADF8 \uC81C\uBCF4 \uB0B4\uC6A9\uC758 \uB9AC\uBDF0\uB97C \uB0A8\uAE30\uC9C0 \uB9C8\uC138\uC694. \uD574\uB2F9 \uD50C\uB7AB\uD3FC\uC758 \uC54C\uB9BC \uC2DC\uC2A4\uD15C\uC774 \uD6C4\uC18D \uD53C\uB4DC\uBC31\uC744 \uCD94\uC801\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4. \uB9CE\uC740 \uC0AC\uB78C\uB4E4\uC774 \uBB38\uC81C\uB97C \uC81C\uAE30\uD558\uACE0 \uB2E4\uC2DC \uB3CC\uC544\uC624\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4.<br> \uBB38\uC81C\uB294 \uC5EC\uAE30\uC5D0 \uBCF4\uACE0\uD574 \uC8FC\uC138\uC694: <a target="_blank" href="https://github.com/MapoMagpie/eh-view-enhance/issues">\uC774\uC288</a></p>

<h2>[\uAC00\uC774\uB4DC\uB97C \uB2E4\uC2DC \uC5F4\uB824\uBA74?]</h2>
<p>\uC124\uC815 \uD328\uB110 \uD558\uB2E8\uC5D0 \uC788\uB294 <strong>\uB3C4\uC6C0\uB9D0</strong> \uBC84\uD2BC\uC744 \uD074\uB9AD\uD558\uC138\uC694.</p>

<h2>[\uD574\uACB0\uB418\uC9C0 \uC54A\uC740 \uBB38\uC81C\uB4E4]</h2>
<ul>
<li>Firefox\uB97C \uC0AC\uC6A9\uD558\uC5EC Twitter\uC758 \uD648\uD398\uC774\uC9C0\uB97C \uC0C8 \uD0ED\uC5D0\uC11C \uC5F0 \uD6C4 \uC0AC\uC6A9\uC790\uC758 \uD648\uD398\uC774\uC9C0\uB85C \uC774\uB3D9\uD558\uBA74 \uC2A4\uD06C\uB9BD\uD2B8\uAC00 \uD65C\uC131\uD654\uB418\uC9C0 \uC54A\uC73C\uBA70 \uD398\uC774\uC9C0 \uC0C8\uB85C\uACE0\uCE68\uC774 \uD544\uC694\uD569\uB2C8\uB2E4.</li>
<li>Chrome\uACFC Firefox\uC758 \uD504\uB808\uC784\uB0B4\uC5D0\uC11C \uC0AC\uC774\uD2B8\uB97C \uC5EC\uB294 \uAC83\uC744 \uBC29\uC9C0\uD558\uB294 \uD655\uC7A5 \uD504\uB85C\uADF8\uB7A8\uC744 \uC0AC\uC6A9\uD558\uB294 \uACBD\uC6B0, E-Hentai\uC5D0\uC11C \uAC24\uB7EC\uB9AC \uB0B4 \uC774\uBBF8\uC9C0\uB97C \uC5F4 \uC218 \uC5C6\uAC8C \uB418\uBA70 \uC124\uC815 \uBA54\uB274 \uB610\uD55C \uD45C\uC2DC\uB418\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4. \uC774 \uBB38\uC81C\uB97C \uD574\uACB0\uD558\uB824\uBA74 \uD655\uC7A5 \uD504\uB85C\uADF8\uB7A8\uC744 \uBE44\uD65C\uC131\uD654\uD558\uAC70\uB098 \uC608\uC678 \uD56D\uBAA9\uC744 \uCD94\uAC00\uD558\uC138\uC694.</li>
</ul>

<h2>[\uC791\uB3D9 \uC6D0\uB9AC]</h2>
<p>\uC774 \uC2A4\uD06C\uB9BD\uD2B8\uB294 \uB2E8\uC21C\uD55C jQuery(\uAD6C\uD615 \uC2A4\uD06C\uB9BD\uD2B8)\uC5D0\uC11C\uBD80\uD130 \uCD5C\uCCA8\uB2E8 Vue.js \uD504\uB808\uC784\uC6CC\uD06C\uC5D0 \uC774\uB974\uAE30\uAE4C\uC9C0 \uB9E4\uC6B0 \uB2E4\uC591\uD55C \uC6F9 \uAE30\uC220\uC5D0\uC11C \uC791\uB3D9\uD569\uB2C8\uB2E4. \uC774 \uC2A4\uD06C\uB9BD\uD2B8\uB294 \uD574\uB2F9 \uAE30\uC220\uB4E4\uC744 \uD574\uD0B9\uD558\uC9C0 \uC54A\uACE0\uB3C4 \uC0C1\uD638\uC791\uC6A9\uD560 \uC218 \uC788\uB3C4\uB85D \uCD5C\uC801\uD654\uB418\uC5B4 \uC788\uC2B5\uB2C8\uB2E4.</p>
<p>\uC124\uC815 \uD328\uB110\uC758 \uC790\uB3D9 \uC800\uC7A5 \uBC0F \uC0AC\uC774\uD2B8\uBCC4 \uC124\uC815 \uAE30\uB2A5\uC740 \uC2A4\uD06C\uB9BD\uD2B8\uC758 \uBCF8\uCCB4 \uCF54\uB4DC\uC5D0 \uC800\uC7A5\uB418\uC9C0 \uC54A\uC73C\uBA70, \uC2A4\uD06C\uB9BD\uD2B8\uC5D0\uC11C \uC218\uC9D1\uD558\uB294 \uC815\uBCF4\uB294 \uB85C\uCEEC \uCEF4\uD4E8\uD130\uC5D0\uB9CC \uC800\uC7A5\uB429\uB2C8\uB2E4.</p>
<p>\uB610\uD55C \uC774 \uC2A4\uD06C\uB9BD\uD2B8\uB294 \uB9CE\uC740 \uC774\uBBF8\uC9C0\uB97C \uCC98\uB9AC\uD560 \uC218 \uC788\uB3C4\uB85D \uD6A8\uC728\uC801\uC73C\uB85C \uC124\uACC4\uB418\uC5C8\uC2B5\uB2C8\uB2E4. \uC774\uBBF8\uC9C0 \uB85C\uB529 \uC2DC\uC810\uC5D0\uC11C\uB294 \uBE0C\uB77C\uC6B0\uC800\uC5D0 \uC758\uC874\uD558\uBA70, \uC774\uBBF8\uC9C0 \uAD00\uB828 \uB370\uC774\uD130\uB294 \uC0AC\uC6A9\uC790 \uC2DC\uC2A4\uD15C\uC758 \uBA54\uBAA8\uB9AC\uB85C \uC9C1\uC811 \uB85C\uB4DC\uB429\uB2C8\uB2E4. \uC774\uB294 \uB370\uC774\uD130 \uC804\uC1A1\uB7C9\uACFC \uC11C\uBC84 \uC694\uCCAD \uC218\uB97C \uC904\uC774\uBA74\uC11C\uB3C4 \uBE60\uB974\uACE0 \uC720\uC5F0\uD55C \uC774\uBBF8\uC9D5\uC744 \uAC00\uB2A5\uD558\uAC8C \uD569\uB2C8\uB2E4.</p>

<h2>[\uC2A4\uD06C\uB9BD\uD2B8\uAC00 \uC791\uB3D9\uD558\uC9C0 \uC54A\uB294 \uC774\uC720\uB294 \uBB34\uC5C7\uC778\uAC00\uC694?]</h2>
<p>\uC774 \uC2A4\uD06C\uB9BD\uD2B8\uB294 \uC6F9\uD398\uC774\uC9C0\uC758 HTML \uAD6C\uC870\uC640 \uC0C1\uD638\uC791\uC6A9\uD558\uAE30 \uB54C\uBB38\uC5D0 \uD398\uC774\uC9C0\uAC00 \uBCC0\uACBD\uB420 \uACBD\uC6B0(\uC608: \uAC1C\uBC1C\uC790\uAC00 \uC5C5\uB370\uC774\uD2B8\uB97C \uD558\uAC70\uB098 \uAD11\uACE0\uB97C \uC0BD\uC785\uD560 \uB54C) \uC608\uC0C1\uB300\uB85C \uC791\uB3D9\uD558\uC9C0 \uC54A\uC744 \uC218 \uC788\uC2B5\uB2C8\uB2E4. \uC774 \uACBD\uC6B0, \uBE0C\uB77C\uC6B0\uC800 \uCF58\uC194\uC744 \uC5F4\uC5B4 \uC624\uB958 \uBA54\uC2DC\uC9C0\uB97C \uD655\uC778\uD558\uC138\uC694. \uC624\uB958 \uBA54\uC2DC\uC9C0\uAC00 \uD45C\uC2DC\uB418\uBA74 GitHub \uC774\uC288 \uC139\uC158\uC5D0 \uBCF4\uACE0\uD574 \uC8FC\uC138\uC694.</p>

<h2>[\uAE30\uD0C0 \uC815\uBCF4]</h2>
<p>\uC124\uC815 \uD328\uB110\uC5D0\uC11C \uB2E4\uC591\uD55C \uC124\uC815 \uC635\uC158\uC744 \uC0AC\uC6A9\uD560 \uC218 \uC788\uC73C\uBA70, \uAC01 \uC124\uC815\uC740 \uC0AC\uC6A9\uC790 \uD658\uACBD\uC744 \uCD5C\uC801\uD654\uD558\uB294 \uB370 \uB3C4\uC6C0\uC774 \uB429\uB2C8\uB2E4. \uC2A4\uD06C\uB9BD\uD2B8\uAC00 \uC758\uB3C4\uB300\uB85C \uC791\uB3D9\uD558\uC9C0 \uC54A\uB294 \uACBD\uC6B0 GitHub \uC774\uC288\uC5D0\uC11C \uD574\uACB0 \uBC29\uBC95\uC744 \uCC3E\uC544\uBCF4\uC138\uC694.</p>
`,`
<h2>\xBFC\xF3mo se usa? \xBFD\xF3nde est\xE1 la entrada</h2>
<p>El script generalmente se activa en las p\xE1ginas principales de galer\xEDas o en las p\xE1ginas principales de artistas. Por ejemplo, en E-Hentai, se activa en la p\xE1gina de detalles de la galer\xEDa, o en Twitter, se activa en la p\xE1gina principal del usuario o en los tweets.p>
<p>Cuando est\xE9 activo, aparecer\xE1 un \xEDcono de <strong>&lt;\u{1F391}&gt;</strong> en la parte inferior izquierda de la p\xE1gina.</p>
<h2 style="color:red;">[Algunos problemas no resueltos]</h2>
<ul>
<li>Al usar Firefox para abrir la p\xE1gina principal de Twitter en una nueva pesta\xF1a y luego navegar a la p\xE1gina principal del usuario, el script no se activa y requiere actualizar la p\xE1gina.</li>
<li>En Firefox, la funci\xF3n de descarga no funciona en el dominio twitter.com. Firefox no redirige twitter.com a x.com cuando se abre en una nueva pesta\xF1a. Debes usar x.com en lugar de twitter.com.</li>
</ul>
<h2>[\xBFSe puede reubicar el punto de entrada o la barra de control del script?]</h2>
<p>\xA1S\xED! En la parte inferior del panel de configuraci\xF3n, hay una opci\xF3n de <strong>Arrastrar para mover</strong>. Arrastra el \xEDcono para reposicionar la barra de control en cualquier parte de la p\xE1gina.</p>
<h2>[\xBFPuede el script abrirse autom\xE1ticamente al navegar a la p\xE1gina correspondiente?]</h2>
<p>\xA1S\xED! Hay una opci\xF3n de <strong>Apertura Autom\xE1tica</strong> en el panel de configuraci\xF3n. Act\xEDvala para habilitar esta funci\xF3n.</p>
<h2>[\xBFC\xF3mo hacer zoom en las im\xE1genes?]</h2>
<p>Hay varias formas de hacer zoom en las im\xE1genes en el modo de lectura de im\xE1genes grandes:</p>
<ul>
<li>Clic derecho + rueda del rat\xF3n</li>
<li>Atajos de teclado</li>
<li>Controles de zoom en la barra de control: haz clic en los botones -/+, desplaza la rueda del rat\xF3n sobre los n\xFAmeros o arrastra los n\xFAmeros hacia la izquierda o derecha.</li>
</ul>
<h2>[\xBFC\xF3mo mantener el espacio entre im\xE1genes grandes?]</h2>
<p>En CONF > Style, modifique o a\xF1ada: .ehvp-root { --ehvp-big-images-gap: 2px; }</p>
<h2>[\xBFC\xF3mo abrir im\xE1genes de una p\xE1gina espec\xEDfica?]</h2>
<p>En la interfaz de lista de miniaturas, simplemente escribe el n\xFAmero de p\xE1gina deseado en tu teclado (sin necesidad de un aviso) y presiona Enter o utiliza tus atajos personalizados.</p>
<h2>[Acerca de la Lista de Miniaturas]</h2>
<p>La interfaz de lista de miniaturas es la caracter\xEDstica m\xE1s importante del script, ya que te permite obtener r\xE1pidamente una vista general de toda la galer\xEDa.</p>
<p>Las miniaturas se cargan de forma diferida, normalmente cargando alrededor de 20 im\xE1genes, lo que es comparable o incluso implica menos solicitudes que la navegaci\xF3n normal.</p>
<p>La paginaci\xF3n tambi\xE9n se carga de manera diferida, lo que significa que no todas las p\xE1ginas de la galer\xEDa se cargan a la vez. Solo cuando te acercas al final de la p\xE1gina, se carga la siguiente.</p>
<p>No te preocupes por generar muchas solicitudes al desplazarte r\xE1pidamente por la lista de miniaturas; el script est\xE1 dise\xF1ado para manejar esto de manera eficiente.</p>
<h2>[Acerca de la Carga Autom\xE1tica y la Carga Anticipada]</h2>
<p>Por defecto, el script carga autom\xE1ticamente y de manera gradual las im\xE1genes grandes una por una.</p>
<p>A\xFAn puedes hacer clic en cualquier miniatura para comenzar a cargar y leer desde ese punto, momento en el cual la carga autom\xE1tica se detendr\xE1 y se pre-cargar\xE1n 3 im\xE1genes desde la posici\xF3n de lectura.</p>
<p>Al igual que con la lista de miniaturas, no necesitas preocuparte por generar muchas solicitudes de carga al desplazarte r\xE1pidamente.</p>
<h2>[Acerca de la Descarga]</h2>
<p>La descarga est\xE1 integrada con la carga de im\xE1genes grandes. Cuando termines de navegar por una galer\xEDa y quieras guardar y descargar las im\xE1genes, puedes hacer clic en <strong>Iniciar Descarga</strong> en el panel de descargas. No te preocupes por volver a descargar las im\xE1genes ya cargadas.</p>
<p>Tambi\xE9n puedes hacer clic directamente en <strong>Iniciar Descarga</strong> en el panel de descargas sin necesidad de leer.</p>
<p>Alternativamente, haz clic en el bot\xF3n <strong>Tomar Cargadas</strong> en el panel de descargas si algunas im\xE1genes no se cargan consistentemente. Esto guardar\xE1 las im\xE1genes que ya se han cargado.</p>
<p>Los indicadores de estado del panel de descargas proporcionan una visi\xF3n clara del progreso de la carga de im\xE1genes.</p>
<p><strong>Nota:</strong> Cuando el tama\xF1o del archivo de descarga supere los 1.2 GB, se habilitar\xE1 autom\xE1ticamente la compresi\xF3n dividida. Si encuentras errores al extraer los archivos, por favor actualiza tu software de extracci\xF3n o usa 7-Zip.</p>
<h2>[\xBFPuedo seleccionar el rango de descarga?]</h2>
<p>S\xED, el panel de descargas tiene una opci\xF3n para seleccionar el rango de descarga (Cherry Pick), que se aplica a la descarga, carga autom\xE1tica y carga anticipada.</p>
<p>Incluso si una imagen est\xE1 excluida del rango de descarga, a\xFAn puedes hacer clic en su miniatura para verla, lo que cargar\xE1 la imagen grande correspondiente.</p>
<h2>[\xBFC\xF3mo seleccionar im\xE1genes en algunos sitios de ilustraci\xF3n?]</h2>
<p>En la lista de miniaturas, puedes usar algunas teclas de acceso r\xE1pido para seleccionar im\xE1genes:</p>
<ul>
<li><strong>Ctrl + Clic Izquierdo:</strong> Selecciona la imagen. La primera selecci\xF3n excluir\xE1 todas las dem\xE1s im\xE1genes.</li>
<li><strong>Ctrl + Shift + Clic Izquierdo:</strong> Selecciona el rango de im\xE1genes entre esta imagen y la \xFAltima imagen seleccionada.</li>
<li><strong>Alt + Clic Izquierdo:</strong> Excluye la imagen. La primera exclusi\xF3n seleccionar\xE1 todas las dem\xE1s im\xE1genes.</li>
<li><strong>Alt + Shift + Clic Izquierdo:</strong> Excluye el rango de im\xE1genes entre esta imagen y la \xFAltima imagen excluida.</li>
</ul>
<p>Adem\xE1s, hay otros m\xE9todos:</p>
<ul>
<li>Haz clic en el bot\xF3n del medio en una miniatura para abrir la URL de la imagen original, luego haz clic derecho para guardar la imagen.</li>
<li>Establece el rango de descarga en 1 en el panel de descargas. Esto excluir\xE1 todas las im\xE1genes excepto la primera. Luego, haz clic en las miniaturas de inter\xE9s en la lista, lo que cargar\xE1 las im\xE1genes grandes correspondientes. Despu\xE9s de seleccionar, borra el rango de descarga y haz clic en <strong>Tomar Cargadas</strong> para empaquetar y descargar tus im\xE1genes seleccionadas.</li>
<li>Desactiva la carga autom\xE1tica y establece la carga anticipada en 1 en el panel de configuraci\xF3n, luego procede como se describe anteriormente.</li>
</ul>
<h2>[\xBFPuedo operar el script mediante el teclado?]</h2>
<p>\xA1S\xED! Hay un bot\xF3n del <strong>Teclado</strong> en la parte inferior del panel de configuraci\xF3n. Haz clic en \xE9l para ver o configurar las operaciones del teclado.</p>
<p>\xA1Incluso puedes configurarlo para operar con una sola mano, liberando as\xED tu otra mano!</p>
<h2>[\xBFC\xF3mo desactivar la apertura autom\xE1tica en ciertos sitios?]</h2>
<p>Hay un bot\xF3n de <strong>Perfiles de Sitio<strong> en la parte inferior del panel de configuraci\xF3n. Haz clic en \xE9l para excluir ciertos sitios de la apertura autom\xE1tica. Por ejemplo, sitios como Twitter o de tipo Booru.</p>
<h2>[\xBFC\xF3mo desactivar este script en ciertos sitios?]</h2>
<p>Hay un bot\xF3n de <strong>Perfiles de Sitio</strong> en la parte inferior del panel de configuraci\xF3n para excluir sitios espec\xEDficos. Una vez excluidos, el script ya no se activar\xE1 en esos sitios.</p>
<p>Para volver a habilitar un sitio, necesitas hacerlo desde un sitio que no haya sido excluido.</p>
<h2>[\xBFC\xF3mo apoyar al autor?]</h2>
<p>D\xE9jame una estrella en <a target='_blank' href='https://github.com/MapoMagpie/eh-view-enhance'>Github</a> o una buena rese\xF1a en <a target='_blank' href='https://greasyfork.org/scripts/397848-e-hentai-view-enhance'>Greasyfork</a>.</p>
<p>Por favor, no dejes rese\xF1as en Greasyfork, ya que su sistema de notificaciones no puede rastrear comentarios posteriores. Muchas personas dejan un problema y nunca vuelven.
Reporta problemas aqu\xED: <a target='_blank' href='https://github.com/MapoMagpie/eh-view-enhance/issues'>issue</a></p>
<h2>[\xBFC\xF3mo reabrir la gu\xEDa?]</h2>
<p>Haz clic en el bot\xF3n de <strong>Ayuda</strong> en la parte inferior del panel de configuraci\xF3n.</p>
`]},xt={"open-full-view-grid":["Enter Read Mode","\u8FDB\u5165\u9605\u8BFB\u6A21\u5F0F","\uC77D\uAE30 \uBAA8\uB4DC \uC2DC\uC791","Entrar en modo de lectura"],"start-download":["Start Download","\u5F00\u59CB\u4E0B\u8F7D","\uB2E4\uC6B4\uB85C\uB4DC \uC2DC\uC791","Iniciar Descarga"],"step-image-prev":["Go Prev Image","\u5207\u6362\u5230\u4E0A\u4E00\u5F20\u56FE\u7247","\uC774\uC804 \uC774\uBBF8\uC9C0","Ir a la imagen anterior"],"step-image-next":["Go Next Image","\u5207\u6362\u5230\u4E0B\u4E00\u5F20\u56FE\u7247","\uB2E4\uC74C \uC774\uBBF8\uC9C0","Ir a la imagen siguiente"],"exit-big-image-mode":["Exit Big Image Mode","\u9000\u51FA\u5927\u56FE\u6A21\u5F0F","\uC774\uBBF8\uC9C0 \uD06C\uAC8C \uBCF4\uAE30 \uC885\uB8CC","Salir del modo de imagen grande"],"step-to-first-image":["Go First Image","\u8DF3\u8F6C\u5230\u7B2C\u4E00\u5F20\u56FE\u7247","\uCCAB \uC774\uBBF8\uC9C0\uB85C \uC774\uB3D9","Ir a la primera imagen"],"step-to-last-image":["Go Last Image","\u8DF3\u8F6C\u5230\u6700\u540E\u4E00\u5F20\u56FE\u7247","\uB9C8\uC9C0\uB9C9 \uC774\uBBF8\uC9C0\uB85C \uC774\uB3D9","Ir a la \xFAltima imagen"],"scale-image-increase":["Increase Image Scale","\u653E\u5927\u56FE\u7247","\uC774\uBBF8\uC9C0 \uD655\uB300","Aumentar la escala de la imagen"],"scale-image-decrease":["Decrease Image Scale","\u7F29\u5C0F\u56FE\u7247","\uC774\uBBF8\uC9C0 \uCD95\uC18C","Disminuir la escala de la imagen"],"scroll-image-up":["Scroll Image Up (Please Keep Default Keys)","\u5411\u4E0A\u6EDA\u52A8\u56FE\u7247 (\u8BF7\u4FDD\u7559\u9ED8\u8BA4\u6309\u952E)","\uC774\uBBF8\uC9C0 \uC704\uB85C \uC2A4\uD06C\uB864 (\uAE30\uBCF8 \uD0A4\uB294 \uADF8\uB300\uB85C \uB450\uC2ED\uC2DC\uC624)","Desplazar la imagen hacia arriba (Por favor, mantener las teclas predeterminadas)"],"scroll-image-down":["Scroll Image Down (Please Keep Default Keys)","\u5411\u4E0B\u6EDA\u52A8\u56FE\u7247 (\u8BF7\u4FDD\u7559\u9ED8\u8BA4\u6309\u952E)","\uC774\uBBF8\uC9C0 \uC544\uB798\uB85C \uC2A4\uD06C\uB864 (\uAE30\uBCF8 \uD0A4\uB294 \uADF8\uB300\uB85C \uB450\uC2ED\uC2DC\uC624)","Desplazar la imagen hacia abajo (Por favor, mantener las teclas predeterminadas)"],"toggle-auto-play":["Toggle Auto Play","\u5207\u6362\u81EA\u52A8\u64AD\u653E","\uC790\uB3D9 \uC7AC\uC0DD \uC2DC\uC791/\uC911\uC9C0","Alternar reproducci\xF3n autom\xE1tica"],"round-read-mode":["Switch Reading mode (Loop)","\u5207\u6362\u9605\u8BFB\u6A21\u5F0F(\u5FAA\u73AF)","\uC77D\uAE30 \uBAA8\uB4DC \uC804\uD658(\uB8E8\uD504)","Cambiar modo de lectura (bucle)"],"toggle-reverse-pages":["Toggle Pages Reverse","\u5207\u6362\u9605\u8BFB\u65B9\u5411","\uD398\uC774\uC9C0 \uBC18\uC804 \uC804\uD658","Alternar p\xE1ginas hacia atr\xE1s"],"rotate-image":["Rotate Image","\u65CB\u8F6C\u56FE\u7247","\uC774\uBBF8\uC9C0 \uD68C\uC804","Girar imagen"],"cherry-pick-current":["Cherry Pick Current Images","\u9009\u62E9\u5F53\u524D\u56FE\u7247","\uCCB4\uB9AC\uD53D \uD604\uC7AC \uC774\uBBF8\uC9C0","Im\xE1genes actuales de Cherry Pick"],"exclude-current":["Exclude current images","\u6392\u9664\u5F53\u524D\u56FE\u7247","\uD604\uC7AC \uC774\uBBF8\uC9C0 \uC81C\uC678","Excluir im\xE1genes actuales"],"open-big-image-mode":["Enter Big Image Mode","\u8FDB\u5165\u5927\u56FE\u9605\u8BFB\u6A21\u5F0F","\uC774\uBBF8\uC9C0 \uD06C\uAC8C \uBCF4\uAE30","Entrar al modo de imagen grande"],"pause-auto-load-temporarily":["Pause Auto Load Temporarily","\u4E34\u65F6\u505C\u6B62\u81EA\u52A8\u52A0\u8F7D","\uC790\uB3D9 \uC774\uBBF8\uC9C0 \uB85C\uB529 \uC77C\uC2DC \uC911\uC9C0","Pausar carga autom\xE1tica temporalmente"],"exit-full-view-grid":["Exit Read Mode","\u9000\u51FA\u9605\u8BFB\u6A21\u5F0F","\uC77D\uAE30 \uBAA8\uB4DC \uC885\uB8CC","Salir del modo de lectura"],"columns-increase":["Increase Columns ","\u589E\u52A0\u6BCF\u884C\u6570\u91CF","\uC5F4 \uC218 \uB298\uB9AC\uAE30","Aumentar columnas"],"columns-decrease":["Decrease Columns ","\u51CF\u5C11\u6BCF\u884C\u6570\u91CF","\uC5F4 \uC218 \uC904\uC774\uAE30","Disminuir columnas"],"retry-fetch-next-page":["Try Fetch Next Page","\u91CD\u65B0\u52A0\u8F7D\u4E0B\u4E00\u5206\u9875","\uB2E4\uC74C \uD398\uC774\uC9C0 \uB85C\uB529 \uC7AC\uC2DC\uB3C4","Intentar cargar la siguiente p\xE1gina"],"go-prev-chapter":["Switch To Previous Chapter","\u5207\u6362\u5230\u4E0A\u4E00\u7AE0\u8282","\uC774\uC804 \uC7A5\uC73C\uB85C \uC804\uD658","Cambiar al cap\xEDtulo anterior"],"go-next-chapter":["Switch To Next Chapter","\u5207\u6362\u5230\u4E0B\u4E00\u7AE0\u8282","\uB2E4\uC74C \uC7A5\uC73C\uB85C \uC804\uD658","cambiar al siguiente cap\xEDtulo"],"resize-flow-vision":["Resize Thumbnail Grid Layout","Resize Thumbnail Grid Layout","Resize Thumbnail Grid Layout","Resize Thumbnail Grid Layout"]};function Ue(o){return Object.entries(o).reduce((i,[n,r])=>(i[n]=new Ct(r),i),{})}const A={...Ue(It),keyboard:Ue(xt)},fe={moonViewCeremony:"<\u{1F391}>",zoomIcon:"\u21F1\u21F2"};function re(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){const e=Math.random()*16|0;return(o=="x"?e:e&3|8).toString(16)})}function qe(){return window.btoa(re())}function Ge(o){return btoa(encodeURIComponent(o).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(parseInt(t,16))}))}const j=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile/i.test(navigator.userAgent);function De(){const o=window.screen.width;return o>2500?7:o>1900?6:o>700?5:3}function At(){const o=window.screen.availHeight;return Math.floor(o/3.4)}function be(){return{colCount:De(),rowHeight:At(),readMode:"pagination",autoLoad:!0,fetchOriginal:!1,restartIdleLoader:2e3,threads:3,downloadThreads:4,timeout:10,version:Ve,debug:!0,first:!0,reversePages:!1,pageHelperAbTop:"unset",pageHelperAbLeft:"20px",pageHelperAbBottom:"20px",pageHelperAbRight:"unset",imgScale:100,defaultImgScaleModeC:60,autoPageSpeed:5,autoPlay:!1,hdThumbnails:!1,filenameTemplate:"{number}-{title}",preventScrollPageTime:100,archiveVolumeSize:1200,pixivConvertTo:"GIF",autoCollapsePanel:!0,minifyPageHelper:j?"never":"inBigMode",keyboards:{inBigImageMode:{},inFullViewGrid:{},inMain:{}},siteProfiles:{},muted:!1,volume:50,mcInSites:["18comic"],paginationIMGCount:1,hitomiFormat:"auto",autoOpen:!1,autoLoadInBackground:!0,reverseMultipleImagesPost:!0,ehentaiTitlePrefer:"japanese",scrollingDelta:300,scrollingSpeed:20,id:re(),configPatchVersion:0,displayText:{},customStyle:"",magnifier:!1,autoEnterBig:!1,pixivJustCurrPage:!1,filenameOrder:"auto",dragImageOut:!1,excludeVideo:!1}}const Ve="4.4.0",Be="ehvh_cfg_";function _t(){if(typeof Ne=="function"&&typeof $e=="function")return{setItem:(o,e)=>$e(o,e),getItem:o=>Ne(o)};if(typeof localStorage<"u")return{setItem:(o,e)=>localStorage.setItem(o,e),getItem:o=>localStorage.getItem(o)};throw new Error("No supported storage method found")}const Oe=_t();function kt(){const o=Oe.getItem(Be);if(o){const t=JSON.parse(o);if(t.version===Ve)return St(t)}const e=be();return q(e),e}function St(o){let e=!1;const t=be(),i=Object.keys(t);i.forEach(a=>{o[a]===void 0&&(o[a]=t[a],e=!0)});const n=Object.keys(o);for(const a of n)i.includes(a)||(delete o[a],e=!0);["pageHelperAbTop","pageHelperAbLeft","pageHelperAbBottom","pageHelperAbRight"].forEach(a=>{if(o[a]!=="unset"){const s=parseInt(o[a]),l=a.endsWith("Right")||a.endsWith("Left")?window.screen.width:window.screen.height;(isNaN(s)||s<5||s>l)&&(o[a]="5px",e=!0)}}),["pagination","continuous","horizontal"].includes(o.readMode)||(o.readMode="pagination",e=!0),(o.imgScale===void 0||isNaN(o.imgScale)||o.imgScale===0)&&(o.imgScale=o.readMode==="continuous"?o.defaultImgScaleModeC:100,e=!0);const r=Et(o);return r&&(o=r,e=!0),e&&q(o),o}function Et(o){let e=!1;return o.configPatchVersion<8&&(o.siteProfiles={},o.configPatchVersion=8,o.colCount=De(),o.keyboards={inBigImageMode:{},inFullViewGrid:{},inMain:{}},e=!0),o.configPatchVersion<9&&(delete o.siteProfiles.rule34,o.configPatchVersion=9,e=!0),o.configPatchVersion<10&&(o.customStyle="",o.configPatchVersion=10,e=!0),e?o:null}function Lt(){confirm(A.resetConfig.get()+" ?")&&q(be())}function q(o){Oe.setItem(Be,JSON.stringify(o))}const u=kt(),ze={imgSrcCSP:!1,originalPolicy:""},Fe=[{key:"colCount",typ:"number"},{key:"rowHeight",typ:"number"},{key:"threads",typ:"number"},{key:"downloadThreads",typ:"number"},{key:"paginationIMGCount",typ:"number"},{key:"timeout",typ:"number"},{key:"preventScrollPageTime",typ:"number"},{key:"autoPageSpeed",typ:"number"},{key:"scrollingDelta",typ:"number"},{key:"scrollingSpeed",typ:"number"},{key:"fetchOriginal",typ:"boolean",gridColumnRange:[1,6]},{key:"autoLoad",typ:"boolean",gridColumnRange:[6,11]},{key:"reversePages",typ:"boolean",gridColumnRange:[1,6]},{key:"autoPlay",typ:"boolean",gridColumnRange:[6,11]},{key:"autoLoadInBackground",typ:"boolean",gridColumnRange:[1,6]},{key:"autoOpen",typ:"boolean",gridColumnRange:[6,11]},{key:"magnifier",typ:"boolean",gridColumnRange:[1,6]},{key:"autoEnterBig",typ:"boolean",gridColumnRange:[6,11]},{key:"dragImageOut",typ:"boolean",gridColumnRange:[1,6]},{key:"hdThumbnails",typ:"boolean",gridColumnRange:[6,11]},{key:"autoCollapsePanel",typ:"boolean",gridColumnRange:[1,11]},{key:"pixivJustCurrPage",typ:"boolean",gridColumnRange:[1,11],displayInSite:/pixiv.net/},{key:"reverseMultipleImagesPost",typ:"boolean",gridColumnRange:[1,11],displayInSite:/(x.com|twitter.com)\//},{key:"excludeVideo",typ:"boolean",gridColumnRange:[1,11],displayInSite:/(x.com|twitter.com|kemono.su)\//},{key:"readMode",typ:"select",options:[{value:"pagination",display:"Pagination"},{value:"continuous",display:"Continuous"},{value:"horizontal",display:"Horizontal"}]},{key:"minifyPageHelper",typ:"select",options:[{value:"always",display:"Always"},{value:"inBigMode",display:"InBigMode"},{value:"never",display:"Never"}]},{key:"hitomiFormat",typ:"select",options:[{value:"auto",display:"Auto"},{value:"avif",display:"Avif"},{value:"webp",display:"Webp"},{value:"jxl",display:"Jxl"}],displayInSite:/hitomi.la\//},{key:"ehentaiTitlePrefer",typ:"select",options:[{value:"english",display:"English"},{value:"japanese",display:"Japanese"}],displayInSite:/e[-x]hentai(.*)?.(org|onion)\//},{key:"filenameOrder",typ:"select",options:[{value:"auto",display:"Auto"},{value:"numbers",display:"Numbers"},{value:"original",display:"Original"},{value:"alphabetically",display:"Alphabetically"}]}],Tt={entry:fe.moonViewCeremony,collapse:A.collapse.get(),fin:"FIN",autoPagePlay:A.autoPagePlay.get(),autoPagePause:A.autoPagePause.get(),config:A.config.get(),download:A.download.get(),chapters:A.chapters.get(),pagination:"PAGE",continuous:"CONT",horizontal:"HORI"};function He(){return{...Tt,...u.displayText}}function I(o,e,...t){o==="debug"&&!u.debug||(o==="error"?console.warn(new Date().toLocaleString(),"EHVP:"+e,...t):console.info(new Date().toLocaleString(),"EHVP:"+e,...t))}class Rt{events;constructor(){this.events=new Map}emit(e,...t){["imf-download-state-change","imf-check-picked"].includes(e)||I("debug","event bus emitted: ",e);const i=this.events.get(e);let n;return i&&i.forEach(r=>n=r(...t)),n}subscribe(e,t){I("info","event bus subscribed: ",e);const i=this.events.get(e);i?i.push(t):this.events.set(e,[t])}reset(){this.events=new Map}}const f=new Rt;class H{tids;mode;lastExecTime;constructor(e){this.tids={},this.lastExecTime=Date.now(),this.mode=e||"debounce"}addEvent(e,t,i){if(this.mode==="throttle"){const n=Date.now();n-this.lastExecTime>=i&&(this.lastExecTime=n,t())}else this.mode==="debounce"&&(window.clearTimeout(this.tids[e]),this.tids[e]=window.setTimeout(t,i))}}function je(o,e,t,i,n){if(me===void 0)throw new Error("your userscript manager does not support Gm_xmlhttpRequest api");return me({method:"GET",url:o,timeout:n||6e5,responseType:e,nocache:!1,revalidate:!1,headers:{Referer:window.location.href,"Cache-Control":"public, max-age=2592000, immutable",...i},...t})?.abort}function Ze(o,e,t){return new Promise((i,n)=>{try{je(o,e,{onload:r=>i(r.response),onerror:r=>n(r)},t??{},10*1e3)}catch(r){n(r)}})}async function we(o,e,t="text"){const i=new Array(o.length);let n=0;for(;n<o.length;){const a=o.slice(n,n+e).map((s,l)=>window.fetch(s).then(c=>{if(c.ok)try{switch(t){case"text":return c.text();case"json":return c.json();case"arraybuffer":return c.arrayBuffer()}}catch(d){throw new Error(`failed to fetch ${s}: ${c.status} ${d}`)}throw new Error(`failed to fetch ${s}: ${c.status} ${c.statusText}`)}).then(c=>i[l+n]=c).catch(c=>i[l+n]=new Error(c)));await Promise.all(a),n+=e}return i}var D=(o=>(o[o.FAILED=0]="FAILED",o[o.URL=1]="URL",o[o.DATA=2]="DATA",o[o.DONE=3]="DONE",o))(D||{});class Pt{index;node;stage=1;tryTimes=0;lock=!1;rendered=!1;data;contentType;downloadState;timeoutId;matcher;chapterIndex;randomID;failedReason;abortSignal=void 0;constructor(e,t,i,n){this.index=e,this.node=t,this.node.onclick=r=>{r.ctrlKey||r.metaKey?f.emit("add-cherry-pick-range",this.chapterIndex,this.index,!0,r.shiftKey):r.altKey?f.emit("add-cherry-pick-range",this.chapterIndex,this.index,!1,r.shiftKey):f.emit("imf-on-click",this)},this.downloadState={total:100,loaded:0,readyState:0},this.matcher=i,this.chapterIndex=n,this.randomID=n+Math.random().toString(16).slice(2)+this.node.href}create(){const e=this.node.create(),t=document.createElement("div");return t.classList.add("img-node-numtip"),t.innerHTML=`<span>${this.index+1}</span>`,e.firstElementChild.appendChild(t),e}setDownloadState(e){this.downloadState={...this.downloadState,...e},this.node.progress(this.downloadState),f.emit("imf-download-state-change",this)}async start(e){if(!this.lock){this.lock=!0;try{this.node.changeStyle("fetching"),await this.fetchImage(),this.node.changeStyle("fetched"),f.emit("imf-on-finished",e,!0,this),this.failedReason=void 0}catch(t){this.failedReason=t.toString(),this.node.changeStyle("failed",this.failedReason),I("error","IMG-FETCHER ERROR:",t),this.stage=0,f.emit("imf-on-finished",e,!1,this)}finally{this.lock=!1}}}resetStage(){this.node.changeStyle("init"),this.stage=1}async fetchImage(){const e=async()=>{try{switch(this.stage){case 0:case 1:const i=await this.fetchOriginMeta();return this.node.originSrc=i.url,i.title&&(this.node.title=i.title,this.node.imgElement&&(this.node.imgElement.title=i.title)),this.node.href=i.href||this.node.href,this.stage=2,e();case 2:const n=await this.fetchImageData();if([this.data,this.contentType]=n,[this.data,this.contentType]=await this.matcher.processData(this.data,this.contentType,this.node),this.contentType.startsWith("text")){const r=new TextDecoder().decode(this.data);throw I("error",`unexpect content:
`,r),new Error(`expect image data, fetched wrong type: ${this.contentType}, the content is showing up in console(F12 open it).`)}this.node.blobSrc=ze.imgSrcCSP?this.node.originSrc:URL.createObjectURL(new Blob([this.data],{type:this.contentType})),this.node.mimeType=this.contentType,this.node.render(r=>{I("error","render image failed, "+r),this.rendered=!1},()=>f.emit("imf-resize",this)),this.stage=3;case 3:return null}}catch(i){return this.stage=0,i}};this.tryTimes=0;let t;for(;this.tryTimes<3;){if(t=await e(),t===null)return;this.tryTimes++,I("error",`fetch image error, try times: ${this.tryTimes}, error:`,t)}throw t}async fetchOriginMeta(){return await this.matcher.fetchOriginMeta(this.node,this.tryTimes>0||this.stage===0,this.chapterIndex)}async fetchImageData(){const e=await this.fetchBigImage();if(e==null)throw new Error(`fetch image data is empty, image url:${this.node.originSrc}`);return e.arrayBuffer().then(t=>[new Uint8Array(t),e.type])}render(){const e=f.emit("imf-check-picked",this.chapterIndex,this.index)??this.node.picked,t=e!==this.node.picked;if(this.node.picked=e,!this.rendered)this.rendered=!0,this.node.render(i=>{I("error","render image failed, "+i),this.rendered=!1},()=>f.emit("imf-resize",this)),this.node.changeStyle(this.stage===3?"fetched":void 0,this.failedReason);else if(t){let i;switch(this.stage){case 0:i="failed";break;case 1:i="init";break;case 2:i="fetching";break;case 3:i="fetched";break}this.node.changeStyle(i,this.failedReason)}}isRender(){return this.rendered}unrender(){this.rendered&&(this.rendered=!1,this.node.unrender(),this.node.changeStyle("init"))}ratio(){return this.node.ratio()}async fetchBigImage(){if(this.node.originSrc?.startsWith("blob:"))return await fetch(this.node.originSrc).then(t=>t.blob());const e=this;return new Promise(async(t,i)=>{const n=new H,r=()=>{n.addEvent("XHR_TIMEOUT",()=>{this.abort(),i(new Error("timeout"))},u.timeout*1e3)};try{this.abortSignal=je(e.node.originSrc,"blob",{onload:function(a){const s=a.response;try{e.setDownloadState({readyState:a.readyState})}catch(l){I("error","warn: fetch big image data onload setDownloadState error:",l)}e.abortSignal=void 0,t(s)},onerror:function(a){if(e.abortSignal=void 0,a.status===0&&a.error?.includes("URL is not permitted")){const s=a.error.match(/(https?:\/\/.*?)\/.*/)?.[1]??"";i(new Error(A.failFetchReason1.get().replace("{{domain}}",s)))}else i(new Error(`response status:${a.status}, error:${a.error}, response:${a.response}`))},onprogress:function(a){e.setDownloadState({total:a.total,loaded:a.loaded,readyState:a.readyState}),r()},onloadstart:function(){e.setDownloadState(e.downloadState)}},this.matcher.headers()),r()}catch(a){i(a)}})}abort(){this.abortSignal?.(),this.abortSignal=void 0}}class Mt{crc=-1;table=this.makeTable();makeTable(){let e,t,i;const n=[];for(e=0;e<256;e++){for(i=e,t=0;t<8;t++)i=i&1?i>>>1^3988292384:i>>>1;n[e]=i}return n}append(e){let t=this.crc|0;const i=this.table;for(let n=0,r=e.length|0;n<r;n++)t=t>>>8^i[(t^e[n])&255];this.crc=t}get(){return~this.crc}}class Nt{level;nameBuf;comment;header;offset;directory;file;crc;compressedLength;uncompressedLength;volumeNo;constructor(e,t){this.level=0;const i=new TextEncoder;this.nameBuf=i.encode(e.name.trim()),this.comment=i.encode(""),this.header=new le(26),this.offset=0,this.directory=!1,this.file=e,this.crc=new Mt,this.compressedLength=0,this.uncompressedLength=0,this.volumeNo=t}}class le{array;view;constructor(e){const t=new Uint8Array(e);this.array=t,this.view=new DataView(t.buffer)}}class $t{volumeSize=1610612736;accumulatedSize=0;volumes=1;currVolumeNo=-1;files=[];currIndex=-1;offset=0;offsetInVolume=0;curr;date;writer;close=!1;constructor(e){e?.volumeSize&&(this.volumeSize=e.volumeSize),this.date=new Date(Date.now()),this.writer=async()=>{}}setWriter(e){this.writer=e}add(e){const t=e.size();this.accumulatedSize+=t,this.accumulatedSize>this.volumeSize&&(this.volumes++,this.accumulatedSize=t),this.files.push(new Nt(e,this.volumes-1))}async next(){if(this.currIndex++,this.curr=this.files[this.currIndex],this.curr){if(this.curr.volumeNo>this.currVolumeNo)return this.currIndex--,this.offsetInVolume=0,!0;this.curr.offset=this.offsetInVolume,await this.writeHeader(),await this.writeContent(),await this.writeFooter(),this.offset+=this.offsetInVolume-this.curr.offset}else if(!this.close)this.close=!0,await this.closeZip();else return!0;return!1}async writeHeader(){if(!this.curr)return;const e=this.curr,t=new le(30+e.nameBuf.length),i=e.header;e.level!==0&&!e.directory&&i.view.setUint16(4,2048),i.view.setUint32(0,335546376),i.view.setUint16(6,(this.date.getHours()<<6|this.date.getMinutes())<<5|this.date.getSeconds()/2,!0),i.view.setUint16(8,(this.date.getFullYear()-1980<<4|this.date.getMonth()+1)<<5|this.date.getDate(),!0),i.view.setUint16(22,e.nameBuf.length,!0),t.view.setUint32(0,1347093252),t.array.set(i.array,4),t.array.set(e.nameBuf,30),this.offsetInVolume+=t.array.length,await this.writer(t.array)}async writeContent(){const e=this.curr,t=(await e.file.stream()).getReader(),i=this.writer;async function n(){const r=await t.read();if(r.done)return;const a=r.value;return e.crc.append(a),e.uncompressedLength+=a.length,e.compressedLength+=a.length,i(a),await n()}await n()}async writeFooter(){if(!this.curr)return;const e=this.curr,t=new le(16);t.view.setUint32(0,1347094280),e.crc&&(e.header.view.setUint32(10,e.crc.get(),!0),e.header.view.setUint32(14,e.compressedLength,!0),e.header.view.setUint32(18,e.uncompressedLength,!0),t.view.setUint32(4,e.crc.get(),!0),t.view.setUint32(8,e.compressedLength,!0),t.view.setUint32(12,e.uncompressedLength,!0)),await this.writer(t.array),this.offsetInVolume+=e.compressedLength+16,e.compressedLength!==e.file.size()&&I("error","WRAN: read length:",e.compressedLength," origin size:",e.file.size(),", title: ",e.file.name)}async closeZip(){const e=this.files.length;let t=0,i=0;for(i=0;i<e;i++){const a=this.files[i];t+=46+a.nameBuf.length+a.comment.length}const n=new le(t+22);let r=0;for(i=0;i<e;i++){const a=this.files[i];n.view.setUint32(r,1347092738),n.view.setUint16(r+4,5120),n.array.set(a.header.array,r+6),n.view.setUint16(r+32,a.comment.length,!0),n.view.setUint16(r+34,a.volumeNo,!0),n.view.setUint32(r+42,a.offset,!0),n.array.set(a.nameBuf,r+46),n.array.set(a.comment,r+46+a.nameBuf.length),r+=46+a.nameBuf.length+a.comment.length}n.view.setUint32(r,1347093766),n.view.setUint16(r+4,this.currVolumeNo,!0),n.view.setUint16(r+6,this.currVolumeNo,!0),n.view.setUint16(r+8,e,!0),n.view.setUint16(r+10,e,!0),n.view.setUint32(r+12,t,!0),n.view.setUint32(r+16,this.offsetInVolume,!0),await this.writer(n.array)}nextReadableStream(){if(this.currVolumeNo++,this.currVolumeNo>=this.volumes)return;const e=this;return new ReadableStream({start(t){e.setWriter(async i=>t.enqueue(i))},async pull(t){await e.next().then(i=>i&&t.close())}})}}class Ut{canvas;mousemoveState;ctx;queue;rectSize;rectGap;columns;padding;scrollTop;scrollSize;debouncer;onClick;cherryPick;constructor(e,t,i){if(this.queue=t,this.cherryPick=i,!e)throw new Error("canvas not found");this.canvas=e,this.canvas.addEventListener("wheel",n=>this.onwheel(n.deltaY)),this.mousemoveState={x:0,y:0},this.canvas.addEventListener("mousemove",n=>{this.mousemoveState={x:n.offsetX,y:n.offsetY},this.drawDebouce()}),this.canvas.addEventListener("click",n=>{this.mousemoveState={x:n.offsetX,y:n.offsetY};const r=this.computeDrawList()?.find(a=>a.selected)?.index;r!==void 0&&f.emit("downloader-canvas-on-click",r)}),this.ctx=this.canvas.getContext("2d"),this.rectSize=12,this.rectGap=6,this.columns=15,this.padding=7,this.scrollTop=0,this.scrollSize=10,this.debouncer=new H,f.subscribe("imf-download-state-change",()=>this.drawDebouce()),f.subscribe("downloader-canvas-resize",()=>this.resize())}resize(e){e=e||this.canvas.parentElement,this.canvas.width=Math.floor(e.offsetWidth),this.canvas.height=Math.floor(e.offsetHeight),this.columns=Math.ceil((this.canvas.width-this.padding*2-this.rectGap)/(this.rectSize+this.rectGap)),this.draw()}onwheel(e){const[t,i]=this.getWH(),n=this.computeClientHeight();n>i&&(e=e>>1,this.scrollTop+=e,this.scrollTop<0&&(this.scrollTop=0),this.scrollTop+i>n+20&&(this.scrollTop=n-i+20),this.draw())}drawDebouce(){this.debouncer.addEvent("DOWNLOADER-DRAW",()=>this.draw(),20)}computeDrawList(){const e=[],t=this.cherryPick(),[i,n]=this.getWH(),r=this.computeStartX(),a=-this.scrollTop+this.padding;for(let s=0,l=-1;s<this.queue.length;s++){const c=s%this.columns;c==0&&l++;const d=r+(this.rectSize+this.rectGap)*c,h=a+(this.rectSize+this.rectGap)*l;if(!(h+this.rectSize<0)){if(h>n)break;e.push({index:s,x:d,y:h,selected:this.isSelected(d,h),disabled:!t.picked(s)})}}return e}draw(){const[e,t]=this.getWH();this.ctx.clearRect(0,0,e,t);const i=this.computeDrawList();for(const n of i)this.drawSmallRect(n.x,n.y,this.queue[n.index],n.index===this.queue.currIndex,n.selected,n.disabled)}computeClientHeight(){return Math.ceil(this.queue.length/this.columns)*(this.rectSize+this.rectGap)-this.rectGap}scrollTo(e){const t=this.computeClientHeight(),[i,n]=this.getWH();if(t<=n)return;const a=(Math.ceil((e+1)/this.columns)-1)*(this.rectSize+this.rectGap);if(a>n){this.scrollTop=a+this.rectSize-n;const s=t-n+20;this.scrollTop+20<=s&&(this.scrollTop+=20)}}isSelected(e,t){return this.mousemoveState.x-e>=0&&this.mousemoveState.x-e<=this.rectSize&&this.mousemoveState.y-t>=0&&this.mousemoveState.y-t<=this.rectSize}computeStartX(){const[e,t]=this.getWH(),i=(this.rectSize+this.rectGap)*this.columns-this.rectGap;return e-i>>1}drawSmallRect(e,t,i,n,r,a){if(a)this.ctx.fillStyle="rgba(20, 20, 20, 1)";else switch(i.stage){case D.FAILED:this.ctx.fillStyle="rgba(250, 50, 20, 0.9)";break;case D.URL:this.ctx.fillStyle="rgba(200, 200, 200, 0.6)";break;case D.DATA:const s=i.downloadState.loaded/i.downloadState.total;this.ctx.fillStyle=`rgba(${200+Math.ceil(-90*s)}, ${200+Math.ceil(0*s)}, ${200+Math.ceil(-80*s)}, ${.6+Math.ceil((1-.6)*s)})`;break;case D.DONE:this.ctx.fillStyle="rgb(110, 200, 120)";break}this.ctx.fillRect(e,t,this.rectSize,this.rectSize),this.ctx.shadowColor="#d53",r?(this.ctx.strokeStyle="rgb(60, 20, 200)",this.ctx.lineWidth=2):n?(this.ctx.strokeStyle="rgb(255, 60, 20)",this.ctx.lineWidth=2):(this.ctx.strokeStyle="rgb(90, 90, 90)",this.ctx.lineWidth=1),this.ctx.strokeRect(e,t,this.rectSize,this.rectSize)}getWH(){return[this.canvas.width,this.canvas.height]}}const ae=/[\\/:*?"<>|\n\t]/g;class qt{meta;title;downloading;queue;idleLoader;pageFetcher;done=!1;selectedChapters=[];filenames=new Set;panel;canvas;cherryPicks=[new F];constructor(e,t,i,n,r){this.panel=e.downloader,this.panel.initTabs(),this.initEvents(this.panel),this.panel.initCherryPick((a,s)=>{this.cherryPicks[a]===void 0&&(this.cherryPicks[a]=new F);const l=this.cherryPicks[a].add(s);return f.emit("cherry-pick-changed",a,this.cherryPicks[a]),l},(a,s)=>{this.cherryPicks[a]===void 0&&(this.cherryPicks[a]=new F);const l=this.cherryPicks[a].remove(s);return f.emit("cherry-pick-changed",a,this.cherryPicks[a]),l},a=>{this.cherryPicks[a]===void 0&&(this.cherryPicks[a]=new F),this.cherryPicks[a].reset(),f.emit("cherry-pick-changed",a,this.cherryPicks[a])},a=>(this.cherryPicks[a]===void 0&&(this.cherryPicks[a]=new F),this.cherryPicks[a].values)),this.panel.initNotice([{btn:A.resetDownloaded.get(),cb:()=>{confirm(A.resetDownloadedConfirm.get())&&this.queue.forEach(a=>a.stage===D.DONE&&a.resetStage())}},{btn:A.resetFailed.get(),cb:()=>{this.queue.forEach(a=>a.stage===D.FAILED&&a.resetStage()),this.downloading||this.idleLoader.abort(0,100)}}]),this.queue=t,this.queue.cherryPick=()=>this.cherryPicks[this.queue.chapterIndex]||new F,this.idleLoader=i,this.idleLoader.cherryPick=()=>this.cherryPicks[this.queue.chapterIndex]||new F,this.canvas=new Ut(this.panel.canvas,t,()=>this.cherryPicks[this.queue.chapterIndex]||new F),this.pageFetcher=n,this.meta=a=>r.galleryMeta(a),this.title=a=>r.title(a),this.downloading=!1,this.queue.downloading=()=>this.downloading,f.subscribe("ifq-on-finished-report",(a,s)=>{if(s.isFinished()){const l=this.selectedChapters.find(c=>c.index===s.chapterIndex);l&&(l.done=!0,l.resolve(!0)),!this.downloading&&!this.done&&this.panel.noticeableBTN()}}),f.subscribe("imf-check-picked",(a,s)=>this.cherryPicks[a]?.picked(s))}initEvents(e){e.forceBTN.addEventListener("click",()=>this.download(this.pageFetcher.chapters)),e.startBTN.addEventListener("click",()=>{this.downloading?this.abort("downloadStart"):this.start()})}needNumberTitle(e){if(u.filenameOrder==="numbers")return!0;if(u.filenameOrder==="original")return!1;let t;u.filenameOrder==="alphabetically"?t=(n,r)=>n<r:t=(n,r)=>n.localeCompare(r,void 0,{numeric:!0,sensitivity:"base"})<0;let i="";for(const n of e){if(i&&t(n.node.title,i))return!0;i=n.node.title}return!1}check(){this.downloading||(setTimeout(()=>f.emit("downloader-canvas-resize"),110),this.panel.createChapterSelectList(this.pageFetcher.chapters,this.selectedChapters),this.queue.length>0?this.panel.switchTab("status"):this.pageFetcher.chapters.length>1&&this.panel.switchTab("chapters"))}checkSelectedChapters(){this.selectedChapters.length=0;const e=this.panel.selectedChapters();return e.size===0?this.selectedChapters.push({index:0,done:!1,...Xe()}):this.pageFetcher.chapters.forEach((t,i)=>e.has(t.id)&&this.selectedChapters.push({index:i,done:!1,...Xe()})),this.selectedChapters}async start(){if(!this.downloading){this.panel.flushUI("downloading"),this.downloading=!0,this.idleLoader.autoLoad=!0,this.checkSelectedChapters();try{for(const e of this.selectedChapters){if(!this.downloading)return;await this.pageFetcher.restoreChapter(e.index),this.queue.forEach(t=>t.stage===D.FAILED&&t.resetStage()),this.queue.isFinished()?(e.done=!0,e.resolve(!0)):(this.idleLoader.processingIndexList=this.queue.map((t,i)=>!t.lock&&t.stage===D.URL?i:-1).filter(t=>t>=0).splice(0,u.downloadThreads),this.idleLoader.onFailed(()=>e.reject("download failed or canceled")),this.idleLoader.checkProcessingIndex(),this.idleLoader.start()),await e.promise}this.downloading&&await this.download(this.selectedChapters.filter(e=>e.done).map(e=>this.pageFetcher.chapters[e.index]))}catch(e){if(e==="abort")return;this.abort("downloadFailed"),I("error","download failed: ",e)}finally{this.downloading=!1}}}mapToFileLikes(e,t,i){if(!e||e.queue.length===0)return[];let n;if(this.needNumberTitle(e.queue)){const l=e.queue.length.toString().length;u.filenameOrder==="numbers"?n=(c,d)=>`${d+1}`.padStart(l,"0")+"."+c.split(".").pop():n=(c,d)=>`${d+1}`.padStart(l,"0")+"_"+c.replaceAll(ae,"_")}else this.filenames.clear(),n=l=>ve(this.filenames,l.replaceAll(ae,"_"));const a=e.queue.filter((l,c)=>t.picked(c)&&l.stage===D.DONE&&l.data).map((l,c)=>({stream:()=>Promise.resolve(We(l.data)),size:()=>l.data.byteLength,name:i+n(l.node.title,c)})),s=new TextEncoder().encode(JSON.stringify(this.meta(e),null,2));return a.push({stream:()=>Promise.resolve(We(s)),size:()=>s.byteLength,name:i+"meta.json"}),a}async download(e){try{const t=this.title(e).replaceAll(ae,"_"),i=navigator.userAgent.indexOf("Win")!==-1?"\\":"/",n=e.length===1;this.panel.flushUI("packaging");const r=new Set,a=[];for(let c=0;c<e.length;c++){const d=e[c],h=this.cherryPicks[c]||new F;let p=n?"":d.title instanceof Array?d.title.join("_").replaceAll(ae,"_").replaceAll(/\s+/g," ")+i:d.title.replaceAll(ae,"_").replaceAll(/\s+/g," ")+i;p=Gt(p,200),p=ve(r,p);const g=this.mapToFileLikes(d,h,p);a.push(...g)}const s=new $t({volumeSize:1024*1024*(u.archiveVolumeSize||1500)});a.forEach(c=>s.add(c)),await(async()=>{let c;for(;c=s.nextReadableStream();){const d=await new Response(c).blob(),h=s.currVolumeNo===s.volumes-1?"zip":"z"+(s.currVolumeNo+1).toString().padStart(2,"0");gt.saveAs(d,`${t}.${h}`)}})(),this.done=!0}catch(t){let i=t.toString();throw i.includes("autoAllocateChunkSize")&&(i="Create Zip archive prevented by The content security policy of this page. Please refer to the CONF > Help for a solution."),f.emit("notify-message","error",`packaging failed, ${i}`),t}finally{this.abort(this.done?"downloaded":"downloadFailed")}}abort(e){this.downloading=!1,this.panel.abort(e),this.idleLoader.abort(),this.selectedChapters.forEach(t=>t.reject("abort"))}}function Gt(o,e){const t=new TextEncoder,i=s=>t.encode(s).byteLength,n=i(o);if(n<=e)return o;const r=[o.length>>1,(o.length>>1)+1];let a=!0;for(;;){if(n-i(o.slice(...r))<=e)return o.slice(0,r[0])+",,,"+o.slice(r[1]);if(a&&r[0]>3){r[0]-=1,a=!1;continue}if(r[1]<o.length-3){r[1]+=1,a=!0;continue}break}return o.slice(0,e)}function ve(o,e){let t=e;if(o.has(t)){const i=t.split("."),n=i.pop(),r=i.join("."),a=parseInt(r.match(/_(\d+)$/)?.[1]||"");return isNaN(a)?t=`${r}_1.${n}`:t=`${r.replace(/\d+$/,(a+1).toString())}.${n}`,ve(o,t)}else return o.add(t),t}function We(o){return new ReadableStream({pull(e){e.enqueue(o),e.close()}})}function Xe(){let o,e;const t=new Promise((i,n)=>{o=i,e=n});return{resolve:o,reject:e,promise:t}}class F{values=[];positive=!1;sieve=[];reset(){this.values=[],this.positive=!1,this.sieve=[]}add(e){if(this.values.length===0)return this.positive=e.positive,this.values.push(e),this.setSieve(e),this.values;if(this.values.find(l=>l.id===e.id))return null;const i=e.range(),n=new Set,r=new Set,a=[];let s=!1;for(let l=0;l<this.values.length;l++){const c=this.values[l],d=c.range();if(i[0]>=d[0]&&i[1]<=d[1]){e.positive!==this.positive&&(n.add(c.id),d[0]<i[0]&&a.push(new z([d[0],i[0]-1],c.positive)),d[1]>i[1]&&a.push(new z([i[1]+1,d[1]],c.positive)),s=i[0]===i[1]&&i[0]===d[0]&&i[1]===d[1]);break}i[0]<=d[0]&&i[1]>=d[1]?n.add(c.id):i[0]<=d[0]&&i[1]>=d[0]&&i[1]<=d[1]?c.reset([i[1]+1,d[1]]):i[0]>=d[0]&&i[0]<=d[1]&&i[1]>=d[1]&&c.reset([d[0],i[0]-1]),e.positive===this.positive&&(r.has(e.id)||(r.add(e.id),a.push(e)))}if(n.size>0&&(this.values=this.values.filter(l=>!n.has(l.id))),a.length>0&&this.values.push(...a),this.values.length===0){if(this.reset(),s)return this.values;this.positive=e.positive,this.values.push(e)}else this.concat();return this.setSieve(e),this.values}setSieve(e){const t=e.range();for(let i=t[0]-1;i<t[1];i++)this.sieve[i]=e.positive===this.positive}concat(){if(this.values.length<2)return;this.values.sort((n,r)=>n.range()[0]-r.range()[0]);let e=0,t=1;const i=[];for(;e<this.values.length&&t<this.values.length;){const n=this.values[e],r=this.values[t],a=n.range(),s=r.range();if(a[1]+1===s[0])n.reset([a[0],s[1]]),i.push(t),t++;else{do e++;while(i.includes(e));t=e+1}}this.values=this.values.filter((n,r)=>!i.includes(r))}remove(e){const t=this.values.findIndex(r=>r.id===e);if(t===-1)return;const n=this.values.splice(t,1)[0].range();for(let r=n[0]-1;r<n[1];r++)this.sieve[r]=!1;this.values.length===0&&(this.sieve=[],this.positive=!1)}picked(e){return!!(this.positive?this.sieve[e]:!this.sieve[e])}}class z{value;positive;id;constructor(e,t){this.positive=t,this.value=e.sort((i,n)=>i-n),this.id=z.rangeToString(this.value,this.positive)}toString(){return z.rangeToString(this.value,this.positive)}reset(e){this.value=e.sort((t,i)=>t-i),this.id=z.rangeToString(this.value,this.positive)}range(){return this.value}static rangeToString(e,t){let i="";return e[0]===e[1]?i=e[0].toString():i=e.map(n=>n.toString()).join("-"),t?i:"!"+i}static from(e){if(e=e?.trim(),!e)return null;e=e.replace(/!+/,"!");const t=e.startsWith("!");if(/^!?\d+$/.test(e)){const i=parseInt(e.replace("!",""));return new z([i,i],!t)}if(/^!?\d+-\d+$/.test(e)){const i=e.replace("!","").split("-").map(n=>parseInt(n));return new z([i[0],i[1]],!t)}return null}}class ye extends Array{executableQueue;currIndex;finishedIndex=new Set;debouncer;downloading;dataSize=0;chapterIndex=0;cherryPick;clear(){this.length=0,this.executableQueue=[],this.currIndex=0,this.finishedIndex.clear()}restore(e,t){this.clear(),this.chapterIndex=e,t.forEach((i,n)=>i.stage===D.DONE&&this.finishedIndex.add(n)),this.push(...t)}static newQueue(){const e=new ye;return f.subscribe("imf-on-finished",(t,i,n)=>e.chapterIndex===n.chapterIndex&&e.finishedReport(t,i,n)),f.subscribe("ifq-do",(t,i,n)=>{i.chapterIndex===e.chapterIndex&&e.do(t,n)}),f.subscribe("pf-change-chapter",()=>e.forEach(t=>t.unrender())),f.subscribe("add-cherry-pick-range",(t,i,n,r)=>{t===e.chapterIndex&&(n||e[i]?.stage===D.DATA&&(e[i].abort(),e[i].stage=D.URL))}),e}constructor(){super(),this.executableQueue=[],this.currIndex=0,this.debouncer=new H}isFinished(){const e=this.cherryPick?.(this.chapterIndex);if(e&&e.values.length>0){for(let t=0;t<this.length;t++)if(e.picked(t)&&!this.finishedIndex.has(t))return!1;return!0}else return this.finishedIndex.size===this.length}do(e,t){t=t||"next",this.currIndex=this.fixIndex(e),f.emit("ifq-on-do",this.currIndex,this,this.downloading?.()||!1),!this.downloading?.()&&this.pushInExecutableQueue(t)&&this.debouncer.addEvent("IFQ-EXECUTABLE",()=>{console.log("IFQ-EXECUTABLE: ",this.executableQueue),Promise.all(this.executableQueue.splice(0,u.paginationIMGCount).map(i=>this[i].start(i))).then(()=>{const i=this.cherryPick?.(this.chapterIndex);this.executableQueue.filter(n=>!i||i.picked(n)).forEach(n=>this[n].start(n))})},300)}finishedReport(e,t,i){this.length!==0&&(!t||i.stage!==D.DONE||(this.finishedIndex.add(e),this.dataSize<1e9&&(this.dataSize+=i.data?.byteLength||0),f.emit("ifq-on-finished-report",e,this)))}fixIndex(e){return e<0?0:e>this.length-1?this.length-1:e}pushInExecutableQueue(e){this.executableQueue=[];for(let t=0,i=this.currIndex;this.checkOutbounds(i,e,t);e==="next"?++i:--i)this[i].stage!==D.DONE&&(this.executableQueue.push(i),t++);return this.executableQueue.length>0}checkOutbounds(e,t,i){let n=!1;return t==="next"&&(n=e<this.length),t==="prev"&&(n=e>-1),n?i<u.threads+u.paginationIMGCount-1:!1}findImgIndex(e){for(let t=0;t<this.length;t++)if(this[t].node.equal(e))return t;return 0}}class Dt{queue;processingIndexList;restartId;maxWaitMS;minWaitMS;onFailedCallback;autoLoad=!1;debouncer;cherryPick;constructor(e){this.queue=e,this.processingIndexList=[0],this.maxWaitMS=1e3,this.minWaitMS=300,this.autoLoad=u.autoLoad,this.debouncer=new H,f.subscribe("ifq-on-do",(t,i,n)=>!n&&this.abort(t)),f.subscribe("imf-on-finished",t=>{this.processingIndexList.includes(t)&&this.wait().then(()=>{this.checkProcessingIndex(),this.start()})}),f.subscribe("pf-change-chapter",t=>!this.queue.downloading?.()&&this.abort(t>0?0:void 0)),window.addEventListener("focus",()=>{u.autoLoadInBackground||this.debouncer.addEvent("Idle-Load-on-focus",()=>{console.log("[ IdleLoader ] window focus, document.hidden:",document.hidden),!document.hidden&&this.abort(0,10)},100)}),f.subscribe("pf-on-appended",(t,i,n,r)=>{r||this.processingIndexList.length>0||this.abort(this.queue.currIndex,100)})}onFailed(e){this.onFailedCallback=e}start(){if(this.autoLoad&&!(document.hidden&&!u.autoLoadInBackground)&&this.processingIndexList.length!==0&&this.queue.length!==0){I("info","Idle Loader start at:"+this.processingIndexList.toString());for(const e of this.processingIndexList)this.queue[e].start(e)}}checkProcessingIndex(){if(this.queue.length===0)return;const e=this.cherryPick?.()||new F,t=new Set;let i=!1;for(let n=0;n<this.processingIndexList.length;n++){const r=this.processingIndexList[n],a=this.queue[r];if(a.stage===D.FAILED&&(i=!0),!(a.lock||a.stage===D.URL)){for(let s=Math.min(r+1,this.queue.length-1),l=this.queue.length;s<l;s++){if(e.picked(s)){const c=this.queue[s];if(!c.lock&&c.stage===D.URL&&!t.has(s)){t.add(s),this.processingIndexList[n]=s;break}c.stage===D.FAILED&&(i=!0)}s>=this.queue.length-1&&(l=r,s=0)}if(t.size===0){this.processingIndexList.length=0,i&&this.onFailedCallback&&(this.onFailedCallback(),this.onFailedCallback=void 0);return}}}}async wait(){const{maxWaitMS:e,minWaitMS:t}=this;return new Promise(function(i){const n=Math.floor(Math.random()*e+t);window.setTimeout(()=>i(!0),n)})}abort(e,t){this.processingIndexList=[],this.debouncer.addEvent("IDLE-LOAD-ABORT",()=>{this.autoLoad&&e!==void 0&&(this.queue.downloading?.()||(this.processingIndexList=[e],this.checkProcessingIndex(),this.start()))},t||u.restartIdleLoader)}}class Vt{chapters=[];chapterIndex=0;queue;matcher;beforeInit;afterInit;appendPageLock=!1;abortb=!1;constructor(e,t){this.queue=e,this.matcher=t;const i=new H;f.subscribe("ifq-on-finished-report",n=>i.addEvent("APPEND-NEXT-PAGES",()=>this.appendPages(n),5)),f.subscribe("imf-on-finished",(n,r,a)=>{n===0&&r&&(this.chapters[a.chapterIndex].thumbimg=a.node.blobSrc)}),f.subscribe("pf-try-extend",()=>i.addEvent("APPEND-NEXT-PAGES",()=>!this.queue.downloading?.()&&this.appendNextPage(),5)),f.subscribe("pf-retry-extend",()=>!this.queue.downloading?.()&&this.appendNextPage(!0)),f.subscribe("pf-init",n=>this.init().then(n)),f.subscribe("pf-append-chapters",n=>this.appendNewChapters(n).then(()=>this.chapters)),f.subscribe("pf-step-chapters",n=>{if(n==="prev"){const r=this.chapterIndex-1;if(r<0)return;this.chapterIndex=r,this.changeToChapter(r),f.emit("notify-message","info","switch to chapter: "+this.chapters[r].title,2e3)}else if(n==="next"){const r=this.chapterIndex+1;if(r>=this.chapters.length)return;this.chapterIndex=r,this.changeToChapter(r),f.emit("notify-message","info","switch to chapter: "+this.chapters[r].title,2e3)}})}appendToView(e,t,i,n){f.emit("pf-on-appended",e,t,i,n)}abort(){this.abortb=!0}async appendNewChapters(e){try{const t=await this.matcher.appendNewChapters(e,this.chapters);t&&t.length>0&&(t.forEach(i=>{i.sourceIter=this.matcher.fetchPagesSource(i),i.onclick=n=>this.changeToChapter(n)}),this.chapters.push(...t),f.emit("pf-update-chapters",this.chapters,!0))}catch(t){f.emit("notify-message","error",`${t}`)}}async init(){this.beforeInit?.(),this.chapters=await this.matcher.fetchChapters().catch(e=>f.emit("notify-message","error",e)||[]),this.afterInit?.(),this.chapters.forEach(e=>{e.sourceIter=this.matcher.fetchPagesSource(e),e.onclick=t=>this.changeToChapter(t)}),f.emit("pf-update-chapters",this.chapters),this.chapters.length===1&&this.changeToChapter(0)}changeToChapter(e){f.emit("pf-change-chapter",e,this.chapters[e]),this.chapters[e].queue.length>0&&this.appendToView(this.chapters[e].queue.length,this.chapters[e].queue,e,this.chapters[e].done),this.queue.downloading?.()||(this.beforeInit?.(),this.restoreChapter(e).then(this.afterInit).catch(this.onFailed))}async restoreChapter(e){this.chapterIndex=e;const t=this.chapters[this.chapterIndex];if(this.queue.restore(e,t.queue),!t.sourceIter){I("error","chapter sourceIter is not set!");return}if(t.queue.length===0){const i=await t.sourceIter.next();if(!i.done){if(i.value.error)throw i.value.error;await this.appendImages(i.value.value)}this.appendPages(this.queue.length)}}async appendPages(e){for(;!(e+60<this.queue.length||!await this.appendNextPage()););}async appendNextPage(e){if(this.appendPageLock)return!1;try{this.appendPageLock=!0;const t=this.chapters[this.chapterIndex];if(e&&(t.done=!1),t.done||this.abortb)return!1;const i=await t.sourceIter.next();if(i.done)return t.done=!0,this.appendToView(this.queue.length,[],this.chapterIndex,!0),!1;if(i.value.error)throw t.done=!0,i.value.error;return await this.appendImages(i.value.value)}catch(t){return I("error","PageFetcher:appendNextPage error: ",t),this.onFailed?.(t),!1}finally{this.appendPageLock=!1}}async appendImages(e){try{const t=await this.obtainImageNodeList(e);if(this.abortb||t.length===0)return!1;const i=this.queue.length,n=t.map((r,a)=>new Pt(a+i,r,this.matcher,this.chapterIndex));return this.queue.push(...n),this.chapters[this.chapterIndex].queue.push(...n),this.appendToView(this.queue.length,n,this.chapterIndex),!0}catch(t){return I("error","page fetcher append images error: ",t),this.onFailed?.(t),!1}}async obtainImageNodeList(e){let t=0,i;for(;t<3;)try{return await this.matcher.parseImgNodes(e,this.chapters[this.chapterIndex].id)}catch(n){I("error","warn: parse image nodes failed, retrying: ",n),t++,i=n}throw I("error","warn: parse image nodes failed: reached max try times!"),i}async fetchDocument(e){return await window.fetch(e).then(t=>t.text())}onFailed(e){f.emit("notify-message","error",e.toString())}}class U{url;title;originTitle;downloader;tags;constructor(e,t){this.url=e,this.title=t,this.tags={},this.downloader="https://github.com/MapoMagpie/eh-view-enhance"}}const Bt=new mt({features:["wasm"]}),Ot={filter:"box"};async function zt(o,e){return Bt.resize(o,e,Ot).then()}const ee="data:image/gif;base64,R0lGODlhAQABAIAAAMLCwgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==",Ce=document.createElement("div");Ce.classList.add("img-node"),Ce.innerHTML=`
<a>
  <img decoding="async" loading="eager" title="untitle.jpg" src="" style="display: none;" />
  <canvas id="sample-canvas" width="100" height="100"></canvas>
</a>`;const Ie=document.createElement("div");Ie.classList.add("overlay-tip"),Ie.innerHTML="<span>GIF</span>";class L{root;thumbnailSrc;href;title;onclick;imgElement;canvasElement;canvasCtx;delaySRC;originSrc;blobSrc;mimeType;downloadBar;picked=!0;debouncer=new H;rect;tags;constructor(e,t,i,n,r,a){this.thumbnailSrc=e,this.href=t,this.title=i,this.delaySRC=n,this.originSrc=r,this.rect=a,this.tags=new Set}setTags(...e){e.forEach(this.tags.add)}hasTag(e){return this.tags.has(e)}create(){this.root=Ce.cloneNode(!0);const e=this.root.firstElementChild;e.href=this.href,e.target="_blank",this.imgElement=e.firstElementChild,this.canvasElement=e.lastElementChild,this.imgElement.setAttribute("title",this.title),this.canvasElement.id="canvas-"+this.title.replaceAll(/[^\w]/g,"_");const t=this.ratio();return this.root.style.aspectRatio=t.toString(),this.root.setAttribute("data-ratio",t.toString()),this.canvasElement.width=512,this.canvasElement.height=Math.floor(512/t),this.canvasCtx=this.canvasElement.getContext("2d"),this.canvasCtx.fillStyle="#aaa",this.canvasCtx.fillRect(0,0,this.canvasElement.width,this.canvasElement.height),this.onclick&&e.addEventListener("click",i=>{i.preventDefault(),this.onclick(i)}),this.root}resize(e,t){if(!this.root||!this.imgElement||!this.canvasElement)return e("undefined elements");if(!this.imgElement.src||this.imgElement.src===ee)return e("empty or default src");if(this.root.offsetWidth<=1)return e("element too small");if(this.imgElement.src===this.imgElement.getAttribute("data-rendered"))return;this.imgElement.onload=null,this.imgElement.onerror=null;const i=this.ratio();this.rect={w:this.imgElement.naturalWidth,h:this.imgElement.naturalHeight};const n=this.ratio(),r=this.root.parentElement?.classList.contains("fvg-sub-container");Math.abs(n-i)>.07&&(this.root.style.aspectRatio=n.toString(),this.root.setAttribute("data-ratio",n.toString()),r?(this.canvasElement.height=this.root.offsetHeight,this.canvasElement.width=Math.floor(this.root.offsetHeight/n)):(this.canvasElement.width=this.root.offsetWidth,this.canvasElement.height=Math.floor(this.root.offsetWidth*n)),t());const a=s=>{this.imgElement.src="",this.imgElement.setAttribute("data-rendered",s)};this.imgElement.src===this.thumbnailSrc||n<.1?(this.canvasCtx?.drawImage(this.imgElement,0,0,this.canvasElement.width,this.canvasElement.height),a(this.imgElement.src)):zt(this.imgElement,this.canvasElement).then(()=>window.setTimeout(()=>a(this.imgElement.src),100)).catch(()=>a(this.canvasCtx?.drawImage(this.imgElement,0,0,this.canvasElement.width,this.canvasElement.height)||""))}ratio(){return this.rect?Math.floor(this.rect.w/this.rect.h*1e3)/1e3:1}render(e,t){this.debouncer.addEvent("IMG-RENDER",()=>{if(!this.imgElement)return e("element undefined");let i=!u.hdThumbnails||!this.blobSrc;if(this.mimeType==="image/gif"||this.mimeType?.startsWith("video")){const n=Ie.cloneNode(!0);n.firstChild.textContent=this.mimeType.split("/")[1].toUpperCase(),this.root?.appendChild(n),i=!0}if(this.imgElement.onload=()=>this.resize(e,t),this.imgElement.onerror=()=>e("img load error"),i){const n=this.delaySRC;this.delaySRC=void 0,n?n.then(r=>(this.thumbnailSrc=r)&&this.render(e,t)).catch(e):this.imgElement.src=this.thumbnailSrc||this.blobSrc||ee}else this.imgElement.src=this.blobSrc||this.thumbnailSrc||ee},30)}unrender(){this.imgElement&&(this.imgElement.src="")}progress(e){if(this.root){if(e.readyState===4){this.downloadBar&&this.downloadBar.parentNode&&this.downloadBar.parentNode.removeChild(this.downloadBar);return}if(!this.downloadBar){const t=document.createElement("div");t.classList.add("download-bar"),t.innerHTML='<div style="width: 0%"></div>',this.downloadBar=t,this.root.firstElementChild.appendChild(this.downloadBar)}this.downloadBar&&(this.downloadBar.firstElementChild.style.width=e.loaded/e.total*100+"%")}}changeStyle(e,t){if(!this.root)return;const i=()=>this.root.classList.forEach(n=>["img-excluded","img-fetching","img-fetched","img-fetch-failed"].includes(n)&&this.root?.classList.remove(n));if(!this.picked)i(),this.root.classList.add("img-excluded");else switch(e){case"fetching":i(),this.root.classList.add("img-fetching");break;case"fetched":i(),this.root.classList.add("img-fetched");break;case"failed":i(),this.root.classList.add("img-fetch-failed");break;case"init":i();break}if(this.root.querySelector(".img-node-error-hint")?.remove(),t){const n=document.createElement("div");n.classList.add("img-node-error-hint"),n.innerHTML=`<span>${t}</span><br><span style="color: white;">You can click here retry again,<br>Or press mouse middle button to open origin image url</span>`,this.root.firstElementChild.appendChild(n)}}equal(e){return e===this.root||e===this.root?.firstElementChild||e===this.canvasElement||e===this.imgElement}}class _{value;error;static ok(e){return{value:e}}static err(e){return{error:e}}}class M{async fetchChapters(){return[{id:0,title:"Default",source:window.location.href,queue:[]}]}title(e){const t=this.galleryMeta(e[0]);return t.originTitle||t.title||"unknown"}galleryMeta(e){return new U(window.location.href,document.title||"unknown")}workURLs(){return[this.workURL()]}async processData(e,t,i){return[e,t]}headers(){return{}}appendNewChapters(e,t){throw new Error("this site does not support add new chapters yet")}}function Ft(o){return md5(o)}function Ht(o,e){o=window.atob(o),e=window.atob(e);let t=Ft(o+e).slice(-1).charCodeAt(0);return parseInt(o)>=268850&&parseInt(o)<=421925?t%=10:parseInt(o)>=421926&&(t%=8),t<10?2+2*t:10}function jt(o,e,t,i){const n=e.width,r=e.height,a=Ht(window.btoa(t),window.btoa(i)),s=parseInt((r%a).toString()),l=n;for(let c=0;c<a;c++){let d=Math.floor(r/a),h=d*c;const p=r-d*(c+1)-s;c==0?d+=s:h+=s,o.drawImage(e,0,p,l,d,0,h,l,d)}}class Zt extends M{name(){return"\u7981\u6F2B"}meta;async fetchChapters(){const e=[],t=document.querySelector(".thumb-overlay > img"),i=Array.from(document.querySelectorAll(".visible-lg .episode > ul > a"));if(i.length>0)i.forEach((n,r)=>{const a=Array.from(n.querySelector("li")?.childNodes||[]).map(l=>l.textContent?.trim()).filter(Boolean).map(l=>l),s=new URL(n.href);s.searchParams.set("read_mode","read-by-page"),e.push({id:r,title:a,source:s.href,queue:[],thumbimg:t?.src})});else{const n=document.querySelector(".visible-lg .read-block")?.firstElementChild;if(n===void 0)throw new Error("No page found");let r="";if(n instanceof HTMLAnchorElement?r=n.href:r=n.getAttribute("href")||"",!r||r.startsWith("javascript"))throw new Error("\u672A\u80FD\u627E\u5230\u9605\u8BFB\u6309\u94AE\uFF01");if(r.startsWith("#coinbuycomic"))throw new Error("\u6B64\u6F2B\u753B\u9700\u8981\u786C\u5E01\u89E3\u9501\uFF01\u8BF7\u70B9\u51FB\u5F00\u59CB\u9605\u8BFB\u6309\u94AE\u8FDB\u884C\u89E3\u9501\u3002");const a=new URL(r);a.searchParams.set("read_mode","read-by-page"),e.push({id:0,title:"Default",source:a.href,queue:[]})}return e}async*fetchPagesSource(e){yield _.ok(e.source)}async parseImgNodes(e){const t=[],i=await window.fetch(e).then(a=>a.text()),n=new DOMParser().parseFromString(i,"text/html"),r=Array.from(n.querySelectorAll(".owl-carousel-page > .center > img"));for(const a of r){const s=a.getAttribute("data-src");if(!s){I("error","warn: cannot find img src",a);continue}const l=s.split("/").pop();t.push(new L("",s,l,void 0,s))}return t}async processData(e,t,i){const n=/(\d+)\/(\d+)\.(\w+)/,r=i.originSrc.match(n),a=r[1];if(Number(a)<220980)return[e,t];const l=r[2];if(r[3]==="gif")return[e,t];const d=await createImageBitmap(new Blob([e],{type:t})),h=document.createElement("canvas");h.width=d.width,h.height=d.height;const p=h.getContext("2d");return jt(p,d,a,l),new Promise(g=>h.toBlob(m=>m?.arrayBuffer().then(b=>g([new Uint8Array(b),m.type])).finally(()=>h.remove()),t))}workURL(){return/(18|jm)comic.*?\/album\/\d+/}galleryMeta(){if(this.meta)return this.meta;const e=document.querySelector(".panel-heading h2")?.textContent||document.title||"UNTITLE";this.meta=new U(window.location.href,e),this.meta.originTitle=e;const t=document.querySelectorAll("div.tag-block > span"),i={};return t.forEach(n=>{const r=n.getAttribute("data-type")?.trim();if(r){const a=Array.from(n.querySelectorAll("a")).map(s=>s.textContent).filter(Boolean);a.length>0&&(i[r]=a)}}),this.meta.tags=i,this.meta}async fetchOriginMeta(e,t){let i=e.originSrc;if(t){const n=i.match(/\/\/cdn-msp(\d)?\./);let r=1;n!==null&&n.length>0&&(r=parseInt(n[1]??"1"),isNaN(r)&&(r=1),r++,r=r%3,r=r===0?r=3:r),i=i.replace(/\/\/cdn-msp(\d)?\./,`//cdn-msp${r===1?"":r}.`)}return{url:i}}}class Wt extends M{originImages;index=0;meta;name(){return"Akuma.moe"}title(){return this.galleryMeta().title}galleryMeta(){return this.meta||(this.meta=this.initGalleryMeta(document)),this.meta}initGalleryMeta(e){const t=e.querySelector("header.entry-header > h1")?.textContent??e.title,i=new U(window.location.href,t);return i.originTitle=e.querySelector("header.entry-header > span")?.textContent||void 0,i.tags=Array.from(e.querySelectorAll("ul.info-list > li.meta-data")).reduce((n,r)=>{const a=r.querySelector("span.data")?.textContent?.replace(":","").toLowerCase().trim();return a&&(n[a]=Array.from(r.querySelectorAll("span.value")).map(s=>s.textContent?.trim()).filter(Boolean)),n},{}),i}async*fetchPagesSource(){const e=document.querySelector("meta[name='csrf-token'][content]")?.content;if(!e)throw new Error("cannot get csrf token form this page");this.originImages=await window.fetch(window.location.href,{headers:{"X-CSRF-TOKEN":e,"X-Requested-With":"XMLHttpRequest","Sec-Fetch-Dest":"empty"},method:"POST"}).then(r=>r.json());const t=Array.from(document.querySelectorAll("body > script")).find(r=>r.textContent?.trimStart().startsWith("var ajx"))?.textContent?.match(/pag = (\{.*?\}),/s)?.[1];if(!t)throw new Error("cannot get page info");const i=JSON.parse(t.replaceAll(/(\w+) :/g,'"$1":'));let n=i.idx;for(yield _.ok(document);n*i.stp<i.cnt;){const r=await window.fetch(i.act,{headers:{"X-CSRF-TOKEN":e,"X-Requested-With":"XMLHttpRequest","Sec-Fetch-Dest":"empty","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},method:"POST",body:`index=${n}`});r.ok||(yield _.err(new Error(`fetch thumbnails failed, status: ${r.statusText}`))),n++,yield _.ok(await r.text().then(a=>new DOMParser().parseFromString(a,"text/html")))}}async parseImgNodes(e){const t=Array.from(e.querySelectorAll("li > a.page-item"));if(t.length===0)throw new Error("cannot find thumbnails");const i=[],n=this.originImages.length.toString().length;for(const r of t){const a=this.originImages[this.index],s=r.href,l=r.firstElementChild.src,c=a.split(".").pop()??"jpg",d=l.slice(0,l.indexOf("tbn"))+a,h=(this.index+1).toString().padStart(n,"0");i.push(new L(l,s,`${h}.${c}`,void 0,d)),this.index++}return i}async fetchOriginMeta(e){return{url:e.originSrc}}workURL(){return/akuma.moe\/g\/\w+\/?$/}}class Xt extends M{name(){return"Arcalive"}async*fetchPagesSource(){yield _.ok(document)}async parseImgNodes(e){const n=Array.from(e.querySelectorAll(".article-content img:not(.arca-emoticon):not(.twemoji), .article-content video:not(.arca-emoticon)")),r=[],a=n.length.toString().length;return n.forEach((s,l)=>{if(s.tagName.toLowerCase()==="img"){const c=s;if(c.src&&c.style.width!=="0px"){const d=c.src,h=new URL(d),p=h.pathname.split(".").pop();h.searchParams.set("type","orig");const g=(l+1).toString().padStart(a,"0")+"."+p;r.push(new L(d,h.href,g,void 0,h.href))}}else if(s.tagName.toLowerCase()==="video"){const c=s;if(c.src){const d=c.src,h=new URL(d),p=h.pathname.split(".").pop();h.searchParams.set("type","orig");const g=(l+1).toString().padStart(a,"0")+"."+p,m=c.poster||"";r.push(new L(m,h.href,g,void 0,h.href))}}}),r}async fetchOriginMeta(e){return{url:e.href}}workURL(){return/arca.live\/b\/\w*\/\d+/}}class Kt extends M{pageData=new Map;info={username:"",projects:0,assets:0};tags={};name(){return"Art Station"}galleryMeta(){const e=new U(window.location.href,`artstaion-${this.info.username}-w${this.info.projects}-p${this.info.assets}`);return e.tags=this.tags,e}async*fetchPagesSource(){const{id:e,username:t}=await this.fetchArtistInfo();this.info.username=t;let i=0;for(;;){i++;try{const n=await this.fetchProjects(t,e.toString(),i);if(!n||n.length===0)break;yield _.ok(n)}catch(n){i--,yield _.err(n)}}}async parseImgNodes(e){const t=e.map(r=>`https://www.artstation.com/projects/${r.hash_id}.json`),i=await we(t,10,"json"),n=[];for(const r of i){if(r instanceof Error){I("error",r.message),f.emit("notify-message","error",r.message,8e3);continue}this.info.projects++,this.tags[r.slug]=r.tags;for(let a=0;a<r.assets.length;a++){const s=r.assets[a];if(s.asset_type==="cover")continue;const l=s.image_url.replace("/large/","/small/"),c=s.image_url.match(/\.(\w+)\?\d+$/)?.[1]??"jpg",d=`${r.slug}-${a+1}.${c}`;let h=s.image_url;if(s.has_embedded_player&&s.player_embedded){if(s.player_embedded.includes("youtube"))continue;h=s.player_embedded}this.info.assets++,n.push(new L(l,r.permalink,d,void 0,h,{w:s.width,h:s.height}))}}return n}async fetchOriginMeta(e){if(e.originSrc?.startsWith("<iframe")){const t=e.originSrc.match(/src=['"](.*?)['"]\s/)?.[1];if(!t)throw new Error("cannot match video clip url");const n=(await window.fetch(t).then(r=>r.text()).then(r=>new DOMParser().parseFromString(r,"text/html"))).querySelector("video > source");if(!n)throw new Error("cannot find video element");return{url:n.src}}return{url:e.originSrc}}async processData(e,t){return t.startsWith("binary")||t.startsWith("text")?[e,"video/mp4"]:[e,t]}workURL(){return/artstation.com\/[-\w]+(\/albums\/\d+)?$/}async fetchArtistInfo(){const e=window.location.pathname.slice(1).split("/").shift();if(!e)throw new Error("cannot match artist's username");return await window.fetch(`https://www.artstation.com/users/${e}/quick.json`).then(i=>i.json())}async fetchProjects(e,t,i){const n=`https://www.artstation.com/users/${e}/projects.json?user_id=${t}&page=${i}`;return(await window.fetch(n).then(a=>a.json())).data}}const Yt=/var C_DATA='(.*?)'/;function ce(o,e){const t=CryptoJS;if(!t)throw new Error("cryptoJS undefined");var i=t.enc.Utf8.parse(o),n=t.AES.decrypt(e,i,{mode:t.mode.ECB,padding:t.pad.Pkcs7});return t.enc.Utf8.stringify(n).toString()}function xe(o){const e=Uint8Array.from(atob(o),i=>i.charCodeAt(0));return new TextDecoder().decode(e)}function Jt(){return new Promise((o,e)=>{const t="https://www.colamanga.com/js/custom.js",i=document.createElement("script");i.addEventListener("load",async()=>{try{const n=await window.fetch(t).then(a=>a.text()),r=oi(n);o(r)}catch(n){e(n)}}),i.src=t,i.type="text/javascript",document.querySelector("head").append(i)})}function Qt(){return new Promise((o,e)=>{const t="https://www.colamanga.com/js/manga.read.js",i=document.createElement("script");i.addEventListener("load",async()=>{try{const n=await window.fetch(t).then(c=>c.text());let r;const a=n.matchAll(/if\(_0x\w+==(0x\w+)\)return (_0x\w+)\((0x\w+)\);/gm),s={};let l=!0;for(const c of a){const d=c[1],h=c[2],p=c[3];if(!r){const m=Ae(n,h)?.[0]?.[0]??h;console.log("colamanga, the function name: ",m),r=new Function("p",`return ${m}(p)`)}const g=r(p);s[parseInt(d)]=g,l=!1}if(l)throw new Error("cannot init key map from "+t);o(s)}catch(n){e(n)}}),i.src=t,i.type="text/javascript",document.querySelector("head").append(i)})}class ei extends M{infoMap={};keymap;keys=["dDeIieDgQpwVQZsJ","54bilXmmMoYBqBcI","KcmiZ8owmiBoPRMf","4uOJvtnq5YYIKZWA","lVfo0i0o4g3V78Rt","i8XLTfT8Mvu1Fcv2"];name(){return"colamanga"}async fetchChapters(){this.keys=await Jt(),this.keymap=await Qt();const e=document.querySelector("dt.fed-part-rows > a")?.getAttribute("data-original")||void 0;return Array.from(document.querySelectorAll(".all_data_list .fed-part-rows > li > a")).map((i,n)=>({id:n,title:i.title,source:i.href,queue:[],thumbimg:e}))}async*fetchPagesSource(e){yield _.ok(e.source)}async parseImgNodes(e,t){const n=(await window.fetch(e).then(h=>h.text())).match(Yt)?.[1];if(!n)throw new Error("cannot find C_DATA from page: "+e);let r;for(const h of this.keys)try{r=ce(h,xe(n));break}catch(p){I("error",p.toString())}if(!r)throw new Error("colamanga decrypt C_DATA failed");r=r.replace("};","},"),r=r.replaceAll("info=","info:"),r="{"+r+"}",r=r.replaceAll(/(\w+):/g,'"$1":');const a=JSON.parse(r),[s,l]=ri(a.mh_info.enc_code1,a.mh_info.enc_code2,a.mh_info.mhid,this.keys);if(s===void 0||l===void 0)throw new Error("colamanga decrypt mh_info failed");const c=[],d=window.location.origin+a.mh_info.webPath+a.mh_info.pageurl;this.infoMap[d]=a;for(let h=a.mh_info.startimg;h<=parseInt(s);h++){const[p,g]=ai(h,l,a);c.push(new L("",d,p,void 0,g))}return c}async fetchOriginMeta(e){return{url:e.originSrc}}async processData(e,t,i){const n=this.infoMap[i.href];if(!n)throw new Error("cannot found info from "+i.href);return n.image_info.imgKey?[ni(e,n.image_info.keyType,n.image_info.imgKey,this.keymap,this.keys),t]:[e,t]}workURL(){return/colamanga.com\/manga-\w*\/?$/}headers(){return{Referer:window.location.href,Origin:window.location.origin}}}function ti(o){let e=[],t=0,i=o.length;for(;t<i;)e.push(o[t++]<<24|o[t++]<<16|o[t++]<<8|o[t++]);return{sigBytes:e.length*4,words:e}}function ii(o){const e=o.words.length,t=new Uint8Array(e<<2);let i=0,n;for(let r=0;r<e;r++)n=o.words[r],t[i++]=n>>24,t[i++]=n>>16&255,t[i++]=n>>8&255,t[i++]=n&255;return t}function ni(o,e,t,i,n){let r;if(e!==""&&e!=="0")r=i[parseInt(e)];else for(const p of n)try{r=ce(p,t);break}catch(g){I("error",g.toString())}const s={ciphertext:ti(o)},l=CryptoJS,c=l.enc.Utf8.parse(r),d=l.AES.decrypt(s,c,{iv:l.enc.Utf8.parse("0000000000000000"),mode:l.mode.CBC,padding:l.pad.Pkcs7});return ii(d)}function ri(o,e,t,i){let n;for(const a of i)try{if(n=ce(a,xe(o)),n==""||isNaN(parseInt(n)))throw new Error("colamanga failed decrypt image count");break}catch(s){I("error",s.toString())}let r;for(const a of i)try{if(r=ce(a,xe(e)),r==""||!r.startsWith(t+"/"))throw new Error("colamanga failed decrypt image path");break}catch(s){I("error",s.toString())}return[n,r]}function ai(o,e,t){const i=(t.mh_info.startimg+o-1).toString().padStart(4,"0");let n=i+".jpg";t.image_info.imgKey!=null&&t.image_info.imgKey!=""&&(n=i+".enc.webp");const r=window.location.host.replace("www.",""),a="https://img"+t.mh_info.use_server+"."+r+"/comic/"+encodeURI(e)+n;return[n,a]}function oi(o){const e=/window(\[\w+\(0x[^)]+\)\]){2}\(((\w+)(\(0x[^)]+\))?),/gm,t=o.matchAll(e),i=[];for(const n of t){const r=n[3],a=n[4];if(r)for(const[s,l]of Ae(o,r,a)){if(s===null||l===null)continue;const c=new Function("return "+s+l)();i.includes(c)||i.push(c)}}return i}function Ae(o,e,t){const i=new RegExp(e+"=((\\w+)(\\([^)]+\\))?)[,; ]","gm"),n=o.matchAll(i),r=[];let a=!0;for(const s of n){a=!1;const l=s[2],c=s[3];c&&(t=c),l&&r.push(...Ae(o,l,t))}return a&&o.includes("function "+e)&&r.push([e,t??null]),r}class de extends M{tags={};blacklistTags=[];count=0;name(){return this.site()}async*fetchPagesSource(){let e=document;this.blacklistTags=this.getBlacklist(e),yield _.ok(e);let t=0;for(;;){const i=this.nextPage(e);if(!i)break;try{e=await window.fetch(i).then(n=>n.text()).then(n=>new DOMParser().parseFromString(n,"text/html"))}catch(n){t++,t>3&&(yield _.err(new Error(`fetch next page failed, ${n}`)));continue}t=0,yield _.ok(e)}}async fetchOriginMeta(e){const t=this.cachedOriginMeta(e.href);if(t)return t;let i=null;const n=await window.fetch(e.href).then(l=>l.text()).then(l=>new DOMParser().parseFromString(l,"text/html"));if(u.fetchOriginal&&(i=this.getOriginalURL(n)),i||(i=this.getNormalURL(n)),!i)throw new Error("Cannot find origin image or video url");let r;const a=i.split(".").pop()?.match(/^\w+/)?.[0],s=this.extractIDFromHref(e.href);return a&&s&&(r=`${s}.${a}`),{url:i,title:r}}cachedOriginMeta(e){return null}async parseImgNodes(e){const t=[];return this.queryList(e).forEach(i=>{const[n,r]=this.toImgNode(i);if(n){if(this.count++,r!==""){const a=r.trim().replaceAll(": ",":").split(" ").map(s=>s.trim()).filter(s=>s!=="");if(this.blacklistTags.findIndex(s=>a.includes(s))>=0)return;this.tags[n.title.split(".")[0]]=a}t.push(n)}}),t}galleryMeta(){const t=new URL(window.location.href).searchParams.get("tags")?.trim(),i=new U(window.location.href,`${this.site().toLowerCase().replace(" ","-")}_${t}_${this.count}`);return i.tags=this.tags,i}}class si extends de{site(){return"danbooru"}workURL(){return/danbooru.donmai.us\/(posts(?!\/)|$)/}nextPage(e){return e.querySelector(".paginator a.paginator-next")?.href||null}queryList(e){return Array.from(e.querySelectorAll(".posts-container > article"))}getBlacklist(e){return e.querySelector("meta[name='blacklisted-tags']")?.getAttribute("content")?.split(",")||[]}toImgNode(e){const t=e.querySelector("a");if(!t)return I("error","warn: cannot find anchor element",t),[null,""];const i=t.querySelector("img");if(!i)return I("error","warn: cannot find img element",i),[null,""];const n=t.getAttribute("href");return n?[new L(i.src,n,`${e.getAttribute("data-id")||e.id}.jpg`),e.getAttribute("data-tags")||""]:(I("error","warn: cannot find href",t),[null,""])}getOriginalURL(e){return e.querySelector("#image-resize-notice > a")?.href||null}getNormalURL(e){return e.querySelector("#image")?.getAttribute("src")||null}extractIDFromHref(e){return e.match(/posts\/(\d+)/)?.[1]}}class li extends de{site(){return"rule34"}workURL(){return/rule34.xxx\/index.php\?page=(post&s=list|favorites&s=view)/}nextPage(e){if(window.location.search.includes("page=favorites")){const t=e.querySelector("#paginator a[name=next]")?.getAttribute("onclick")?.match(/location='(.*)?'/)?.[1]||null;return t&&window.location.origin+"/"+t}else return e.querySelector(".pagination a[alt=next]")?.href||null}queryList(e){return window.location.search.includes("page=favorites")?Array.from(e.querySelectorAll("#content .thumb a")):Array.from(e.querySelectorAll(".image-list > .thumb:not(.blacklisted-image) > a"))}getBlacklist(e){return e.querySelector("meta[name='blacklisted-tags']")?.getAttribute("content")?.split(",")||[]}toImgNode(e){const t=e.querySelector("img");if(!t)return I("error","warn: cannot find img element",t),[null,""];const i=e.getAttribute("href");return i?[new L(t.src,i,`${e.id}.jpg`),t.getAttribute("alt")||""]:(I("error","warn: cannot find href",e),[null,""])}getOriginalURL(e){const t=e.querySelector("#note-container + script")?.textContent?.trim().replace("image = ","").replace(";","").replaceAll("'",'"');try{if(t){const i=JSON.parse(t);return`${i.domain}/${i.base_dir}/${i.dir}/${i.img}`}}catch(i){I("error","get original url failed",i)}return null}getNormalURL(e){const t=e.querySelector("#image,#gelcomVideoPlayer > source");return t?.getAttribute("src")||t?.getAttribute("data-cfsrc")||null}extractIDFromHref(e){return e.match(/id=(\d+)/)?.[1]}}const Ke=/Post\.register\((.*)\)/g;class ci extends M{name(){return"yande.re"}infos={};count=0;workURL(){return/yande.re\/post(?!\/show\/.*)/}async*fetchPagesSource(){let e=document;yield _.ok(e);let t=0;for(;;){const i=e.querySelector("#paginator a.next_page")?.href;if(!i)break;try{e=await window.fetch(i).then(n=>n.text()).then(n=>new DOMParser().parseFromString(n,"text/html"))}catch(n){if(t++,t>3)throw new Error(`fetch next page failed, ${n}`);continue}t=0,yield _.ok(e)}}async parseImgNodes(e){const t=e.querySelector("body > form + script")?.textContent;if(!t)throw new Error("cannot find post list from script");const i=t.matchAll(Ke),n=[];for(const r of i)if(!(!r||r.length<2))try{const a=JSON.parse(r[1]);this.infos[a.id.toString()]=a,this.count++,n.push(new L(a.preview_url,`${window.location.origin}/post/show/${a.id}`,`${a.id}.${a.file_ext}`,void 0,void 0,{w:a.width,h:a.height}))}catch(a){I("error","parse post info failed",a);continue}return n}async fetchOriginMeta(e){const t=e.href.split("/").pop();if(!t)throw new Error(`cannot find id from ${e.href}`);let i;if(u.fetchOriginal?i=this.infos[t]?.file_url:i=this.infos[t]?.sample_url,!i)throw new Error(`cannot find url for id ${t}`);return{url:i}}galleryMeta(){const t=new URL(window.location.href).searchParams.get("tags")?.trim(),i=new U(window.location.href,`yande_${t||"post"}_${this.count}`);return i.infos=this.infos,i}}class di extends M{name(){return"konachan"}infos={};count=0;workURL(){return/konachan.com\/post(?!\/show\/.*)/}async*fetchPagesSource(){let e=document;yield _.ok(e);let t=0;for(;;){const i=e.querySelector("#paginator a.next_page")?.href;if(!i)break;try{e=await window.fetch(i).then(n=>n.text()).then(n=>new DOMParser().parseFromString(n,"text/html"))}catch(n){if(t++,t>3)throw new Error(`fetch next page failed, ${n}`);continue}t=0,yield _.ok(e)}}async parseImgNodes(e){const t=e.querySelector("body > script + script")?.textContent;if(!t)throw new Error("cannot find post list from script");const i=t.matchAll(Ke),n=[];for(const r of i)if(!(!r||r.length<2))try{const a=JSON.parse(r[1]);this.infos[a.id.toString()]=a,this.count++;const s=a.file_ext||a.file_url.split(".").pop();n.push(new L(a.preview_url,`${window.location.origin}/post/show/${a.id}`,`${a.id}.${s}`))}catch(a){I("error","parse post info failed",a);continue}return n}async fetchOriginMeta(e){const t=e.href.split("/").pop();if(!t)throw new Error(`cannot find id from ${e.href}`);let i;if(u.fetchOriginal?i=this.infos[t]?.file_url:i=this.infos[t]?.sample_url,!i)throw new Error(`cannot find url for id ${t}`);return{url:i}}galleryMeta(){const t=new URL(window.location.href).searchParams.get("tags")?.trim(),i=new U(window.location.href,`konachan_${t}_${this.count}`);return i.infos=this.infos,i}}class hi extends de{site(){return"gelbooru"}workURL(){return/gelbooru.com\/index.php\?page=post&s=list/}nextPage(e){const t=e.querySelector("#paginator a[alt=next]")?.href;return t||e.querySelector("#paginator b + a")?.href||null}queryList(e){return Array.from(e.querySelectorAll(".thumbnail-container > article.thumbnail-preview:not(.blacklisted-image) > a"))}getBlacklist(e){return e.querySelector("meta[name='blacklisted-tags']")?.getAttribute("content")?.split(",")||[]}toImgNode(e){const t=e.querySelector("img");if(!t)return I("error","warn: cannot find img element",t),[null,""];const i=e.getAttribute("href");return i?[new L(t.src,i,`${e.id}.jpg`),t.getAttribute("alt")||""]:(I("error","warn: cannot find href",e),[null,""])}getOriginalURL(e){return e.querySelector("head > meta[property='og:image']")?.getAttribute("content")||null}getNormalURL(e){const t=e.querySelector("#image");if(t?.src)return t.src;const i=Array.from(e.querySelectorAll("#gelcomVideoPlayer > source"));return i.length===0?null:i.find(n=>n.type.endsWith("mp4"))?.src||i[0].src}extractIDFromHref(e){return e.match(/id=(\d+)/)?.[1]}}class ui extends de{cache=new Map;nextPage(e){return e.querySelector(".paginator #paginator-next")?.href??null}getOriginalURL(){throw new Error("Method not implemented.")}getNormalURL(){throw new Error("Method not implemented.")}extractIDFromHref(){throw new Error("Method not implemented.")}getBlacklist(e){const t=e.querySelector("meta[name='blacklisted-tags']")?.getAttribute("content");return t?t.slice(1,-1).split(",").map(i=>i.slice(1,-1)):[]}queryList(e){return ze.imgSrcCSP=!0,Array.from(e.querySelectorAll(".posts-container > article"))}toImgNode(e){const t=e.getAttribute("data-preview-url");if(!t)return[null,""];const i=`${window.location.origin}/posts/${e.getAttribute("data-id")}`,n=e.getAttribute("data-tags"),r=e.getAttribute("data-id"),a=e.getAttribute("data-large-url"),s=e.getAttribute("data-file-url"),l=e.getAttribute("data-file-ext")||void 0;if(!a||!s||!r)return[null,""];const c=e.getAttribute("data-width"),d=e.getAttribute("data-height");let h;return c&&d&&(h={w:parseInt(c),h:parseInt(d)}),this.cache.set(i,{normal:a,original:s,id:r,fileExt:l}),[new L(t,i,`${r}.jpg`,void 0,void 0,h),n||""]}cachedOriginMeta(e){const t=this.cache.get(e);if(!t)throw new Error("miss origin meta: "+e);return["webm","webp","mp4"].includes(t.fileExt??"bbb")||u.fetchOriginal?{url:t.original,title:`${t.id}.${t.fileExt}`}:{url:t.normal,title:`${t.id}.${t.normal.split(".").pop()}`}}site(){return"e621"}workURL(){return/e621.net\/(posts(?!\/)|$)/}}function pi(o){return o.map(e=>{const[t,i]=e.backgroundPosition.split(" ").map(n=>Math.abs(parseInt(n)));if(isNaN(t))throw new Error("invalid background position");return{x:t,y:i,width:parseInt(e.width),height:parseInt(e.height)}})}function gi(o,e){const t=document.createElement("canvas"),i=t.getContext("2d"),n=[];for(const r of e)t.width=r.width,t.height=r.height,i.drawImage(o,r.x,r.y,r.width,r.height,0,0,r.width,r.height),n.push(t.toDataURL());return t.remove(),n}async function Ye(o,e){let t;for(let n=0;n<3;n++)try{t=await Ze(o,"blob");break}catch(r){I("error","fetch thumbnail failed, ",r)}if(!t)throw new Error("load sprite image error");o=URL.createObjectURL(t);const i=await new Promise((n,r)=>{const a=new Image;a.onload=()=>n(a),a.onerror=()=>r(new Error("load sprite image error")),a.src=o});return URL.revokeObjectURL(o),gi(i,e)}const Z={normal:/\<img\sid=\"img\"\ssrc=\"(.*?)\"\sstyle/,original:/\<a\shref=\"(http[s]?:\/\/e[x-]?hentai(55ld2wyap5juskbm67czulomrouspdacjamjeloj7ugjbsad)?\.(org|onion)\/fullimg?[^"\\]*)\"\>/,nlValue:/\<a\shref=\"\#\"\sid=\"loadfail\"\sonclick=\"return\snl\(\'(.*)\'\)\"\>/,isMPV:/https?:\/\/e[-x]hentai(55ld2wyap5juskbm67czulomrouspdacjamjeloj7ugjbsad)?\.(org|onion)\/mpv\/\w+\/\w+\/#page\w/,mpvImageList:/imagelist\s=\s(\[.*?\])/,sprite:/url\((.*?)\)/};class mi extends M{name(){return"e-hentai"}docMap={};workURL(){return/e[-x]hentai(.*)?.(org|onion)\/g\/\w+/}title(e){const t=e[0].meta||this.galleryMeta(e[0]);let i="";return u.ehentaiTitlePrefer==="japanese"?i=t.originTitle||t.title||"UNTITLE":i=t.title||t.originTitle||"UNTITLE",e.length>1&&(i+="+"+e.length+"chapters"),i}galleryMeta(e){if(e.meta)return e.meta;const t=this.docMap[e.id],i=t.querySelectorAll("#gd2 h1");let n,r;i&&i.length>0&&(n=i[0].textContent||void 0,i.length>1&&(r=i[1].textContent||void 0)),e.meta=new U(window.location.href,n||"UNTITLE"),e.meta.originTitle=r;const a=t.querySelectorAll("#taglist tr"),s={};return a.forEach(l=>{const c=l.childNodes,d=c[0].textContent;if(d){const h=[];c[1].childNodes.forEach(p=>{p.textContent&&h.push(p.textContent)}),s[d.replace(":","")]=h}}),e.meta.tags=s,e.meta}async fetchChapters(){const e={id:0,title:"Default",source:window.location.href,queue:[]};return this.docMap[0]=document,this.galleryMeta(e),e.title=e.meta.title,[e]}async appendNewChapters(e,t){if(!this.workURL().test(e))throw new Error("invaild gallery url");const i=await window.fetch(e).then(a=>a.text()).then(a=>new DOMParser().parseFromString(a,"text/html"));let n=t[t.length-1]?.id||0;n=n+1;const r={id:n,title:"NewChapter-"+n,source:e,queue:[]};return this.docMap[n]=i,this.galleryMeta(r),r.title=r.meta.title,[r]}async parseImgNodes(e){const t=[],i=await window.fetch(e).then(d=>d.text()).then(d=>new DOMParser().parseFromString(d,"text/html"));if(!i)throw new Error("warn: eh matcher failed to get document from source page!");let n=!1,r=d=>{const h=d.firstElementChild,p=h.firstElementChild,g=p.getAttribute("title")?.replace(/Page\s\d+[:_]\s*/,"")||"untitle.jpg";return{thumbnailImage:p.src,title:g,href:h.getAttribute("href"),wh:fi(p.src)||{w:100,h:100},style:d.style,backgroundImage:null,delaySrc:void 0}},a=i.querySelectorAll("#gdt .gdtl");if((!a||a.length==0)&&(a=i.querySelectorAll("#gdt .gdtm > div"),n=a?.length>0,r=d=>{const h=d.firstElementChild,g=h.firstElementChild.getAttribute("title")?.replace(/Page\s\d+[:_]\s*/,"")||"untitle.jpg";return{backgroundImage:d.style.background.match(Z.sprite)?.[1]?.replaceAll('"',"")||null,title:g,href:h.getAttribute("href"),wh:_e(d.style)??{w:100,h:100},style:d.style,thumbnailImage:"",delaySrc:void 0}}),(!a||a.length==0)&&(a=i.querySelectorAll("#gdt > a"),n=a?.length>0,r=d=>{const h=d;let p=h.firstElementChild;(!p.style.background||p.childElementCount>0)&&(p=p.firstElementChild);const g=p.getAttribute("title")?.replace(/Page\s\d+[:_]\s*/,"")||"untitle.jpg";return{backgroundImage:p.style.background.match(Z.sprite)?.[1]?.replaceAll('"',"")||null,title:g,href:h.getAttribute("href"),wh:_e(p.style)??{w:100,h:100},style:p.style,thumbnailImage:"",delaySrc:void 0}}),!a||a.length==0)throw new Error("warn: failed query image nodes!");const s=[],l=Array.from(a),c=r(l[0]);if(Z.isMPV.test(c.href)){n=!0;const d=await window.fetch(c.href).then(m=>m.text()).then(m=>new DOMParser().parseFromString(m,"text/html")),h=JSON.parse(d.querySelector("#pane_outer + script")?.innerHTML.match(Z.mpvImageList)?.[1]??"[]"),p=Array.from(d.querySelectorAll("#pane_thumbs > a > div")),g=location.pathname.split("/")[2];for(let m=0;m<h.length;m++){const b=h[m],y=b.t.match(/\((http.*)\)/)?.[1]||null;p[m].style.background="url"+b.t;const v={backgroundImage:y,title:b.n,href:`${location.origin}/s/${b.k}/${g}-${m+1}`,wh:_e(p[m].style)??{w:100,h:100},style:p[m].style,thumbnailImage:"",delaySrc:void 0};s.push(v)}}else l.forEach(d=>s.push(r(d)));if(n){const d=[];for(let h=0;h<s.length;h++){const p=s[h];if(!p.backgroundImage){I("error","e-hentai miss node, ",p);continue}d.length===0||d[d.length-1].url!==p.backgroundImage?d.push({url:p.backgroundImage,range:[{index:h,style:p.style}]}):d[d.length-1].range.push({index:h,style:p.style})}d.forEach(({url:h,range:p})=>{if(h=h.startsWith("http")?h:window.location.origin+h,p.length===1)s[p[0].index].thumbnailImage=h;else{const g=[];for(let m=0;m<p.length;m++)s[p[m].index].delaySrc=new Promise((b,y)=>g.push({resolve:b,reject:y}));Ye(h,pi(p.map(m=>m.style))).then(m=>{for(let b=0;b<m.length;b++)g[b].resolve(m[b])}).catch(m=>g.forEach(b=>b.reject(m)))}})}for(let d=0;d<s.length;d++){const h=s[d];t.push(new L(h.thumbnailImage,h.href,h.title,h.delaySrc,void 0,h.wh))}return t}async*fetchPagesSource(e){const t=this.docMap[e.id],i=t.querySelector("#gdt a")?.getAttribute("href");if(i&&Z.isMPV.test(i)){yield _.ok(window.location.href);return}const n=Array.from(t.querySelectorAll(".gtb td a")).filter(s=>s.getAttribute("href")).map(s=>s.getAttribute("href"));if(n.length===0)throw new Error("cannot found next page elements");let r=0,a;for(const s of n){const l=new URL(s),c=parseInt(l.searchParams.get("p")||"0");c>=r&&(r=c,a=l)}if(!a)throw new Error("cannot found next page elements again");a.searchParams.delete("p"),yield _.ok(a.href);for(let s=1;s<r+1;s++)a.searchParams.set("p",s.toString()),yield _.ok(a.href)}async fetchOriginMeta(e,t){const i=await window.fetch(e.href).then(r=>r.text()).catch(r=>new Error(r));if(i instanceof Error||!i)throw new Error(`fetch source page error, ${i.toString()}`);let n;if(u.fetchOriginal){n=Z.original.exec(i)?.[1].replace(/&amp;/g,"&");const r=e.href.includes("?")?e.href.split("?").pop():void 0;n&&r&&(n+="?"+r)}if(n||(n=Z.normal.exec(i)?.[1]),t){const r=Z.nlValue.exec(i)?.[1];r?(e.href=e.href+(e.href.includes("?")?"&":"?")+"nl="+r,I("info",`IMG-FETCHER retry url:${e.href}`),n=(await this.fetchOriginMeta(e,!1)).url):I("error",`Cannot matching the nlValue, content: ${i}`)}if(!n)throw I("error",`cannot matching the image url from content:
`,i),new Error("cannot matching the image url from content. (the content is showing up in console(F12 open it)");if(n.startsWith("http")||(n=window.location.origin+n),n.endsWith("509.gif"))throw new Error("509, Image limits Exceeded, Please reset your Quota!");return{url:n,href:e.href}}async processData(e,t){if(t.startsWith("text")&&e.byteLength===1329)throw new Error('fetching the raw image requires being logged in, please try logging in or disable "raw image"');return[e,t]}}function fi(o){if(!o)return;const e=o.match(/\/\w+-\d+-(\d+)-(\d+)-/);if(e&&e.length===3)return{w:parseInt(e[1]),h:parseInt(e[2])}}function _e(o){const e={w:parseInt(o.width),h:parseInt(o.height)};if(!(isNaN(e.w)||isNaN(e.h)))return e}class bi extends M{meta;galleryMeta(){return this.meta}name(){return"hanime1.me"}parseMeta(){const e=document.querySelector(".comics-panel-margin h3.title")?.textContent?.replaceAll(/\s/g,""),t=document.querySelector(".comics-panel-margin h4.title")?.textContent?.replaceAll(/\s/g,""),i=new U(window.location.href,e??document.title);i.originTitle=t??void 0,Array.from(document.querySelectorAll(".comics-panel-margin .comics-metadata-margin-top h5")).forEach(n=>{let r=n.firstChild?.textContent??"misc";r=r.trim().replace(/：:/,"");const a=Array.from(n.querySelectorAll("a")).map(s=>s.textContent?.trim()).filter(Boolean);i.tags[r]=a}),this.meta=i}async*fetchPagesSource(){this.parseMeta(),yield _.ok(document)}async parseImgNodes(e){const t=Array.from(e.querySelectorAll(".comics-panel-margin > a")),i=t[0],n={j:"jpg",p:"png",g:"gif",w:"webp"};let r="",a;if(i){const l=await window.fetch(i.href).then(h=>h.text()).then(h=>new DOMParser().parseFromString(h,"text/html")),c=l.querySelector("#comic-content-wrapper img");r=c?.getAttribute("prefix")??c?.getAttribute("data-prefix")??"";const d=l.querySelector("#comic-content-wrapper script")?.textContent?.match(/extensions.innerHTML = '(.*)?'/)?.[1]?.replaceAll("&quot;",'"');a=d?JSON.parse(d):void 0}const s=t.length.toString().length;return t.map((l,c)=>{const d=l.href,h=l.querySelector("img")?.getAttribute("data-srcset")||"",p=a?.[c]??"j",g=n[p]??"jpg",m=r?r+(c+1)+"."+g:void 0;return new L(h,d,(c+1).toString().padStart(s,"0")+"."+g,void 0,m)})}async fetchOriginMeta(e){if(e.originSrc)return{url:e.originSrc};const i=(await window.fetch(e.href).then(n=>n.text()).then(n=>new DOMParser().parseFromString(n,"text/html"))).querySelector("#comic-content-wrapper img");if(!i)throw new Error("cannot find img from "+e.href);return{url:i.src}}workURL(){return/hanime1.me\/comic\/\d+\/?$/}}const wi=/initReader\("(.*?)\",\s?"(.*?)",\s?(.*?)\)/,vi=/read\/\d+\/(\d+)$/;class yi extends M{name(){return"hentainexus"}meta;baseURL;readerData;async*fetchPagesSource(){this.meta=this.pasrseGalleryMeta(document),yield _.ok(document)}async parseImgNodes(e){const t=[];return Array.from(e.querySelectorAll(".section .container + .container > .box > .columns > .column a")).forEach((n,r)=>{const a=n.querySelector("img");if(!a)return;const s=n.href.split("/").pop()||r.toString(),l=a.src.split(".").pop(),c=s+"."+l;t.push(new L(a.src,n.href,c))}),t}async fetchOriginMeta(e){if(!this.readerData){const a=(await window.fetch(e.href).then(s=>s.text()).then(s=>new DOMParser().parseFromString(s,"text/html"))).querySelector("body > script")?.textContent?.match(wi)?.slice(1);if(!a||a.length!==3)throw new Error("cannot find reader data");try{this.initReader(a[0],a[1])}catch{throw new Error("hentainexus updated decryption function")}}if(!this.readerData)throw new Error("cannot find reader data");const t=e.href.match(vi)?.[1]||"001",i=this.readerData.find(r=>r.url_label===t)?.image;if(!i)throw new Error("cannot find image url");const n=i.split(".").pop();return{url:i,title:t+"."+n}}workURL(){return/hentainexus.com\/view\/\d+/}galleryMeta(e){return this.meta||super.galleryMeta(e)}pasrseGalleryMeta(e){const t=e.querySelector("h1.title")?.textContent||"UNTITLED",i=new U(this.baseURL||window.location.href,t);return e.querySelectorAll(".view-page-details tr").forEach(n=>{const r=n.querySelector(".viewcolumn")?.textContent?.trim();if(!r)return;let a=Array.from(n.querySelector(".viewcolumn + td")?.childNodes||[]).map(s=>s?.textContent?.trim()).filter(Boolean);a.length!==0&&(r==="Tags"&&(a=a.map(s=>s.replace(/\s?\([0-9,]*\)$/,""))),i.tags[r]=a)}),i}initReader(e,t){this.meta&&(this.meta.originTitle=t.replace(/::\s?HentaiNexus/,""));const i=window.location.hostname.split(""),n=Math.min(i.length,64),r=window.atob(e).split("");for(let g=0;g<n;g++)r[g]=String.fromCharCode(r[g].charCodeAt(0)^i[g].charCodeAt(0));const a=r.join(""),s=[],l=[];for(let g=2;l.length<16;++g)if(!s[g]){l.push(g);for(let m=g<<1;m<=256;m+=g)s[m]=!0}let c=0;for(let g=0;g<64;g++){c=c^a.charCodeAt(g);for(let m=0;m<8;m++)c=c&1?c>>>1^12:c>>>1}c=c&7;const d=new Uint8Array(256);for(let g=0;g<256;g++)d[g]=g;let h="",p=0;for(let g=0,m=0;g<256;g++)m=(m+d[g]+a.charCodeAt(g%64))%256,p=d[g],d[g]=d[m],d[m]=p;for(let g=l[c],m=0,b=0,y=0,v=0,S=0;S+64<a.length;S++)y=(y+g)%256,v=(b+d[(v+d[y])%256])%256,b=(b+y+d[y])%256,p=d[y],d[y]=d[v],d[v]=p,m=d[(v+d[(y+d[(m+b)%256])%256])%256],h+=String.fromCharCode(a.charCodeAt(S+64)^m);this.readerData=JSON.parse(h)}}const te="gold-usergeneratedcontent.net";class Ci{base=void 0;b;m;constructor(e,t){this.b=e,this.m=new Function("g",t)}real_full_path_from_hash(e){return e.replace(/^.*(..)(.)$/,"$2/$1/"+e)}s(e){const t=/(..)(.)$/.exec(e);return parseInt(t[2]+t[1],16).toString(10)}subdomain_from_url(e,t,i){let n="";t||(i==="webp"?n="w":i==="avif"&&(n="a"));let r=16,s=/\/[0-9a-f]{61}([0-9a-f]{2})([0-9a-f])/.exec(e);if(!s)return n;let l=parseInt(s[2]+s[1],r);return isNaN(l)||(t?n=String.fromCharCode(97+this.m(l))+t:n=n+(1+this.m(l))),n}thumbURL(e){e=e.replace(/^.*(..)(.)$/,"$2/$1/"+e);const t="https://a."+te+"/webpsmalltn/"+e+".webp";return t.replace(/\/\/..?\.(?:gold-usergeneratedcontent\.net|hitomi\.la)\//,"//"+this.subdomain_from_url(t,"tn","webp")+"."+te+"/")}originURL(e,t){let i=t;i==="webp"||i==="avif"?i="":i+="/";let n="https://a."+te+"/"+i+this.b+this.s(e)+"/"+e+"."+t;return n=n.replace(/\/\/..?\.(?:gold-usergeneratedcontent\.net|hitomi\.la)\//,"//"+this.subdomain_from_url(n,this.base,t)+"."+te+"/"),n}}const Ii=/m:\sfunction\(g\)\s{(.*?return.*?;)/s,xi=/b:\s'(\d*\/)'/;class Ai extends M{name(){return"hitomi"}gg;meta={};infoRecord={};formats=["avif","jxl","webp"];formatIndex=0;workURL(){return/hitomi.la\/(?!reader)\w+\/.*\d+\.html/}async fetchChapters(){if(this.formatIndex=u.hitomiFormat==="auto"?0:this.formats.indexOf(u.hitomiFormat),this.formatIndex===-1)throw new Error("invalid hitomi format: "+u.hitomiFormat);const e=await window.fetch(`https://ltn.${te}/gg.js?_=${Date.now()}`).then(i=>i.text());this.gg=new Ci(xi.exec(e)[1],Ii.exec(e)[1]);const t=[];return t.push({id:0,title:document.querySelector("#gallery-brand")?.textContent||"default",source:window.location.href,queue:[],thumbimg:document.querySelector(".content > .cover-column > .cover img")?.src}),u.mcInSites?.indexOf("hitomi")===-1||document.querySelectorAll("#related-content > div").forEach((i,n)=>{const r=i.querySelector("h1.lillie > a");r&&t.push({id:n+1,title:r.textContent||"default-"+(n+1),source:r.href,queue:[],thumbimg:i.querySelector("img")?.src})}),t}async*fetchPagesSource(e){const i=e.source.match(/([0-9]+)(?:\.html)/)?.[1];if(!i)throw new Error("cannot query hitomi gallery id");const n=await window.fetch(`https://ltn.${te}/galleries/${i}.js`).then(a=>a.text()).then(a=>a.replace("var galleryinfo = ",""));if(!n)throw new Error("cannot query hitomi gallery info");const r=JSON.parse(n);this.setGalleryMeta(r,i,e),yield _.ok(r)}async parseImgNodes(e){const t=e.files,i=[];for(let n=0;n<t.length;n++){const r=t[n];let a=this.formats.slice(this.formatIndex).find(h=>r["has"+h]===1);a||(a="webp",I("error","no format found: ",t[n]));const s=r.name.replace(/\.\w+$/,""),l=this.gg.originURL(r.hash,a),{width:c,height:d}=r;i.push(new L(this.gg.thumbURL(t[n].hash),l,s+"."+a,void 0,l,c&&d?{w:c,h:d}:void 0))}return i}async fetchOriginMeta(e){return{url:e.originSrc}}setGalleryMeta(e,t,i){this.infoRecord[i.id]=e,this.meta[i.id]=new U(i.source,e.title||"hitomi-"+t),this.meta[i.id].originTitle=e.japanese_title||void 0;const n=["scene_indexes","files"];for(const r in e)n.indexOf(r)>-1||(this.meta[i.id].tags[r]=e[r])}galleryMeta(e){return this.meta[e.id]}title(){const e=Object.entries(this.infoRecord);return e.length===0?"hitomi-unknown":e.length===1?e[0][1].japanese_title||e[0][1].title||"hitomi-unknown":"hitomi-multiple"+e.map(t=>t[1].id).join("_")}}function w(o,e){const t=e.querySelector(o);if(!t)throw new Error(`Can't find element: ${o}`);return t}class _i extends M{name(){return"im-hentai"}data;gth;async fetchOriginMeta(e,t){return{url:e.originSrc}}async parseImgNodes(){if(!this.data||!this.gth)throw new Error("impossibility");const e=[],t=this.data.total.toString().length;for(let i=1;i<=this.data.total;i++){const n=`https://m${this.data.server}.imhentai.xxx/${this.data.imgDir}/${this.data.gid}/${i}t.jpg`,r=`https://imhentai.xxx/view/${this.data.uid}/${i}/`,a=ki(this.gth[i.toString()]),s=`https://m${this.data.server}.imhentai.xxx/${this.data.imgDir}/${this.data.gid}/${i}.${a}`;let l;const c=this.gth[i.toString()].split(",");c.length===3&&(l={w:parseInt(c[1]),h:parseInt(c[2])});const d=new L(n,r,`${i.toString().padStart(t,"0")}.${a}`,void 0,s,l);e.push(d)}return e}async*fetchPagesSource(){const e=w("#load_server",document).value,t=w("#gallery_id",document).value,i=w("#load_id",document).value,n=w("#load_dir",document).value,r=w("#load_pages",document).value;this.data={server:e,uid:t,gid:i,imgDir:n,total:Number(r)};const a=Array.from(document.querySelectorAll("script")).find(s=>s.textContent?.trimStart().startsWith("var g_th"))?.textContent?.match(/\('(\{.*?\})'\)/)?.[1];if(!a)throw new Error("cannot match gallery images info");this.gth=JSON.parse(a),yield _.ok(null)}galleryMeta(){const e=document.querySelector(".right_details > h1")?.textContent||void 0,t=document.querySelector(".right_details > p.subtitle")?.textContent||void 0,i=new U(window.location.href,e||"UNTITLE");i.originTitle=t,i.tags={};const n=Array.from(document.querySelectorAll(".galleries_info > li"));for(const r of n){let a=r.querySelector(".tags_text")?.textContent;if(!a||(a=a.replace(":","").trim(),!a))continue;const s=Array.from(r.querySelectorAll("a.tag")).map(l=>l.firstChild?.textContent?.trim()).filter(l=>!!l);i.tags[a]=s}return i}workURL(){return/imhentai.xxx\/gallery\/\d+\//}}function ki(o){switch(o.slice(0,1)){case"j":return"jpg";case"g":return"gif";case"p":return"png";case"w":return"webp";case"a":return"avif";case"m":return"mp4";default:throw new Error("cannot parse image extension from info: "+o)}}class Si extends M{config;name(){return"Instagram"}async*fetchPagesSource(){this.config=Ei();let e=null;for(;;)try{const[t,i]=await this.fetchPosts(e);if(e=i.end_cursor,yield _.ok(t),!i.has_next_page)break}catch(t){yield _.err(t)}}async parseImgNodes(e){const t=[];for(let i=0;i<e.length;i++){const n=e[i],r=n.video_versions,a=!r&&n.carousel_media&&n.carousel_media.length>0?n.carousel_media.map(l=>l.image_versions2):[n.image_versions2],s=a.length.toString().length;for(let l=0;l<a.length;l++){const c=a[l],d=a.length>1?`${n.pk}-${(l+1).toString().padStart(s,"0")}`:n.pk,h=r?"mp4":"jpeg",[p,g]=this.getThumbAndOrigin(c.candidates,r);t.push(new L(p?.url??"",`${window.location.origin}/p/${n.code}`,`${d}.${h}`,void 0,g.url,{w:p.width,h:p.height}))}}return t}async fetchOriginMeta(e){return{url:e.originSrc}}workURL(){return/instagram.com\/(?!(home|explore|direct|reels|stories))\w+/}async fetchPosts(e){if(!this.config)throw new Error("instagram config null");const t=this.config,i=new Headers;i.append("x-fb-friendly-name",t.apiName),i.append("x-bloks-version-id",t.bloksVersionID),i.append("x-csrftoken",t.csrfToken),i.append("x-ig-app-id",t.appID),i.append("x-fb-lsd",t.lsd),i.append("x-asbd-id","129477");let n={username:t.username,__relay_internal__pv__PolarisIsLoggedInrelayprovider:!0,__relay_internal__pv__PolarisFeedShareMenurelayprovider:!0,data:{count:12,include_relationship_info:!0,latest_besties_reel_media:!0,latest_reel_media:!0}};e&&(n.after=e,n.before=null,n.first=12,n.last=null);const r=new URLSearchParams;r.append("av",t.userID),r.append("__d","www"),r.append("__user","0"),r.append("__a","1"),r.append("__req","x"),r.append("__hs",t.hasteSession),r.append("dpr","1"),r.append("__ccg","UNKNOWN"),r.append("__rev",t.clientVersion),r.append("__hsi",t.hsi),r.append("__dyn",t.dyn),r.append("__comet_req","7"),r.append("fb_dtsg",t.dtsg),r.append("lsd",t.lsd),r.append("__spin_r",t.spinR),r.append("__spin_b",t.spinB),r.append("__spin_t",t.spinT),r.append("fb_api_caller_class","RelayModern"),r.append("fb_api_req_friendly_name",t.apiName),r.append("variables",JSON.stringify(n)),r.append("server_timestamps","true"),r.append("doc_id",t.docID);const s=(await window.fetch("https://www.instagram.com/graphql/query",{headers:i,body:r,method:"POST"}).then(l=>l.json()))?.data?.xdt_api__v1__feed__user_timeline_graphql_connection;if(!s)throw new Error("failed fetch user's posts by API");return[s.edges.map(l=>l.node),s.page_info]}getThumbAndOrigin(e,t){const i=t?.[0]??e[0];let n;for(const r of e){if(!n){n=r;continue}if(n.width<r.width||r.width<=240)break;n=r}return[n,i]}}function Ei(){const o=new Error("cannot find instagram config from script[data-sjs]"),e=Array.from(document.querySelectorAll("script[data-sjs]")).find(E=>E.textContent?.trimStart().startsWith('{"require":[["ScheduledServerJS","handle",null,[{"__bbox":{"define":'))?.textContent;if(!e)throw o;const n=(JSON.parse(e).require?.[0]?.[3]?.[0]?.__bbox?.define).reduce((E,B)=>(E[B[0]]=B[2],E),{});if(!n)throw o;let r=n.InstagramSecurityConfig?.csrf_token,a=n.LSD?.token,s=n.WebBloksVersioningID?.versioningID,l=n.CurrentUserInitialData?.APP_ID,c=n.CurrentUserInitialData?.NON_FACEBOOK_USER_ID,d=n.SiteData?.haste_session,h=n.SiteData?.client_revision,p=n.SiteData?.hsi,g=n.SiteData?.__spin_r,m=n.SiteData?.__spin_b,b=n.SiteData?.__spin_t,y=n.DTSGInitData?.token;const v=window.location.pathname.split("/")?.[1];if(!r||!a||!s||!l||!c||!d||!h||!p||!g||!m||!b||!y||!v)throw o;return{csrfToken:r,lsd:a,bloksVersionID:s,appID:l,userID:c,hasteSession:d,clientVersion:h,hsi:p,spinR:g,spinB:m,spinT:b,dtsg:y,docID:"8363144743749214",apiName:"PolarisProfilePostsTabContentQuery_connection",dyn:"7xeUjG1mxu1syUbFp41twpUnwgU7SbzEdF8aUco2qwJxS0k24o0B-q1ew65xO0FE2awgo9oO0n24oaEnxO1ywOwv89k2C1Fwc60D87u3ifK0EUjwGzEaE2iwNwmE2eUlwhEe87q7U1mVEbUGdG1QwTU9UaQ0Lo6-3u2WE5B08-269wr86C1mwPwUQp1yUb9UK6V8aUuwm9EO6UaU4W",username:v}}const Li=["jpeg","jpg","png","gif","webp","bmp","avif","jxl"],Ti=["mp4","webm","ogg","ogv","mov","avi","mkv","av1"];function ke(o){return Li.includes(o)}function Se(o){return Ti.includes(o)}class Ee{async*next(){const e=new URL(window.location.href);let t=parseInt(e.searchParams.get("o")??"0");t=isNaN(t)?0:t;const i=e.searchParams.get("q");for(;;){const n=await window.fetch(this.getURL(t,i)).then(s=>s.json());n.error&&(yield _.err(new Error(n.error)));const r=this.getPosts(n);if(!r||r.length===0)break;t+=r.length;const a=Je(this.getList(n));if(a.size>0&&r.forEach(s=>{if(s.file?.path){const l=a.get(s.file.path);s.file.name=l?.name,s.file.server=l?.server}s.attachments&&s.attachments.length>0&&s.attachments.forEach(l=>{if(l.path){const c=a.get(l.path);l.name=c?.name,l.server=c?.server}})}),yield _.ok(r),r.length<50)break}}}class Ri extends Ee{getURL(e,t){const i=new URL(window.location.href),n=new URL(`${i.origin}/api/v1/${i.pathname}/posts-legacy`);return e>0&&n.searchParams.set("o",e.toString()),t&&n.searchParams.set("q",t),n.href}getList(e){return[...e.result_previews??[],...e.result_attachments??[]].flat(1)}getPosts(e){return e.results}}class Pi extends Ee{getPosts(e){return e.posts}getURL(e,t){const i=new URL(window.location.href),n=new URL(`${i.origin}/api/v1/${i.pathname}`);return e>0&&n.searchParams.set("o",e.toString()),t&&n.searchParams.set("q",t),n.href}getList(){return[]}}class Mi extends Ee{getPosts(e){return e?.post?[e.post]:[]}getURL(){return`${window.location.origin}/api/v1/${window.location.pathname}`}getList(e){return[...e.previews??[],...e.attachments??[]]}}class Ni extends M{list;constructor(){super(),window.location.href.includes("/posts")?this.list=new Pi:/user\/\w+/.test(window.location.href)&&(/post\/\w+/.test(window.location.href)?this.list=new Mi:this.list=new Ri)}name(){return"Kemono"}fetchPagesSource(e){if(!this.list)throw new Error("Current path is not supported");return this.list.next()}async parseImgNodes(e){const t=[],i=(r,a,s,l,c,d)=>{const h=`https://img.kemono.su/thumbnail/data/${l}`,p=`https://kemono.su/${s}/user/${a}/post/${r}`;let g=d?`${d}/data/${l}?f=${c}`:void 0;const m=new L(h,p,c,void 0,g);l.indexOf(".mp4")>1&&(m.mimeType="video/mp4",m.thumbnailSrc="");const b=l.split(".").pop()??"";if(!(!ke(b)&&(u.excludeVideo||!Se(b))))return m},n=[];for(const r of e){const a=[];r.file?.path&&a.push(r.file),a.push(...r.attachments??[]),n.push({res:r,list:a,needFetchPost:!a[0]?.server&&a.length>0})}await this.batchFetchPathServerMap(n);for(const r of n)for(const a of r.list){if(!a.path)continue;if(!a.name||!a.server)throw new Error("cannot find image or video name and server");const s=i(r.res.id,r.res.user,r.res.service,a.path,a.name,a.server);s&&t.push(s)}return t}async fetchOriginMeta(e){if(!e.originSrc)throw new Error("cannot find kemono image file: "+e.href);return{url:e.originSrc}}workURL(){return/kemono.su\/(\w+\/user\/\w+(\/post\/\w+)?|posts)(\?\w=.*)?$/}async batchFetchPathServerMap(e){const t=e.filter(a=>a.needFetchPost).map(a=>`${window.location.origin}/api/v1/${a.res.service}/user/${a.res.user}/post/${a.res.id}`),n=(await we(t,10,"json")).reduce((a,s)=>[...a,...s.previews??[],...s.attachments??[]],[]),r=Je(n);e.filter(a=>a.needFetchPost).forEach(a=>a.list.forEach(s=>{if(s.path){const l=r.get(s.path);s.name=l?.name,s.server=l?.server}}))}}function Je(o){const e=new Map;for(const t of o??[])t.path&&t.server&&e.set(t.path,{server:t.server,name:t.name});return e}const $i=/niyaniya.moe\/\w+\/(\d+\/\w+)/,Ui={0:"misc",1:"artist",2:"circle",7:"uploader",8:"male",9:"female",10:"mixed",11:"language"};class qi extends M{name(){return"niyaniya.moe"}meta;galleryMeta(){return this.meta||new U(window.location.href,"koharu-unknows")}async*fetchPagesSource(e){yield _.ok(e.source)}createMeta(e){const t=e.tags.reduce((i,n)=>{const r=Ui[n.namespace||0]||"misc";return i[r]||(i[r]=[]),i[r].push(n.name),i},{});this.meta=new U(window.location.href,e.title),this.meta.tags=t}async parseImgNodes(e){const t=e.match($i);if(!t||t.length<2)throw new Error("invaild url: "+e);const i=t[1],n=`https://api.niyaniya.moe/books/detail/${i}`,r=await window.fetch(n).then(m=>m.json()).then(m=>m).catch(m=>new Error(m.toString()));if(r instanceof Error)throw r;this.createMeta(r);const[a,s]=Object.entries(r.data).sort((m,b)=>b[1].size-m[1].size).find(([m,b])=>b.id!==void 0&&b.public_key!==void 0)??[void 0,void 0];if(a===void 0&&s===void 0)throw new Error("cannot find resolution from gallery detail");const l=`https://api.niyaniya.moe/books/data/${i}/${s.id}/${s.public_key}?v=${r.updated_at??r.created_at}&w=${a}`,c=await window.fetch(l).then(m=>m.json()).then(m=>m).catch(m=>new Error(m.toString()));if(c instanceof Error)throw new Error(`koharu updated their api, ${c.toString()}`);if(c.entries.length!==r.thumbnails.entries.length)throw new Error("thumbnails length not match");const d=r.thumbnails.entries,h=r.thumbnails.base,p=c.base,g=c.entries.length.toString().length;return c.entries.map((m,b)=>{const y=`${window.location.origin}/reader/${i}/${b+1}`,v=(b+1).toString().padStart(g,"0")+"."+m.path.split(".").pop(),S=p+m.path+"?w="+a;return new L(h+d[b].path,y,v,void 0,S,{w:m.dimensions[0],h:m.dimensions[1]})})}async fetchOriginMeta(e){return{url:e.originSrc}}workURL(){return/niyaniya.moe\/(g|reader)\/\d+\/\w+/}headers(){return{Referer:"https://niyaniya.moe/",Origin:window.location.origin}}}class Gi extends M{name(){return"\u62F7\u8D1D\u6F2B\u753B"}update_date;chapterCount=0;meta;galleryMeta(){if(this.meta)return this.meta;let e=document.querySelector(".comicParticulars-title-right > ul > li > h6")?.textContent??document.title;return document.querySelectorAll(".comicParticulars-title-right > ul > li > span.comicParticulars-right-txt").forEach(t=>{/^\d{4}-\d{2}-\d{2}$/.test(t.textContent?.trim()||"")&&(this.update_date=t.textContent?.trim())}),e+="-c"+this.chapterCount+(this.update_date?"-"+this.update_date:""),this.meta=new U(window.location.href,e),this.meta}async*fetchPagesSource(e){yield _.ok(e.source)}async parseImgNodes(e){const t=await Ze(e,"text",{"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.79 Safari/537.36"}),n=new DOMParser().parseFromString(t,"text/html").querySelector(".imageData[contentKey]")?.getAttribute("contentKey");if(!n)throw new Error("cannot find content key");try{const r=await Vi(n),a=JSON.parse(r),s=a.length.toString().length;return a.map((l,c)=>new L("",e,(c+1).toString().padStart(s,"0")+".webp",void 0,l.url))}catch(r){throw new Error("cannot decrypt contentKey: "+r.toString()+`
`+n)}}async fetchOriginMeta(e){return{url:e.originSrc}}workURL(){return/(mangacopy|copymanga).*?\/comic\/[^\/]*\/?$/}async fetchChapters(){const e=document.querySelector(".comicParticulars-left-img > img[data-src]")?.getAttribute("data-src")||void 0,t=window.location.href.match(Di)?.[1];if(!t)throw new Error("cannot match comic id");const i=`https://api.mangacopy.com/api/v3/comic2/${t}?platform=1&_update=true`,n=await window.fetch(i).then(l=>l.json()).catch(l=>new Error(l.toString()));if(n instanceof Error||!n.results.groups)throw new Error("fetch comic detail error: "+n.toString());if(n.code!==200)throw new Error("fetch comic detail error: "+n.message);const r=[],a=n.results.groups;let s=0;for(const l in a){let c=0;for(;;){const d=`https://api.mangacopy.com/api/v3/comic/${t}/group/${a[l].path_word}/chapters?limit=100&offset=${c}&_update=true`,h=await window.fetch(d).then(g=>g.json()).catch(g=>new Error(g.toString()));if(h instanceof Error)throw new Error("fetch chapters error: "+h.toString());if(h.code!==200)throw new Error("fetch chaters error: "+h.message);const p=h.results;c+=p.list.length;for(const g of p.list)r.push({id:s++,title:l==="default"?g.name:`${a[l].name}-${g.name}`,source:`${window.location.origin}/comic/${t}/chapter/${g.uuid}`,queue:[],thumbimg:e});if(c>=p.total)break}}return r}}const Di=/\/comic\/(\w*)/;async function Vi(o){const e=new TextEncoder,t=new TextDecoder,i=e.encode("xxxmanga.woo.key"),n=o.substring(0,16),r=o.substring(16),a=e.encode(n),s=new Uint8Array(r.match(/.{1,2}/g).map(d=>parseInt(d,16))),l=await crypto.subtle.importKey("raw",i,{name:"AES-CBC"},!1,["decrypt"]),c=await crypto.subtle.decrypt({name:"AES-CBC",iv:a},l,s);return t.decode(c)}class Bi extends M{name(){return"\u6F2B\u753B\u67DC"}meta;chapterCount=0;galleryMeta(){if(this.meta)return this.meta;let e=document.querySelector(".book-title > h1")?.textContent??document.title;e+="-c"+this.chapterCount;const t=document.querySelector(".detail-list .status")?.textContent?.match(Hi),i=t?.[1];e+=i?"-"+i:"";const n=t?.[2];return e+=n?"-"+n.trim():"",this.meta=new U(window.location.href,e),this.meta}async*fetchPagesSource(e){yield _.ok(e.source)}async parseImgNodes(e){const i=(await window.fetch(e).then(a=>a.text())).match(ji);if(!i||i.length<5)throw new Error("cannot match image data");let n;try{n=Wi(i[1],parseInt(i[2]),parseInt(i[3]),i[4])}catch(a){throw new Error("cannot parse image data: "+a.toString())}const r=Fi();return n.files.map((a,s)=>{const l=`${r}/${n.path}/${a}?e=${n.sl.e}&m=${n.sl.m}}`,c=`https://www.manhuagui.com/comic/${n.bid}/${n.cid}.html#p=${s+1}`;return new L("",c,a,void 0,l)})}async fetchOriginMeta(e){return{url:e.originSrc}}workURL(){return/manhuagui.com\/comic\/\d+\/?$/}async fetchChapters(){const e=document.querySelector(".book-cover img")?.src,t=[];return document.querySelectorAll(".chapter-list").forEach(i=>{let n=Oi(i,"prev",r=>r.tagName.toLowerCase()==="h4")?.firstElementChild?.textContent??void 0;n=n?n+"-":"",i.querySelectorAll("ul").forEach(r=>{const a=Array.from(r.querySelectorAll("li > a")).reverse().map(s=>({id:0,title:n+s.title,source:s.href,queue:[],thumbimg:e}));t.push(...a)})}),t.forEach((i,n)=>i.id=n+1),t}}function Oi(o,e,t){const i=r=>r.previousElementSibling;let n=o;for(;n=i(n);)if(t(n))return n;return null}const zi=[{name:"\u81EA\u52A8",hosts:[{h:"i",w:.1},{h:"eu",w:5},{h:"eu1",w:5},{h:"us",w:1},{h:"us1",w:1},{h:"us2",w:1},{h:"us3",w:1}]},{name:"\u7535\u4FE1",hosts:[{h:"eu",w:1},{h:"eu1",w:1}]},{name:"\u8054\u901A",hosts:[{h:"us",w:1},{h:"us1",w:1},{h:"us2",w:1},{h:"us3",w:1}]}];function Fi(){const o=parseInt(window.localStorage.getItem("")??"0"),e=parseInt(window.localStorage.getItem("")??"0");return`https://${zi[o]?.hosts[e]?.h??"us1"}.hamreus.com`}const Hi=/\[(\d{4}-\d{2}-\d{2})\].*?\[(.*?)\]/,ji=/\('\w+\.\w+\((.*?)\).*?,(\d+),(\d+),'(.*?)'\[/;function Zi(o){return LZString.decompressFromBase64(o)}function Wi(o,e,t,i){const n=Zi(i).split("|"),r={};function a(l){const c=l<e?"":a(Math.floor(l/e)).toString(),d=(l=l%e)>35?String.fromCharCode(l+29):l.toString(36);return c+d}for(;t--;)r[a(t)]=n[t]||a(t);const s=o.replace(new RegExp("\\b\\w+\\b","g"),l=>r[l]);return JSON.parse(s)}class Xi extends M{map=new Map;name(){return"Mini Serve"}async fetchChapters(){const e=Array.from(document.querySelectorAll("table tbody a.file")),t=[];let i=0;for(const n of e){const r=n.href;r.split(".").pop()?.toLowerCase()==="zip"&&(t.push({id:i,title:n.textContent??"unknown-"+i,source:r,queue:[]}),i++)}if(t.length===0)throw new Error("can not found zip files");return t}async*fetchPagesSource(e){yield _.ok(e.source)}async parseImgNodes(e,t){const i=await window.fetch(e).then(s=>s.blob()),r=await new Q.ZipReader(new Q.BlobReader(i)).getEntries(),a=new Map;return this.map.set(t,a),r.filter(s=>{const l=s.filename.split(".").pop()??"jpg";return ke(l)||Se(l)}).map(s=>{const l=s.getData(new Q.BlobWriter);a.set(s.filename,l);const c=s.filename.split(".").pop()??"jpg",d=new L("",s.filename,s.filename,void 0);return ke(c)?d.mimeType="image/"+c:Se(c)&&(d.mimeType="video/"+c),d})}async fetchOriginMeta(e,t,i){const n=this.map.get(i)?.get(e.href);if(!n)throw new Error("cannot read image from zip");const r=await n;return{url:URL.createObjectURL(r)}}async processData(e,t,i){return[e,i.mimeType]}workURL(){return/.*:41021/}}class Ki extends M{meta;name(){return"My Comic"}workURL(){return/mycomic.com\/(\w+\/)?comics\/\d+$/}galleryMeta(e){return this.meta??super.galleryMeta(e)}initGalleryMeta(){const e=document.querySelector(".grow > div[data-flux-heading]")?.textContent??document.title;this.meta=new U(window.location.href,e)}async fetchChapters(){this.initGalleryMeta();const e=Array.from(document.querySelectorAll(".mt-8.mb-12 > div[x-data]")),t=[];for(const i of e){let n=i.getAttribute("x-data");n&&(n=n.replace(/,\n\s*toggleSorting\(\) \{.*?\},/gms,""),n=n.replaceAll(/(chapters|decending)/g,'"$1"'));const r=JSON.parse(n??"{}");let a=i.querySelector(".text-lg > div")?.textContent??"";if(a=a?a+"-":"",!r.chapters)continue;const s=r.chapters.map(l=>({id:l.id,title:a+l.title,source:`https://mycomic.com/cn/chapters/${l.id}`,queue:[]}));t.push(...s)}return t}async*fetchPagesSource(e){const t=await window.fetch(e.source).then(i=>i.text()).then(i=>new DOMParser().parseFromString(i,"text/html"));yield _.ok(t)}async parseImgNodes(e,t){const i=Array.from(e.querySelectorAll(".\\-mx-6 > img[x-ref]")),n=[],r=i.length.toString().length;for(let a=0;a<i.length;a++){const s=i[a],l=s.getAttribute("src")||s.getAttribute("data-src");if(!l){I("error","cannot find imgage src, ",s);continue}const c=l.split(".").pop(),d=(a+1).toString().padStart(r,"0")+"."+c;n.push(new L("",l,d,void 0,l,{w:s.width,h:s.height}))}return n}async fetchOriginMeta(e){return{url:e.originSrc}}}function W(o){return new Promise(e=>setTimeout(e,o))}function he(o){switch(o.slice(0,1)){case"j":return"jpg";case"g":return"gif";case"p":return"png";case"w":return"webp";case"a":return"avif";case"m":return"mp4";default:throw new Error("cannot parse image extension from info: "+o)}}class Yi extends M{meta;name(){return"nhentai"}workURL(){return/nhentai.net\/g\/\d+\/?$/}galleryMeta(){return this.meta}parseInfo(){const e=Array.from(document.querySelectorAll("body > script")).find(r=>r.textContent?.trim()?.startsWith("window._n_app"))?.textContent?.match(/media_server:\s?(\d+)/)?.[1];if(!e)throw new Error("cannot find media server");const t=Array.from(document.querySelectorAll("body > script")).find(r=>r.textContent?.trim()?.startsWith("window._gallery"))?.textContent?.match(/parse\((.*)\);/)?.[1];if(!t)throw new Error("cannot find images info");const i=JSON.parse(JSON.parse(t)),n=new U(window.location.href,i.title.english);return n.originTitle=i.title.japanese,n.tags=i.tags.reduce((r,a)=>(r[a.type]||(r[a.type]=[]),r[a.type].push(a.name),r),{}),this.meta=n,{info:i,mediaServer:e}}async fetchOriginMeta(e){return{url:e.originSrc}}async parseImgNodes(e){await W(200);const t=Array.from(e.querySelectorAll(".thumb-container > .gallerythumb")??[]);if(t.length==0)throw new Error("cannot find image nodes");const{info:i,mediaServer:n}=this.parseInfo(),r=i.media_id,a=t.length.toString().length,s=[];for(let l=0;l<t.length;l++){const c=t[l],d=c.querySelector("img")?.getAttribute("data-src")??"",h=(l+1).toString().padStart(a,"0"),p=he(i.images.pages[l].t),g=location.origin+c.getAttribute("href"),m=`${window.location.origin.replace("//","//i"+n+".")}/galleries/${r}/${l+1}.${p}`,b={w:i.images.pages[l].w,h:i.images.pages[l].h};s.push(new L(d,g,h+"."+p,void 0,m,b))}return s}async*fetchPagesSource(){yield _.ok(document)}}class Ji extends M{meta;galleryMeta(){return this.meta}name(){return"nhentai.xxx"}parseMeta(){const e=document.querySelector(".info h1")?.textContent,t=document.querySelector(".info h2")?.textContent,i=new U(window.location.href,e??document.title);i.originTitle=t??void 0,Array.from(document.querySelectorAll(".info > ul > li.tags")).forEach(n=>{let r=n.querySelector("span.text")?.textContent??"misc";r=r.trim().replace(":","");const a=Array.from(n.querySelectorAll("a.tag_btn > .tag_name")).map(s=>s.textContent?.trim()).filter(Boolean);i.tags[r]=a}),this.meta=i}async*fetchPagesSource(){this.parseMeta(),yield _.ok(document)}async parseImgNodes(e){const t=e;await W(200);const[i,n]=this.parseInfo(t);if(i.length!==n.length)throw new Error("thumbs length not eq images length");const r=t.querySelector(".cover img")?.src;if(!r)throw new Error("cannot find cover src");const a=r.slice(0,r.lastIndexOf("/")+1),s=[],l=i.length.toString().length;let c=window.location.href;c.endsWith("/")&&(c=c.slice(0,-1));for(let d=0;d<i.length;d++){const h=(d+1).toString().padStart(l,"0"),p=n[d],g=a+p[0]+"."+he(p[1]),m=i[d],b=a+m[0]+"."+he(m[1]),y=m[1].split(",");let v;y.length===3&&(v={w:parseInt(y[1].trim()),h:parseInt(y[2].trim())}),s.push(new L(g,c+"/"+(d+1),h+"."+he(m[1]),void 0,b,v))}return s}parseInfo(e){const t=Array.from(e.querySelectorAll("script[type]")).find(a=>a.textContent?.trimStart().startsWith("var g_th"))?.textContent?.match(/\('(.*)'\);/);if(!t||t.length!==2)throw new Error("cannot find images info from script");const i=JSON.parse(t[1]),n=Object.entries(i.fl),r=Object.entries(i.th);return[n,r]}async fetchOriginMeta(e){return{url:e.originSrc}}workURL(){return/nhentai.xxx\/g\/\d+\/?$/}}var P;(function(o){o.LOAD="LOAD",o.EXEC="EXEC",o.FFPROBE="FFPROBE",o.WRITE_FILE="WRITE_FILE",o.READ_FILE="READ_FILE",o.DELETE_FILE="DELETE_FILE",o.RENAME="RENAME",o.CREATE_DIR="CREATE_DIR",o.LIST_DIR="LIST_DIR",o.DELETE_DIR="DELETE_DIR",o.ERROR="ERROR",o.DOWNLOAD="DOWNLOAD",o.PROGRESS="PROGRESS",o.LOG="LOG",o.MOUNT="MOUNT",o.UNMOUNT="UNMOUNT"})(P||(P={}));const Qi=(()=>{let o=0;return()=>o++})(),en=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),tn=new Error("called FFmpeg.terminate()"),nn="KGZ1bmN0aW9uICgpIHsKICAgICd1c2Ugc3RyaWN0JzsKCiAgICBjb25zdCBDT1JFX1ZFUlNJT04gPSAiMC4xMi42IjsKICAgIGNvbnN0IENPUkVfVVJMID0gYGh0dHBzOi8vdW5wa2cuY29tL0BmZm1wZWcvY29yZUAke0NPUkVfVkVSU0lPTn0vZGlzdC91bWQvZmZtcGVnLWNvcmUuanNgOwogICAgdmFyIEZGTWVzc2FnZVR5cGU7CiAgICAoZnVuY3Rpb24gKEZGTWVzc2FnZVR5cGUpIHsKICAgICAgICBGRk1lc3NhZ2VUeXBlWyJMT0FEIl0gPSAiTE9BRCI7CiAgICAgICAgRkZNZXNzYWdlVHlwZVsiRVhFQyJdID0gIkVYRUMiOwogICAgICAgIEZGTWVzc2FnZVR5cGVbIldSSVRFX0ZJTEUiXSA9ICJXUklURV9GSUxFIjsKICAgICAgICBGRk1lc3NhZ2VUeXBlWyJSRUFEX0ZJTEUiXSA9ICJSRUFEX0ZJTEUiOwogICAgICAgIEZGTWVzc2FnZVR5cGVbIkRFTEVURV9GSUxFIl0gPSAiREVMRVRFX0ZJTEUiOwogICAgICAgIEZGTWVzc2FnZVR5cGVbIlJFTkFNRSJdID0gIlJFTkFNRSI7CiAgICAgICAgRkZNZXNzYWdlVHlwZVsiQ1JFQVRFX0RJUiJdID0gIkNSRUFURV9ESVIiOwogICAgICAgIEZGTWVzc2FnZVR5cGVbIkxJU1RfRElSIl0gPSAiTElTVF9ESVIiOwogICAgICAgIEZGTWVzc2FnZVR5cGVbIkRFTEVURV9ESVIiXSA9ICJERUxFVEVfRElSIjsKICAgICAgICBGRk1lc3NhZ2VUeXBlWyJFUlJPUiJdID0gIkVSUk9SIjsKICAgICAgICBGRk1lc3NhZ2VUeXBlWyJET1dOTE9BRCJdID0gIkRPV05MT0FEIjsKICAgICAgICBGRk1lc3NhZ2VUeXBlWyJQUk9HUkVTUyJdID0gIlBST0dSRVNTIjsKICAgICAgICBGRk1lc3NhZ2VUeXBlWyJMT0ciXSA9ICJMT0ciOwogICAgICAgIEZGTWVzc2FnZVR5cGVbIk1PVU5UIl0gPSAiTU9VTlQiOwogICAgICAgIEZGTWVzc2FnZVR5cGVbIlVOTU9VTlQiXSA9ICJVTk1PVU5UIjsKICAgIH0pKEZGTWVzc2FnZVR5cGUgfHwgKEZGTWVzc2FnZVR5cGUgPSB7fSkpOwoKICAgIGNvbnN0IEVSUk9SX1VOS05PV05fTUVTU0FHRV9UWVBFID0gbmV3IEVycm9yKCJ1bmtub3duIG1lc3NhZ2UgdHlwZSIpOwogICAgY29uc3QgRVJST1JfTk9UX0xPQURFRCA9IG5ldyBFcnJvcigiZmZtcGVnIGlzIG5vdCBsb2FkZWQsIGNhbGwgYGF3YWl0IGZmbXBlZy5sb2FkKClgIGZpcnN0Iik7CiAgICBjb25zdCBFUlJPUl9JTVBPUlRfRkFJTFVSRSA9IG5ldyBFcnJvcigiZmFpbGVkIHRvIGltcG9ydCBmZm1wZWctY29yZS5qcyIpOwoKICAgIC8vLyA8cmVmZXJlbmNlIG5vLWRlZmF1bHQtbGliPSJ0cnVlIiAvPgogICAgLy8vIDxyZWZlcmVuY2UgbGliPSJlc25leHQiIC8+CiAgICAvLy8gPHJlZmVyZW5jZSBsaWI9IndlYndvcmtlciIgLz4KICAgIGxldCBmZm1wZWc7CiAgICBjb25zdCBsb2FkID0gYXN5bmMgKHsgY29yZVVSTDogX2NvcmVVUkwsIHdhc21VUkw6IF93YXNtVVJMLCB3b3JrZXJVUkw6IF93b3JrZXJVUkwsIH0pID0+IHsKICAgICAgICBjb25zdCBmaXJzdCA9ICFmZm1wZWc7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKCFfY29yZVVSTCkKICAgICAgICAgICAgICAgIF9jb3JlVVJMID0gQ09SRV9VUkw7CiAgICAgICAgICAgIC8vIHdoZW4gd2ViIHdvcmtlciB0eXBlIGlzIGBjbGFzc2ljYC4KICAgICAgICAgICAgaW1wb3J0U2NyaXB0cyhfY29yZVVSTCk7CiAgICAgICAgfQogICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgaWYgKCFfY29yZVVSTCkKICAgICAgICAgICAgICAgIF9jb3JlVVJMID0gQ09SRV9VUkwucmVwbGFjZSgnL3VtZC8nLCAnL2VzbS8nKTsKICAgICAgICAgICAgLy8gd2hlbiB3ZWIgd29ya2VyIHR5cGUgaXMgYG1vZHVsZWAuCiAgICAgICAgICAgIHNlbGYuY3JlYXRlRkZtcGVnQ29yZSA9IChhd2FpdCBpbXBvcnQoCiAgICAgICAgICAgIC8qIHdlYnBhY2tJZ25vcmU6IHRydWUgKi8gLyogQHZpdGUtaWdub3JlICovIF9jb3JlVVJMKSkuZGVmYXVsdDsKICAgICAgICAgICAgaWYgKCFzZWxmLmNyZWF0ZUZGbXBlZ0NvcmUpIHsKICAgICAgICAgICAgICAgIHRocm93IEVSUk9SX0lNUE9SVF9GQUlMVVJFOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNvbnN0IGNvcmVVUkwgPSBfY29yZVVSTDsKICAgICAgICBjb25zdCB3YXNtVVJMID0gX3dhc21VUkwgPyBfd2FzbVVSTCA6IF9jb3JlVVJMLnJlcGxhY2UoLy5qcyQvZywgIi53YXNtIik7CiAgICAgICAgY29uc3Qgd29ya2VyVVJMID0gX3dvcmtlclVSTAogICAgICAgICAgICA/IF93b3JrZXJVUkwKICAgICAgICAgICAgOiBfY29yZVVSTC5yZXBsYWNlKC8uanMkL2csICIud29ya2VyLmpzIik7CiAgICAgICAgZmZtcGVnID0gYXdhaXQgc2VsZi5jcmVhdGVGRm1wZWdDb3JlKHsKICAgICAgICAgICAgLy8gRml4IGBPdmVybG9hZCByZXNvbHV0aW9uIGZhaWxlZC5gIHdoZW4gdXNpbmcgbXVsdGktdGhyZWFkZWQgZmZtcGVnLWNvcmUuCiAgICAgICAgICAgIC8vIEVuY29kZWQgd2FzbVVSTCBhbmQgd29ya2VyVVJMIGluIHRoZSBVUkwgYXMgYSBoYWNrIHRvIGZpeCBsb2NhdGVGaWxlIGlzc3VlLgogICAgICAgICAgICBtYWluU2NyaXB0VXJsT3JCbG9iOiBgJHtjb3JlVVJMfSMke2J0b2EoSlNPTi5zdHJpbmdpZnkoeyB3YXNtVVJMLCB3b3JrZXJVUkwgfSkpfWAsCiAgICAgICAgfSk7CiAgICAgICAgZmZtcGVnLnNldExvZ2dlcigoZGF0YSkgPT4gc2VsZi5wb3N0TWVzc2FnZSh7IHR5cGU6IEZGTWVzc2FnZVR5cGUuTE9HLCBkYXRhIH0pKTsKICAgICAgICBmZm1wZWcuc2V0UHJvZ3Jlc3MoKGRhdGEpID0+IHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgICAgICB0eXBlOiBGRk1lc3NhZ2VUeXBlLlBST0dSRVNTLAogICAgICAgICAgICBkYXRhLAogICAgICAgIH0pKTsKICAgICAgICByZXR1cm4gZmlyc3Q7CiAgICB9OwogICAgY29uc3QgZXhlYyA9ICh7IGFyZ3MsIHRpbWVvdXQgPSAtMSB9KSA9PiB7CiAgICAgICAgZmZtcGVnLnNldFRpbWVvdXQodGltZW91dCk7CiAgICAgICAgZmZtcGVnLmV4ZWMoLi4uYXJncyk7CiAgICAgICAgY29uc3QgcmV0ID0gZmZtcGVnLnJldDsKICAgICAgICBmZm1wZWcucmVzZXQoKTsKICAgICAgICByZXR1cm4gcmV0OwogICAgfTsKICAgIGNvbnN0IHdyaXRlRmlsZSA9ICh7IHBhdGgsIGRhdGEgfSkgPT4gewogICAgICAgIGZmbXBlZy5GUy53cml0ZUZpbGUocGF0aCwgZGF0YSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9OwogICAgY29uc3QgcmVhZEZpbGUgPSAoeyBwYXRoLCBlbmNvZGluZyB9KSA9PiBmZm1wZWcuRlMucmVhZEZpbGUocGF0aCwgeyBlbmNvZGluZyB9KTsKICAgIC8vIFRPRE86IGNoZWNrIGlmIGRlbGV0aW9uIHdvcmtzLgogICAgY29uc3QgZGVsZXRlRmlsZSA9ICh7IHBhdGggfSkgPT4gewogICAgICAgIGZmbXBlZy5GUy51bmxpbmsocGF0aCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9OwogICAgY29uc3QgcmVuYW1lID0gKHsgb2xkUGF0aCwgbmV3UGF0aCB9KSA9PiB7CiAgICAgICAgZmZtcGVnLkZTLnJlbmFtZShvbGRQYXRoLCBuZXdQYXRoKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH07CiAgICAvLyBUT0RPOiBjaGVjayBpZiBjcmVhdGlvbiB3b3Jrcy4KICAgIGNvbnN0IGNyZWF0ZURpciA9ICh7IHBhdGggfSkgPT4gewogICAgICAgIGZmbXBlZy5GUy5ta2RpcihwYXRoKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH07CiAgICBjb25zdCBsaXN0RGlyID0gKHsgcGF0aCB9KSA9PiB7CiAgICAgICAgY29uc3QgbmFtZXMgPSBmZm1wZWcuRlMucmVhZGRpcihwYXRoKTsKICAgICAgICBjb25zdCBub2RlcyA9IFtdOwogICAgICAgIGZvciAoY29uc3QgbmFtZSBvZiBuYW1lcykgewogICAgICAgICAgICBjb25zdCBzdGF0ID0gZmZtcGVnLkZTLnN0YXQoYCR7cGF0aH0vJHtuYW1lfWApOwogICAgICAgICAgICBjb25zdCBpc0RpciA9IGZmbXBlZy5GUy5pc0RpcihzdGF0Lm1vZGUpOwogICAgICAgICAgICBub2Rlcy5wdXNoKHsgbmFtZSwgaXNEaXIgfSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBub2RlczsKICAgIH07CiAgICAvLyBUT0RPOiBjaGVjayBpZiBkZWxldGlvbiB3b3Jrcy4KICAgIGNvbnN0IGRlbGV0ZURpciA9ICh7IHBhdGggfSkgPT4gewogICAgICAgIGZmbXBlZy5GUy5ybWRpcihwYXRoKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH07CiAgICBjb25zdCBtb3VudCA9ICh7IGZzVHlwZSwgb3B0aW9ucywgbW91bnRQb2ludCB9KSA9PiB7CiAgICAgICAgY29uc3Qgc3RyID0gZnNUeXBlOwogICAgICAgIGNvbnN0IGZzID0gZmZtcGVnLkZTLmZpbGVzeXN0ZW1zW3N0cl07CiAgICAgICAgaWYgKCFmcykKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGZmbXBlZy5GUy5tb3VudChmcywgb3B0aW9ucywgbW91bnRQb2ludCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9OwogICAgY29uc3QgdW5tb3VudCA9ICh7IG1vdW50UG9pbnQgfSkgPT4gewogICAgICAgIGZmbXBlZy5GUy51bm1vdW50KG1vdW50UG9pbnQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfTsKICAgIHNlbGYub25tZXNzYWdlID0gYXN5bmMgKHsgZGF0YTogeyBpZCwgdHlwZSwgZGF0YTogX2RhdGEgfSwgfSkgPT4gewogICAgICAgIGNvbnN0IHRyYW5zID0gW107CiAgICAgICAgbGV0IGRhdGE7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKHR5cGUgIT09IEZGTWVzc2FnZVR5cGUuTE9BRCAmJiAhZmZtcGVnKQogICAgICAgICAgICAgICAgdGhyb3cgRVJST1JfTk9UX0xPQURFRDsgLy8gZXNsaW50LWRpc2FibGUtbGluZQogICAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgICAgICAgICAgIGNhc2UgRkZNZXNzYWdlVHlwZS5MT0FEOgogICAgICAgICAgICAgICAgICAgIGRhdGEgPSBhd2FpdCBsb2FkKF9kYXRhKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRkZNZXNzYWdlVHlwZS5FWEVDOgogICAgICAgICAgICAgICAgICAgIGRhdGEgPSBleGVjKF9kYXRhKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRkZNZXNzYWdlVHlwZS5XUklURV9GSUxFOgogICAgICAgICAgICAgICAgICAgIGRhdGEgPSB3cml0ZUZpbGUoX2RhdGEpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBGRk1lc3NhZ2VUeXBlLlJFQURfRklMRToKICAgICAgICAgICAgICAgICAgICBkYXRhID0gcmVhZEZpbGUoX2RhdGEpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBGRk1lc3NhZ2VUeXBlLkRFTEVURV9GSUxFOgogICAgICAgICAgICAgICAgICAgIGRhdGEgPSBkZWxldGVGaWxlKF9kYXRhKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRkZNZXNzYWdlVHlwZS5SRU5BTUU6CiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHJlbmFtZShfZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEZGTWVzc2FnZVR5cGUuQ1JFQVRFX0RJUjoKICAgICAgICAgICAgICAgICAgICBkYXRhID0gY3JlYXRlRGlyKF9kYXRhKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRkZNZXNzYWdlVHlwZS5MSVNUX0RJUjoKICAgICAgICAgICAgICAgICAgICBkYXRhID0gbGlzdERpcihfZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEZGTWVzc2FnZVR5cGUuREVMRVRFX0RJUjoKICAgICAgICAgICAgICAgICAgICBkYXRhID0gZGVsZXRlRGlyKF9kYXRhKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRkZNZXNzYWdlVHlwZS5NT1VOVDoKICAgICAgICAgICAgICAgICAgICBkYXRhID0gbW91bnQoX2RhdGEpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBGRk1lc3NhZ2VUeXBlLlVOTU9VTlQ6CiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHVubW91bnQoX2RhdGEpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICB0aHJvdyBFUlJPUl9VTktOT1dOX01FU1NBR0VfVFlQRTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjYXRjaCAoZSkgewogICAgICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgICAgIGlkLAogICAgICAgICAgICAgICAgdHlwZTogRkZNZXNzYWdlVHlwZS5FUlJPUiwKICAgICAgICAgICAgICAgIGRhdGE6IGUudG9TdHJpbmcoKSwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7CiAgICAgICAgICAgIHRyYW5zLnB1c2goZGF0YS5idWZmZXIpOwogICAgICAgIH0KICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsgaWQsIHR5cGUsIGRhdGEgfSwgdHJhbnMpOwogICAgfTsKCn0pKCk7Cg==",rn=o=>Uint8Array.from(atob(o),e=>e.charCodeAt(0)),an=URL.createObjectURL(new Blob([rn(nn)],{type:"text/javascript"}));class on{#t=null;#n={};#i={};#r=[];#a=[];loaded=!1;#o=()=>{this.#t&&(this.#t.onmessage=({data:{id:e,type:t,data:i}})=>{switch(t){case P.LOAD:this.loaded=!0,this.#n[e](i);break;case P.MOUNT:case P.UNMOUNT:case P.EXEC:case P.FFPROBE:case P.WRITE_FILE:case P.READ_FILE:case P.DELETE_FILE:case P.RENAME:case P.CREATE_DIR:case P.LIST_DIR:case P.DELETE_DIR:this.#n[e](i);break;case P.LOG:this.#r.forEach(n=>n(i));break;case P.PROGRESS:this.#a.forEach(n=>n(i));break;case P.ERROR:this.#i[e](i);break}delete this.#n[e],delete this.#i[e]})};#e=({type:e,data:t},i=[],n)=>this.#t?new Promise((r,a)=>{const s=Qi();this.#t&&this.#t.postMessage({id:s,type:e,data:t},i),this.#n[s]=r,this.#i[s]=a,n?.addEventListener("abort",()=>{a(new DOMException(`Message # ${s} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(en);on(e,t){e==="log"?this.#r.push(t):e==="progress"&&this.#a.push(t)}off(e,t){e==="log"?this.#r=this.#r.filter(i=>i!==t):e==="progress"&&(this.#a=this.#a.filter(i=>i!==t))}load=({classWorkerURL:e,...t}={},{signal:i}={})=>(this.#t||(this.#t=e?new Worker(new URL(e,J&&J.tagName.toUpperCase()==="SCRIPT"&&J.src||new URL("__entry.js",document.baseURI).href),{type:"module"}):new Worker(new URL(an,J&&J.tagName.toUpperCase()==="SCRIPT"&&J.src||new URL("__entry.js",document.baseURI).href),{type:"module"}),this.#o()),this.#e({type:P.LOAD,data:t},void 0,i));exec=(e,t=-1,{signal:i}={})=>this.#e({type:P.EXEC,data:{args:e,timeout:t}},void 0,i);ffprobe=(e,t=-1,{signal:i}={})=>this.#e({type:P.FFPROBE,data:{args:e,timeout:t}},void 0,i);terminate=()=>{const e=Object.keys(this.#i);for(const t of e)this.#i[t](tn),delete this.#i[t],delete this.#n[t];this.#t&&(this.#t.terminate(),this.#t=null,this.loaded=!1)};writeFile=(e,t,{signal:i}={})=>{const n=[];return t instanceof Uint8Array&&n.push(t.buffer),this.#e({type:P.WRITE_FILE,data:{path:e,data:t}},n,i)};mount=(e,t,i)=>{const n=[];return this.#e({type:P.MOUNT,data:{fsType:e,options:t,mountPoint:i}},n)};unmount=e=>{const t=[];return this.#e({type:P.UNMOUNT,data:{mountPoint:e}},t)};readFile=(e,t="binary",{signal:i}={})=>this.#e({type:P.READ_FILE,data:{path:e,encoding:t}},void 0,i);deleteFile=(e,{signal:t}={})=>this.#e({type:P.DELETE_FILE,data:{path:e}},void 0,t);rename=(e,t,{signal:i}={})=>this.#e({type:P.RENAME,data:{oldPath:e,newPath:t}},void 0,i);createDir=(e,{signal:t}={})=>this.#e({type:P.CREATE_DIR,data:{path:e}},void 0,t);listDir=(e,{signal:t}={})=>this.#e({type:P.LIST_DIR,data:{path:e}},void 0,t);deleteDir=(e,{signal:t}={})=>this.#e({type:P.DELETE_DIR,data:{path:e}},void 0,t)}var Qe;(function(o){o.MEMFS="MEMFS",o.NODEFS="NODEFS",o.NODERAWFS="NODERAWFS",o.IDBFS="IDBFS",o.WORKERFS="WORKERFS",o.PROXYFS="PROXYFS"})(Qe||(Qe={}));const sn=new Error("failed to get response body reader"),ln=new Error("failed to complete download"),cn="Content-Length",dn=async(o,e)=>{const t=await fetch(o);let i;try{const n=parseInt(t.headers.get(cn)||"-1"),r=t.body?.getReader();if(!r)throw sn;const a=[];let s=0;for(;;){const{done:d,value:h}=await r.read(),p=h?h.length:0;if(d){if(n!=-1&&n!==s)throw ln;e&&e({url:o,total:n,received:s,delta:p,done:d});break}a.push(h),s+=p,e&&e({url:o,total:n,received:s,delta:p,done:d})}const l=new Uint8Array(s);let c=0;for(const d of a)l.set(d,c),c+=d.length;i=l.buffer}catch(n){console.log("failed to send download progress event: ",n),i=await t.arrayBuffer()}return i},et=async(o,e,t=!1,i)=>{const n=t?await dn(o,i):await(await fetch(o)).arrayBuffer(),r=new Blob([n],{type:e});return URL.createObjectURL(r)};class hn{coreURL;wasmURL;ffmpeg;size=0;maxSize=14e7;taskCount=0;reloadLock=!1;async init(){const e="https://unpkg.com/@ffmpeg/core@0.12.6/dist/esm";return this.coreURL=await et(`${e}/ffmpeg-core.js`,"text/javascript"),this.wasmURL=await et(`${e}/ffmpeg-core.wasm`,"application/wasm"),this.ffmpeg=new on,await this.load(),this}async load(){await this.ffmpeg.load({coreURL:this.coreURL,wasmURL:this.wasmURL})}async check(){if(!this.coreURL||!this.wasmURL||!this.ffmpeg)throw new Error("FFmpegConvertor not init");if(this.size>this.maxSize){const e=this.reloadLock;if(await this.waitForTaskZero(),this.reloadLock)await this.waitForReloadLock();else{this.reloadLock=!0;try{I("info","FFmpegConvertor: size limit exceeded, terminate ffmpeg, verLock: ",e),this.ffmpeg.terminate(),await this.load(),this.size=0,this.taskCount=0}finally{this.reloadLock=!1}}}}async writeFiles(e,t){const i=this.ffmpeg;await Promise.all(e.map(async n=>{this.size+=n.data.byteLength,await i.writeFile(t+n.name,n.data)}))}async readOutputFile(e){const t=await this.ffmpeg.readFile(e);return this.size+=t.length,t}async convertTo(e,t,i){await this.check(),this.taskCount++;try{const n=this.ffmpeg,r=Math.random().toString(36).substring(7);await this.writeFiles(e,r);let a;i?a=i.map(h=>`file '${r}${h.file}'
duration ${h.delay/1e3}`).join(`
`):a=e.map(h=>`file '${r}${h.name}'
duration 0.04`).join(`
`),await n.writeFile(r+"meta.txt",a);let s,l;switch(t){case"GIF":s=r+"output.gif",l="image/gif",await n.exec(["-f","concat","-safe","0","-i",r+"meta.txt","-vf","split[a][b];[a]palettegen=stats_mode=diff[p];[b][p]paletteuse=dither=bayer:bayer_scale=2",s]);break;case"MP4":s=r+"output.mp4",l="video/mp4",await n.exec(["-f","concat","-safe","0","-i",r+"meta.txt","-c:v","h264","-pix_fmt","yuv420p",s]);break}const c=await this.readOutputFile(s),d=e.map(h=>n.deleteFile(r+h.name));return i&&d.push(n.deleteFile(r+"meta.txt")),d.push(n.deleteFile(s)),await Promise.all(d),new Blob([c],{type:l})}finally{this.taskCount--}}async waitForTaskZero(){for(;this.taskCount>0;)await new Promise(e=>setTimeout(e,100));await new Promise(e=>setTimeout(e,Math.random()*100+10))}async waitForReloadLock(){for(;this.reloadLock;)await new Promise(e=>setTimeout(e,100));await new Promise(e=>setTimeout(e,Math.random()*100+10))}}class un{homeData;thumbnails={};pids={};async fetchChapters(){const{error:e,body:t}=await window.fetch("https://www.pixiv.net/ajax/top/illust?mode=all&lang=en").then(a=>a.json());if(e)throw new Error("fetch your home data error, check you have already logged in");this.homeData=t,this.thumbnails=t.thumbnails.illust.reduce((a,s)=>(a[s.id]=s,a),{});const i=[],n=t.page.recommendByTag.reduce((a,s)=>(a[s.tag]=s.ids,a),{});this.pids={follow:t.page.follow.map(a=>a.toString()),"for you":t.page.recommend.ids,...n};let r=0;for(const[a,s]of Object.entries(this.pids))i.push({id:r,title:a==="follow"?"Your Following":"Recommend "+a,source:a,thumbimg:this.thumbnails[s[0]??""]?.url,queue:[]}),r++;return i}async*next(e){const t=this.pids[e.source];if(t.length===0){yield _.ok([]);return}for(;t.length>0;){const n=t.splice(0,20).reduce((a,s)=>{const l=this.thumbnails[s]?.userId??"unk";return a[l]||(a[l]=[]),a[l].push(s),a},{}),r=Object.entries(n).map(([a,s])=>({id:a==="unk"?void 0:a,pids:s}));yield _.ok(r)}}title(){return"home"}}class pn{first;author;title(){return this.author??"author"}async fetchChapters(){return[{id:1,title:"Default",source:window.location.href,queue:[]}]}async*next(e){if(this.author=mn(),!this.author)throw new Error("Cannot find author id!");if(this.first=window.location.href.match(/artworks\/(\d+)$/)?.[1],this.first)for(yield _.ok([{id:this.author,pids:[this.first]}]);u.pixivJustCurrPage;)yield _.ok([]);const t=await window.fetch(`https://www.pixiv.net/ajax/user/${this.author}/profile/all`).then(n=>n.json());if(t.error)throw new Error(`Fetch illust list error: ${t.message}`);let i=[...Object.keys(t.body.illusts),...Object.keys(t.body.manga)];if(i=i.sort((n,r)=>parseInt(r)-parseInt(n)),this.first){const n=i.indexOf(this.first);n>-1&&i.splice(n,1)}for(;i.length>0;){const n=i.splice(0,20);yield _.ok([{id:this.author,pids:n}])}}}const tt=/\/(\d+)_([a-z]+)\d*\.\w*$/;class gn extends M{name(){return"Pixiv"}api;meta;pageCount=0;works={};ugoiraMetas={};convertor;constructor(){super(),this.meta=new U(window.location.href,"UNTITLE"),/pixiv.net(\/en\/)?$/.test(window.location.href)?this.api=new un:this.api=new pn}async processData(e,t,i){const n=this.ugoiraMetas[i.originSrc];if(!n)return[e,t];const r=new Q.ZipReader(new Q.Uint8ArrayReader(e)),a=performance.now();this.convertor||(this.convertor=await new hn().init());const s=performance.now(),l=await r.getEntries().then(g=>g.map(m=>m.getData?.(new Q.Uint8ArrayWriter).then(b=>({name:m.filename,data:b})))),c=await Promise.all(l).then(g=>g.filter(m=>m&&m.data.length>0).map(m=>m)),d=performance.now();if(c.length!==n.body.frames.length)throw new Error("unpack ugoira file error: file count not equal to meta");const h=await this.convertor.convertTo(c,u.pixivConvertTo,n.body.frames),p=performance.now();return I("debug",`convert ugoira to ${u.pixivConvertTo}
init convertor cost: ${s-a}ms
unpack ugoira  cost: ${d-s}ms
ffmpeg convert cost: ${p-d}ms
total cost: ${(p-a)/1e3}s
size: ${h.size/1e3} KB, original size: ${e.byteLength/1e3} KB
before contentType: ${t}, after contentType: ${h.type}
`),h.arrayBuffer().then(g=>[new Uint8Array(g),h.type])}workURL(){return/pixiv.net\/(en\/)?(artworks\/.*|users\/.*|$)/}galleryMeta(){return this.meta.title=`pixiv_${this.api.title()}_w${Object.keys(this.works).length}_p${this.pageCount}`||"UNTITLE",this.meta.tags=Object.entries(this.works).reduce((e,t)=>(e[t[0]]=t[1].tags,e),{}),this.meta}async fetchTagsByPids(e,t){try{const n=await window.fetch(`https://www.pixiv.net/ajax/user/${e}/profile/illusts?ids[]=${t.join("&ids[]=")}&work_category=illustManga&is_first_page=0&lang=en`).then(r=>r.json());if(n.error)I("error","WARN: fetch tags by pids error: ",n.message);else{const r={};Object.entries(n.body.works).forEach(([a,s])=>{r[a]={id:s.id,title:s.title,alt:s.alt,illustType:s.illustType,description:s.description,tags:s.tags,pageCount:s.pageCount}}),this.works={...this.works,...r}}}catch(i){I("error","ERROR: fetch tags by pids error: ",i)}}fetchChapters(){return this.api.fetchChapters()}fetchPagesSource(e){return this.api.next(e)}async parseImgNodes(e){const t=[];if(e.length===0)return t;const i=[];for(const r of e)r.id&&this.fetchTagsByPids(r.id,r.pids),i.push(...r.pids);if(i.length===0)return t;i.sort((r,a)=>parseInt(a)-parseInt(r));const n=await we(i.map(r=>`https://www.pixiv.net/ajax/illust/${r}/pages?lang=en`),5,"json");for(let r=0;r<i.length;r++){const a=i[r],s=n[r];if(s instanceof Error||s.error){const d=`pid:[${a}], ${s.message}`;I("error",d),f.emit("notify-message","error",d,8e3);continue}this.pageCount+=s.body.length;const l=s.body.length.toString().length;let c=-1;for(const d of s.body){let h=d.urls.original.split("/").pop()||`${a}_p${c.toString().padStart(l)}.jpg`;const p=d.urls.original.match(tt);p&&p.length>2&&p[2]&&p[2]==="ugoira"&&(h=h.replace(/\.\w+$/,".gif")),c++;const g=new L(d.urls.small,`${window.location.origin}/artworks/${a}`,h,void 0,d.urls.original,{w:d.width,h:d.height});t.push(g)}}return t}async fetchOriginMeta(e){const t=e.originSrc.match(tt);if(!t||t.length<2)return{url:e.originSrc};const i=t[1],n=t[2];if(this.works[i]?.illustType===2||n==="ugoira"){const r=await window.fetch(`https://www.pixiv.net/ajax/illust/${i}/ugoira_meta?lang=en`).then(a=>a.json());return this.ugoiraMetas[r.body.src]=r,{url:r.body.src}}else return{url:e.originSrc}}}function mn(){const o=document.querySelector("a[data-gtm-value][href*='/users/']")?.href||document.querySelector("a.user-details-icon[href*='/users/']")?.href||window.location.href;return/users\/(\d+)/.exec(o)?.[1]}class fn extends M{name(){return"rokuhentai"}sprites=[];fetchedThumbnail=[];galleryId="";imgCount=0;workURL(){return/rokuhentai.com\/\w+$/}galleryMeta(){const e=document.querySelector(".site-manga-info__title-text")?.textContent||"UNTITLE",t=new U(window.location.href,e);t.originTitle=e;const i=document.querySelectorAll("div.mdc-chip .site-tag-count"),n={};return i.forEach(r=>{const a=r.getAttribute("data-tag")?.trim().split(":");if(a===void 0||a.length===0)return;const s=a[0];n[s]===void 0&&(n[s]=[]),n[s].push(a[1].replaceAll('"',""))}),t.tags=n,t}async fetchOriginMeta(e){return{url:e.originSrc}}async parseImgNodes(e){const t=[],i=this.imgCount.toString().length;for(let n=e[0];n<e[1];n++){let r="",a;this.sprites[n]?a=this.fetchThumbnail(n):r=`https://rokuhentai.com/_images/page-thumbnails/${this.galleryId}/${n}.jpg`;const s=`https://rokuhentai.com/_images/pages/${this.galleryId}/${n}.jpg`;t.push(new L(r,s,n.toString().padStart(i,"0")+".jpg",a,s))}return t}async*fetchPagesSource(){const e=document,t=parseInt(e.querySelector(".mdc-typography--caption")?.textContent||"");if(isNaN(t))throw new Error("error: failed query image count!");this.imgCount=t,this.galleryId=window.location.href.split("/").pop();const i=Array.from(e.querySelectorAll(".mdc-layout-grid__cell .site-page-card__media"));for(const n of i){this.fetchedThumbnail.push(void 0);const r=parseInt(n.getAttribute("data-offset-x")||""),a=parseInt(n.getAttribute("data-offset-y")||""),s=parseInt(n.getAttribute("data-width")||""),l=parseInt(n.getAttribute("data-height")||"");if(isNaN(r)||isNaN(a)||isNaN(s)||isNaN(l)){this.sprites.push(void 0);continue}const c=n.getAttribute("data-src");this.sprites.push({src:c,pos:{x:r,y:a,width:s,height:l}})}for(let n=0;n<this.imgCount;n+=20)yield _.ok([n,Math.min(n+20,this.imgCount)])}async fetchThumbnail(e){if(this.fetchedThumbnail[e])return this.fetchedThumbnail[e];const t=this.sprites[e].src,i=[];for(let r=e;r<this.imgCount&&t===this.sprites[r]?.src;r++)i.push(this.sprites[r].pos);const n=await Ye(t,i);for(let r=e;r<e+n.length;r++)this.fetchedThumbnail[r]=n[r-e];return this.fetchedThumbnail[e]}async processData(e){return[e,"image/jpeg"]}}const bn=/background-image:\surl\(.*?(h.*\/).*?\)/;class wn extends M{name(){return"Steam Screenshots"}workURL(){return/steamcommunity.com\/id\/[^/]+\/screenshots.*/}async fetchOriginMeta(e){let t="";try{if(t=await window.fetch(e.href).then(a=>a.text()),!t)throw new Error("[text] is empty")}catch(a){throw new Error(`Fetch source page error, expected [text]\uFF01 ${a}`)}const r=new DOMParser().parseFromString(t,"text/html").querySelector(".actualmediactn > a")?.getAttribute("href");if(!r)throw new Error("Cannot Query Steam original Image URL");return{url:r}}async parseImgNodes(e){const t=[],i=await window.fetch(e).then(r=>r.text()).then(r=>new DOMParser().parseFromString(r,"text/html"));if(!i)throw new Error("warn: steam matcher failed to get document from source page!");const n=i.querySelectorAll(".profile_media_item");if(!n||n.length==0)throw new Error("warn: failed query image nodes!");for(const r of Array.from(n)){const a=bn.exec(r.innerHTML)?.[1];if(!a)throw new Error(`Cannot Match Steam Image URL, Content: ${r.innerHTML}`);const s=new L(a,r.getAttribute("href"),r.getAttribute("data-publishedfileid")+".jpg");t.push(s)}return t}async*fetchPagesSource(){let e=-1;document.querySelectorAll(".pagingPageLink").forEach(i=>{e=Number(i.textContent)});const t=new URL(window.location.href);if(t.searchParams.set("view","grid"),e===-1){const i=await window.fetch(t.href).then(n=>n.text()).then(n=>new DOMParser().parseFromString(n,"text/html")).catch(()=>null);if(!i)throw new Error("warn: steam matcher failed to get document from source page!");i.querySelectorAll(".pagingPageLink").forEach(n=>e=Number(n.textContent))}if(e>0)for(let i=1;i<=e;i++)t.searchParams.set("p",i.toString()),yield _.ok(t.href);else yield _.ok(t.href)}parseGalleryMeta(){const t=new URL(window.location.href).searchParams.get("appid");return new U(window.location.href,"steam-"+t||"all")}}class vn{uuid=re();userID;fetchChapters(){return window.location.href.includes("/media")?[{id:1,title:"User Medias",source:window.location.href,queue:[],thumbimg:"https://pbs.twimg.com/profile_images/1683899100922511378/5lY42eHs_bigger.jpg"}]:[{id:0,title:"User Posts",source:window.location.href,queue:[],thumbimg:"https://pbs.twimg.com/profile_images/1683899100922511378/5lY42eHs_bigger.jpg"},{id:1,title:"User Media",source:window.location.href,queue:[],thumbimg:"https://pbs.twimg.com/profile_images/1683899100922511378/5lY42eHs_bigger.jpg"}]}async next(e,t){if(this.userID||(this.userID=An()),!this.userID)throw new Error("Cannot obatained User ID");let i="";if(e.id===0){const n=`{"userId":"${this.userID}","count":20,${t?'"cursor":"'+t+'",':""}"includePromotedContent":true,"withQuickPromoteEligibilityTweetFields":true,"withVoice":true}`;i=`${window.location.origin}/i/api/graphql/q6xj5bs0hapm9309hexA_g/UserTweets?variables=${encodeURIComponent(n)}&features=%7B%22rweb_video_screen_enabled%22%3Afalse%2C%22profile_label_improvements_pcf_label_in_post_enabled%22%3Atrue%2C%22rweb_tipjar_consumption_enabled%22%3Atrue%2C%22verified_phone_label_enabled%22%3Afalse%2C%22creator_subscriptions_tweet_preview_api_enabled%22%3Atrue%2C%22responsive_web_graphql_timeline_navigation_enabled%22%3Atrue%2C%22responsive_web_graphql_skip_user_profile_image_extensions_enabled%22%3Afalse%2C%22premium_content_api_read_enabled%22%3Afalse%2C%22communities_web_enable_tweet_community_results_fetch%22%3Atrue%2C%22c9s_tweet_anatomy_moderator_badge_enabled%22%3Atrue%2C%22responsive_web_grok_analyze_button_fetch_trends_enabled%22%3Afalse%2C%22responsive_web_grok_analyze_post_followups_enabled%22%3Atrue%2C%22responsive_web_jetfuel_frame%22%3Afalse%2C%22responsive_web_grok_share_attachment_enabled%22%3Atrue%2C%22articles_preview_enabled%22%3Atrue%2C%22responsive_web_edit_tweet_api_enabled%22%3Atrue%2C%22graphql_is_translatable_rweb_tweet_is_translatable_enabled%22%3Atrue%2C%22view_counts_everywhere_api_enabled%22%3Atrue%2C%22longform_notetweets_consumption_enabled%22%3Atrue%2C%22responsive_web_twitter_article_tweet_consumption_enabled%22%3Atrue%2C%22tweet_awards_web_tipping_enabled%22%3Afalse%2C%22responsive_web_grok_show_grok_translated_post%22%3Afalse%2C%22responsive_web_grok_analysis_button_from_backend%22%3Atrue%2C%22creator_subscriptions_quote_tweet_preview_enabled%22%3Afalse%2C%22freedom_of_speech_not_reach_fetch_enabled%22%3Atrue%2C%22standardized_nudges_misinfo%22%3Atrue%2C%22tweet_with_visibility_results_prefer_gql_limited_actions_policy_enabled%22%3Atrue%2C%22longform_notetweets_rich_text_read_enabled%22%3Atrue%2C%22longform_notetweets_inline_media_enabled%22%3Atrue%2C%22responsive_web_grok_image_annotation_enabled%22%3Atrue%2C%22responsive_web_enhance_cards_enabled%22%3Afalse%7D&fieldToggles=%7B%22withArticlePlainText%22%3Afalse%7D`}else{const n=`{"userId":"${this.userID}","count":20,${t?'"cursor":"'+t+'",':""}"includePromotedContent":false,"withClientEventToken":false,"withBirdwatchNotes":false,"withVoice":true,"withV2Timeline":true}`;i=`${window.location.origin}/i/api/graphql/aQQLnkexAl5z9ec_UgbEIA/UserMedia?variables=${encodeURIComponent(n)}&features=%7B%22rweb_tipjar_consumption_enabled%22%3Atrue%2C%22responsive_web_graphql_exclude_directive_enabled%22%3Atrue%2C%22verified_phone_label_enabled%22%3Afalse%2C%22creator_subscriptions_tweet_preview_api_enabled%22%3Atrue%2C%22responsive_web_graphql_timeline_navigation_enabled%22%3Atrue%2C%22responsive_web_graphql_skip_user_profile_image_extensions_enabled%22%3Afalse%2C%22communities_web_enable_tweet_community_results_fetch%22%3Atrue%2C%22c9s_tweet_anatomy_moderator_badge_enabled%22%3Atrue%2C%22articles_preview_enabled%22%3Atrue%2C%22tweetypie_unmention_optimization_enabled%22%3Atrue%2C%22responsive_web_edit_tweet_api_enabled%22%3Atrue%2C%22graphql_is_translatable_rweb_tweet_is_translatable_enabled%22%3Atrue%2C%22view_counts_everywhere_api_enabled%22%3Atrue%2C%22longform_notetweets_consumption_enabled%22%3Atrue%2C%22responsive_web_twitter_article_tweet_consumption_enabled%22%3Atrue%2C%22tweet_awards_web_tipping_enabled%22%3Afalse%2C%22creator_subscriptions_quote_tweet_preview_enabled%22%3Afalse%2C%22freedom_of_speech_not_reach_fetch_enabled%22%3Atrue%2C%22standardized_nudges_misinfo%22%3Atrue%2C%22tweet_with_visibility_results_prefer_gql_limited_actions_policy_enabled%22%3Atrue%2C%22tweet_with_visibility_results_prefer_gql_media_interstitial_enabled%22%3Atrue%2C%22rweb_video_timestamps_enabled%22%3Atrue%2C%22longform_notetweets_rich_text_read_enabled%22%3Atrue%2C%22longform_notetweets_inline_media_enabled%22%3Atrue%2C%22responsive_web_enhance_cards_enabled%22%3Afalse%7D&fieldToggles=%7B%22withArticlePlainText%22%3Afalse%7D`}try{const n=await window.fetch(i,{headers:Le(this.uuid),signal:AbortSignal.timeout(1e4)}),r=await n.json();if(n.status!==200&&r?.errors?.[0].message)throw new Error(r?.errors?.[0].message);if(e.id===0){const s=r.data.user.result.timeline.timeline.instructions.find(d=>d.type==="TimelineAddEntries");if(!s)throw new Error("Not found TimelineAddEntries");const{items:l,cursor:c}=Te(s);return[l,c]}else{const a=r.data.user.result.timeline_v2.timeline.instructions,s=[],l=a.find(h=>h.type==="TimelineAddToModule"),c=a.find(h=>h.type==="TimelineAddEntries");if(!c)throw new Error("Not found TimelineAddEntries");l&&l.moduleItems.forEach(h=>s.push(h.item)),s.length===0&&c.entries.find(p=>p.content.entryType==="TimelineTimelineModule")?.content?.items.forEach(p=>s.push(p.item));const d=c.entries.find(h=>h.content.entryType==="TimelineTimelineCursor"&&h.entryId.startsWith("cursor-bottom"))?.content?.value;return[s,d]}}catch(n){throw new Error(`twitter api query error: ${n}`)}}}class yn{uuid=re();listID;fetchChapters(){return[{id:1,title:"User Medias",source:window.location.href,queue:[]}]}getListID(){return window.location.href.match(/i\/lists\/(\d+)$/)?.[1]}async next(e,t){if(this.listID||(this.listID=this.getListID()),!this.listID)throw new Error("Cannot obatained list ID");const i=`{"listId":"${this.listID}","count":20${t?',"cursor":"'+t+'"':""}}`,r=`${window.location.origin}/i/api/graphql/LSefrrxhpeX8HITbKfWz9g/ListLatestTweetsTimeline?variables=${encodeURIComponent(i)}&features=%7B%22rweb_video_screen_enabled%22%3Afalse%2C%22profile_label_improvements_pcf_label_in_post_enabled%22%3Atrue%2C%22rweb_tipjar_consumption_enabled%22%3Atrue%2C%22responsive_web_graphql_exclude_directive_enabled%22%3Atrue%2C%22verified_phone_label_enabled%22%3Afalse%2C%22creator_subscriptions_tweet_preview_api_enabled%22%3Atrue%2C%22responsive_web_graphql_timeline_navigation_enabled%22%3Atrue%2C%22responsive_web_graphql_skip_user_profile_image_extensions_enabled%22%3Afalse%2C%22premium_content_api_read_enabled%22%3Afalse%2C%22communities_web_enable_tweet_community_results_fetch%22%3Atrue%2C%22c9s_tweet_anatomy_moderator_badge_enabled%22%3Atrue%2C%22responsive_web_grok_analyze_button_fetch_trends_enabled%22%3Afalse%2C%22responsive_web_grok_analyze_post_followups_enabled%22%3Atrue%2C%22responsive_web_jetfuel_frame%22%3Afalse%2C%22responsive_web_grok_share_attachment_enabled%22%3Atrue%2C%22articles_preview_enabled%22%3Atrue%2C%22responsive_web_edit_tweet_api_enabled%22%3Atrue%2C%22graphql_is_translatable_rweb_tweet_is_translatable_enabled%22%3Atrue%2C%22view_counts_everywhere_api_enabled%22%3Atrue%2C%22longform_notetweets_consumption_enabled%22%3Atrue%2C%22responsive_web_twitter_article_tweet_consumption_enabled%22%3Atrue%2C%22tweet_awards_web_tipping_enabled%22%3Afalse%2C%22responsive_web_grok_show_grok_translated_post%22%3Afalse%2C%22responsive_web_grok_analysis_button_from_backend%22%3Atrue%2C%22creator_subscriptions_quote_tweet_preview_enabled%22%3Afalse%2C%22freedom_of_speech_not_reach_fetch_enabled%22%3Atrue%2C%22standardized_nudges_misinfo%22%3Atrue%2C%22tweet_with_visibility_results_prefer_gql_limited_actions_policy_enabled%22%3Atrue%2C%22longform_notetweets_rich_text_read_enabled%22%3Atrue%2C%22longform_notetweets_inline_media_enabled%22%3Atrue%2C%22responsive_web_grok_image_annotation_enabled%22%3Atrue%2C%22responsive_web_enhance_cards_enabled%22%3Afalse%7D`;try{const a=await window.fetch(r,{headers:Le(this.uuid),signal:AbortSignal.timeout(1e4)}),s=await a.json();if(a.status!==200&&s?.errors?.[0].message)throw new Error(s?.errors?.[0].message);const c=s.data.list.tweets_timeline.timeline.instructions.find(p=>p.type==="TimelineAddEntries");if(!c)throw new Error("Not found TimelineAddEntries");const{items:d,cursor:h}=Te(c);return[d,h]}catch(a){throw new Error(`twitter api query error: ${a}`)}}}class Cn{uuid=re();seenTweetIds={1:[],2:[],3:[]};chapterCursors={1:void 0,2:void 0,3:void 0};myID;fetchChapters(){return[{id:1,title:"For you",source:window.location.href,queue:[],thumbimg:"https://pbs.twimg.com/profile_images/1683899100922511378/5lY42eHs_bigger.jpg"},{id:2,title:"Following",source:window.location.href,queue:[],thumbimg:"https://pbs.twimg.com/profile_images/1683899100922511378/5lY42eHs_bigger.jpg"},{id:3,title:"Your Likes",source:window.location.href,queue:[],thumbimg:"https://pbs.twimg.com/profile_images/1683899100922511378/5lY42eHs_bigger.jpg"}]}async next(e){const t=this.chapterCursors[e.id],i=this.seenTweetIds[e.id].map(s=>'"'+s+'"').join(","),n=Le(this.uuid),[r,a]=(()=>{if(e.id===1){const s=`${window.location.origin}/i/api/graphql/ci_OQZ2k0rG0Ax_lXRiWVA/HomeTimeline`,c=`{"variables":{"count":20,${t?`"cursor":"${t}",`:""}"includePromotedContent":true,"latestControlAvailable":true,"requestContext":"launch","withCommunity":true,"seenTweetIds":[${i}]},"features":{"rweb_video_screen_enabled":false,"profile_label_improvements_pcf_label_in_post_enabled":true,"rweb_tipjar_consumption_enabled":true,"responsive_web_graphql_exclude_directive_enabled":true,"verified_phone_label_enabled":false,"creator_subscriptions_tweet_preview_api_enabled":true,"responsive_web_graphql_timeline_navigation_enabled":true,"responsive_web_graphql_skip_user_profile_image_extensions_enabled":false,"premium_content_api_read_enabled":false,"communities_web_enable_tweet_community_results_fetch":true,"c9s_tweet_anatomy_moderator_badge_enabled":true,"responsive_web_grok_analyze_button_fetch_trends_enabled":false,"responsive_web_grok_analyze_post_followups_enabled":true,"responsive_web_jetfuel_frame":false,"responsive_web_grok_share_attachment_enabled":true,"articles_preview_enabled":true,"responsive_web_edit_tweet_api_enabled":true,"graphql_is_translatable_rweb_tweet_is_translatable_enabled":true,"view_counts_everywhere_api_enabled":true,"longform_notetweets_consumption_enabled":true,"responsive_web_twitter_article_tweet_consumption_enabled":true,"tweet_awards_web_tipping_enabled":false,"responsive_web_grok_show_grok_translated_post":false,"responsive_web_grok_analysis_button_from_backend":true,"creator_subscriptions_quote_tweet_preview_enabled":false,"freedom_of_speech_not_reach_fetch_enabled":true,"standardized_nudges_misinfo":true,"tweet_with_visibility_results_prefer_gql_limited_actions_policy_enabled":true,"longform_notetweets_rich_text_read_enabled":true,"longform_notetweets_inline_media_enabled":true,"responsive_web_grok_image_annotation_enabled":true,"responsive_web_enhance_cards_enabled":false},"queryId":"ci_OQZ2k0rG0Ax_lXRiWVA"}`;return[s,c]}else if(e.id===2){const s=`${window.location.origin}/i/api/graphql/nMyTQqsJiUGBKLGNSQamAA/HomeLatestTimeline`,c=`{"variables":{"count":20,${t?`"cursor":"${t}",`:""}"includePromotedContent":true,"latestControlAvailable":true,"seenTweetIds":[${i}]},"features":{"rweb_video_screen_enabled":false,"profile_label_improvements_pcf_label_in_post_enabled":true,"rweb_tipjar_consumption_enabled":true,"responsive_web_graphql_exclude_directive_enabled":true,"verified_phone_label_enabled":false,"creator_subscriptions_tweet_preview_api_enabled":true,"responsive_web_graphql_timeline_navigation_enabled":true,"responsive_web_graphql_skip_user_profile_image_extensions_enabled":false,"premium_content_api_read_enabled":false,"communities_web_enable_tweet_community_results_fetch":true,"c9s_tweet_anatomy_moderator_badge_enabled":true,"responsive_web_grok_analyze_button_fetch_trends_enabled":false,"responsive_web_grok_analyze_post_followups_enabled":true,"responsive_web_jetfuel_frame":false,"responsive_web_grok_share_attachment_enabled":true,"articles_preview_enabled":true,"responsive_web_edit_tweet_api_enabled":true,"graphql_is_translatable_rweb_tweet_is_translatable_enabled":true,"view_counts_everywhere_api_enabled":true,"longform_notetweets_consumption_enabled":true,"responsive_web_twitter_article_tweet_consumption_enabled":true,"tweet_awards_web_tipping_enabled":false,"responsive_web_grok_show_grok_translated_post":false,"responsive_web_grok_analysis_button_from_backend":true,"creator_subscriptions_quote_tweet_preview_enabled":false,"freedom_of_speech_not_reach_fetch_enabled":true,"standardized_nudges_misinfo":true,"tweet_with_visibility_results_prefer_gql_limited_actions_policy_enabled":true,"longform_notetweets_rich_text_read_enabled":true,"longform_notetweets_inline_media_enabled":true,"responsive_web_grok_image_annotation_enabled":true,"responsive_web_enhance_cards_enabled":false},"queryId":"nMyTQqsJiUGBKLGNSQamAA"}`;return[s,c]}else{if(this.myID||(this.myID=xn()),!this.myID)throw new Error("cannot find my id from current page");const s=t?`"cursor":"${t}",`:"",l=`{"userId":"${this.myID}","count":20,${s}"includePromotedContent":false,"withClientEventToken":false,"withBirdwatchNotes":false,"withVoice":true}`;return[`${window.location.origin}/i/api/graphql/uxjTlmrTI61zreSIV1urbw/Likes?variables=${encodeURIComponent(l)}&features=%7B%22rweb_video_screen_enabled%22%3Afalse%2C%22profile_label_improvements_pcf_label_in_post_enabled%22%3Atrue%2C%22rweb_tipjar_consumption_enabled%22%3Atrue%2C%22responsive_web_graphql_exclude_directive_enabled%22%3Atrue%2C%22verified_phone_label_enabled%22%3Afalse%2C%22creator_subscriptions_tweet_preview_api_enabled%22%3Atrue%2C%22responsive_web_graphql_timeline_navigation_enabled%22%3Atrue%2C%22responsive_web_graphql_skip_user_profile_image_extensions_enabled%22%3Afalse%2C%22premium_content_api_read_enabled%22%3Afalse%2C%22communities_web_enable_tweet_community_results_fetch%22%3Atrue%2C%22c9s_tweet_anatomy_moderator_badge_enabled%22%3Atrue%2C%22responsive_web_grok_analyze_button_fetch_trends_enabled%22%3Afalse%2C%22responsive_web_grok_analyze_post_followups_enabled%22%3Atrue%2C%22responsive_web_jetfuel_frame%22%3Afalse%2C%22responsive_web_grok_share_attachment_enabled%22%3Atrue%2C%22articles_preview_enabled%22%3Atrue%2C%22responsive_web_edit_tweet_api_enabled%22%3Atrue%2C%22graphql_is_translatable_rweb_tweet_is_translatable_enabled%22%3Atrue%2C%22view_counts_everywhere_api_enabled%22%3Atrue%2C%22longform_notetweets_consumption_enabled%22%3Atrue%2C%22responsive_web_twitter_article_tweet_consumption_enabled%22%3Atrue%2C%22tweet_awards_web_tipping_enabled%22%3Afalse%2C%22responsive_web_grok_show_grok_translated_post%22%3Afalse%2C%22responsive_web_grok_analysis_button_from_backend%22%3Atrue%2C%22creator_subscriptions_quote_tweet_preview_enabled%22%3Afalse%2C%22freedom_of_speech_not_reach_fetch_enabled%22%3Atrue%2C%22standardized_nudges_misinfo%22%3Atrue%2C%22tweet_with_visibility_results_prefer_gql_limited_actions_policy_enabled%22%3Atrue%2C%22longform_notetweets_rich_text_read_enabled%22%3Atrue%2C%22longform_notetweets_inline_media_enabled%22%3Atrue%2C%22responsive_web_grok_image_annotation_enabled%22%3Atrue%2C%22responsive_web_enhance_cards_enabled%22%3Afalse%7D&fieldToggles=%7B%22withArticlePlainText%22%3Afalse%7D`,""]}})();try{const s={};n.forEach((b,y)=>{s[y]=b});const l=await new Promise((b,y)=>{me({method:a?"POST":"GET",url:r,headers:s,data:a||void 0,timeout:2e4,onload:v=>b(v.response),ontimeout:()=>y("timeout"),onerror:v=>y(v)})}),c=JSON.parse(l);if(c?.errors?.[0].message)throw new Error(c?.errors?.[0].message);const h=(()=>{if(e.id===3){if(c?.data?.user?.result?.timeline_v2?.timeline?.instructions)return c.data.user.result.timeline_v2.timeline.instructions;if(c?.data?.user?.result?.timeline?.timeline?.instructions)return c.data.user.result.timeline.timeline.instructions;throw new Error("cannot found: json?.data?.user?.result?.timeline_v2?.timeline?.instructions")}else{if(!c?.data?.home?.home_timeline_urt?.instructions)throw new Error("cannot found: json?.data?.home?.home_timeline_urt?.instructions");return c.data.home.home_timeline_urt.instructions}})().find(b=>b.type==="TimelineAddEntries");if(!h)throw new Error("Not found TimelineAddEntries");const{items:p,ids:g,cursor:m}=Te(h);return this.seenTweetIds[e.id]=g,this.chapterCursors[e.id]=m,[p,m]}catch(s){throw new Error(`twitter api query error: ${s}`)}}}class In extends M{name(){return"Twitter | X"}postCount=0;mediaCount=0;api;constructor(){super(),/\/home$/.test(window.location.href)?this.api=new Cn:/i\/lists\/\d+$/.test(window.location.href)?this.api=new yn:this.api=new vn}async fetchChapters(){return this.api.fetchChapters()}async*fetchPagesSource(e){let t;for(;;)try{const[i,n]=await this.api.next(e,t);if(t=n||"last",!i||i.length===0||(yield _.ok(i),!n))break}catch(i){yield _.err(i)}}async parseImgNodes(e){if(!e)throw new Error("warn: cannot find items");const t=[];for(const i of e){const n=i?.itemContent?.tweet_results?.result?.legacy?.entities?.media||i?.itemContent?.tweet_results?.result?.tweet?.legacy?.entities?.media||i?.itemContent?.tweet_results?.result?.legacy?.retweeted_status_result?.result?.legacy?.entities?.media;if(n===void 0){const r=i.itemContent?.tweet_results?.result?.core?.user_results?.result?.legacy?.name,a=i.itemContent.tweet_results.result.rest_id;I("error",`cannot found mediaList: ${window.location.origin}/${r}/status/${a}`,i);continue}this.postCount++,u.reverseMultipleImagesPost&&n.reverse();for(let r=0;r<n.length;r++){const a=n[r];if(u.excludeVideo&&a.type==="video")continue;if(a.type!=="video"&&a.type!=="photo"&&a.type!=="animated_gif"){I("error",`Not supported media type: ${a.type}`);continue}const s=a.media_url_https.split(".").pop(),l=a.media_url_https.replace(`.${s}`,""),c=`${l}?format=${s}&name=${a.sizes.small?"small":"thumb"}`;let d=a.expanded_url.replace(/\/(photo|video)\/\d+/,"");d=`${d}/${a.type==="video"?"video":"photo"}/${r+1}`;const h=`${l}?format=${s}&name=${a.sizes.large?"large":a.sizes.medium?"medium":"small"}`,p=`${a.id_str}-${l.split("/").pop()}.${s}`,g={w:a.sizes.small.w,h:a.sizes.small.h},m=new L(c,d,p,void 0,h,g);if(a.video_info){let b=0;for(const y of a.video_info.variants)y.bitrate!==void 0&&y.bitrate>=b&&(b=y.bitrate,m.originSrc=y.url,m.mimeType=y.content_type,m.title=m.title.replace(/\.\w+$/,`.${y.content_type.split("/")[1]}`))}t.push(m),this.mediaCount++}}return t}async fetchOriginMeta(e){return{url:e.originSrc}}workURL(){return/(\/x|twitter).com\/(?!(explore|notifications|messages|jobs|lists)$|i\/(?!list)|search\?)\w+/}galleryMeta(){const e=window.location.href.match(/(twitter|x).com\/(\w+)\/?/)?.[2];return new U(window.location.href,`twitter-${e||document.title}-${this.postCount}-${this.mediaCount}`)}}function xn(){return Array.from(document.querySelectorAll("script")).find(o=>o.innerText.startsWith("window.__INITIAL_STATE__"))?.innerText.match(/"id_str":\s?"(\d+)"/)?.[1]}function An(){const o=window.location.href.match(/(twitter|x).com\/(\w+)\/?/)?.[2]||"lililjiliijili",e=Array.from(document.querySelectorAll("button[data-testid][aria-label]"));return e.length===0?void 0:(e.find(i=>(i.getAttribute("aria-label")??"").toLowerCase().includes(`@${o.toLowerCase()}`))||e[0]).getAttribute("data-testid").match(/(\d+)/)?.[1]}function Le(o){const e=new Headers;e.set("authorization","Bearer AAAAAAAAAAAAAAAAAAAAANRILgAAAAAAnNwIzUejRCOuH5E6I8xnZz4puTs%3D1Zv7ttfk8LF81IUq16cHjhLTvJu4FA33AGWWjCpTnA"),e.set("Pragma","no-cache"),e.set("Cache-Control","no-cache"),e.set("content-type","application/json"),e.set("x-client-uuid",o),e.set("x-twitter-auth-type","OAuth2Session"),e.set("x-twitter-client-language","en"),e.set("x-twitter-active-user","yes"),e.set("x-client-transaction-id",qe()),e.set("Sec-Fetch-Dest","empty"),e.set("Sec-Fetch-Mode","cors"),e.set("Sec-Fetch-Site","same-origin");const t=document.cookie.match(/ct0=(\w+)/)?.[1];if(!t)throw new Error("Not found csrfToken");return e.set("x-csrf-token",t),e}function Te(o){const e=[],t=[];let i;for(const n of o.entries)n.content.entryType==="TimelineTimelineItem"&&!n.entryId.startsWith("promoted-")?(e.push(n.content),n.content.itemContent.tweet_results.result.legacy?.id_str&&t.push(n.content.itemContent.tweet_results.result.legacy.id_str),n.content.itemContent.tweet_results.result.legacy?.retweeted_status_result?.result?.legacy?.id_str&&t.push(n.content.itemContent.tweet_results.result.legacy?.retweeted_status_result?.result?.legacy?.id_str)):n.content.entryType==="TimelineTimelineModule"&&n.content.displayType==="VerticalConversation"?n.content.items.forEach(r=>{e.push(r.item),r.item.itemContent.tweet_results.result.legacy?.id_str&&t.push(r.item.itemContent.tweet_results.result.legacy?.id_str),r.item.itemContent.tweet_results.result.legacy?.retweeted_status_result?.result?.legacy?.id_str&&t.push(r.item.itemContent.tweet_results.result.legacy?.retweeted_status_result?.result?.legacy?.id_str)}):n.content.entryType==="TimelineTimelineCursor"&&n.entryId.startsWith("cursor-bottom")&&(i=n.content.value);return{items:e,ids:t,cursor:i}}class _n extends M{name(){return"\u7EC5\u58EB\u6F2B\u753B"}meta;baseURL;galleryURL;async*fetchPagesSource(){const e=this.extractIDFromHref(window.location.href);if(!e)throw new Error("Cannot find gallery ID");this.baseURL=`${window.location.origin}/photos-index-page-1-aid-${e}.html`,this.galleryURL=`${window.location.origin}/photos-gallery-aid-${e}.html`;let t=await window.fetch(this.baseURL).then(n=>n.text()).then(n=>new DOMParser().parseFromString(n,"text/html"));this.meta=this.pasrseGalleryMeta(t);let i=await this.requestGalleryImages(this.galleryURL);yield _.ok(i)}async parseImgNodes(e){const t=[];for(let i=0;i<e.length;i++){const n=e[i];let r=new L("",n.url,n.caption,void 0,n.url);t.push(r)}return t}async fetchOriginMeta(e){const t=e.originSrc??e.thumbnailSrc,i=t.includes(".")?t.split(".").pop():"jpg",n=e.title.replace("[","").replace("]","")+"."+i;return{url:t,title:n}}workURL(){return/(wnacg.com|wn\d{2}.cc)\/photos-index/}galleryMeta(e){return this.meta||super.galleryMeta(e)}extractIDFromHref(e){const t=e.match(/-(\d+).html$/);if(t)return t[1]}pasrseGalleryMeta(e){const t=e.querySelector("#bodywrap > h2")?.textContent||"unknown",i=new U(this.baseURL||window.location.href,t),n=Array.from(e.querySelectorAll(".asTB .tagshow")).map(a=>a.textContent).filter(Boolean),r=Array.from(e.querySelector(".asTB > .asTBcell.uwconn > p")?.childNodes||[]).map(a=>a.textContent).filter(Boolean);return i.tags={tags:n,description:r},i}async requestGalleryImages(e){const t=await window.fetch(e).then(n=>n.text());let i="";for(let n of t.split(`
`))n=n.replace('document.writeln("',""),n=n.replace('");',""),n.includes("var imglist")&&(n=n.replace("var imglist = ",""),n=n.replaceAll("fast_img_host+\\",""),n=n.replaceAll("\\",""),i+=n);return this.extractUrlsAndCaptions(i)}extractUrlsAndCaptions(e){const t=/url:\s*"(.*?)",\s*caption:\s*"(.*?)"/gs;let i;const n=[];for(;(i=t.exec(e))!==null;)n.push({url:i[1],caption:i[2]});return n.length>0&&n[n.length-1].caption.includes("\u52A0\u5165\u6536\u85CF")&&n.pop(),n}}class kn extends M{meta;name(){return"Yabai.si"}workURL(){return/yabai.si\/g\/\w+\/?$/}title(){return this.meta?.title??document.title}galleryMeta(){return this.meta}async*fetchPagesSource(){const e=await this.query(window.location.href+"/read",'{"page":1}');if(e.props?.pages?.data?.list){const t=e.props?.pages?.data;yield _.ok(t)}else throw new Error("cannot fetch pages")}async parseImgNodes(e){const t=this.buildList(e);if(t.length===0)throw new Error("cannot build list from gallery data");const i=Math.ceil(e.count/20),n=await this.query(window.location.href,`{"page":${i}}`),r=n.props?.post?.data?.page_list;if(!r)throw new Error("cannot fetch thumbnails");const a=n.props?.post?.data;a&&(this.meta=this.buildGalleryMeta(a));const s=[];for(let l=0;l<t.length;l++){const c=t[l],d=r[l];s.push(new L(d,c.url,`${c.name}.${c.ext}`,void 0,c.url))}return s}async fetchOriginMeta(e){return{url:e.originSrc}}buildGalleryMeta(e){const t=new U(e.url,e.name);return t.originTitle=e.alt_name,t.tags={flag:[e.flag],category:[e.category],date:[e.date],...e.tags},t}buildList(e){const t=e.list,i=[];for(let n=0;n<e.count;n++){const r=parseInt(t.head[n])-1,a=t.head[n].padStart(4,"0"),s="".concat(t.root,"/").concat(t.code.toString(),"/").concat(a,"-").concat(t.hash[n],"-").concat(t.rand[n],".").concat(t.type[n]);i[r]={url:s,name:a,ext:t.type[n]}}return i}async query(e,t){const i=document.cookie.match(/XSRF-TOKEN=(.*)?;?/)?.[1];if(!i)throw new Error("cannot get csrf token form cookie");return await(await window.fetch(e,{headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-Inertia":"true","X-Inertia-Version":qe(),"X-XSRF-TOKEN":decodeURIComponent(i)},body:t,method:"POST"})).json()}}function it(){return[new mi,new Yi,new Ji,new Ai,new gn,new wn,new fn,new Zt,new si,new li,new ci,new di,new hi,new _i,new In,new _n,new yi,new qi,new Bi,new Gi,new ui,new Xt,new Kt,new Wt,new Si,new ei,new kn,new bi,new Ki,new Ni,new Xi]}function Sn(o){const t=it().filter(i=>u.siteProfiles[i.name()]?.enable??!0).find(i=>{let n=i.workURLs();return u.siteProfiles[i.name()]&&u.siteProfiles[i.name()].workURLs.length>0&&(n=u.siteProfiles[i.name()].workURLs.map(r=>new RegExp(r))),n.find(r=>r.test(o))});return t?[t,u.siteProfiles[t.name()]?.enableAutoOpen??!0,u.siteProfiles[t.name()]?.enableFlowVision??!0]:[null,!1,!1]}function ie(o){const e=[];if(o.ctrlKey&&e.push("ctrl"),o.shiftKey&&e.push("shift"),o.altKey&&e.push("alt"),o.metaKey&&e.push("meta"),o instanceof KeyboardEvent){let t=o.key;t===" "&&(t="space"),e.push(t)}if(o instanceof MouseEvent){let t="m"+o.button;e.push(t)}return e.join("+").toLowerCase()}function oe(o,e,t,i){const n=e.getBoundingClientRect();let r=n.left+n.width/2-o.offsetWidth/2;r=Math.min(r,t-o.offsetWidth),r=Math.max(r,0),o.style.left=r+"px",n.top>i/2?(o.style.bottom=i-n.top+"px",o.style.top="unset"):(o.style.top=n.bottom+"px",o.style.bottom="unset")}function En(o,e,t){const i=document.createElement("div");i.style.position="fixed",i.style.lineHeight="2em",i.id="input-element",i.innerHTML='<input type="text" style="width:20em;height:2em;"><button class="ehvp-custom-btn ehvp-custom-btn-plain">&nbsp\u221A&nbsp</button>',o.appendChild(i);const n=i.querySelector("input");i.querySelector("button").addEventListener("click",()=>{t(n.value),i.remove()}),oe(i,e,o.offsetWidth,o.offsetHeight)}function Re(o,e,t){const i=o.map(n=>`<div><span style="user-select: text;">${n}</span><span class="ehvp-custom-btn ehvp-custom-btn-plain" data-value="${n}">&nbspx&nbsp</span></div>`);e.innerHTML=i.join(""),Array.from(e.querySelectorAll("div > span + span")).forEach(n=>{n.addEventListener("click",()=>{t(n.getAttribute("data-value")),n.parentElement.remove()})})}function Ln(o,e){const t=it(),i=t.map(l=>{const c=l.name(),d="id-"+Ge(c).replaceAll(/[+=\/]/g,"-"),h=u.siteProfiles[c];return`<li data-index="${d}" class="ehvp-custom-panel-list-item">
             <div class="ehvp-custom-panel-list-item-title">
               <div style="font-size: 1.2em;font-weight: 800;">${c}</div>
               <div>
                 <label class="ehvp-custom-panel-checkbox"><span>${A.enable.get()}: </span><input id="${d}-enable-checkbox" ${h?.enable??!0?"checked":""} type="checkbox"></label>
                 <label class="ehvp-custom-panel-checkbox"><span>${A.enableAutoOpen.get()}: </span><input id="${d}-enable-auto-open-checkbox" ${h?.enableAutoOpen??!0?"checked":""} type="checkbox"></label>
                 <label class="ehvp-custom-panel-checkbox"><span>${A.enableFlowVision.get()}: </span><input id="${d}-enable-flow-vision-checkbox" ${h?.enableFlowVision??!0?"checked":""} type="checkbox"></label>
                 <label class="ehvp-custom-panel-checkbox"><span>${A.addRegexp.get()}: </span><span id="${d}-add-workurl" class="ehvp-custom-btn ehvp-custom-btn-green">&nbsp+&nbsp</span></label>
               </div>
             </div>
             <div id="${d}-workurls"></div>
           </li>`}),n=`
<div class="ehvp-custom-panel">
  <div class="ehvp-custom-panel-title">
    <span>
      <span>${A.showSiteProfiles.get()}</span>
      <span style="font-size:0.5em;">
        <span class="p-tooltip"> ${A.enable.get()}? <span class="p-tooltiptext">${A.enableTooltips.get()}</span></span>
        <span class="p-tooltip"> ${A.enableAutoOpen.get()}? <span class="p-tooltiptext">${A.enableAutoOpenTooltips.get()}</span></span>
        <span class="p-tooltip"> ${A.enableFlowVision.get()}? <span class="p-tooltiptext">${A.enableFlowVisionTooltips.get()}</span></span>
      </span>
    </span>
    <span id="ehvp-custom-panel-close" class="ehvp-custom-panel-close">\u2716</span>
  </div>
  <div class="ehvp-custom-panel-container">
    <div class="ehvp-custom-panel-content">
      <ul class="ehvp-custom-panel-list">
      ${i.join("")}
      </ul>
    </div>
  </div>
</div>
`,r=document.createElement("div");r.classList.add("ehvp-full-panel"),r.innerHTML=n;const a=()=>{r.remove(),e?.()};r.addEventListener("click",l=>{l.target.classList.contains("ehvp-full-panel")&&a()}),o.appendChild(r),r.querySelector(".ehvp-custom-panel-close").addEventListener("click",a);const s=u.siteProfiles;t.forEach(l=>{const c=l.name(),d="id-"+Ge(c).replaceAll(/[+=\/]/g,"-"),h=l.workURLs().map(x=>x.source),p=()=>{let x=s[c];return x||(x={enable:!0,enableAutoOpen:!0,enableFlowVision:!0,workURLs:[...h]},s[c]=x),x},g=w(`#${d}-enable-checkbox`,r);g.addEventListener("click",()=>{p().enable=g.checked,q(u)});const m=w(`#${d}-enable-auto-open-checkbox`,r);m.addEventListener("click",()=>{p().enableAutoOpen=m.checked,q(u)});const b=w(`#${d}-enable-flow-vision-checkbox`,r);b.addEventListener("click",()=>{p().enableFlowVision=b.checked,q(u)});const y=w(`#${d}-add-workurl`,r),v=w(`#${d}-workurls`,r),S=(x,E)=>{const B=E.workURLs.indexOf(x);let O=!1;B>-1&&(E.workURLs.splice(B,1),O=!0),E.workURLs.length===0&&(E.workURLs=[...h],O=!0,Re(h,v,se=>{S(se,p())})),O&&q(u)};y.addEventListener("click",()=>{const x=document.createElement("div");x.addEventListener("click",E=>E.target===x&&x.remove()),x.setAttribute("style","position:absolute;width:100%;height:100%;"),r.appendChild(x),En(x,y,E=>{if(!E)return;try{new RegExp(E)}catch{return}x.remove(),p().workURLs.push(E),q(u),Re(p().workURLs,v,O=>{S(O,p())})})});let G=h;s[c]&&(s[c].workURLs.length===0?s[c].workURLs.push(...h):G=s[c].workURLs),Re(G,v,x=>{S(x,p())})}),r.querySelectorAll(".p-tooltip").forEach(l=>{const c=l.querySelector(".p-tooltiptext");c&&(l.addEventListener("mouseenter",()=>{c.style.display="block",oe(c,l,o.offsetWidth,o.offsetHeight)}),l.addEventListener("mouseleave",()=>c.style.display="none"))})}function Tn(o,e){const t=`
<div class="ehvp-custom-panel">
  <div class="ehvp-custom-panel-title">
    <span>${A.showHelp.get()}</span>
    <span id="ehvp-custom-panel-close" class="ehvp-custom-panel-close">\u2716</span>
  </div>
  <div class="ehvp-custom-panel-container ehvp-help-panel">
    <div class="ehvp-custom-panel-content">${A.help.get()}</div>
  </div>
</div>
`,i=document.createElement("div");i.classList.add("ehvp-full-panel"),i.innerHTML=t;const n=()=>{i.remove(),e?.()};i.addEventListener("click",r=>{r.target.classList.contains("ehvp-full-panel")&&n()}),o.appendChild(i),i.querySelector(".ehvp-custom-panel-close").addEventListener("click",n)}function Rn(o,e,t){function i(s,l,c,d){const h=`<span data-id="${c}" data-key="${d}" class="ehvp-custom-panel-item-value"><span>${d}</span><span class="ehvp-custom-btn ehvp-custom-btn-plain" style="padding:0;border:none;">&nbspx&nbsp</span></span>`,p=document.createElement("div");p.innerHTML=h;const g=p.firstElementChild;s.before(g),g.querySelector(".ehvp-custom-btn").addEventListener("click",m=>{const b=u.keyboards[l][c];if(b&&b.length>0){const v=b.indexOf(d);v!==-1&&b.splice(v,1),b.length===0&&delete u.keyboards[l][c],q(u)}m.target.parentElement.remove(),Array.from(s.parentElement.querySelectorAll(".ehvp-custom-panel-item-value")).length===0&&o[l][c].defaultKeys.forEach(S=>i(s,l,c,S))}),p.remove()}const n=`
<div class="ehvp-custom-panel">
  <div class="ehvp-custom-panel-title">
    <span>${A.showKeyboard.get()}</span>
    <span id="ehvp-custom-panel-close" class="ehvp-custom-panel-close">\u2716</span>
  </div>
  <div class="ehvp-custom-panel-container">
    <div class="ehvp-custom-panel-content">
      ${Object.entries(o.inMain).map(([s])=>`
        <div class="ehvp-custom-panel-item">
         <div class="ehvp-custom-panel-item-title">
           <span>${A.keyboard[s].get()}</span>
         </div>
         <div class="ehvp-custom-panel-item-values">
           <!-- wait element created from button event -->
           <button class="ehvp-add-keyboard-btn ehvp-custom-btn ehvp-custom-btn-green" style="margin-left: 0.2em;" data-cate="inMain" data-id="${s}">+</button>
         </div>
        </div>
      `).join("")}
    </div>
    <div class="ehvp-custom-panel-content">
      ${Object.entries(o.inFullViewGrid).map(([s])=>`
        <div class="ehvp-custom-panel-item">
         <div class="ehvp-custom-panel-item-title">
           <span>${A.keyboard[s].get()}</span>
         </div>
         <div class="ehvp-custom-panel-item-values">
           <!-- wait element created from button event -->
           <button class="ehvp-add-keyboard-btn ehvp-custom-btn ehvp-custom-btn-green" style="margin-left: 0.2em;" data-cate="inFullViewGrid" data-id="${s}">+</button>
         </div>
        </div>
      `).join("")}
    </div>
    <div class="ehvp-custom-panel-content">
      ${Object.entries(o.inBigImageMode).map(([s])=>`
        <div class="ehvp-custom-panel-item">
         <div class="ehvp-custom-panel-item-title">
           <span>${A.keyboard[s].get()}</span>
         </div>
         <div class="ehvp-custom-panel-item-values">
           <!-- wait element created from button event -->
           <button class="ehvp-add-keyboard-btn ehvp-custom-btn ehvp-custom-btn-green" style="margin-left: 0.2em;display:inline-block;" data-cate="inBigImageMode" data-id="${s}">+</button>
         </div>
        </div>
      `).join("")}
    </div>
  </div>
</div>
`,r=document.createElement("div");r.classList.add("ehvp-full-panel"),r.innerHTML=n;const a=()=>{r.remove(),t?.()};r.addEventListener("click",s=>{s.target.classList.contains("ehvp-full-panel")&&a()}),e.appendChild(r),r.querySelector(".ehvp-custom-panel-close").addEventListener("click",a),r.querySelectorAll(".ehvp-add-keyboard-btn").forEach(s=>{const l=s.getAttribute("data-cate"),c=s.getAttribute("data-id");let d=u.keyboards[l][c];(d===void 0||d.length===0)&&(d=o[l][c].defaultKeys),d.forEach(p=>i(s,l,c,p));const h=p=>{if(p.preventDefault(),p instanceof KeyboardEvent){const m=p.key.toLowerCase();if(m==="alt"||m==="shift"||m==="control"||m==="meta")return}const g=ie(p);u.keyboards[l][c]!==void 0?u.keyboards[l][c].push(g):u.keyboards[l][c]=d.concat(g),q(u),i(s,l,c,g),s.textContent="+",s.removeAttribute("d-pressing"),s.removeEventListener("keyup",h),s.removeEventListener("mouseup",h)};s.addEventListener("click",p=>{p.preventDefault(),s.textContent="Press Key",s.setAttribute("d-pressing",""),s.addEventListener("keyup",h,{once:!1}),s.addEventListener("mouseup",h,{once:!1})}),s.addEventListener("mouseleave",()=>{s.textContent="+",s.removeAttribute("d-pressing"),s.removeEventListener("keyup",h),s.removeEventListener("mouseup",h)})})}function ue(){const o=He();return`
<div class="b-main" style="flex-direction:row;">
  <a class="b-main-item s-pickable" data-key="entry">${o.entry}</a>
  <a class="b-main-item s-pickable" data-key="collapse">${o.collapse}</a>
  <div class="b-main-item">
      <a class="" style="color:#ffc005;">1</a><span id="p-slash-1">/</span><span id="p-total">0</span>
  </div>
  <div class="b-main-item s-pickable" data-key="fin">
      <span>${o.fin}:</span><span id="p-finished">0</span>
  </div>
  <a class="b-main-item s-pickable" data-key="autoPagePlay" data-status="play">
     <span>${o.autoPagePlay}</span>
  </a>
  <a class="b-main-item s-pickable" data-key="autoPagePause" data-status="paused">
     <span>${o.autoPagePause}</span>
  </a>
  <a class="b-main-item s-pickable" data-key="config">${o.config}</a>
  <a class="b-main-item s-pickable" data-key="download">${o.download}</a>
  <a class="b-main-item s-pickable" data-key="chapters">${o.chapters}</a>
  <div class="b-main-item">
      <div id="read-mode-select"
      ><a class="b-main-option b-main-option-selected s-pickable" data-key="pagination" data-value="pagination">${o.pagination}</a
      ><a class="b-main-option s-pickable" data-key="continuous" data-value="continuous">${o.continuous}</a
      ><a class="b-main-option s-pickable" data-key="horizontal" data-value="horizontal">${o.horizontal}</a></div>
  </div>
  <div class="b-main-item">
      <span>
        <a class="b-main-btn" type="button">&lt;</a>
        <a class="b-main-btn" type="button">-</a>
        <span class="b-main-input">1</span>
        <a class="b-main-btn" type="button">+</a>
        <a class="b-main-btn" type="button">&gt;</a>
      </span>
  </div>
  <div class="b-main-item">
      <span>
        <span>${fe.zoomIcon}</span>
        <a class="b-main-btn" type="button">-</a>
        <span class="b-main-input" style="width: 3rem; cursor: move;">100</span>
        <a class="b-main-btn" type="button">+</a>
      </span>
  </div>
</div>`}function Pn(o,e){const t=`
<div class="ehvp-custom-panel" style="min-width:30vw;">
  <div class="ehvp-custom-panel-title">
    <span>${A.showStyleCustom.get()}</span>
    <span id="ehvp-custom-panel-close" class="ehvp-custom-panel-close">\u2716</span>
  </div>
  <div class="ehvp-custom-panel-container">
    <div class="ehvp-custom-panel-content">
      <div id="control-bar-example-container"></div>
      <div style="margin-top:1em;line-height:2em;">
        <input id="b-main-btn-custom-input" style="width: 30%;" type="text">
        <span id="b-main-btn-custom-confirm" class="ehvp-custom-btn ehvp-custom-btn-green">&nbspOk&nbsp</span>
        <span id="b-main-btn-custom-reset" class="ehvp-custom-btn ehvp-custom-btn-plain">&nbspReset&nbsp</span>
        <span id="b-main-btn-custom-preset1" class="ehvp-custom-btn ehvp-custom-btn-plain">&nbspPreset1&nbsp</span>
        <span id="b-main-btn-custom-preset2" class="ehvp-custom-btn ehvp-custom-btn-plain">&nbspPreset2&nbsp</span>
      </div>
      <div><span style="font-size:0.6em;color:#888;">${A.controlBarStyleTooltip.get()}</span></div>
    </div>
    <div class="ehvp-custom-panel-content" style="position:relative;">
      <div>
        <span class="ehvp-style-preset-btn ehvp-custom-btn ehvp-custom-btn-green" data-index="0">Preset 1</span>
        <span class="ehvp-style-preset-btn ehvp-custom-btn ehvp-custom-btn-green" data-index="1">Preset 2</span>
        <span class="ehvp-style-preset-btn ehvp-custom-btn ehvp-custom-btn-green" data-index="2">Preset 3</span>
        <span class="ehvp-style-preset-btn ehvp-custom-btn ehvp-custom-btn-green" data-index="3">Preset 4</span>
        <span class="ehvp-style-preset-btn ehvp-custom-btn ehvp-custom-btn-plain" data-index="99">Reset</span>
      </div>
      <textarea id="style-custom-input" style="width: 100%; height: 50vh;border:none;background-color:#00000090;color:#97ff97;text-align:left;vertical-align:top;font-size:1.2em;font-weight:600;">${u.customStyle??""}</textarea>
      <span style="position:absolute;bottom:2em;right:1em;" class="ehvp-custom-btn ehvp-custom-btn-green" id="style-custom-confirm">&nbspApply&nbsp</span>
    </div>
  </div>
</div>
`,i=document.createElement("div");i.classList.add("ehvp-full-panel"),i.innerHTML=t;const n=()=>{i.remove(),e?.()};i.addEventListener("click",b=>{b.target.classList.contains("ehvp-full-panel")&&n()}),o.appendChild(i),i.querySelector(".ehvp-custom-panel-close").addEventListener("click",n);const r=i.querySelector("#control-bar-example-container");let a;r.innerHTML=ue();const s=()=>{Array.from(i.querySelectorAll(".s-pickable[data-key]")).forEach(b=>{b.addEventListener("click",()=>{a=b.getAttribute("data-key")||void 0,l.value="",a&&l.focus()})})};s();const l=i.querySelector("#b-main-btn-custom-input"),c=i.querySelector("#b-main-btn-custom-confirm"),d=i.querySelector("#b-main-btn-custom-reset"),h=()=>{const b=l.value;l.value="",!(!b||!a)&&(u.displayText[a]=b,q(u),r.innerHTML=ue(),s())};c.addEventListener("click",h),l.addEventListener("keypress",b=>b.key==="Enter"&&h()),d.addEventListener("click",()=>{l.value="",u.displayText={},q(u),r.innerHTML=ue(),s()});for(let b=0;b<2;b++)i.querySelector(`#b-main-btn-custom-preset${b+1}`).addEventListener("click",()=>{u.displayText=Nn(b),q(u),r.innerHTML=ue(),s()});const p=i.querySelector("#style-custom-input"),g=i.querySelector("#style-custom-confirm");p.addEventListener("keydown",b=>{if(b.key==="Tab"){b.preventDefault();const y=p.selectionStart,v=p.value.slice(0,y),S=p.value.slice(y);p.value=v+"  "+S,p.selectionStart=y+2,p.selectionEnd=y+2}});const m=b=>{o.querySelector("#ehvp-style-custom")?.remove();const y=document.createElement("style");y.id="ehvp-style-custom",u.customStyle=b,y.innerHTML=b,o.appendChild(y),q(u)};g.addEventListener("click",()=>m(p.value)),i.querySelectorAll(".ehvp-style-preset-btn").forEach(b=>{b.addEventListener("click",()=>{const y=parseInt(b.getAttribute("data-index")??"0"),v=Mn(y);p.value=v,m(v)})})}function Mn(o){return[`.ehvp-root {
  --ehvp-theme-bg-color: #393939db;
  --ehvp-theme-font-color: #fff;
  --ehvp-thumbnail-list-bg: #000000;
  --ehvp-thumbnail-border-size: 2px;
  --ehvp-thumbnail-border-radius: 0px;
  --ehvp-thumbnail-box-shadow: none;
  --ehvp-img-fetched: #95ff97;
  --ehvp-img-failed: red;
  --ehvp-img-init: #ffffff;
  --ehvp-img-fetching: #00000000;
  --ehvp-controlbar-border: none;
  --ehvp-panel-border: none;
  --ehvp-panel-box-shadow: none;
  --ehvp-big-images-gap: 0px;
  --ehvp-big-images-bg: #000000c4;
  --ehvp-clickable-color-hover: #90ea90;
  --ehvp-playing-progress-bar-color: #ffffffd0;
  ${j?"":"font-size: 16px;"}
  font-family: Poppins,sans-serif;
}
/** override any style here, make the big image have a green border */
/**
.bifm-container > div {
  border: 2px solid green;
}
*/`,`.ehvp-root {
  --ehvp-theme-bg-color: #ffffff;
  --ehvp-theme-font-color: #760098;
  --ehvp-thumbnail-list-bg: #ffffff;
  --ehvp-thumbnail-border-size: 2px;
  --ehvp-thumbnail-border-radius: 4px;
  --ehvp-thumbnail-box-shadow: 0px 2px 2px 0px #785174;
  --ehvp-img-fetched: #d96cff;
  --ehvp-img-failed: red;
  --ehvp-img-init: #000000;
  --ehvp-img-fetching: #ffffff70;
  --ehvp-controlbar-border: 2px solid #760098;
  --ehvp-panel-border: 2px solid #760098;
  --ehvp-panel-box-shadow: none;
  --ehvp-big-images-gap: 0px;
  --ehvp-big-images-bg: #919191b0;
  --ehvp-clickable-color-hover: #ff87ba;
  --ehvp-playing-progress-bar-color: #760098d0;
  ${j?"":"font-size: 16px;"}
  font-family: Poppins, sans-serif;
}`,`.ehvp-root {
  --ehvp-theme-bg-color: #000000c9;
  --ehvp-theme-font-color: #ffe637;
  --ehvp-thumbnail-list-bg: #000000;
  --ehvp-thumbnail-border-size: 2px;
  --ehvp-thumbnail-border-radius: 0px;
  --ehvp-thumbnail-box-shadow: none;
  --ehvp-img-fetched: #ffe637;
  --ehvp-img-failed: red;
  --ehvp-img-init: #fff;
  --ehvp-img-fetching: #00000000;
  --ehvp-controlbar-border: 2px solid #ffe637;
  --ehvp-panel-border: 2px solid #ffe637;
  --ehvp-panel-box-shadow: none;
  --ehvp-big-images-gap: 0px;
  --ehvp-big-images-bg: #000000d6;
  --ehvp-clickable-color-hover: #90ea90;
  --ehvp-playing-progress-bar-color: #ffe637d0;
  ${j?"":"font-size: 16px;"}
  font-family: Poppins, sans-serif;
}`,`.ehvp-root {
  --ehvp-theme-bg-color: #ffffff;
  --ehvp-theme-font-color: #000000;
  --ehvp-thumbnail-list-bg: #ffffff;
  --ehvp-thumbnail-border-size: 2px;
  --ehvp-thumbnail-border-radius: 4px;
  --ehvp-thumbnail-box-shadow: 0px 2px 2px 0px #000000;
  --ehvp-img-fetched: #000000;
  --ehvp-img-failed: red;
  --ehvp-img-init: #ffffff;
  --ehvp-img-fetching: #ffffff70;
  --ehvp-controlbar-border: 2px solid #000000;
  --ehvp-panel-border: 2px solid #000000;
  --ehvp-panel-box-shadow: none;
  --ehvp-big-images-gap: 0px;
  --ehvp-big-images-bg: #919191b0;
  --ehvp-clickable-color-hover: #ff0000;
  --ehvp-playing-progress-bar-color: #000000d0;
  ${j?"":"font-size: 16px;"}
  font-family: Poppins, sans-serif;
}`][o]??""}function Nn(o){return[{entry:"ENTER",collapse:"X",config:"C",download:"D",chapters:"CH.",fin:"F",pagination:"P",continuous:"C",horizontal:"H",autoPagePlay:"PLAY",autoPagePause:"PAUSE"},{entry:"<\u273F>",collapse:">\u2734<",config:"\u2638",download:"\u2B07",chapters:"CH.",fin:"\u2B07",pagination:"\u274F",continuous:"\u21C5",horizontal:"\u21C6",autoPagePlay:"\u22B3",autoPagePause:"\u21E2\u21E2\u21E2"}][o]??{}}function X(o,e){return Array.from(o.cssRules).find(t=>t.selectorText===e)}class R{defaultKeys;cb;noPreventDefault=!1;constructor(e,t,i){this.defaultKeys=e,this.cb=t,this.noPreventDefault=i||!1}}function $n(o,e,t,i,n){function r(C,k,N){if(!N){const T={colCount:[1,12],rowHeight:[50,4096],threads:[1,10],downloadThreads:[1,10],timeout:[8,40],autoPageSpeed:[1,100],preventScrollPageTime:[-1,9e4],paginationIMGCount:[1,3],scrollingDelta:[1,5e3],scrollingSpeed:[1,100]};let V=1;(C==="preventScrollPageTime"||C==="rowHeight"||C==="scrollingDelta")&&(V=u[C]===1?9:10),k==="add"?N=Math.min(u[C]+V,T[C][1]):k==="minus"&&(N=Math.max(u[C]-V,T[C][0]))}if(N===void 0)return;u[C]=N;const $=w(`#${C}Input`,o.config.panel);if($.value=u[C].toString(),(C==="colCount"||C==="rowHeight")&&f.emit("fvg-flow-vision-resize"),C==="paginationIMGCount"){w("#paginationInput",o.paginationAdjustBar).textContent=u.paginationIMGCount.toString();const T=X(o.styleSheet,".bifm-container-page .bifm-img");T&&(T.style.maxWidth=u.imgScale===100&&u.paginationIMGCount===1?"100%":""),e.setNow(t[t.currIndex])}q(u)}function a(C,k){const N=w(`#${C}Checkbox`,o.config.panel);k!==void 0?N.checked=k:k=N.checked||!1,k!==void 0&&(u[C]=k,q(u),C==="autoLoad"&&(i.autoLoad=u.autoLoad,i.abort(0,u.restartIdleLoader/3)),C==="reversePages"&&e.changeLayout())}function s(C){C&&(u.readMode=C,q(u)),e.changeLayout(),u.autoPageSpeed=u.readMode==="pagination"?5:1,w("#autoPageSpeedInput",o.config.panel).value=u.autoPageSpeed.toString(),Array.from(o.readModeSelect.querySelectorAll(".b-main-option")).forEach(k=>{k.getAttribute("data-value")===u.readMode?k.classList.add("b-main-option-selected"):k.classList.remove("b-main-option-selected")}),u.readMode==="pagination"?o.root.querySelectorAll(".img-land").forEach(k=>k.style.display=""):o.root.querySelectorAll(".img-land").forEach(k=>k.style.display="none")}function l(C,k){const N=w(`#${C}Select`,o.config.panel);if(k?N.value=k:k=N.value,!!k&&(u[C]=k,q(u),C==="readMode"&&s(),C==="minifyPageHelper"))switch(u.minifyPageHelper){case"always":n.minify("bigImageFrame");break;case"inBigMode":case"never":n.minify(e.visible?"bigImageFrame":"fullViewGrid");break}}const c={};function d(C,k){k&&h(k);const N=window.setTimeout(()=>C.classList.add("p-collapse"),100);k&&(c[k]=N)}function h(C){(C?[C]:[...Object.keys(c)]).forEach(k=>{window.clearTimeout(c[k]),delete c[k]})}function p(C,k,N){const $=`${C}-panel`,T=w("#"+$,o.pageHelper);if(T){if(k===void 0){p(C,!T.classList.contains("p-collapse"),N);return}k?d(T,$):(Array.from(o.root.querySelectorAll(".p-panel")).filter(V=>V!==T).forEach(V=>d(V,V.id)),T.classList.remove("p-collapse"),N&&oe(T,N,o.root.clientWidth,o.root.clientHeight))}}const g=document.body.style.overflow;function m(){o.root.classList.remove("ehvp-root-collapse"),e.visible?(e.root.focus(),n.minify("bigImageFrame")):(o.fullViewGrid.focus(),n.minify("fullViewGrid")),document.body.style.overflow="hidden"}function b(){n.minify("exit"),o.entryBTN.setAttribute("data-stage","exit"),o.root.classList.add("ehvp-root-collapse"),e.visible?e.root.blur():o.fullViewGrid.blur(),document.body.style.overflow=g}function y(){const C={"exit-big-image-mode":new R(["escape","enter"],()=>e.hidden()),"step-image-prev":new R(["arrowleft"],()=>e.stepNext(u.reversePages?"next":"prev")),"step-image-next":new R(["arrowright"],()=>e.stepNext(u.reversePages?"prev":"next")),"step-to-first-image":new R(["home"],()=>e.stepNext("next",0,1)),"step-to-last-image":new R(["end"],()=>e.stepNext("prev",0,-1)),"scale-image-increase":new R(["="],()=>e.scaleBigImages(1,5)),"scale-image-decrease":new R(["-"],()=>e.scaleBigImages(-1,5)),"scroll-image-up":new R(["pageup","arrowup","shift+space"],$=>{const T=ie($),V=["pageup","shift+space"].includes(T);let K=!["pageup","arrowup","shift+space"].includes(T);e.onWheel(new WheelEvent("wheel",{deltaY:u.scrollingDelta*-1}),V,K,void 0,$)},!0),"scroll-image-down":new R(["pagedown","arrowdown","space"],$=>{const T=ie($),V=["pagedown","space"].includes(T),K=!["pagedown","arrowdown","space"].includes(T);e.onWheel(new WheelEvent("wheel",{deltaY:u.scrollingDelta}),V,K,void 0,$)},!0),"toggle-auto-play":new R(["p"],()=>f.emit("toggle-auto-play")),"round-read-mode":new R(["alt+m"],()=>{const $=["pagination","continuous","horizontal"],T=($.indexOf(u.readMode)+1)%$.length;l("readMode",$[T])},!0),"toggle-reverse-pages":new R(["alt+f"],()=>a("reversePages",!u.reversePages),!0),"rotate-image":new R(["alt+r"],()=>f.emit("bifm-rotate-image"),!0),"cherry-pick-current":new R(["alt+x"],()=>e.cherryPickCurrent(!1),!0),"exclude-current":new R(["shift+alt+x"],()=>e.cherryPickCurrent(!0),!0),"go-prev-chapter":new R(["shift+alt+w"],()=>f.emit("pf-step-chapters","prev"),!0),"go-next-chapter":new R(["alt+w"],()=>f.emit("pf-step-chapters","next"),!0)},k={"open-big-image-mode":new R(["enter"],()=>{let $=t.currIndex;if(S&&S.length>0){if($=Number(S.join(""))-1,S=null,isNaN($))return;$=Math.max(0,Math.min($,t.length-1))}t[$].node.root?.querySelector("a")?.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0}))}),"pause-auto-load-temporarily":new R(["alt+p"],()=>{i.autoLoad=!i.autoLoad,i.autoLoad?(i.abort(t.currIndex,u.restartIdleLoader/3),f.emit("notify-message","info","Auto load Restarted",3*1e3)):f.emit("notify-message","info","Auto load Pause",3*1e3)}),"exit-full-view-grid":new R(["escape"],()=>f.emit("toggle-main-view",!1)),"columns-increase":new R(["="],()=>r("colCount","add")),"columns-decrease":new R(["-"],()=>r("colCount","minus")),"toggle-auto-play":new R(["p"],()=>f.emit("toggle-auto-play")),"retry-fetch-next-page":new R(["alt+n"],()=>f.emit("pf-retry-extend")),"resize-flow-vision":new R(["alt+r"],()=>f.emit("fvg-flow-vision-resize")),"start-download":new R(["shift+alt+d"],()=>f.emit("start-download",()=>n.minify("fullViewGrid",!1))),"go-prev-chapter":new R(["shift+alt+w"],()=>f.emit("pf-step-chapters","prev"),!0),"go-next-chapter":new R(["alt+w"],()=>f.emit("pf-step-chapters","next"),!0)},N={"open-full-view-grid":new R(["enter"],()=>{const $=document.activeElement;$ instanceof HTMLInputElement||$ instanceof HTMLSelectElement||f.emit("toggle-main-view",!0)},!0),"start-download":new R(["alt+shift+d"],()=>{f.emit("start-download",()=>n.minify("exit",!1))},!0)};return{inBigImageMode:C,inFullViewGrid:k,inMain:N}}const v=y();let S=null;function G(C){if(o.bigImageFrame.classList.contains("big-img-frame-collapse"))return;const k=ie(C),N=Object.entries(v.inBigImageMode).find(([V,K])=>{const Y=u.keyboards.inBigImageMode[V];return Y!==void 0&&Y.length>0?Y.includes(k):K.defaultKeys.includes(k)});if(!N)return;const[$,T]=N;T.noPreventDefault||C.preventDefault(),T.cb(C)}function x(C){if(o.root.classList.contains("ehvp-root-collapse"))return;const k=ie(C),N=Object.entries(v.inFullViewGrid).find(([$,T])=>{const V=u.keyboards.inFullViewGrid[$];return V!==void 0&&V.length>0?V.includes(k):T.defaultKeys.includes(k)});if(N){const[$,T]=N;T.noPreventDefault||C.preventDefault(),T.cb(C)}else C instanceof KeyboardEvent&&C.key.length===1&&C.key>="0"&&C.key<="9"&&(S=S?[...S,Number(C.key)]:[Number(C.key)],C.preventDefault())}function E(C){if(!o.root.classList.contains("ehvp-root-collapse")||!o.bigImageFrame.classList.contains("big-img-frame-collapse"))return;const k=ie(C),N=Object.entries(v.inMain).find(([V,K])=>{const Y=u.keyboards.inMain[V];return Y!==void 0&&Y.length>0?Y.includes(k):K.defaultKeys.includes(k)});if(!N)return;const[$,T]=N;T.noPreventDefault||C.preventDefault(),T.cb(C)}function B(){e.visible?o.bigImageFrame.focus():o.fullViewGrid.focus()}function O(){Tn(o.root,B)}function se(){Rn(v,o.root,B)}function ge(){Ln(o.root,B)}function ar(){Pn(o.root,B)}return{modNumberConfigEvent:r,modBooleanConfigEvent:a,modSelectConfigEvent:l,togglePanelEvent:p,showFullViewGrid:m,hiddenFullViewGrid:b,fullViewGridKeyBoardEvent:x,bigImageFrameKeyBoardEvent:G,keyboardEvent:E,showGuideEvent:O,collapsePanelEvent:d,abortMouseleavePanelEvent:h,showKeyboardCustomEvent:se,showSiteProfilesEvent:ge,showStyleCustomEvent:ar,changeReadModeEvent:s}}class nt{}class Un{root;queue=[];done=!1;chapterIndex=0;layout;resizedNodesPending=[];debouncer;constructor(e,t,i=!1){this.root=e.fullViewGrid,this.debouncer=new H,i?this.layout=new Gn(this.root):this.layout=new qn(this.root,e.styleSheet),f.subscribe("pf-on-appended",(n,r,a,s)=>{this.chapterIndex>-1&&a!==this.chapterIndex||(this.append(r),this.done=s||!1,setTimeout(()=>this.renderCurrView(),200))}),f.subscribe("pf-change-chapter",n=>{this.chapterIndex=n,this.layout.reset(),this.queue=[],this.done=!1}),f.subscribe("ifq-do",(n,r)=>{if(!t.visible||r.chapterIndex!==this.chapterIndex||!r.node.root)return;let a=0;i?a=r.node.root.parentElement.offsetTop-window.screen.availHeight/3:a=r.node.root.offsetTop-window.screen.availHeight/3,a=a<=0?0:a>=this.root.scrollHeight?this.root.scrollHeight:a,this.root.scrollTo.toString().includes("[native code]")?this.root.scrollTo({top:a,behavior:"smooth"}):this.root.scrollTop=a}),f.subscribe("cherry-pick-changed",n=>this.chapterIndex===n&&this.updateRender()),this.root.addEventListener("scroll",()=>this.debouncer.addEvent("FULL-VIEW-SCROLL-EVENT",()=>{e.root.classList.contains("ehvp-root-collapse")||(this.renderCurrView(),this.tryExtend())},400)),this.root.addEventListener("click",n=>{(n.target===e.fullViewGrid||n.target.classList.contains("fvg-sub-container"))&&f.emit("toggle-main-view",!1)}),f.subscribe("fvg-flow-vision-resize",()=>this.layout.resize(this.queue)),f.subscribe("imf-resize",n=>this.resizedNodes(n))}resizedNodes(e){const t=e.node;t.root&&this.resizedNodesPending.push(t.root),this.debouncer.addEvent("RESIZED-NODES",()=>{if(this.resizedNodesPending.length===0)return;let i=null;for(;i=this.resizedNodesPending.shift();){const n=this.layout.resizedNode(i,this.resizedNodesPending);this.resizedNodesPending=this.resizedNodesPending.filter((r,a)=>!n.includes(a))}},50)}append(e){if(e.length>0){let t=this.queue.length;const i=e.map(n=>{const r={node:n,element:n.create(),ratio:n.ratio()};return r.element.setAttribute("data-index",t.toString()),t++,r});this.queue.push(...i),this.layout.append(i)}}tryExtend(){this.done||this.layout.nearBottom()&&f.emit("pf-try-extend")}updateRender(){this.queue.forEach(({node:e})=>e.isRender()&&e.render())}renderCurrView(){const[e,t]=this.layout.visibleRange(this.root,this.queue.map(r=>r.element)),[i,n]=[parseInt(e.getAttribute("data-index")??"-1"),parseInt(t.getAttribute("data-index")??"-1")];i<n&&i>-1&&n<this.queue.length?(this.queue.slice(i,n+1).forEach(r=>r.node.render()),I("info","render curr view, range: ",`[${i}-${n}]`)):I("error","render curr view error, range: ",`[${i}-${n}]`)}}class qn extends nt{root;style;constructor(e,t){super(),this.root=e,this.style=t,this.root.classList.add("fvg-grid"),this.root.classList.remove("fvg-flow")}append(e){this.root.append(...e.map(t=>t.element))}nearBottom(){const e=Array.from(this.root.childNodes);if(e.length===0)return!1;const t=e[e.length-1];return!(this.root.scrollTop+this.root.clientHeight+this.root.clientHeight*2.5<t.offsetTop+t.offsetHeight)}reset(){this.root.innerHTML=""}resize(){const e=X(this.style,".fvg-grid");e&&(e.style.gridTemplateColumns=`repeat(${u.colCount}, minmax(10px, 1fr))`)}resizedNode(e,t){return t.map((i,n)=>n)}visibleRange(e,t){if(t.length===0)return[e,e];const i=e.offsetHeight;let n,r,a=0;for(let s=0;s<t.length;s+=u.colCount){const l=t[s].getBoundingClientRect(),c=l.top+l.height>=0&&l.top<=i;if(c&&n===void 0&&(n=t[s]),n&&!c&&a++,a>=2){r=t[Math.min(t.length-1,s+u.colCount)];break}}return r=r??t[t.length-1],[n??r,r]}}class Gn extends nt{root;lastRow;count=0;resizeObserver;lastRootWidth;base;constructor(e){super(),this.root=e,this.root.classList.add("fvg-flow"),this.root.classList.remove("fvg-grid"),this.lastRootWidth=this.root.offsetWidth,this.base=this.initBaseline(),this.resizeObserver=new ResizeObserver(t=>{const i=t[0],n=i.contentRect.width;this.lastRootWidth!==n&&(this.lastRootWidth=n,Array.from(i.target.querySelectorAll(".fvg-sub-container")).forEach(r=>this.resizeRow(r)))}),this.resizeObserver.observe(this.root)}initBaseline(){return{height:u.rowHeight,columns:u.colCount,gap:8}}createRow(e){const t=document.createElement("div");return t.classList.add("fvg-sub-container"),t.style.height=(e??this.base.height)+"px",t.style.marginTop=this.base.gap+"px",this.root.appendChild(t),t}append(e){for(const t of e)t.element.style.marginLeft=this.base.gap+"px",this.lastRow||(this.lastRow=this.createRow()),this.checkRowFilled(this.lastRow,t.ratio)&&(this.resizeRow(this.lastRow),this.lastRow=this.createRow(this.lastRow?.offsetHeight)),this.lastRow.appendChild(t.element),this.count++}checkRowFilled(e,t){if(e.childElementCount===0)return!1;let i=e.childElementCount>=this.base.columns;if(!i){let n=this.base.height*t;const r=e.childElementCount*this.base.gap+this.base.gap,a=.4/Math.max(1,t);n=n*a,i=this.childrenRatio(e).reduce((l,c)=>l+c*this.base.height,0)+r+n>=this.root.offsetWidth}return i}childrenRatio(e){const t=[],i=n=>{let r=parseFloat(n.getAttribute("data-ratio")??"1");return r=isNaN(r)?1:r,r};return e.childNodes.forEach(n=>t.push(i(n))),t}resizeRow(e){const t=this.childrenRatio(e).reduce((a,s)=>a+s,0),i=e.childElementCount*this.base.gap+this.base.gap,r=(this.root.offsetWidth-i)/t;e.style.height=r+"px"}resize(e){this.base=this.initBaseline(),this.root.innerHTML="",this.lastRow=void 0,this.append(e)}resizedNode(e,t){let i=e.parentElement;if(!i)return[];const n=document.createDocumentFragment();let r=[];function*a(){if(n.append(...r),i.childElementCount>0){const p=Array.from(i.childNodes).map(g=>g);n.append(...p),r.push(...p)}let d=null;for(;d=r.shift();)yield d;const h=i?.nextElementSibling;if(h)for(r=Array.from(h.childNodes).map(p=>p);d=r.shift();)yield d}let s=[],l=0,c=1;for(;;){for(const d of a()){const h=parseFloat(d.getAttribute("data-ratio")??"1");if(this.checkRowFilled(i,h)){r.unshift(d),this.resizeRow(i);break}const p=t.indexOf(d);p>=0&&s.push(p),l++,i.appendChild(d)}if(i=i?.nextElementSibling,i===null&&(i=this.createRow()),r.length===0){i.childElementCount===0&&i.remove();break}if(r.length===i.childElementCount&&r[0]===i.firstElementChild)break;c++}return I("info",`resizedNode moved img-nodes [${l}], changed rows [${c}], resized [${s.length}]`),s}nearBottom(){const e=this.lastRow;return!(!e||this.root.scrollTop+this.root.clientHeight+this.root.clientHeight*2.5<e.offsetTop+e.offsetHeight)}reset(){this.lastRow=void 0,this.root.innerHTML=""}visibleRange(){const e=Array.from(this.root.querySelectorAll(".fvg-sub-container"));if(e.length===0)return[this.root,this.root];const t=this.root.offsetHeight;let i,n,r=0;for(let a=0;a<e.length;a++){const s=e[a].getBoundingClientRect(),l=s.top+s.height>=0&&s.top<=t;if(l&&i===void 0&&(i=e[a].firstElementChild),i&&!l&&r++,r>=2){n=e[a].lastElementChild;break}}return n=n??e[e.length-1].lastElementChild,[i??n,n]}}function rt(o,e,t,i){const n={vw:o,vh:e};return t<=o/2?n.left=Math.max(t,5):n.right=Math.max(o-t,5),i<=e/2?n.top=Math.max(i,5):n.bottom=Math.max(e-i,5),n}function Dn(o,e,t){(t??o).addEventListener("mousedown",i=>{i.preventDefault();const n=window.innerHeight,r=window.innerWidth,a=new AbortController;e.onStart?.(i.clientX,i.clientY),document.addEventListener("mousemove",s=>{e.onMoving?.(rt(r,n,s.clientX,s.clientY))},{signal:a.signal}),document.addEventListener("mouseup",()=>{a.abort(),e.onFinish?.(rt(r,n,i.clientX,i.clientY))},{once:!0})})}function Vn(o,e,t,i){if(o.buttons!==1)return;document.querySelector("#drag-element-with-line")?.remove();const n=document.createElement("canvas");n.id="drag-element-with-line",n.style.position="fixed",n.style.zIndex="100000",n.style.top="0px",n.style.left="0px",n.style.width="100vw",n.style.height="100vh",n.width=window.innerWidth,n.height=window.innerHeight,document.body.appendChild(n);const r=e.getBoundingClientRect(),a=Math.floor(r.height/2.2),[s,l]=[r.left+r.width/2,r.top+r.height/2],c=n.getContext("2d",{alpha:!0}),d=new AbortController;n.addEventListener("mouseup",()=>{document.body.removeChild(n),d.abort()},{once:!0}),n.addEventListener("mousemove",h=>{const[p,g]=[t.x?s:h.clientX,l];c.clearRect(0,0,n.width,n.height),c.beginPath(),c.moveTo(s,l),c.lineTo(p,g),c.strokeStyle="#ffffffa0",c.lineWidth=4,c.stroke(),c.beginPath(),c.arc(p,g,a,0,2*Math.PI),c.fillStyle="#ffffffa0",c.fill(),i(Bn(s,l,p,g))},{signal:d.signal})}function Bn(o,e,t,i){const n=Math.sqrt(Math.pow(t-o,2)+Math.pow(i-e,2)),r=1<<(e>i?3:2)|1<<(o>t?1:0);return{start:{x:o,y:e},end:{x:t,y:i},distance:n,direction:r}}function On(){return`
.ehvp-root {
  --ehvp-theme-bg-color: #333343bb;
  --ehvp-theme-font-color: #fff;
  --ehvp-thumbnail-list-bg: #000;
  --ehvp-thumbnail-border-size: 2px;
  --ehvp-thumbnail-border-radius: 5px;
  --ehvp-thumbnail-box-shadow: none;
  --ehvp-img-fetched: #90ffae;
  --ehvp-img-failed: red;
  --ehvp-img-init: #fff;
  --ehvp-img-fetching: #ffffff70;
  --ehvp-controlbar-border: 1px solid #2f7b10;
  --ehvp-panel-border: none;
  --ehvp-panel-box-shadow: none;
  --ehvp-big-images-gap: 0px;
  --ehvp-big-images-bg: #000000d6;
  --ehvp-clickable-color-hover: #90ea90;
  --ehvp-playing-progress-bar-color: #ffffffd0;
  font-size: 16px;
  font-family: Poppins,sans-serif;
}
.ehvp-root {
  width: 100%;
  height: 100%;
  background-color: #000;
  position: fixed;
  top: 0px;
  left: 0px;
  z-index: 2000;
  box-sizing: border-box;
  overflow: clip;
}
.ehvp-root input[type="checkbox"] {
  width: 1em;
  height: unset !important;
}
.ehvp-root select {
  width: 8em;
  height: 2em;
}
.ehvp-root input {
  width: 3em;
  height: 1.5em;
}
.ehvp-root-collapse {
  height: 0;
}
.fvg-flow {
  width: 100%;
  height: 100%;
  overflow: hidden scroll;
  background: var(--ehvp-thumbnail-list-bg);
}
.fvg-grid {
  width: 100%;
  height: 100%;
  display: grid;
  align-content: start;
  grid-gap: 0.7em;
  grid-template-columns: repeat(${u.colCount}, minmax(10px, 1fr));
  overflow: hidden scroll;
  padding: 0.3em;
  box-sizing: border-box;
  background: var(--ehvp-thumbnail-list-bg);
}
.ehvp-root input, .ehvp-root select {
  color: var(--ehvp-theme-font-color);
  background-color: var(--ehvp-theme-bg-color);
  border: 1px solid #000000;
  border-radius: 4px;
  margin: 0px;
  padding: 0px;
  text-align: center;
  vertical-align: middle;
}
.ehvp-root input:enabled:hover, .ehvp-root select:enabled:hover, .ehvp-root input:enabled:focus, .ehvp-root select:enabled:focus {
  background-color: #34355b !important;
}
.ehvp-root select option {
  background-color: #34355b !important;
  color: #f1f1f1;
  font-size: 1em;
}
.p-label {
  cursor: pointer;
  height: 2em;
}
.p-label > span {
  white-space: nowrap;
}
.p-label > span:first-child {
  overflow: hidden;
  text-overflow: ellipsis;
  position: relative;
  padding-right: 1.5em;
}
.p-label > span:first-child > .p-tooltip {
  position: absolute;
  right: 0.2em;
}
.full-view-grid, .big-img-frame {
  outline: none !important;
}
.img-node {
  position: relative;
  padding: var(--ehvp-thumbnail-border-size);
  box-sizing: border-box;
  background-color: var(--ehvp-img-init);
  border-radius: var(--ehvp-thumbnail-border-radius);
  box-shadow: var(--ehvp-thumbnail-box-shadow);
}
.fvg-sub-container {
  display: flex;
  width: 100%;
  flex-wrap: nowrap;
  /**
  contain: content;
  scollbar-width: none;
  */
}
/**
.full-view-grid::-webkit-scrollbar {
  display: none;
}
*/
.fvg-sub-container .img-node {
  height: 100%;
}
.fvg-sub-container .img-node a {
  width: 100%;
  height: 100%;
}
.img-node canvas, .img-node img {
  width: 100%;
  height: 100%;
  border-radius: var(--ehvp-thumbnail-border-radius);
}
.img-node-numtip {
  position: absolute;
  top: 0;
  left: 0.5em;
  font-size: 1.8em;
  font-weight: 900;
  height: 1.8em;
  line-height: 1.8em;
  text-shadow: 0px 0px 3px #000000;
  color: var(--ehvp-theme-font-color);
  display: none;
}
.img-node:hover .img-node-numtip {
  display: block;
}
.img-node > a {
  display: block;
  line-height: 0;
  position: relative;
  z-index: 1;
  width: 100%;
  height: 100%;
}
.ehvp-chapter-description, .img-node-error-hint {
  display: block;
  position: absolute;
  bottom: 0px;
  left: 0px;
  background-color: #708090e3;
  color: #ffe785;
  width: 100%;
  font-weight: 700;
  min-height: 3em;
  font-size: 0.8em;
  padding: 0.5em;
  box-sizing: border-box;
  line-height: 1.3em;
  z-index: 10;
}
.img-node-error-hint {
  color: #8a0000;
}
.img-fetched {
  background-color: var(--ehvp-img-fetched);
}
.img-fetch-failed {
  background-color: var(--ehvp-img-failed);
}
.img-fetching {
  background-color: var(--ehvp-img-fetching);
}
.img-excluded {
  filter: brightness(0.3);
}
.img-fetching::after {
  content: '';
  position: absolute;
  top: 0%;
  left: 0%;
  width: 30%;
  height: 30%;
  background-color: #ff0000;
  animation: img-loading 1s linear infinite;
}
@keyframes img-loading {
	25% {
    background-color: #ff00ff;
    top: 0%;
    left: 70%;
	}
	50% {
    background-color: #00ffff;
    top: 70%;
    left: 70%;
	}
	75% {
    background-color: #ffff00;
    top: 70%;
    left: 0%;
	}
}
.big-img-frame::-webkit-scrollbar {
  display: none;
}
.big-img-frame {
  position: fixed;
  width: 100%;
  height: 100%;
  top: 0;
  right: 0;
  overflow: auto;
  scrollbar-width: none;
  z-index: 2001;
  background: var(--ehvp-big-images-bg);
  display: flex;
}
.bifm-container > div {
  box-sizing: border-box;
}
.bifm-container-vert {
  width: ${u.imgScale}%;
  height: fit-content;
  margin: 0 auto;
}
.bifm-container-hori {
  width: fit-content;
  height: ${u.imgScale}%;
  margin: auto 0;
  display: flex;
  flex-wrap: nowrap;
}
.bifm-container-page {
  width: fit-content;
  height: ${u.imgScale}%;
  margin: 0 auto;
  display: flex;
  flex-wrap: nowrap;
}
.bifm-container-vert > div {
  margin: var(--ehvp-big-images-gap) 0px;
}
.bifm-container-hori > div {
  margin: 0px var(--ehvp-big-images-gap);
}
.bifm-container-page > div {
  height: 100%;
  margin: 0px var(--ehvp-big-images-gap);
  display: flex;
}
.bifm-node-hide {
  position: fixed;
  left: -100%;
  z-index: -1000;
  opacity: 0;
}
.bifm-container-page .bifm-img {
  ${u.imgScale===100&&u.paginationIMGCount===1?"max-width: 100%;":""}
}
.bifm-img {
  height: 100%;
  object-fit: contain;
  display: block;
}
.bifm-rotate-90 {
  transform: rotate(90deg);
  width: 100vh;
  height: 100vw;
  transform-origin: 0px 0px;
  left: 100vw;
}
.bifm-rotate-180 {
  transform: rotate(180deg);
}
.bifm-rotate-270 {
  transform: rotate(270deg);
  width: 100vh;
  height: 100vw;
  transform-origin: 0px 0px;
  left: 0px;
  top: 100vh;
}
#bifm-loading-helper {
  position: fixed;
  z-index: 3000;
  display: none;
  padding: 0px 3px;
  background-color: #ffffff90;
  font-weight: blod;
  left: 0px;
}
.ehvp-root-collapse .big-img-frame {
  position: unset;
}
.p-helper {
  position: fixed;
  z-index: 2011 !important;
  box-sizing: border-box;
  top: ${u.pageHelperAbTop};
  left: ${u.pageHelperAbLeft};
  bottom: ${u.pageHelperAbBottom};
  right: ${u.pageHelperAbRight};
}
.p-panel {
  z-index: 2012 !important;
  background-color: var(--ehvp-theme-bg-color);
  box-sizing: border-box;
  position: fixed;
  color: var(--ehvp-theme-font-color);
  padding: 3px;
  border-radius: 4px;
  font-weight: 800;
  overflow: hidden;
  width: 24em;
  height: 32em;
  max-height: 75vh;
  border: var(--ehvp-panel-border);
  box-shadow: var(--ehvp-panel-box-shadow);
}
.clickable {
  text-decoration-line: underline;
  user-select: none;
  text-align: center;
  white-space: nowrap;
}
.clickable:hover {
  color: var(--ehvp-clickable-color-hover) !important;
}
.p-collapse {
  height: 0px !important;
  padding: 0px !important;
  border: none;
}
.b-main {
  display: flex;
  user-select: none;
  flex-direction: ${u.pageHelperAbLeft==="unset"?"row-reverse":"row"};
  flex-wrap: wrap-reverse;
}
.b-main-item {
  box-sizing: border-box;
  border: var(--ehvp-controlbar-border);
  border-radius: 4px;
  background-color: var(--ehvp-theme-bg-color);
  color: var(--ehvp-theme-font-color);
  font-weight: 800;
  padding: 0em 0.3em;
  margin: 0em 0.2em;
  position: relative;
  white-space: nowrap;
  font-size: 1em;
  line-height: 1.2em;
}
.b-main-option {
  padding: 0em 0.2em;
}
.b-main-option-selected {
  color: black;
  background-color: #ffffffa0;
  border-radius: 6px;
}
.b-main-btn {
  display: inline-block;
  width: 1em;
}
.b-main-input {
  color: var(--ehvp-theme-font-color);
  background-color: var(--ehvp-theme-bg-color);
  border-radius: 6px;
  display: inline-block;
  text-align: center;
  width: 1.5em;
  cursor: ns-resize;
}
.chapter-thumbnail {
  width: auto;
  height: 100%;
  aspect-ratio: 1 / 1;
  position: relative;
}
.chapter-thumbnail > #chapter-thumbnail-image-container {
  position: absolute;
  width: 100%;
  height: 100%;
  display: flex;
  just-content: center;
  items-align: center;
  z-index: 1;
}
.chapter-thumbnail > #chapter-thumbnail-image-container > img {
  object-fit: contain;
  display: block;
  height: 100%;
  min-width: 100%;
}
.chapter-thumbnail > canvas {
  width: 100%;
  height: 100%;
  /**
  filter: blur(3px) brightness(0.5);
  */
}
.chapter-list {
  height: 100%;
  width: 100%;
  overflow: hidden auto;
  scrollbar-width: none;
  border-left: 2px solid black;
}
.chapter-list::-webkit-scrollbar {
  display: none;
}
.chapter-list-item {
  width: 100%;
  padding-left: 0.7em;
  white-space: nowrap;
  line-height: 1.8em;
  text-decoration: underline;
}
.chapter-list-item:hover {
  background-color: #cddee3ab;
}
.chapter-list-item-hl {
  filter: brightness(150%);
  background-color: #84c5ff6b;
}
.p-chapters {
  width: 34em;
  height: 18em;
  display: flex;
  max-height: 80%;
  max-width: 100%;
}
.p-chapters-large {
  width: 45em;
  height: 25em;
}
.p-chapters-large .chapter-thumbnail {
  width: auto;
  height: 100%;
}
.p-config {
  display: grid;
  grid-template-columns: repeat(10, 1fr);
  align-content: start;
  line-height: 2em;
  overflow: auto scroll;
  scrollbar-width: none;
}
.p-config::-webkit-scrollbar {
  display: none;
}
.p-config label {
  display: flex;
  justify-content: space-between;
  padding-right: 10px;
  margin-bottom: unset;
}
.p-config input {
  cursor: ns-resize;
}
.p-downloader {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  align-items: center;
}
.p-downloader canvas {
  /* border: 1px solid greenyellow; */
}
.p-downloader .download-notice {
  text-align: center;
  width: 100%;
}
.p-downloader .downloader-btn-group {
  align-items: center;
  text-align: right;
  width: 100%;
}
.p-btn {
  color: var(--ehvp-theme-font-color);
  cursor: pointer;
  font-weight: 800;
  background-color: var(--ehvp-theme-bg-color);
  vertical-align: middle;
  width: 1.5em;
  height: 1.5em;
  border: 1px solid #000000;
  border-radius: 4px;
}
@keyframes main-progress {
  from {
    width: 0%;
  }
  to {
    width: 100%;
  }
}
.big-img-frame-collapse {
  display: none;
}
.ehvp-root-collapse .img-land,
.big-img-frame-collapse .img-land,
.ehvp-root-collapse .ehvp-message-box,
.ehvp-root-collapse .p-panel
 {
  display: none !important;
}
.download-bar {
  background-color: #33333310;
  height: 0.3em;
  width: 100%;
  bottom: -0.5em;
  position: absolute;
  box-sizing: border-box;
  z-index: 2;
}
.download-bar > div {
  background-color: var(--ehvp-img-fetched);
  height: 100%;
  border: none;
}
.img-land-left, .img-land-right {
  width: 15%;
  height: 50%;
  position: fixed;
  z-index: 2004;
  top: 25%;
}
.img-land-left {
  left: 0;
  cursor: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC3UlEQVR4nO2ZS28TMRDHV0APcON1gXKisUMRJ0QFJ74EAgQfhMclF15nCqk2noTHcVF2nDRCqBc+AZUKRYR3U0olaODK47JoNiqU0mjX9uymSPlLI0Vayfv72157ZuJ5Qw01lLMCL9gKxfAESLwMAutK4nMQ+BWE/tkL+o3z8bNi41Kl2Dhe8kpbvEGrdhAPKKlvKIlLIHVkGB9A4vXKWH00d/DqWLAXhPaV0D8swP8K1RujfK8Y7s4FXkk8B0J/cQXfwEhXCTyTGbh/1B8BqRU3OPxjBKdKJx9vY4Zv7lBSP8waHlZNSGzRO5ng/ZE84WGNCZaVyGPbQP8ou8KfHyB8RFEV4WkreDrWQOIKF8jsZDuaq7wy30pCd33R3GM++0L7nPCrsjEBEm8ZwdPtyHFJrYe3N4Hf7xam96c2QOlBVvCk2dtt8/EEXksFT0lWL0/JBv7ZnTdW4ymJS5Q0JhroZZXZwM/ff+s0riqEE8kGKCXOAL4dLERQdJsYJfTFFPsfQ274l/VOVD3UcP6mQOCD5BWgwoMR/jUu8sDLeAWepjBgnir3g3/36GNUG+eBhzhwJXkLGZ7//eDfzywzw+v4PmA1UB1vRAszy3xnvWQwYLqFaoebfU3YpQ3abQvZfMR5mVDpPmKs2wyejwkMMr3IMjch8EKiAWo6ubwkSxO+aB5LlcwpqRc3nQmBndTdPOqYuS43twkl9NVU8JwFTT8TTyZfZFvQkKgj4GpgIxPm8Jpm/6ZnKjUe7FJSf+Y0YQnfte6bQkGf5TBAYZuRVqQ+ZQX/eyUETnGZyGXrrBfVoS5FjnUIPc3W5O01d7GVI3wzGA22e5yi2eA6mZK2TYm7vb5W1KvkbDnCn/jk/MGaHLHU7qMLxnnGJX6jWS8fae308hbdjtQxs8qdBHZA4BWQep83aMUJYCGcoL4NtT6o8KDKjtKROCWJqzyco2eUElNWuSn+Zh1qKO//1y8OuBKqSFLycQAAAABJRU5ErkJggg=="), auto;
}
.img-land-right {
  right: 0;
  cursor: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAADG0lEQVR4nO2ZS2tTQRTHL2oXuvO10bqymYkVV2LRlV9CVPQrdO9jE/ANPvCZcjvToju5mpxJGqtWwZ1QH4UWa1WotTUWtNWt1VJHTi6V2KbJnZmTW4X8YaAQuPP7z5nHOaee11BDDTkr8IKVMpndIzkclwwygsOwZPBNMvUzHPg3vCr9lswd60zmdqe81ApvudW9FbYIrs4JDkXJlTYcHyWHs50tmebYwbtago2SKV8w9cMC/K8hwm+kbyWz62OBFxwOSaa+uoJXMDItGByoG7i/02+SXAlqcLnICHSk9j5ZRQyfXyO46q03vJw3waGAcxLB+01xwssyEySRiGPbyKVH2hX+8DLCaxxdLLvfCh6vNclhynTCR+39+sXl13Rbialpn+U3mK8+U77pZI/b+/Xc7JxGvbwyQhgJuG4Ej6+j6SNVDj8vukjAzM1Ez+bIBjA9MJ1k9F5RV9Lzi8M0JhiciQSPSVaYpxgettacHi0sYeKSeyQEhyImjTUNhFml3SRVTRBEQiSybbUNYErsMEk1E88uuJkQTB2NsP8h67pSVU2cdzDB4E7tCGDhQXDoljTxS+unJ4dsIzAUwQBdqty9Pa8/9E1WNnFi0OKbMFV7CxEUKfUzATOxG8AxcONNxfMwcnuM3gB1tTVwrTL827vjumtbjn4LUR3iqvAZG3gV9RBDpp7w72DCCl6GEQjq/pBVg8d8Ca9X628zOFLTADad6gH/vreou13gudI+y++KlMwJriZI4e9/coaXDMYjd/OwY0YG/4AAnpcO8OlI8LYFDSZqCzX2kAZemhY0YRRU2nSichNjfZOlV9gdXuHqX/VMJVqDdYKrLzYmiOGnrfumMqEO2kxqf8+rRaOTq31W8H8iwaCDCiaWrbNQWIdSFDnGg6kesiZv2NyFQozw+aA5WO1RClfD5may2TYp6vZ6ubBXadNyjDA+Ox9YkysW2334wDivOIfvuOrpHYW1XtzC1xE7Zla5E4NxyeCU5GqTt9wqJYCJbBv2bbD1gYUHVnaYjpRSklKVB4P4G6bEmFX+E/9mbagh7//Xb5hJEJPq8mugAAAAAElFTkSuQmCC"), auto;
}
.p-tooltip { }
.p-tooltip .p-tooltiptext {
  display: none;
  max-width: 34em;
  background-color: var(--ehvp-theme-bg-color);
  color: var(--ehvp-theme-font-color);
  border-radius: 6px;
  position: fixed;
  z-index: 1;
  font-size: small;
  white-space: normal;
  text-align: left;
  padding: 0.3em 1em;
  box-sizing: border-box;
  pointer-events: none;
}
.page-loading {
  width: 100%;
  height: 100%;
  justify-content: center;
  align-items: center;
  background-color: #333333a6;
}
.page-loading-text {
  color: var(--ehvp-theme-font-color);
  font-size: 6em;
}
@keyframes rotate {
	100% {
		transform: rotate(1turn);
	}
}
.border-ani {
	position: relative;
	z-index: 0;
	overflow: hidden;
}
.border-ani::before {
	content: '';
	position: absolute;
	z-index: -2;
	left: -50%;
	top: -50%;
	width: 200%;
	height: 200%;
	background-color: #fff;
	animation: rotate 4s linear infinite;
}
.border-ani::after {
	content: '';
	position: absolute;
	z-index: -1;
	left: 6px;
	top: 6px;
	width: calc(100% - 16px);
	height: calc(100% - 16px);
	background-color: #333;
}
.overlay-tip {
  position: absolute;
  z-index: 10;
  font-weight: 800;
  top: 0.3em;
  right: 0.3em;
  font-size: 0.8em;
  color: var(--ehvp-theme-font-color);
  text-shadow: 0px 0px 3px #000000;
}
.lightgreen { color: #90ea90; }
.ehvp-full-panel {
  position: fixed;
  width: 100%;
  height: 100%;
  background-color: #000000e8;
  z-index: 3000;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  top: 0;
}
.ehvp-custom-panel {
  min-width: 50vw;
  min-height: 50vh;
  max-width: 80vw;
  max-height: 80vh;
  background-color: var(--ehvp-theme-bg-color);
  border: 1px solid #000000;
  display: flex;
  flex-direction: column;
  text-align: start;
  color: var(--ehvp-theme-font-color);
  position: relative;
  user-select: none;
}
.ehvp-custom-panel-title {
  font-size: 1.8em;
  line-height: 2em;
  font-weight: 800;
  display: flex;
  justify-content: space-between;
  padding-left: 1em;
}
.ehvp-custom-panel-close {
  width: 2em;
  text-align: center;
}
.ehvp-custom-panel-close:hover {
  background-color: #c3c0e0;
}
.ehvp-custom-panel-container {
  overflow: auto;
  scrollbar-width: thin;
}
.ehvp-custom-panel-content {
  border: 1px solid #000000;
  border-radius: 4px;
  margin: 0.5em;
  padding: 0.5em;
}
.ehvp-custom-panel-item {
  margin: 0.2em 0em;
}
.ehvp-custom-panel-item-title {
  font-size: 1.4em;
}
.ehvp-custom-panel-item-values {
  margin-top: 0.3em;
  text-align: end;
  line-height: 1.3em;
}
.ehvp-custom-panel-item-value {
  font-size: 1.1em;
  font-weight: 800;
  color: black;
  background-color: #c5c5c5;
  border: 1px solid #000000;
  box-sizing: border-box;
  margin-left: 0.3em;
  display: inline-flex;
}
.ehvp-custom-panel-item-value span {
  padding: 0em 0.5em;
}
.ehvp-custom-panel-item-value button {
  background-color: #fff;
  color: black;
  border: none;
}
.ehvp-custom-panel-item-value button:hover {
  background-color: #ffff00;
}
.ehvp-custom-panel-item-input, .ehvp-custom-panel-item-span {
  font-size: 1.1em;
  font-weight: 800;
  background-color: #7fef7b;
  color: black;
  border: none;
}
.ehvp-custom-panel-item-span {
  background-color: #34355b;
  color: white;
}
.ehvp-custom-panel-item-add-btn:hover {
  background-color: #ffff00 !important;
}
.ehvp-custom-panel-list > li {
  line-height: 3em;
  margin-left: 0.5em;
  font-size: 1.4em;
}
.ehvp-custom-panel-checkbox:hover {
  border: 1px solid var(--ehvp-theme-font-color);
}
.ehvp-custom-panel-list-item-disable {
  text-decoration: line-through;
  color: red;
}
.ehvp-help-panel > div > h2 {
  color: #c1ffc9;
}
.ehvp-help-panel > div > p {
  font-size: 1.1em;
  margin-left: 1em;
  font-weight: 600;
}
.ehvp-help-panel > div > ul {
  font-size: 1em;
}
.ehvp-help-panel > div a {
  color: #ff5959;
}
.ehvp-help-panel > div strong {
  color: #d76d00;
}
.bifm-vid-ctl {
  position: fixed;
  z-index: 2010;
  padding: 3px 10px;
  bottom: 0.2em;
  ${u.pageHelperAbLeft==="unset"?"left: 0.2em;":"right: 0.2em;"}
}
.bifm-vid-ctl > div {
  display: flex;
  align-items: center;
  line-height: 1.2em;
}
.bifm-vid-ctl > div > * {
  margin: 0 0.1em;
}
.bifm-vid-ctl:not(:hover) .bifm-vid-ctl-btn,
.bifm-vid-ctl:not(:hover) .bifm-vid-ctl-span,
.bifm-vid-ctl:not(:hover) #bifm-vid-ctl-volume
{
  opacity: 0;
}
.bifm-vid-ctl-btn {
  height: 1.5em;
  width: 1.5em;
  font-size: 1.2em;
  padding: 0;
  margin: 0;
  border: none;
  background-color: #00000000;
  cursor: pointer;
}
#bifm-vid-ctl-volume {
  width: 5em;
  height: 0.5em;
}
.bifm-vid-ctl-pg {
  border: 1px solid #00000000;
  background-color: #3333337e;
  -webkit-appearance: none;
}
#bifm-vid-ctl-pg {
  width: 100%;
  height: 0.2em;
  background-color: #333333ee;
}
.bifm-vid-ctl:hover {
  background-color: var(--ehvp-theme-bg-color);
}
.bifm-vid-ctl:hover #bifm-vid-ctl-pg {
  height: 0.8em;
}
.bifm-vid-ctl-pg-inner {
  background-color: #ffffffa0;
  height: 100%;
}
.bifm-vid-ctl:hover #bifm-vid-ctl-pg .bifm-vid-ctl-pg-inner {
  background-color: #fff;
}
.bifm-vid-ctl-span {
  color: white;
  font-weight: 800;
}
.download-middle {
  width: 100%;
  height: auto;
  flex-grow: 1;
  overflow: hidden;
}
.download-middle .ehvp-tabs + div {
  width: 100%;
  height: calc(100% - 2em);
}
.ehvp-tabs {
  height: 2em;
  width: 100%;
  line-height: 2em;
}
.ehvp-p-tab {
  border: 1px dotted #ff0;
  font-size: 1em;
  padding: 0 0.4em;
}
.download-chapters, .download-status, .download-cherry-pick {
  width: 100%;
  height: 100%;
}
.download-chapters {
  overflow: hidden auto;
}
.download-chapters label {
  white-space: nowrap;
}
.download-chapters label span {
  margin-left: 0.5em;
}
.ehvp-p-tab-selected {
  color: rgb(120, 240, 80) !important;
}
.ehvp-message-box {
  position: fixed;
  z-index: 4001;
  top: 0;
  left: 0;
}
.ehvp-message {
  margin-top: 1em;
  margin-left: 1em;
  line-height: 2em;
  background-color: #ffffffd6;
  border-radius: 6px;
  padding-left: 0.3em;
  position: relative;
  box-shadow: inset 0 0 5px 2px #8273ff;
  color: black;
}
.ehvp-message > button {
  border: 1px solid #00000000;
  margin-left: 1em;
  color: black;
  background-color: #00000000;
  height: 2em;
  width: 2em;
  text-align: center;
  font-weight: 800;
}
.ehvp-message > button:hover {
  background-color: #444;
}
.ehvp-message-duration-bar {
  position: absolute;
  bottom: 0;
  width: 0%;
  left: 0;
  height: 0.1em;
  background: red;
}
.ehvp-custom-btn {
  border: 1px solid #000;
  font-weight: 700;
  color: #000;
  background-color: #ffffff80;
}
.ehvp-custom-btn-plain {
  background-color: #aaa;
}
.ehvp-custom-btn-green {
  background-color: #7fef7b;
}
.ehvp-custom-btn:hover {
  border: 1px solid #fff;
  color: #333;
  background-color: #ffffff90;
  filter: brightness(150%);
}
.ehvp-custom-btn:active {
  color: #ccc;
}
.ehvp-custom-panel-list-item-title {
  display: flex;
  justify-content: space-between;
  border-bottom: 2px solid #000;
  padding: 0em 1em;
}
.ehvp-custom-panel-title:hover, .ehvp-custom-panel-list-item-title:hover {
  background-color: #33333388;
}
.s-pickable:hover {
  border: 1px solid red;
  filter: brightness(150%);
}
#auto-page-progress {
  height: 100%;
  width: 0%;
  position: absolute;
  top: 0px;
  left: 0px;
  background: var(--ehvp-playing-progress-bar-color);
}
@media (max-width: ${j?"1440px":"720px"}) {
  .ehvp-root {
    font-size: 4cqw;
  }
  .ehvp-root-collapse #entry-btn {
    font-size: 2.2em;
  }
  .p-helper {
    bottom: 0px;
    left: 0px;
    top: unset;
    right: unset;
  }
  .b-main {
    flex-direction: row;
  }
  .b-main-item {
    font-size: 1.3em;
    margin-top: 0.2em;
  }
  #pagination-adjust-bar,
  #scale-bar
  {
    display: none;
  }
  .p-panel {
    width: 100%;
    font-size: 5cqw;
  }
  .p-chapters {
    width: 100%;
  }
  .ehvp-custom-panel {
    max-width: 100%;
  }
  .ehvp-root input, .ehvp-root select {
    width: 2em;
    height: 1.2em;
    font-size: 1em;
  }
  .ehvp-root select {
    width: 7em !important;
  }
  .p-btn {
    font-size: 1em;
  }
  .bifm-vid-ctl {
    display: none;
  }
  .ehvp-custom-panel-list-item-title {
    display: block;
  }
  .chapter-thumbnail {
    display: none;
  }
  .bifm-container-hori > div {
    width: 100%;
  }
}
`}class at{root;panel;canvas;tabStatus;tabChapters;tabCherryPick;statusElement;chaptersElement;cherryPickElement;noticeElement;forceBTN;startBTN;btn;constructor(e){this.root=e,this.btn=w("#downloader-panel-btn",e),this.panel=w("#downloader-panel",e),this.canvas=w("#downloader-canvas",e),this.tabStatus=w("#download-tab-status",e),this.tabChapters=w("#download-tab-chapters",e),this.tabCherryPick=w("#download-tab-cherry-pick",e),this.statusElement=w("#download-status",e),this.chaptersElement=w("#download-chapters",e),this.cherryPickElement=w("#download-cherry-pick",e),this.noticeElement=w("#download-notice",e),this.forceBTN=w("#download-force",e),this.startBTN=w("#download-start",e),this.panel.addEventListener("transitionend",()=>f.emit("downloader-canvas-resize"))}initTabs(){const e=[this.statusElement,this.chaptersElement,this.cherryPickElement],t=[{ele:this.tabStatus,cb:()=>{e.forEach((i,n)=>i.hidden=n!=0),f.emit("downloader-canvas-resize")}},{ele:this.tabChapters,cb:()=>{e.forEach((i,n)=>i.hidden=n!=1)}},{ele:this.tabCherryPick,cb:()=>{e.forEach((i,n)=>i.hidden=n!=2),w("#download-cherry-pick-input",this.cherryPickElement).focus()}}];t.forEach(({ele:i,cb:n},r)=>{i.addEventListener("click",()=>{i.classList.add("ehvp-p-tab-selected"),t.filter((a,s)=>s!=r).forEach(a=>a.ele.classList.remove("ehvp-p-tab-selected")),n()})})}switchTab(e){switch(e){case"status":this.tabStatus.click();break;case"chapters":this.tabChapters.click();break;case"cherry-pick":this.tabCherryPick.click();break}}initNotice(e){this.noticeElement.innerHTML="",e.forEach(t=>{const i=document.createElement("a");i.textContent=t.btn,i.classList.add("clickable"),i.style.color="gray",i.style.margin="0em 0.5em",i.addEventListener("click",t.cb),this.noticeElement.append(i)})}abort(e){this.flushUI(e),this.normalizeBTN()}flushUI(e){this.startBTN.style.color=e==="downloadFailed"?"red":"",this.startBTN.textContent=A[e].get(),this.btn.style.color=e==="downloadFailed"?"red":""}noticeableBTN(){this.btn.classList.contains("lightgreen")||(this.btn.classList.add("lightgreen"),/✓/.test(this.btn.textContent)||(this.btn.textContent+="\u2713"))}normalizeBTN(){this.btn.textContent=this.btn.textContent.replace("\u2713",""),this.btn.classList.remove("lightgreen")}createChapterSelectList(e,t){const i=e.length===1;this.chaptersElement.innerHTML=`
      <div>
        <span id="download-chapters-select-all" class="clickable">Select All</span>
        <span id="download-chapters-unselect-all" class="clickable">Unselect All</span>
        <span id="download-chapters-add-new" class="clickable">Add New Chapters</span>
      </div>
      ${e.map((n,r)=>`<div><label>
        <input type="checkbox" id="ch-${n.id}" value="${n.id}" ${i||t.find(a=>a.index===r)?"checked":""} />
        <span>${n.title}</span></label></div>`).join("")}`,[["#download-chapters-select-all",!0],["#download-chapters-unselect-all",!1]].forEach(([n,r])=>this.chaptersElement.querySelector(n)?.addEventListener("click",()=>e.forEach(a=>{const s=this.chaptersElement.querySelector("#ch-"+a.id);s&&(s.checked=r)}))),this.chaptersElement.querySelector("#download-chapters-add-new")?.addEventListener("click",n=>{function r(a,s,l,c){const d=document.createElement("div");d.style.position="fixed",d.style.zIndex="2100",d.style.padding="3px",d.style.backgroundColor="var(--ehvp-theme-bg-color)",d.style.border="var(--ehvp-panel-border)",d.style.borderRadius="5px",d.innerHTML=`
          <div style="display: flex; justify-content: center; margin: 10px 2px;">${l}</div>
          <div style="display: flex; justify-content: center;">
            <button class="ehvp-custom-btn ehvp-modal-btn-cancel" style="background-color: gray;">Cancel</button>
            <button class="ehvp-custom-btn ehvp-modal-btn-confirm" style="background-color: var(--ehvp-clickable-color-hover);">Confirm</button>
          </div>
        `,a.appendChild(d),d.querySelector(".ehvp-modal-btn-cancel")?.addEventListener("click",()=>d.remove()),d.querySelector(".ehvp-modal-btn-confirm")?.addEventListener("click",()=>c(d).finally(()=>d.remove())),oe(d,s,a.offsetWidth,a.offsetHeight)}r(this.root,n.target,'<input id="download-chapters-add-input" style="width: 250px; background-color: #ffffff80;" placeholder="https://example.com" />',async a=>{const s=a.querySelector("#download-chapters-add-input")?.value;if(!s)return;const l=f.emit("pf-append-chapters",s);l&&await l})})}selectedChapters(){const e=new Set;return this.chaptersElement.querySelectorAll("input[type=checkbox][id^=ch-]:checked").forEach(t=>e.add(Number(t.value))),e}initCherryPick(e,t,i,n){let r=0;function a(v,S,G){v.querySelectorAll(".ehvp-custom-panel-item-value").forEach(E=>E.remove());const x=document.createElement("div");S.forEach(E=>{const B=`<span class="ehvp-custom-panel-item-value" data-id="${E.id}"><span >${E.toString()}</span><span class="ehvp-custom-btn ehvp-custom-btn-plain" style="padding:0;border:none;">&nbspx&nbsp</span></span>`;x.innerHTML=B;const O=x.firstElementChild;O.style.backgroundColor=E.positive?"#7fef7b":"#ffa975",v.appendChild(O),O.querySelector(".ehvp-custom-btn").addEventListener("click",se=>{const ge=se.target.parentElement;G(ge.getAttribute("data-id")),ge.remove()}),x.remove()})}const s=w("#download-cherry-pick-btn-add",this.cherryPickElement),l=w("#download-cherry-pick-btn-exclude",this.cherryPickElement),c=w("#download-cherry-pick-btn-clear",this.cherryPickElement),d=w("#download-cherry-pick-btn-range-before",this.cherryPickElement),h=w("#download-cherry-pick-btn-range-after",this.cherryPickElement),p=w("#download-cherry-pick-input",this.cherryPickElement),g=(v,S)=>{const G=S?[z.from((v?"!":"")+S)].filter(x=>x!==null):(p.value||"").split(",").map(x=>(v?"!":"")+x).map(z.from).filter(x=>x!==null);G.length>0&&G.forEach(x=>{const E=e(r,x);E!==null&&a(this.cherryPickElement.firstElementChild,E,B=>t(r,B))}),p.value="",p.focus()},m=()=>{i(r),a(this.cherryPickElement.firstElementChild,[],v=>t(r,v)),p.value="",p.focus()};s.addEventListener("click",()=>g(!1)),l.addEventListener("click",()=>g(!0)),c.addEventListener("click",m),this.cherryPickElement.querySelectorAll(".download-cherry-pick-follow-btn").forEach(v=>{const S=()=>{const G=parseInt(v.getAttribute("data-sibling-step")||"1");let x=v;for(let E=0;E<G;E++)x=x.previousElementSibling;G<=1&&m(),g(G>1,x.getAttribute("data-range")||void 0)};v.addEventListener("click",S)}),p.addEventListener("keypress",v=>v.key==="Enter"&&g(!1));let b=0;f.subscribe("add-cherry-pick-range",(v,S,G,x)=>{const E=new z([S+1,x?(b??S)+1:S+1],G);b=S,a(this.cherryPickElement.firstElementChild,e(v,E)||[],B=>t(v,B))}),f.subscribe("pf-change-chapter",v=>{v!==-1&&(r=v,a(this.cherryPickElement.firstElementChild,n(r)||[],S=>t(r,S)))});let y=0;f.subscribe("pf-on-appended",v=>{y=v.toString().length;const S=h.getAttribute("data-range").split("-").map(x=>x.padStart(y,"0")).join("-");h.textContent=S,h.setAttribute("data-range",S);const G=d.getAttribute("data-range").split("-").map((x,E)=>E===1?v.toString():x.padStart(y,"0")).join("-");d.textContent=G,d.setAttribute("data-range",G)}),f.subscribe("ifq-do",v=>{const S=[1,v+1].map(x=>x.toString().padStart(y,"0")).join("-");h.textContent=S,h.setAttribute("data-range",S);const G=d.getAttribute("data-range").split("-").map((x,E)=>E===0?(v+1).toString().padStart(y,"0"):x).join("-");d.textContent=G,d.setAttribute("data-range",G)})}static html(){return`
<div id="downloader-panel" class="p-panel p-downloader p-collapse">
    <div id="download-notice" class="download-notice" style="font-size: 0.7em;"></div>
    <div id="download-middle" class="download-middle">
      <div class="ehvp-tabs">
        <a id="download-tab-status" class="clickable ehvp-p-tab">${A.status.get()}</a>
        <a id="download-tab-cherry-pick" class="clickable ehvp-p-tab">${A.cherryPick.get()}</a>
        <a id="download-tab-chapters" class="clickable ehvp-p-tab">${A.selectChapters.get()}</a>
      </div>
      <div>
        <div id="download-status" class="download-status" hidden>
          <canvas id="downloader-canvas" width="0" height="0"></canvas>
        </div>
        <div id="download-cherry-pick" class="download-cherry-pick" hidden>
          <div class="ehvp-custom-panel-item-values" style="text-align: start;">
            <div style="margin-bottom: 1rem;display: flex;">
              <input type="text" class="ehvp-custom-panel-item-input" id="download-cherry-pick-input" placeholder="1, 2-3" style="text-align: start; width: 50%; height: 1.3rem; border-radius: 0px;" />
              <span class="ehvp-custom-btn ehvp-custom-btn-green" id="download-cherry-pick-btn-add">Pick</span>
              <span class="ehvp-custom-btn ehvp-custom-btn-plain" id="download-cherry-pick-btn-exclude">Exclude</span>
              <span class="ehvp-custom-btn ehvp-custom-btn-plain" id="download-cherry-pick-btn-clear">Clear</span>
            </div>
            <div style="margin-bottom: 1rem;">
              <div style="margin-bottom: 0.2rem">
                <span class="ehvp-custom-panel-item-span" id="download-cherry-pick-btn-range-after" data-range="1-1">1-1</span><span
                 class="ehvp-custom-btn ehvp-custom-btn-green download-cherry-pick-follow-btn" data-sibling-step="1">pick</span><span
                 class="ehvp-custom-btn ehvp-custom-btn-plain download-cherry-pick-follow-btn" data-sibling-step="2">exclude</span>
              </div>
              <div>
                <span class="ehvp-custom-panel-item-span" id="download-cherry-pick-btn-range-before" data-range="1-1">1-1</span><span
                class="ehvp-custom-btn ehvp-custom-btn-green download-cherry-pick-follow-btn" data-sibling-step="1">pick</span><span
                class="ehvp-custom-btn ehvp-custom-btn-plain download-cherry-pick-follow-btn" data-sibling-step="2">exclude</span>
              </div>
            </div>
          </div>
        </div>
        <div id="download-chapters" class="download-chapters" hidden></div>
      </div>
    </div>
    <div class="download-btn-group">
       <a id="download-force" class="clickable">${A.forceDownload.get()}</a>
       <a id="download-start" style="color: rgb(120, 240, 80)" class="clickable">${A.downloadStart.get()}</a>
    </div>
</div>`}}class ot{panel;btn;constructor(e){this.panel=w("#config-panel",e),this.btn=w("#config-panel-btn",e),this.panel.querySelectorAll(".p-tooltip").forEach(t=>{const i=t.querySelector(".p-tooltiptext");i&&(t.addEventListener("mouseenter",()=>{i.style.display="block",oe(i,t,e.offsetWidth,e.offsetHeight)}),t.addEventListener("mouseleave",()=>i.style.display="none"))})}initEvents(e){Fe.forEach(t=>{switch(t.typ){case"number":w(`#${t.key}MinusBTN`,this.panel).addEventListener("click",()=>e.modNumberConfigEvent(t.key,"minus")),w(`#${t.key}AddBTN`,this.panel).addEventListener("click",()=>e.modNumberConfigEvent(t.key,"add")),w(`#${t.key}Input`,this.panel).addEventListener("wheel",i=>{i.preventDefault(),i.deltaY<0?e.modNumberConfigEvent(t.key,"add"):i.deltaY>0&&e.modNumberConfigEvent(t.key,"minus")});break;case"boolean":w(`#${t.key}Checkbox`,this.panel).addEventListener("click",()=>e.modBooleanConfigEvent(t.key));break;case"select":w(`#${t.key}Select`,this.panel).addEventListener("change",()=>e.modSelectConfigEvent(t.key));break}})}static html(){return`
<div id="config-panel" class="p-panel p-config p-collapse">
    ${Fe.map(zn).join("")}
    <div style="grid-column-start: 1; grid-column-end: 11; padding-left: 5px;">
        <label class="p-label">
            <span>${A.dragToMove.get()}:</span>
            <span id="dragHub" style="font-size: 1.85rem;cursor: grab;">\u2720</span>
        </label>
    </div>
    <div style="grid-column-start: 1; grid-column-end: 11; padding-left: 5px; text-align: left;">
         <a id="show-guide-element" class="clickable" style="border: 1px dotted #fff; padding: 0px 3px;">${A.showHelp.get()}</a>
         <a id="show-keyboard-custom-element" class="clickable" style="border: 1px dotted #fff; padding: 0px 3px;">${A.showKeyboard.get()}</a>
         <a id="show-site-profiles-element" class="clickable" style="border: 1px dotted #fff; padding: 0px 3px;">${A.showSiteProfiles.get()}</a>
         <a id="show-style-custom-element" class="clickable" style="border: 1px dotted #fff; padding: 0px 3px;">${A.showStyleCustom.get()}</a>
         <a id="reset-config-element" class="clickable" style="border: 1px dotted #fff; padding: 0px 3px;">${A.resetConfig.get()}</a>
         <a class="clickable" style="border: 1px dotted #fff; padding: 0px 3px;" href="https://github.com/MapoMagpie/eh-view-enhance" target="_blank">${A.letUsStar.get()}</a>
    </div>
</div>`}}function zn(o){const e=o.i18nKey||o.key,t=A[e],i=A[`${e}Tooltip`];if(!t)throw new Error(`i18n key ${e} not found`);let n=!0;o.displayInSite&&(n=o.displayInSite.test(location.href));let r="";switch(o.typ){case"boolean":r=`<input id="${o.key}Checkbox" ${u[o.key]?"checked":""} type="checkbox" />`;break;case"number":r=`<span>
                  <button id="${o.key}MinusBTN" class="p-btn" type="button">-</button>
                  <input id="${o.key}Input" value="${u[o.key]}" disabled type="text" />
                  <button id="${o.key}AddBTN" class="p-btn" type="button">+</button></span>`;break;case"select":if(!o.options)throw new Error(`options for ${o.key} not found`);const l=o.options.map(c=>`<option value="${c.value}" ${u[o.key]==c.value?"selected":""}>${c.display}</option>`).join("");r=`<select id="${o.key}Select">${l}</select>`;break}const[a,s]=o.gridColumnRange?o.gridColumnRange:[1,11];return`<div style="grid-column-start: ${a}; grid-column-end: ${s}; padding-left: 5px;${n?"":" display: none;"}"><label class="p-label"><span><span>${t.get()}</span><span class="p-tooltip">${i?" ?:":" :"}<span class="p-tooltiptext">${i?.get()||""}</span></span></span>${r}</label></div>`}class st{panel;root;thumbnail;thumbnailImg;thumbnailCanvas;listContainer;constructor(e){this.root=e,this.panel=w("#chapters-panel",e),this.thumbnail=w("#chapter-thumbnail",e),this.thumbnailImg=w("#chapter-thumbnail-image",e),this.thumbnailCanvas=w("#chapter-thumbnail-canvas",e),this.listContainer=w("#chapter-list",e),f.subscribe("pf-update-chapters",(t,i)=>{this.updateChapterList(t),t.length>1&&!i&&this.relocateToCenter()}),f.subscribe("pf-change-chapter",(t,i)=>this.updateHighlight(t,i))}updateChapterList(e){const t=this.listContainer.firstElementChild;t.innerHTML="",e.forEach((i,n)=>{const r=document.createElement("div");let a="";i.title instanceof Array?a=i.title.join("	"):a=i.title,r.innerHTML=`<span>${a}</span>`,r.setAttribute("id","chapter-list-item-"+i.id.toString()),r.classList.add("chapter-list-item"),r.addEventListener("click",()=>{i.onclick?.(n),this.panel.classList.contains("p-panel-large")&&(this.panel.classList.add("p-collapse"),this.panel.classList.remove("p-panel-large"),this.panel.classList.remove("p-chapters-large"))}),r.addEventListener("mouseenter",()=>this.updateChapterThumbnail(i)),t.appendChild(r)}),this.updateChapterThumbnail(e[0])}relocateToCenter(){this.panel.classList.remove("p-collapse"),this.panel.classList.add("p-panel-large"),this.panel.classList.add("p-chapters-large");const[e,t]=[this.root.offsetWidth,this.root.offsetHeight],[i,n]=[this.panel.offsetWidth,this.panel.offsetHeight],[r,a]=[e/2-i/2,t/2-n/2];this.panel.style.left=r+"px",this.panel.style.top=a+"px"}updateHighlight(e,t){Array.from(this.listContainer.querySelectorAll("div > .chapter-list-item")).forEach((i,n)=>{n===e?i.classList.add("chapter-list-item-hl"):i.classList.remove("chapter-list-item-hl")}),this.updateChapterThumbnail(t)}updateChapterThumbnail(e){this.thumbnailImg.onload=()=>{const i=this.thumbnailImg.naturalWidth,n=this.thumbnailImg.naturalHeight;let[r,a,s,l]=[0,i,0,n];i>n?(r=Math.floor((i-n)/2),a=n):i<n&&(s=Math.floor((n-i)/2),l=i),this.thumbnailCanvas.width=a,this.thumbnailCanvas.height=l,this.thumbnailCanvas.getContext("2d").drawImage(this.thumbnailImg,r,s,a,l,0,0,i,n)},this.thumbnailImg.src=e.thumbimg??ee,this.thumbnail.querySelector(".ehvp-chapter-description")?.remove();const t=document.createElement("div");t.classList.add("ehvp-chapter-description"),Array.isArray(e.title)?t.innerHTML=e.title.map(i=>`<span>${i}</span>`).join("<br>"):t.innerHTML=`<span>${e.title}</span>`,this.thumbnail.appendChild(t)}static html(){return`
<div id="chapters-panel" class="p-panel p-chapters p-collapse">
    <div id="chapter-thumbnail" class="chapter-thumbnail">
      <div id="chapter-thumbnail-image-container" style="display:none;">
        <img id="chapter-thumbnail-image" src="${ee}" alt="thumbnail" />
      </div>
      <canvas id="chapter-thumbnail-canvas" width="100" height="100"></canvas>
    </div>
    <div id="chapter-list" class="chapter-list">
      <div></div>
    </div>
</div>`}}function Fn(){const o=document.createElement("div"),e=He();o.id="ehvp-base",o.setAttribute("style","all: initial"),document.body.after(o);const t=`
<div id="page-loading" class="page-loading" style="display: none;">
    <div class="page-loading-text border-ani">Loading...</div>
</div>
<div id="message-box" class="ehvp-message-box"></div>
<div id="ehvp-nodes-container" class="full-view-grid" tabindex="6"></div>
<div id="big-img-frame" class="big-img-frame big-img-frame-collapse" tabindex="7">
   <a id="img-land-left" class="img-land img-land-left"></a>
   <a id="img-land-right" class="img-land img-land-right"></a>
</div>
<div id="p-helper" class="p-helper">
    <div>
        ${ot.html()}
        ${at.html()}
        ${st.html()}
    </div>
    <div id="b-main" class="b-main">
        <a id="entry-btn" class="b-main-item clickable" data-display-texts="${e.entry},${e.collapse}">${e.entry}</a>
        <div id="page-status" class="b-main-item" hidden>
            <a class="clickable" id="p-curr-page" style="color:#ffc005;">1</a><span id="p-slash-1">/</span><span id="p-total">0</span>
        </div>
        <div id="fin-status" class="b-main-item" hidden>
            <span>${e.fin}:</span><span id="p-finished">0</span>
        </div>
        <a id="auto-page-btn" class="b-main-item clickable" hidden data-status="paused" data-display-texts="${e.autoPagePlay},${e.autoPagePause}">
           <span>${e.autoPagePlay}</span>
           <div id="auto-page-progress"></div>
        </a>
        <a id="config-panel-btn" class="b-main-item clickable" hidden>${e.config}</a>
        <a id="downloader-panel-btn" class="b-main-item clickable" hidden>${e.download}</a>
        <a id="chapters-panel-btn" class="b-main-item clickable" hidden>${e.chapters}</a>
        <div id="read-mode-bar" class="b-main-item" hidden>
            <div id="read-mode-select"
            ><a class="b-main-option clickable ${u.readMode==="pagination"?"b-main-option-selected":""}" data-value="pagination">${e.pagination}</a
            ><a class="b-main-option clickable ${u.readMode==="continuous"?"b-main-option-selected":""}" data-value="continuous">${e.continuous}</a
            ><a class="b-main-option clickable ${u.readMode==="horizontal"?"b-main-option-selected":""}" data-value="horizontal">${e.horizontal}</a></div>
        </div>
        <div id="pagination-adjust-bar" class="b-main-item" hidden>
            <span>
              <a id="paginationStepPrev" class="b-main-btn clickable" type="button">&lt;</a>
              <a id="paginationMinusBTN" class="b-main-btn clickable" type="button">-</a>
              <span id="paginationInput" class="b-main-input">${u.paginationIMGCount}</span>
              <a id="paginationAddBTN" class="b-main-btn clickable" type="button">+</a>
              <a id="paginationStepNext" class="b-main-btn clickable" type="button">&gt;</a>
            </span>
        </div>
        <div id="scale-bar" class="b-main-item" hidden>
            <span>
              <span>${fe.zoomIcon}</span>
              <a id="scaleMinusBTN" class="b-main-btn clickable" type="button">-</a>
              <span id="scaleInput" class="b-main-input" style="width: 3rem; cursor: move;">${u.imgScale}</span>
              <a id="scaleAddBTN" class="b-main-btn clickable" type="button">+</a>
            </span>
        </div>
    </div>
</div>
`,i=o.attachShadow({mode:"open"}),n=document.createElement("div");n.classList.add("ehvp-root"),n.classList.add("ehvp-root-collapse"),n.innerHTML=t;const r=document.createElement("style");r.innerHTML=On();const a=document.createElement("style");return a.id="ehvp-style-custom",a.innerHTML=u.customStyle,i.append(r),n.append(a),i.append(n),{root:n,fullViewGrid:w("#ehvp-nodes-container",n),bigImageFrame:w("#big-img-frame",n),pageHelper:w("#p-helper",n),configPanelBTN:w("#config-panel-btn",n),downloaderPanelBTN:w("#downloader-panel-btn",n),chaptersPanelBTN:w("#chapters-panel-btn",n),entryBTN:w("#entry-btn",n),currPageElement:w("#p-curr-page",n),totalPageElement:w("#p-total",n),finishedElement:w("#p-finished",n),showGuideElement:w("#show-guide-element",n),showKeyboardCustomElement:w("#show-keyboard-custom-element",n),showSiteProfilesElement:w("#show-site-profiles-element",n),showStyleCustomElement:w("#show-style-custom-element",n),resetConfigElement:w("#reset-config-element",n),imgLandLeft:w("#img-land-left",n),imgLandRight:w("#img-land-right",n),autoPageBTN:w("#auto-page-btn",n),pageLoading:w("#page-loading",n),messageBox:w("#message-box",n),config:new ot(n),downloader:new at(n),chapters:new st(n),readModeSelect:w("#read-mode-select",n),paginationAdjustBar:w("#pagination-adjust-bar",n),styleSheet:r.sheet}}function Hn(o,e,t,i,n){e.config.initEvents(o);const r={config:{panel:e.config.panel,btn:e.configPanelBTN},downloader:{panel:e.downloader.panel,btn:e.downloaderPanelBTN,cb:()=>i.check()},chapters:{panel:e.chapters.panel,btn:e.chaptersPanelBTN}};function a(l){u.autoCollapsePanel&&!l.classList.contains("p-panel-large")&&o.collapsePanelEvent(l,l.id),t.visible?e.bigImageFrame.focus():e.fullViewGrid.focus()}Object.entries(r).forEach(([l,c])=>{c.panel.addEventListener("mouseleave",()=>a(c.panel)),c.panel.addEventListener("blur",()=>a(c.panel)),c.btn.addEventListener("click",()=>{o.togglePanelEvent(l,void 0,c.btn),c.cb?.()})});let s=!1;e.pageHelper.addEventListener("mouseover",()=>{s=!0,o.abortMouseleavePanelEvent(),n.minify(n.lastStage,!0)}),e.pageHelper.addEventListener("mouseleave",()=>{s=!1,Object.values(r).forEach(l=>a(l.panel)),setTimeout(()=>!s&&n.minify(n.lastStage,!1),700)}),e.entryBTN.addEventListener("click",()=>{let l=e.entryBTN.getAttribute("data-stage")||"exit";l=l==="open"?"exit":"open",e.entryBTN.setAttribute("data-stage",l),f.emit("toggle-main-view",l==="open")}),e.currPageElement.addEventListener("wheel",l=>t.stepNext(l.deltaY>0?"next":"prev",l.deltaY>0?-1:1,parseInt(e.currPageElement.textContent)-1)),document.addEventListener("keydown",l=>o.keyboardEvent(l)),document.addEventListener("mouseup",l=>o.keyboardEvent(l)),e.fullViewGrid.addEventListener("keydown",l=>{o.fullViewGridKeyBoardEvent(l),l.stopPropagation()}),e.fullViewGrid.addEventListener("mouseup",l=>{o.fullViewGridKeyBoardEvent(l),l.stopPropagation()}),e.bigImageFrame.addEventListener("keydown",l=>{o.bigImageFrameKeyBoardEvent(l),l.stopPropagation()}),e.bigImageFrame.addEventListener("mouseup",l=>{o.bigImageFrameKeyBoardEvent(l),l.stopPropagation()}),e.imgLandLeft.addEventListener("click",l=>{t.stepNext(u.reversePages?"next":"prev"),l.stopPropagation()}),e.imgLandRight.addEventListener("click",l=>{t.stepNext(u.reversePages?"prev":"next"),l.stopPropagation()}),e.showGuideElement.addEventListener("click",o.showGuideEvent),e.showKeyboardCustomElement.addEventListener("click",o.showKeyboardCustomEvent),e.showSiteProfilesElement.addEventListener("click",o.showSiteProfilesEvent),e.showStyleCustomElement.addEventListener("click",o.showStyleCustomEvent),e.resetConfigElement.addEventListener("click",Lt),Dn(e.pageHelper,{onFinish:()=>{u.pageHelperAbTop=e.pageHelper.style.top,u.pageHelperAbLeft=e.pageHelper.style.left,u.pageHelperAbBottom=e.pageHelper.style.bottom,u.pageHelperAbRight=e.pageHelper.style.right,q(u)},onMoving:l=>{e.pageHelper.style.top=l.top===void 0?"unset":`${l.top}px`,e.pageHelper.style.bottom=l.bottom===void 0?"unset":`${l.bottom}px`,e.pageHelper.style.left=l.left===void 0?"unset":`${l.left}px`,e.pageHelper.style.right=l.right===void 0?"unset":`${l.right}px`;const c=X(e.styleSheet,".b-main");c&&(c.style.flexDirection=l.left===void 0?"row-reverse":"row")}},w("#dragHub",e.pageHelper)),e.readModeSelect.addEventListener("click",l=>{const c=l.target.getAttribute("data-value");c&&(o.changeReadModeEvent(c),n.minify(n.lastStage))}),w("#paginationStepPrev",e.pageHelper).addEventListener("click",()=>t.stepNext(u.reversePages?"next":"prev",u.reversePages?-1:1)),w("#paginationStepNext",e.pageHelper).addEventListener("click",()=>t.stepNext(u.reversePages?"prev":"next",u.reversePages?1:-1)),w("#paginationMinusBTN",e.pageHelper).addEventListener("click",()=>o.modNumberConfigEvent("paginationIMGCount","minus")),w("#paginationAddBTN",e.pageHelper).addEventListener("click",()=>o.modNumberConfigEvent("paginationIMGCount","add")),w("#paginationInput",e.pageHelper).addEventListener("wheel",l=>o.modNumberConfigEvent("paginationIMGCount",l.deltaY<0?"add":"minus")),w("#scaleInput",e.pageHelper).addEventListener("mousedown",l=>{const c=l.target,d=u.imgScale||(u.readMode==="continuous"?u.defaultImgScaleModeC:100);Vn(l,c,{},h=>{if(h.distance===0)return;const p=(h.direction&3)===1?1:-1;t.scaleBigImages(1,0,Math.floor(d+h.distance*.6*p)),c.textContent=u.imgScale.toString()})}),w("#scaleMinusBTN",e.pageHelper).addEventListener("click",()=>t.scaleBigImages(-1,10)),w("#scaleAddBTN",e.pageHelper).addEventListener("click",()=>t.scaleBigImages(1,10)),w("#scaleInput",e.pageHelper).addEventListener("wheel",l=>t.scaleBigImages(l.deltaY>0?-1:1,5))}function jn(o,e,t,i){const n=document.createElement("div");n.classList.add("ehvp-message"),n.innerHTML=`<span ${e==="error"?"style='color: red;'":""}>${t}</span><button>X</button><div class="ehvp-message-duration-bar"></div>`,o.appendChild(n),n.querySelector("button")?.addEventListener("click",()=>n.remove());const r=n.querySelector("div.ehvp-message-duration-bar");i&&(r.style.animation=`${i}ms linear main-progress`,r.addEventListener("animationend",()=>n.remove()))}class Zn{html;chapterIndex=-1;pageNumInChapter=[];lastStage="exit";chapters;downloading;constructor(e,t,i){this.html=e,this.chapters=t,this.downloading=i,f.subscribe("pf-change-chapter",n=>{let r=0;n>=0&&(r=this.pageNumInChapter[n]||0),this.chapterIndex=n;const[a,s]=(()=>{const l=this.chapters()[n]?.queue;if(!l)return[0,0];const c=l.filter(d=>d.stage===D.DONE).length;return[l.length,c]})();this.setPageState({finished:s.toString(),total:a.toString(),current:(r+1).toString()}),this.minify(this.lastStage)}),f.subscribe("bifm-on-show",()=>this.minify("bigImageFrame")),f.subscribe("bifm-on-hidden",()=>this.minify("fullViewGrid")),f.subscribe("ifq-do",(n,r)=>{r.chapterIndex!==this.chapterIndex||!this.chapters()[this.chapterIndex]?.queue||(this.pageNumInChapter[this.chapterIndex]=n,this.setPageState({current:(n+1).toString()}))}),f.subscribe("ifq-on-finished-report",(n,r)=>{r.chapterIndex===this.chapterIndex&&(this.setPageState({finished:r.finishedIndex.size.toString()}),I("info",`No.${n+1} Finished\uFF0CCurrent index at No.${r.currIndex+1}`))}),f.subscribe("pf-on-appended",(n,r,a,s)=>{this.chapterIndex>-1&&a!==this.chapterIndex||this.setPageState({total:`${n}${s?"":".."}`})}),e.currPageElement.addEventListener("click",n=>{const r=n.target,a=parseInt(r.textContent||"1")-1;if(this.chapterIndex>=0){const s=this.chapters()[this.chapterIndex]?.queue;if(!s||!s[a])return;f.emit("imf-on-click",s[a])}})}setPageState({total:e,current:t,finished:i}){e!==void 0&&(this.html.totalPageElement.textContent=e),t!==void 0&&(this.html.currPageElement.textContent=t),i!==void 0&&(this.html.finishedElement.textContent=i)}minify(e,t=!1){this.lastStage=e;let i=[0,0];if(e==="exit")i=[0,0];else switch(e){case"fullViewGrid":u.minifyPageHelper==="never"||u.minifyPageHelper==="inBigMode"?i=[1,1]:i=t?[1,1]:[3,1];break;case"bigImageFrame":u.minifyPageHelper==="never"?i=[2,2]:i=t?[2,2]:[3,2];break}function n(h,p=!1){switch(h){case 0:return p?["entry-btn","page-status","fin-status"]:["entry-btn"];case 1:return["page-status","fin-status","auto-page-btn","config-panel-btn","downloader-panel-btn","chapters-panel-btn","entry-btn"];case 2:return["page-status","fin-status","auto-page-btn","config-panel-btn","downloader-panel-btn","chapters-panel-btn","entry-btn","read-mode-bar","pagination-adjust-bar","scale-bar"];case 3:return["page-status","auto-page-btn"]}return[]}const r=h=>h==="chapters-panel-btn"?this.chapters().length>1:h==="auto-page-btn"&&i[0]===3?this.html.pageHelper.querySelector("#auto-page-btn")?.getAttribute("data-status")==="playing":h==="pagination-adjust-bar"?u.readMode==="pagination":!0,a=n(i[0],this.downloading()).filter(r),s=n(i[1],this.downloading()).filter(r),l=Array.from(this.html.pageHelper.querySelectorAll(".b-main > .b-main-item"));for(const h of l){const p=a.indexOf(h.id);h.style.order=p===-1?"99":p.toString(),h.style.opacity=p===-1?"0":"1",h.hidden=!s.includes(h.id)}const c=this.html.pageHelper.querySelector("#entry-btn"),d=c.getAttribute("data-display-texts").split(",");c.textContent=e==="exit"?d[0]:d[1]}}function lt(o,e,t){o.addEventListener("mousedown",i=>{const{left:n}=o.getBoundingClientRect(),r=a=>{const s=a.clientX-n,l=Math.round(s/o.clientWidth*100);e(l)};r(i),o.addEventListener("mousemove",r),o.addEventListener("mouseup",()=>{o.removeEventListener("mousemove",r)},{once:!0}),o.addEventListener("mouseleave",()=>{o.removeEventListener("mousemove",r)},{once:!0})},{signal:t})}const ct='<svg width="1.4rem" height="1.4rem" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M106.854 106.002a26.003 26.003 0 0 0-25.64 29.326c16 124 16 117.344 0 241.344a26.003 26.003 0 0 0 35.776 27.332l298-124a26.003 26.003 0 0 0 0-48.008l-298-124a26.003 26.003 0 0 0-10.136-1.994z"/></svg>',Wn='<svg width="1.4rem" height="1.4rem" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M120.16 45A20.162 20.162 0 0 0 100 65.16v381.68A20.162 20.162 0 0 0 120.16 467h65.68A20.162 20.162 0 0 0 206 446.84V65.16A20.162 20.162 0 0 0 185.84 45h-65.68zm206 0A20.162 20.162 0 0 0 306 65.16v381.68A20.162 20.162 0 0 0 326.16 467h65.68A20.162 20.162 0 0 0 412 446.84V65.16A20.162 20.162 0 0 0 391.84 45h-65.68z"/></svg>',Xn='<svg width="1.4rem" height="1.4rem" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"> <path fill="#fff" d="M10.0012 8.99984H9.1C8.53995 8.99984 8.25992 8.99984 8.04601 9.10883C7.85785 9.20471 7.70487 9.35769 7.60899 9.54585C7.5 9.75976 7.5 10.0398 7.5 10.5998V13.3998C7.5 13.9599 7.5 14.2399 7.60899 14.4538C7.70487 14.642 7.85785 14.795 8.04601 14.8908C8.25992 14.9998 8.53995 14.9998 9.1 14.9998H10.0012C10.5521 14.9998 10.8276 14.9998 11.0829 15.0685C11.309 15.1294 11.5228 15.2295 11.7143 15.3643C11.9305 15.5164 12.1068 15.728 12.4595 16.1512L15.0854 19.3023C15.5211 19.8252 15.739 20.0866 15.9292 20.1138C16.094 20.1373 16.2597 20.0774 16.3712 19.9538C16.5 19.811 16.5 19.4708 16.5 18.7902V5.20948C16.5 4.52892 16.5 4.18864 16.3712 4.04592C16.2597 3.92233 16.094 3.86234 15.9292 3.8859C15.7389 3.9131 15.5211 4.17451 15.0854 4.69733L12.4595 7.84843C12.1068 8.27166 11.9305 8.48328 11.7143 8.63542C11.5228 8.77021 11.309 8.87032 11.0829 8.93116C10.8276 8.99984 10.5521 8.99984 10.0012 8.99984Z" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',dt='<svg width="1.4rem" height="1.4rem" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M16 9.50009L21 14.5001M21 9.50009L16 14.5001M4.6 9.00009H5.5012C6.05213 9.00009 6.32759 9.00009 6.58285 8.93141C6.80903 8.87056 7.02275 8.77046 7.21429 8.63566C7.43047 8.48353 7.60681 8.27191 7.95951 7.84868L10.5854 4.69758C11.0211 4.17476 11.2389 3.91335 11.4292 3.88614C11.594 3.86258 11.7597 3.92258 11.8712 4.04617C12 4.18889 12 4.52917 12 5.20973V18.7904C12 19.471 12 19.8113 11.8712 19.954C11.7597 20.0776 11.594 20.1376 11.4292 20.114C11.239 20.0868 11.0211 19.8254 10.5854 19.3026L7.95951 16.1515C7.60681 15.7283 7.43047 15.5166 7.21429 15.3645C7.02275 15.2297 6.80903 15.1296 6.58285 15.0688C6.32759 15.0001 6.05213 15.0001 5.5012 15.0001H4.6C4.03995 15.0001 3.75992 15.0001 3.54601 14.8911C3.35785 14.7952 3.20487 14.6422 3.10899 14.4541C3 14.2402 3 13.9601 3 13.4001V10.6001C3 10.04 3 9.76001 3.10899 9.54609C3.20487 9.35793 3.35785 9.20495 3.54601 9.10908C3.75992 9.00009 4.03995 9.00009 4.6 9.00009Z" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';class Kn{ui;paused=!1;abort;elementID;root;constructor(e){this.root=e,this.ui=this.create(this.root),this.flushUI()}show(){this.ui.root.hidden=!1}hidden(){this.ui.root.hidden=!0}create(e){const t=document.createElement("div");return t.classList.add("bifm-vid-ctl"),t.innerHTML=`
<div>
  <button id="bifm-vid-ctl-play" class="bifm-vid-ctl-btn">${ct}</button>
  <button id="bifm-vid-ctl-mute" class="bifm-vid-ctl-btn">${dt}</button>
    <div id="bifm-vid-ctl-volume" class="bifm-vid-ctl-pg">
      <div class="bifm-vid-ctl-pg-inner" style="width: 30%"></div>
    </div>
  <span id="bifm-vid-ctl-time" class="bifm-vid-ctl-span">00:00</span>
  <span class="bifm-vid-ctl-span">/</span>
  <span id="bifm-vid-ctl-duration" class="bifm-vid-ctl-span">10:00</span>
  <!-- <span id = "bifm-vid-ctl-drag" class="bifm-vid-ctl-span" style = "cursor: grab;">\u2720</span> -->
</div>
<div>
    <div id="bifm-vid-ctl-pg" class="bifm-vid-ctl-pg">
      <div class="bifm-vid-ctl-pg-inner" style="width: 30%"></div>
    </div>
</div>
`,e.appendChild(t),{root:t,playBTN:w("#bifm-vid-ctl-play",t),volumeBTN:w("#bifm-vid-ctl-mute",t),volumeProgress:w("#bifm-vid-ctl-volume",t),progress:w("#bifm-vid-ctl-pg",t),time:w("#bifm-vid-ctl-time",t),duration:w("#bifm-vid-ctl-duration",t)}}flushUI(e,t){const{value:i,max:n}=e?{value:e.time,max:e.duration}:{value:0,max:10},r=i/n*100;this.ui.progress.firstElementChild.style.width=`${r}%`,this.ui.time.textContent=ht(i),this.ui.duration.textContent=ht(n),!t&&(this.ui.playBTN.innerHTML=this.paused?ct:Wn,this.ui.volumeBTN.innerHTML=u.muted?dt:Xn,this.ui.volumeProgress.firstElementChild.style.width=`${u.volume||30}%`)}attach(e){this.detach(),this.show(),this.abort=new AbortController;const t={time:e.currentTime,duration:e.duration};this.flushUI(t),e.addEventListener("timeupdate",i=>{const n=i.target;t&&(t.time=n.currentTime,this.flushUI(t,!0))},{signal:this.abort.signal}),e.onwaiting=()=>I("debug","onwaiting"),e.onended=()=>{e.currentTime=0,e.play()},e.muted=u.muted||!1,e.volume=Math.min(1,(u.volume||30)/100),this.paused||e.play(),this.elementID=e.id,this.elementID||(this.elementID="vid-"+Math.random().toString(36).slice(2),e.id=this.elementID),this.ui.playBTN.addEventListener("click",()=>{const i=this.getVideoElement();i&&(this.paused=!this.paused,this.paused?i.pause():i.play(),this.flushUI(t))},{signal:this.abort.signal}),this.ui.volumeBTN.addEventListener("click",()=>{const i=this.getVideoElement();i&&(u.muted=!u.muted,i.muted=u.muted,q(u),this.flushUI(t))},{signal:this.abort.signal}),lt(this.ui.progress,i=>{const n=this.getVideoElement();n&&(n.currentTime=n.duration*(i/100),t.time=n.currentTime,this.flushUI(t))},this.abort.signal),lt(this.ui.volumeProgress,i=>{const n=this.getVideoElement();n&&(u.volume=Math.min(100,i),q(u),n.volume=Math.min(1,u.volume/100),this.flushUI(t))},this.abort.signal)}detach(){const e=this.getVideoElement();e&&e.pause(),this.elementID=void 0,this.abort?.abort(),this.abort=void 0,this.flushUI(),this.hidden()}getVideoElement(){return this.root.querySelector(`#${this.elementID}`)}}function ht(o){const e=Math.floor(o/60).toString().padStart(2,"0"),t=Math.floor(o%60).toString().padStart(2,"0");return`${e}:${t}`}class ut{element;scrolling=!1;step;distance=0;additional=0;lastDirection;directionChanged=!1;scrollMargin;maxScrollMargin;setScrollMargin;constructor(e,t,i){this.element=e,this.step=t||1,i&&i==="x"?(this.scrollMargin=()=>this.element.scrollLeft,this.maxScrollMargin=()=>this.element.scrollWidth-this.element.clientWidth,this.setScrollMargin=n=>this.element.scrollLeft=n):(this.scrollMargin=()=>this.element.scrollTop,this.maxScrollMargin=()=>this.element.scrollHeight-this.element.clientHeight,this.setScrollMargin=n=>this.element.scrollTop=n)}scroll(e,t){t&&(this.step=t);let i;const n=new Promise(c=>i=c);this.distance=Math.abs(e);const r=e<0?"up":"down";if(this.directionChanged=this.lastDirection!==void 0&&this.lastDirection!==r,this.scrolling||this.distance<=0)return n;const a=e/this.distance;this.lastDirection=r,this.additional=0,this.scrolling=!0;const s=()=>{this.scrolling=!1,this.directionChanged=!1,this.lastDirection=void 0,this.distance=0,i?.()},l=()=>{if(!this.scrolling)return s();this.distance-=this.step+this.additional;let c=this.scrollMargin()+(this.step+this.additional)*a;if(c=Math.max(c,0),c=Math.min(c,this.maxScrollMargin()),this.setScrollMargin(c),this.distance<=0||this.directionChanged||c===0||c===this.maxScrollMargin())return s();window.requestAnimationFrame(l)};return window.requestAnimationFrame(l),n}}class pe{id;x;y;constructor(e,t,i){this.id=e,this.x=t,this.y=i}static from(e){return new pe(e.identifier,e.clientX,e.clientY)}distance(e){return pt({x:this.x,y:this.y},{x:e.x,y:e.y})}direction(e){const t=this.x-e.x,i=this.y-e.y,n=Math.abs(t),r=Math.abs(i);return n>r?t>0?"L":"R":i>0?"U":"D"}}class Yn{element;trail={};handlers;constructor(e,t){this.element=e,this.handlers=t,this.element.addEventListener("touchstart",i=>this.start(i)),this.element.addEventListener("touchmove",i=>this.move(i)),this.element.addEventListener("touchend",i=>this.end(i))}start(e){const t=Array.from(e.targetTouches).map(pe.from);this.trail=t.reduce((n,r)=>(n[r.id]=[r],n),{});let i=0;t.length===2&&(i=t[0].distance(t[1])),this.handlers.start?.(i,e)}move(e){const t=Array.from(e.targetTouches).map(pe.from);if(t.forEach(i=>{const n=this.trail[i.id];n[n.length-1].distance(i)>30&&n.push(i)}),Object.keys(this.trail).length===2&&t.length===2){const i=t[0],n=t[1];this.handlers.zoom?.(i.distance(n),e);return}}end(e){const t=Object.keys(this.trail).map(Number);if(t.length===1&&this.trail[t[0]].length>1){const i=this.trail[t[0]];let n;for(let r=0,a=1;a<i.length;r++,a++)if(!n)n=i[r].direction(i[a]);else if(i[r].direction(i[a])!==n)return;this.handlers.swipe?.(n,e)}if(t.length===2){const i=this.trail[t[0]],n=this.trail[t[1]];if(i.length>1&&n.length>1){const r=[i[0],i[i.length-1]],a=[n[0],n[n.length-1]],{angle:s,clockwise:l}=Jn(r,a);this.handlers.rotate?.(l,s,e)}}this.trail={},this.handlers.end?.(e)}}function pt(o,e){const t=o.x-e.x,i=o.y-e.y;return Math.sqrt(t*t+i*i)}function Jn(o,e){if(o.length!==2||e.length!==2)throw new Error("line1 or line2 length must be 2");[o,e].forEach(([p,g])=>{if(p.x===g.x&&p.y===g.y)throw new Error(`start at ${p.toString()}, end at ${g.toString()}, not line`)});const t={x:o[1].x-o[0].x,y:o[1].y-o[0].y},i={x:e[1].x-e[0].x,y:e[1].y-e[0].y},n=t.x*i.x+t.y*i.y,r=Math.sqrt(t.x**2+t.y**2),a=Math.sqrt(i.x**2+i.y**2),s=n/(r*a),l=Math.acos(s),d=t.x*i.y-t.y*i.x<=0;return{angle:l*(180/Math.PI),clockwise:d}}class Qn{root;container;observer;intersectingElements=[];renderingElements=[];currentIndex=0;preventStep={currentPreventFinished:!1};debouncer;callbackOnWheel;visible=!1;html;vidController;chapterIndex=0;getChapter;loadingHelper;currLoadingState=new Map;scrollerY;scrollerX;lastMouse;pageNumInChapter=[];oriented="next";intersectingIndexLock=!1;constructor(e,t){switch(this.html=e,this.root=e.bigImageFrame,this.debouncer=new H,this.getChapter=t,this.scrollerY=new ut(this.root),this.scrollerX=new ut(this.root,void 0,"x"),this.container=document.createElement("div"),this.container.classList.add("bifm-container"),u.readMode){case"continuous":this.container.classList.add("bifm-container-vert");break;case"pagination":this.container.classList.add("bifm-container-page");break;case"horizontal":this.container.classList.add("bifm-container-hori");break}this.observer=new IntersectionObserver(i=>this.intersecting(i),{root:this.root}),this.root.appendChild(this.container),this.initEvent(),f.subscribe("pf-on-appended",(i,n,r)=>{r===this.chapterIndex&&this.append(n)}),f.subscribe("pf-change-chapter",i=>{this.chapterIndex=Math.max(0,i),this.container.innerHTML=""}),f.subscribe("imf-on-click",i=>this.show(i)),f.subscribe("imf-on-finished",(i,n,r)=>{if(r.chapterIndex!==this.chapterIndex||(this.currLoadingState.delete(i),this.debouncer.addEvent("FLUSH-LOADING-HELPER",()=>this.flushLoadingHelper(),20),!n))return;const a=this.renderingElements.find(s=>ne(s)===i);a&&(a.innerHTML="",a.appendChild(this.newMediaNode(r)))}),f.subscribe("imf-resize",i=>{i.chapterIndex===this.chapterIndex&&this.onResize(i)}),f.subscribe("bifm-rotate-image",()=>this.rotate(!0)),this.loadingHelper=document.createElement("span"),this.loadingHelper.id="bifm-loading-helper",this.root.appendChild(this.loadingHelper),f.subscribe("imf-download-state-change",i=>{if(i.chapterIndex!==this.chapterIndex)return;const[n,r]=[this.currentIndex,this.currentIndex+(u.readMode!=="pagination"?1:u.paginationIMGCount)];i.index<n||i.index>=r||(this.currLoadingState.set(i.index,Math.floor(i.downloadState.loaded/i.downloadState.total*100)),this.debouncer.addEvent("FLUSH-LOADING-HELPER",()=>this.flushLoadingHelper(),20))}),new er(this,e.autoPageBTN)}onResize(e){const t=this.container.querySelector(`div[d-index="${e.index}"]`),i=this.container.querySelector(`div[d-index="${this.currentIndex}"]`);if(!(!t||!i))if(u.readMode==="continuous"){const n=i.offsetTop,r=this.root.scrollTop;t.style.aspectRatio=e.ratio().toString(),n!==i.offsetTop&&(this.root.scrollTop=i.offsetTop+(n-r))}else{const n=i.offsetLeft,r=this.root.scrollLeft;t.style.aspectRatio=e.ratio().toString(),u.readMode==="pagination"&&e.index===this.currentIndex?this.jumpTo(this.currentIndex):n!==i.offsetLeft&&(this.root.scrollLeft=i.offsetLeft-(n-r))}}intersecting(e){for(const t of e)if(t.isIntersecting){const i=t.target;if(ne(i)===-1)continue;this.intersectingElements.push(i)}else{const i=this.intersectingElements.indexOf(t.target);i>-1&&this.intersectingElements.splice(i,1)}if(this.intersectingIndexLock)if(this.intersectingElements.find(i=>this.currentIndex===ne(i)))this.intersectingIndexLock=!1;else return;this.debouncer.addEvent("rendering-images",()=>this.rendering(),50)}rendering(){const e=this.intersectingElements.map(l=>({index:ne(l),elem:l}));e.filter(l=>l.index>-1).sort((l,c)=>l.index-c.index),u.reversePages&&e.reverse();const t=e.map(l=>l.elem);if(t.length===0)return;let i=t[0],[n,r]=[0,u.paginationIMGCount];for(;(i=i.previousElementSibling)&&n<r;)t.unshift(i),n++;for(i=t[t.length-1],n=0;(i=i.nextElementSibling)&&n<r;)t.push(i),n++;const a=[],s=[];for(const l of this.renderingElements)t.includes(l)?s.push(l):a.push(l);a.forEach(l=>l.innerHTML="");for(const l of t)if(!s.includes(l)){l.innerHTML="";const c=this.getIMF(l);c&&l.appendChild(this.newMediaNode(c))}this.renderingElements=t}getIMF(e){const t=ne(e);return t===-1||isNaN(t)?null:this.getChapter(this.chapterIndex).queue[t]??null}initEvent(){this.root.addEventListener("wheel",e=>this.onWheel(new WheelEvent("wheel",{deltaY:u.scrollingDelta*(e.deltaY<0?-1:1),buttons:e.buttons,button:e.button}),void 0,void 0,void 0,e)),this.root.addEventListener("scroll",e=>this.onScroll(e),{passive:!1}),this.root.addEventListener("contextmenu",e=>{e.preventDefault()}),this.root.addEventListener("mousedown",e=>{if(e.button!==0||e.target.classList.contains("img-land"))return;let t=!1;const i={x:e.clientX,y:e.clientY};let n={x:e.clientX,y:e.clientY},r;const a=new AbortController,[s,l]=[this.root.scrollTop,this.root.scrollLeft];this.root.addEventListener("mouseup",c=>{a.abort(),t?u.magnifier&&u.imgScale===100&&(this.scaleBigImages(1,0,u.imgScale,!1),[this.root.scrollTop,this.root.scrollLeft]=[s,l]):this.hidden(c),t=!1},{once:!0}),this.root.addEventListener("mousemove",c=>{if(u.dragImageOut){t=!0;return}if(!j){if(!t){if(pt(i,{x:c.clientX,y:c.clientY})<20)return;if(u.magnifier&&u.imgScale===100&&this.scaleBigImages(1,0,150,!1),u.readMode==="pagination"){const h=this.intersectingElements;h.length>0&&(r=h[h.length-1].offsetLeft+h[h.length-1].offsetWidth-h[0].offsetLeft)}}t=!0,this.debouncer.addEvent("BIG-IMG-MOUSE-MOVE",()=>{tr(this.root,c,n,r),n={x:c.clientX,y:c.clientY}},5)}},{signal:a.signal})}),new Yn(this.root,{start:()=>{u.readMode==="pagination"&&(this.root.style.overflow="hidden")},swipe:e=>{u.readMode==="continuous"||u.readMode==="horizontal"||(this.oriented=(()=>{switch(e){case"L":return u.reversePages?"next":"prev";case"R":return u.reversePages?"prev":"next";case"U":return"next";case"D":return"prev"}})(),this.stepNext(this.oriented),u.readMode==="pagination"&&(this.root.style.overflow=""))},rotate:(e,t)=>{}})}cherryPickCurrent(e){f.emit("add-cherry-pick-range",this.chapterIndex,this.currentIndex,!e,!1);const t=u.readMode==="pagination"&&u.paginationIMGCount>1,i=this.currentIndex+u.paginationIMGCount-1;t&&f.emit("add-cherry-pick-range",this.chapterIndex,i,!e,!0);const n=`${e?"Excluded":"Selected"} Image${t?"s":""} no.${this.currentIndex+1}${t?"-"+(i+1):""}`;f.emit("notify-message","info",n,1e3)}rotate(e){const t=["bifm-rotate-90","bifm-rotate-180","bifm-rotate-270",""];e||t.reverse();let i=t.findIndex(r=>this.root.classList.contains(r));i===-1?i=e?3:0:this.root.classList.remove(t[i]);const n=(i+1)%4;t[n]!==""&&this.root.classList.add(t[n])}scrollStop(){this.scrollerY.scrolling=!1,this.scrollerX.scrolling=!1}hidden(e){e&&e.target&&e.target.tagName==="SPAN"||(this.visible=!1,f.emit("bifm-on-hidden"),this.html.fullViewGrid.focus(),this.vidController?.detach(),this.root.classList.add("big-img-frame-collapse"),this.renderingElements.forEach(t=>t.innerHTML=""),this.renderingElements=[],this.intersectingIndexLock=!1)}show(e){this.visible=!0,this.currentIndex=e.index,this.intersectingIndexLock=!0,this.root.classList.remove("big-img-frame-collapse"),this.root.focus(),this.debouncer.addEvent("TOGGLE-CHILDREN-D",()=>e.chapterIndex===this.chapterIndex&&this.setNow(e),100),f.emit("bifm-on-show")}setNow(e){this.currentIndex=e.index,this.pageNumInChapter[this.chapterIndex]=e.index,this.visible&&this.jumpTo(e.index),f.emit("ifq-do",e.index,e,this.oriented??"next"),this.lastMouse=void 0,this.currLoadingState.clear(),this.flushLoadingHelper()}append(e){if(u.readMode==="pagination")return;const t=[],i=this.root.scrollWidth;for(const r of e){const a=document.createElement("div");a.style.aspectRatio=r.ratio().toString(),a.setAttribute("d-index",r.index.toString()),t.push(a),this.observer.observe(a)}const n=u.readMode!=="continuous"&&u.reversePages;if(this.container.childElementCount===0){const r=window.innerWidth/window.innerHeight,a=document.createElement("div");a.style.aspectRatio=r.toString(),a.setAttribute("d-index","-1"),t.unshift(a);const s=document.createElement("div");s.style.aspectRatio=r.toString(),s.setAttribute("d-index","-1"),t.push(s)}else t.push(n?this.container.firstElementChild:this.container.lastElementChild);n?(t.reverse(),this.container.prepend(...t),this.root.scrollLeft=this.root.scrollLeft+this.root.scrollWidth-i):this.container.append(...t)}changeLayout(){switch(this.resetScaleBigImages(!0),u.readMode){case"continuous":this.container.classList.remove("bifm-container-hori","bifm-container-vert","bifm-container-page"),this.container.classList.add("bifm-container-vert");break;case"pagination":this.container.classList.remove("bifm-container-hori","bifm-container-vert","bifm-container-page"),this.container.classList.add("bifm-container-page");break;case"horizontal":this.container.classList.remove("bifm-container-hori","bifm-container-vert","bifm-container-page"),this.container.classList.add("bifm-container-hori");break}this.container.innerHTML="",this.intersectingElements=[],this.renderingElements=[];const e=this.getChapter(this.chapterIndex).queue;this.append(e),this.jumpTo(this.currentIndex)}jumpTo(e){switch(u.readMode){case"pagination":{const t=this.setElements();this.container.offsetWidth>this.root.offsetWidth&&(u.reversePages?this.root.scrollLeft=this.container.offsetWidth-this.root.offsetWidth:this.root.scrollLeft=0),this.root.scrollTop=0,t[0].firstElementChild&&this.tryPlayVideo(t[0].firstElementChild);break}case"horizontal":{const t=this.container.querySelector(`div[d-index="${e}"]`);if(!t)return;u.reversePages?this.root.scrollLeft=t.offsetLeft-this.root.offsetWidth+t.offsetWidth:this.root.scrollLeft=t.offsetLeft;break}case"continuous":{const t=this.container.querySelector(`div[d-index="${e}"]`);if(!t)return;const i=this.root.offsetHeight,n=t.offsetHeight;let r=e===0?0:Math.floor((i-n)/2);r=Math.max(0,r),this.root.scrollTop=t.offsetTop-r;break}}}stepNext(e,t=0,i){this.oriented=e;let n=i||this.currentIndex;if(n===void 0||isNaN(n))return;const r=this.getChapter(this.chapterIndex)?.queue;!r||r.length===0||(n=e==="next"?n+u.paginationIMGCount:n-u.paginationIMGCount,u.paginationIMGCount>1&&(n+=t),n<-u.paginationIMGCount?n=r.length-1:n=Math.max(0,n),r[n]&&(this.resetPreventStep(),this.setNow(r[n])))}checkCurrent(){const e=this.root.getBoundingClientRect(),t=u.readMode==="continuous"?(i,n)=>i.top<=n.height/2&&i.bottom>=n.height/2:(i,n)=>i.left<=n.width/2&&i.right>=n.width/2;for(const i of this.intersectingElements){const n=i.getBoundingClientRect();if(t(n,e)){const r=this.getIMF(i);if(r===null||r.index===this.currentIndex)continue;f.emit("ifq-do",r.index,r,this.oriented),this.currentIndex=r.index,this.pageNumInChapter[this.chapterIndex]=r.index,i.firstElementChild&&this.tryPlayVideo(i.firstElementChild);break}}}onScroll(e){switch(u.readMode){case"continuous":{const[t,i]=[this.container.children.item(1),this.container.children.item(this.container.children.length-2)];let n=t.offsetTop??0;this.root.scrollTop<n-3?this.root.scrollTop=n-2:(n=i?i.offsetTop+i.offsetHeight-this.root.offsetHeight:this.root.scrollHeight,this.root.scrollTop>n+3&&(this.root.scrollTop=n+2));break}case"pagination":break;case"horizontal":{const[t,i]=[this.container.children.item(1),this.container.children.item(this.container.children.length-2)];let n=t?.offsetLeft??0;this.root.scrollLeft<n-3?this.root.scrollLeft=n-2:(n=i?i.offsetLeft+i.offsetWidth-this.root.offsetWidth:this.root.scrollWidth,this.root.scrollLeft>n+3&&(this.root.scrollLeft=n+2));break}}u.readMode!=="pagination"&&this.debouncer.addEvent("bifm-on-wheel",()=>this.checkCurrent(),69)}onWheel(e,t,i,n,r){const a=()=>{e.preventDefault(),r?.preventDefault()};if(n||this.callbackOnWheel?.(e),e.buttons===2){a(),this.scaleBigImages(e.deltaY>0?-1:1,5);return}const[s,l]=e.deltaY>0?["next","prev"]:["prev","next"];switch(this.oriented=s,u.readMode){case"pagination":{const c=this.checkOverflow(),[d,h]=u.reversePages?[l,this.oriented]:[this.oriented,l];if(this.root.classList.contains("bifm-rotate-90")||this.root.classList.contains("bifm-rotate-270")){this.stepNext(this.oriented);break}if(c[this.oriented].overY-1<=0&&c[d].overX-1<=0){if(a(),!t&&(c[h].overX>0||c[l].overY>0)&&this.tryPreventStep())break;this.stepNext(this.oriented);break}let g=this.oriented==="next"?1:-1;i&&c[this.oriented].overY>0&&this.scrollerY.scroll(Math.min(c[this.oriented].overY,Math.abs(e.deltaY*3))*g,Math.abs(Math.ceil(e.deltaY/4))),g=g*(u.reversePages?-1:1),c[this.oriented].overY-1<=0&&c[d].overX>0&&this.scrollerX.scroll(Math.min(c[d].overX,Math.abs(e.deltaY*3))*g,Math.abs(Math.ceil(e.deltaY/4)));break}case"horizontal":{a(),this.scrollerX.scroll(e.deltaY*(u.reversePages?-1:1),u.scrollingSpeed);break}case"continuous":{i&&this.scrollerY.scroll(e.deltaY,u.scrollingSpeed);break}}}resetPreventStep(e){this.preventStep.ani?.cancel(),this.preventStep.ele?.remove(),this.preventStep={currentPreventFinished:e??!1}}tryPreventStep(){if(u.preventScrollPageTime===0)return!1;if(this.preventStep.currentPreventFinished)return this.resetPreventStep(),!1;if(!this.preventStep.ele){const e=document.createElement("div");if(e.style.width="100vw",e.style.position="fixed",e.style.display="flex",e.style.justifyContent="center",e.style.bottom="0px",e.innerHTML='<div style="width: 30vw;height: 0.1rem;background-color: #1b00ff59;text-align: center;font-size: 0.8rem;position: relative;font-weight: 800;color: gray;border-radius: 7px;border: 1px solid #510000;"><span style="position: absolute;bottom: -3px;"></span></div>',this.root.appendChild(e),this.preventStep.ele=e,u.preventScrollPageTime>0){const t=e.children[0].animate([{width:"30vw"},{width:"0vw"}],{duration:u.preventScrollPageTime});t.onfinish=()=>this.preventStep.ele&&this.resetPreventStep(!0),this.preventStep.ani=t}this.preventStep.currentPreventFinished=!1}return!0}checkOverflow(){const e=Array.from(this.container.querySelectorAll("div:not(.bifm-node-hide)"));if(e.length===0)return{prev:{overX:0,overY:0},next:{overX:0,overY:0},elements:[]};const t=this.root.getBoundingClientRect().left,i=e[0].getBoundingClientRect(),n=e[e.length-1].getBoundingClientRect();return{prev:{overX:Math.round(i.left)*-1+t,overY:Math.round(i.top)*-1},next:{overX:Math.round(n.right)-this.root.offsetWidth,overY:Math.round(i.bottom)-this.root.offsetHeight},elements:e}}restoreScrollTop(e,t){this.root.scrollTop=this.getRealOffsetTop(e)-t}getRealOffsetTop(e){return e.offsetTop}newMediaNode(e){if(e.contentType?.startsWith("video")){const t=document.createElement("video");return t.classList.add("bifm-img"),t.classList.add("bifm-vid"),t.draggable=u.dragImageOut,t.onloadeddata=()=>{this.visible&&e.index===this.currentIndex&&this.tryPlayVideo(t)},t.src=e.node.blobSrc,t}else{const t=document.createElement("img");return t.decoding="async",t.classList.add("bifm-img"),t.draggable=u.dragImageOut,e.stage===D.DONE?t.src=e.node.blobSrc:e.node.thumbnailSrc?t.src=e.node.thumbnailSrc:t.src=ee,t}}tryPlayVideo(e){e instanceof HTMLVideoElement?(this.vidController||(this.vidController=new Kn(this.html.root)),this.vidController.attach(e)):this.vidController?.detach()}scaleBigImages(e,t,i,n){let r=u.imgScale,a=i??r+t*e;switch(u.readMode){case"pagination":{const s=X(this.html.styleSheet,".bifm-container-page");if(a=Math.max(a,100),a=Math.min(a,300),s&&(s.style.height=`${a}%`),u.paginationIMGCount===1){const l=X(this.html.styleSheet,".bifm-container-page .bifm-img");l&&(l.style.maxWidth=a>100?"":"100%")}}break;case"horizontal":{const s=this.root.scrollLeft,l=X(this.html.styleSheet,".bifm-container-hori");a=Math.max(a,80),a=Math.min(a,300),l&&(l.style.height=`${a}%`),this.root.scrollLeft=s*(a/r)}break;case"continuous":{const s=this.root.scrollTop,l=X(this.html.styleSheet,".bifm-container-vert");a=Math.max(a,20),a=Math.min(a,100),l&&(l.style.width=`${a}%`),this.root.scrollTop=s*(a/r)}break}return(n??!0)&&(u.imgScale=a,q(u)),w("#scaleInput",this.html.pageHelper).textContent=`${a}`,a}resetScaleBigImages(e){const t=u.readMode!=="continuous"||j?100:u.defaultImgScaleModeC;this.scaleBigImages(1,0,t,e)}flushLoadingHelper(){if(this.currLoadingState.size===0)this.loadingHelper.style.display="none";else{this.loadingHelper.style.display==="none"&&(this.loadingHelper.style.display="inline-block");const e=Array.from(this.currLoadingState).map(([t,i])=>`[P-${t+1}: ${i}%]`);u.reversePages&&e.reverse(),this.loadingHelper.textContent=`Loading ${e.join(",")}`}}getPageNumber(){return this.pageNumInChapter[this.chapterIndex]??0}setElements(){let e=Array.from(this.container.childNodes);const t=u.paginationIMGCount*3;if(e.length>t)e.splice(t).forEach(h=>h.remove());else for(;e.length<t;){const d=document.createElement("div");e.push(d)}const i=this.getChapter(this.chapterIndex).queue;let[n,r]=[this.currentIndex-u.paginationIMGCount,this.currentIndex+u.paginationIMGCount*2-1];[n,r]=[Math.max(n,0),Math.min(r,i.length-1)];const a=e.map(d=>({index:ne(d),elem:d})).sort((d,h)=>d.index-h.index),s=d=>{let h=a.findIndex(g=>g.index===d);if(h>-1)return[a.splice(h,1)[0].elem,!1];if(h=a.findIndex(g=>g.index<n||g.index>r),h===-1)return[null,!1];const p=a.splice(h,1)[0];return p.elem.setAttribute("d-index",d.toString()),[p.elem,!0]};e=[];const l=[];for(let d=n;d<=r;d++){const[h,p]=s(d);if(!h)throw new Error(`BIFM.setElements cannot found element by index:[${d}], or found empty element`);const g=d>=this.currentIndex&&d<this.currentIndex+u.paginationIMGCount;e.push(h),g?(h.classList.remove("bifm-node-hide"),l.push(h)):h.classList.add("bifm-node-hide"),(p||h.childElementCount===0)&&(h.style.aspectRatio="",h.innerHTML="",h.appendChild(this.newMediaNode(i[d])))}u.reversePages&&e.reverse(),this.renderingElements=[...e];const c=a.map(d=>(d.elem.setAttribute("d-index","-1"),d.elem.innerHTML="",d.elem.classList.add("bifm-node-hide"),d.elem));return e.push(...c),this.container.append(...e),l}}class er{bifm;status;button;lockVer;constructor(e,t){this.bifm=e,this.status="stop",this.button=t,this.lockVer=0,this.bifm.callbackOnWheel=()=>{this.status==="running"&&(this.stop(),this.start(this.lockVer))},f.subscribe("bifm-on-hidden",()=>this.stop()),f.subscribe("bifm-on-show",()=>u.autoPlay&&this.start(this.lockVer)),f.subscribe("toggle-auto-play",()=>{this.status==="stop"?this.start(this.lockVer):this.stop()}),this.initPlayButton()}initPlayButton(){this.button.addEventListener("click",()=>{this.status==="stop"?this.start(this.lockVer):this.stop()})}async start(e){this.status="running",this.button.setAttribute("data-status","playing");const t=this.button.getAttribute("data-display-texts").split(",");if(this.button.firstElementChild.innerText=t[1],!this.bifm.visible){const r=this.bifm.getChapter(this.bifm.chapterIndex).queue;if(r.length===0)return;this.bifm.show(r[this.bifm.currentIndex])}const i=w("#auto-page-progress",this.button),n=()=>u.readMode==="pagination"?u.autoPageSpeed:1;for(;;){if(await W(10),i.style.animation=`${n()*1e3}ms linear main-progress`,await W(n()*1e3),this.lockVer!==e)return;if(i.style.animation="",this.status!=="running")break;const r=this.bifm.getChapter(this.bifm.chapterIndex).queue;if(this.bifm.currentIndex<0||this.bifm.currentIndex>=r.length)break;if(u.readMode==="pagination"){const s=this.bifm.container.querySelector(`div[d-index="${this.bifm.currentIndex}"]`)?.firstElementChild;if(s instanceof HTMLVideoElement){let l;const c=new Promise(d=>l=d);s.addEventListener("timeupdate",()=>{s.currentTime>=s.duration-1&&W(1e3).then(l)}),await c}}const a=this.bifm.root.offsetHeight/2;this.bifm.onWheel(new WheelEvent("wheel",{deltaY:a}),!0,!0,!0)}this.stop()}stop(){this.status="stop",this.button.setAttribute("data-status","paused");const e=w("#auto-page-progress",this.button);e.style.animation="",this.lockVer+=1;const t=this.button.getAttribute("data-display-texts").split(",");this.button.firstElementChild.innerText=t[0],this.bifm.scrollStop()}}function ne(o){if(!o)return-1;const e=o.getAttribute("d-index")||"",t=parseInt(e);return isNaN(t)?-1:t}function tr(o,e,t,i){let[n,r]=[e.clientY-t.y,e.clientX-t.x];[n,r]=[-n,-r];const a=o.scrollHeight-o.offsetHeight;if(a>0){const l=u.readMode==="continuous"?1:a/(o.offsetHeight/4)*3;let c=o.scrollTop+n*l;c=Math.max(c,0),c=Math.min(c,a),o.scrollTop=c}const s=(i??o.scrollWidth)-o.offsetWidth;if(s>0){const l=u.readMode!=="pagination"?1:s/(o.offsetWidth/4)*3;let c=o.scrollLeft+r*l;o.scrollLeft=c}}function ir(o){const e=Element.prototype.scrollTo;Object.defineProperty(o,"scrollTo",{value:e,writable:!0,configurable:!0})}function nr(o,e,t){const i=Fn();[i.fullViewGrid,i.bigImageFrame].forEach(g=>ir(g));const n=ye.newQueue(),r=new Dt(n),a=new Vt(n,o),s=new qt(i,n,r,a,o),l=new Zn(i,()=>a.chapters,()=>s.downloading),c=new Qn(i,g=>a.chapters[g]);new Un(i,c,t);const d=$n(i,c,n,r,l);Hn(d,i,c,s,l),f.subscribe("downloader-canvas-on-click",g=>{n.currIndex=g,n.chapterIndex===c.chapterIndex&&c.show(n[g])}),f.subscribe("notify-message",(g,m,b)=>jn(i.messageBox,g,m,b)),a.beforeInit=()=>i.pageLoading.style.display="flex",a.afterInit=()=>{if(i.pageLoading.style.display="none",r.processingIndexList=[0],r.start(),u.autoEnterBig||c.visible){const g=n[c.getPageNumber()];g&&c.show(g)}},u.first&&(d.showGuideEvent(),u.first=!1,q(u)),f.subscribe("start-download",g=>{h.first=!1,a.chapters.length===0?f.emit("pf-init",()=>{s.start(),g()}):(s.start(),W(20).then(g))});const h={first:!0};function p(g){i.pageHelper&&(g?(d.showFullViewGrid(),h.first&&(h.first=!1,f.emit("pf-init",()=>{}))):(["config","downloader"].forEach(m=>d.togglePanelEvent(m,!0)),d.hiddenFullViewGrid()))}return f.subscribe("toggle-main-view",p),u.autoOpen&&e&&(i.entryBTN.setAttribute("data-stage","open"),p(!0)),()=>(console.log("destory eh-view-enhance"),p(!1),a.abort(),r.abort(),n.length=0,f.reset(),document.querySelector("#ehvp-base")?.remove(),W(500))}let Pe;const rr=new H;function Me(){rr.addEvent("LOCATION-CHANGE",()=>{const o=()=>{if(window.self!==window.top){I("error","in iframe");return}if(document.querySelector(".ehvp-base"))return;const[e,t,i]=Sn(window.location.href);e&&(Pe=nr(e,t,i))};Pe?Pe().then(o):o()},20)}setTimeout(()=>{const o=history.pushState;history.pushState=function(...i){return Me(),o.apply(this,i)};const e=history.replaceState;history.replaceState=function(...i){return e.apply(this,i)},window.addEventListener("popstate",Me),Me()},300)})(saveAs,pica,zip);
