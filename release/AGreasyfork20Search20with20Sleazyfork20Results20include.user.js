// ==UserScript==
// @name         Greasyfork Search with Sleazyfork Results include
// @namespace    hoothin
// @version      1.6.6
// @author       hoothin
// @match        http*://greasyfork.org/*
// @match        http*://www.greasyfork.org/*
// @match        http*://sleazyfork.org/*
// @match        http*://www.sleazyfork.org/*
// @grant        GM_xmlhttpRequest
// @grant        GM_setValue
// @grant        GM_getValue
// @grant        GM_registerMenuCommand
// @grant        GM_notification
// @grant        GM.xmlHttpRequest
// @grant        GM.setValue
// @grant        GM.getValue
// @grant        GM.registerMenuCommand
// @grant        GM.notification
// @connect      greasyfork.org
// @connect      sleazyfork.org
// @contributionURL https://www.buymeacoffee.com/hoothin
// @contributionAmount 1
// @downloadURL https://raw.githubusercontent.com/FiorenMas/Userscripts/release/release/AGreasyfork20Search20with20Sleazyfork20Results20include.user.js
// @updateURL https://raw.githubusercontent.com/FiorenMas/Userscripts/release/release/AGreasyfork20Search20with20Sleazyfork20Results20include.meta.js
// ==/UserScript==
(function(){"use strict";var M,q,x;typeof GM_xmlhttpRequest<"u"?M=GM_xmlhttpRequest:typeof GM<"u"&&typeof GM.xmlHttpRequest<"u"&&(M=GM.xmlHttpRequest),typeof GM_registerMenuCommand<"u"?q=GM_registerMenuCommand:typeof GM<"u"&&typeof GM.registerMenuCommand<"u"&&(q=GM.registerMenuCommand),typeof GM_notification<"u"?x=GM_notification:typeof GM<"u"&&typeof GM.notification<"u"&&(x=GM.notification),typeof M>"u"&&(M=e=>{}),typeof q>"u"&&(q=(e,t)=>{}),typeof x>"u"&&(x=e=>{});var C={supportGM:typeof GM_getValue=="function"&&typeof GM_getValue("a","b")<"u",supportGMPromise:typeof GM<"u"&&typeof GM.getValue=="function"&&typeof GM.getValue("a","b")<"u",mxAppStorage:function(){try{return window.external.mxGetRuntime().storage}catch{}}(),operaUJSStorage:function(){try{return window.opera.scriptStorage}catch{}}(),setItem:function(e,t){this.operaUJSStorage?this.operaUJSStorage.setItem(e,t):this.mxAppStorage?this.mxAppStorage.setConfig(e,t):this.supportGM?GM_setValue(e,t):this.supportGMPromise?GM.setValue(e,t):window.localStorage&&window.localStorage.setItem(e,t)},getItem:function(e,t){var r;if(this.operaUJSStorage)r=this.operaUJSStorage.getItem(e);else if(this.mxAppStorage)r=this.mxAppStorage.getConfig(e);else if(this.supportGM)r=GM_getValue(e);else if(this.supportGMPromise){r=GM.getValue(e).then(s=>{t(s)});return}else window.localStorage&&(r=window.localStorage.getItem(e));t(r)}};if(document.querySelector("span.sign-in-link")){var H=/greasyfork\.org/.test(location.hostname)?"sleazyfork":"greasyfork";/scripts\/\d+/.test(location.href)?!document.querySelector("#script-info")&&(H=="greasyfork"||document.querySelector("div.width-constraint>section>p>a").href.indexOf("sign_in")!=-1)&&(location.href=location.href.replace(/\/\/([^\.]+\.)?(greasyfork|sleazyfork)\.org/,"//$1"+H+".org")):/\/(scripts|users)(\/|.*(\?|&)q=|.*[\?&]set=)/.test(location.href)&&M({method:"GET",url:location.href.replace(/\/\/([^\.]+\.)?(greasyfork|sleazyfork)\.org/,"//$1"+H+".org"),onload:function(e){var t=null;try{t=document.implementation.createHTMLDocument(""),t.documentElement.innerHTML=e.responseText}catch{console.log("parse error")}if(t){var r=t.querySelector("ol.script-list");if(r){var s=document.querySelector("ol.script-list");if(!s){s=document.createElement("ol"),s.setAttribute("class","script-list");var l=document.querySelector(".sidebarred-main-content"),o=l.querySelectorAll("p");for(let a=0;a<o.length;a++){let i=o[a];l.removeChild(i)}l.appendChild(s)}var n=r.querySelectorAll("li");if(n)for(let a=0;a<n.length;a++){let i=n[a];s.querySelector("li[data-script-id='"+i.dataset.scriptId+"']")||s.appendChild(i)}}}},onerror:function(e){console.log(e)}})}var G,B="vip.*(\u89C6\u9891|\u8996\u983B)|\u7F51\u8BFE|\u5237\u8BFE|(mooc|\u8003\u8BD5|\u5B66\u4E60).*(\u7B54\u9898|\u6302\u673A)|(\u7F51\u76D8|\u7DB2\u76E4|\u4E91\u76D8).*(vip|\u76F4\u94FE)|\u4F18\u60E0\u52B5|\u512A\u60E0\u5238|AntiGame|split|Agar|\\.io(\\b|:|\\/|\\.|$)|ExtencionRipXChetoMalo|AposBot|DFxLite|ZTx-Lite|AposFeedingBot|AposLoader|Blah Blah|Orc Clan Script|Astro\\s*Empires|^\\s*Attack|^\\s*Battle|BiteFight|Blood\\s*Wars|Bots|Bots4|Brawler|\\bBvS\\b|Business\\s*Tycoon|Castle\\s*Age|City\\s*Ville|Comunio|Conquer\\s*Club|CosmoPulse|Dark\\s*Orbit|Dead\\s*Frontier|\\bDOA\\b|DotD|Dossergame|Dragons\\s*of\\s*Atlantis|Dugout|\\bDS[a-z]+\\n|Empire\\s*Board|eRep(ublik)?|Epic.*War|ExoPlanet|Falcon Tools|Feuerwache|Farming|FarmVille|Fightinfo|Frontier\\s*Ville|Ghost\\s*Trapper|Gladiatus|Goalline|Gondal|Grepolis|Hobopolis|\\bhwm(\\b|_)|Ikariam|\\bIT2\\b|Jellyneo|Kapi\\s*Hospital|Kings\\s*Age|Kingdoms?\\s*of|knastv(\xF6|oe)gel|Knight\\s*Fight|\\b(Power)?KoC(Atta?ck)?\\b|\\bKOL\\b|Kongregate|Last\\s*Emperor|Legends?\\s*of|Light\\s*Rising|Lockerz|\\bLoU\\b|Mafia\\s*(Wars|Mofo)|Menelgame|Mob\\s*Wars|Mouse\\s*Hunt|Molehill\\s*Empire|NeoQuest|MyFreeFarm|Neopets|Nemexia|\\bOGame\\b|Ogar(io)?|Pardus|Pennergame|Pigskin\\s*Empire|PlayerScripts|Popmundo|Po?we?r\\s*(Bot|Tools)|PsicoTSI|Ravenwood|Schulterglatze|slitheriogameplay|SpaceWars|\\bSW_[a-z]+\\n|\\bSnP\\b|The\\s*Crims|The\\s*West|Travian|Treasure\\s*Isl(and|e)|Tribal\\s*Wars|TW.?PRO|Vampire\\s*Wars|War\\s*of\\s*Ninja|West\\s*Wars|\\bWoD\\b|World\\s*of\\s*Dungeons|wtf\\s*battles|Wurzelimperium",I=document.querySelector("#script-list-sort"),b=document.createElement("span"),R=document.querySelector("#user-script-list")!=null,w,S,k,f,m;if(b.innerHTML='<svg class="icon" style="width: 1em;height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2274"><path d="M981.314663 554.296783a681.276879 681.276879 0 0 1-46.986468 152.746388q-105.706098 230.734238-360.983096 242.19829a593.06288 593.06288 0 0 1-228.689008-33.853939v-1.022615l-31.808709 79.979258a55.759429 55.759429 0 0 1-20.506122 22.551352 40.043451 40.043451 0 0 1-21.04434 5.382184 51.076928 51.076928 0 0 1-19.483507-5.382184 95.210839 95.210839 0 0 1-13.347817-7.158305 52.314831 52.314831 0 0 1-5.382184-4.628679L71.671707 731.908862a57.427906 57.427906 0 0 1-7.158305-21.528737 46.932646 46.932646 0 0 1 1.022615-17.438277 35.952991 35.952991 0 0 1 7.158305-13.347816 74.435608 74.435608 0 0 1 10.279972-10.279972 60.495751 60.495751 0 0 1 11.248765-7.373593 50.431066 50.431066 0 0 1 8.18092-3.606063 6.189512 6.189512 0 0 0 3.067845-1.776121l281.003839-74.866183a91.497132 91.497132 0 0 1 35.899168-2.583448 122.337047 122.337047 0 0 1 22.174599 6.404799 21.528737 21.528737 0 0 1 12.325202 12.325202 76.157907 76.157907 0 0 1 4.628679 14.854829 47.63233 47.63233 0 0 1 0 14.370431 55.167388 55.167388 0 0 1-2.04523 10.764369 10.764368 10.764368 0 0 0-1.022615 3.606063l-32.831324 79.979258a677.50935 677.50935 0 0 0 164.264262 39.505232q77.395809 7.696523 131.809692-3.606063a358.507291 358.507291 0 0 0 101.023598-36.921784 381.27393 381.27393 0 0 0 73.951211-50.753997 352.64071 352.64071 0 0 0 48.708767-55.382676 410.391547 410.391547 0 0 0 26.910921-41.550462c3.767529-7.481236 6.673908-13.616926 8.719139-18.460892zM40.885614 449.667121a685.69027 685.69027 0 0 1 63.563595-176.427998q118.0313-212.273346 374.330913-207.160271a571.803252 571.803252 0 0 1 207.160271 39.989629l33.853939-78.956643A75.619688 75.619688 0 0 1 735.187378 9.189165a37.67529 37.67529 0 0 1 15.393047-8.234742 42.303968 42.303968 0 0 1 14.854829-0.538219 47.578509 47.578509 0 0 1 13.347817 3.606064 102.907362 102.907362 0 0 1 11.302586 6.13569 49.569917 49.569917 0 0 1 6.673909 4.628678l3.067845 3.067845 154.84544 276.913379a81.970666 81.970666 0 0 1 6.13569 22.712817 46.986468 46.986468 0 0 1-1.022615 17.438277 32.293105 32.293105 0 0 1-7.696523 13.347817 69.322533 69.322533 0 0 1-10.764369 9.741753 92.142994 92.142994 0 0 1-11.302587 6.673909l-8.18092 4.09046a7.104483 7.104483 0 0 1-3.067845 1.022615l-283.049068 67.546412a112.003254 112.003254 0 0 1-46.125319-1.022615c-11.571696-3.390776-19.160576-8.019454-22.551352-13.832214a41.173709 41.173709 0 0 1-5.382184-21.04434 97.256069 97.256069 0 0 1 1.291724-17.438277 24.381295 24.381295 0 0 1 3.067845-8.234742L600.632773 296.81309a663.730958 663.730958 0 0 0-164.102797-43.057474q-77.987849-9.203535-131.809692 0a348.227319 348.227319 0 0 0-101.292707 33.853938 368.571976 368.571976 0 0 0-75.350579 49.246986 383.31916 383.31916 0 0 0-50.269601 54.360061 408.507783 408.507783 0 0 0-28.740863 41.012244A113.025869 113.025869 0 0 0 40.885614 449.667121z m0 0" fill="#ffffff" p-id="2275"></path></svg>',R){var L=document.createElement("span");w=document.createElement("span"),S=document.createElement("span"),k=document.createElement("span"),f=document.createElement("span"),m=document.createElement("span"),w.className="good-rating-count",S.className="ok-rating-count",k.className="bad-rating-count",f.className="good-rating-count",m.className="good-rating-count",L.appendChild(w),L.appendChild(S),L.appendChild(k),document.querySelector("#script-list-sort ul>li:nth-child(1)").appendChild(m),document.querySelector("#script-list-sort ul>li:nth-child(2)").appendChild(f),document.querySelector("#script-list-sort ul>li:nth-child(3)").appendChild(L),L.style.display=f.style.display=m.style.display="none",w.innerHTML=S.innerHTML=k.innerHTML=f.innerHTML=m.innerHTML="0"}C.getItem("GeasyforkBullshit",e=>{if(G=e,G||(G=B),/greasyfork\.org\/.*\/scripts\/23840[^\/]*$/.test(location.href)){var t=document.createElement("p"),r;t.style.width="99%",t.innerHTML="<b>Filter RegExp</b><button id='ok' style='margin-left: 20px;'>Save</button><button id='reset' style='margin-left: 20px;'>Reset</button>";var s=t.querySelector("#ok"),l=t.querySelector("#reset"),o=document.createElement("pre"),n=document.createElement("script");n.src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js?skin=sons-of-obsidian",document.head.appendChild(n);var a=document.createElement("link");a.rel="stylesheet",a.href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css",document.head.appendChild(a),o.contentEditable="true",o.className="prettyprint lang-js",o.style.whiteSpace="pre-wrap",o.style.overflowWrap="break-word",o.style.width="100%",o.innerHTML=G;var i=document.querySelector("#additional-info");t.appendChild(o),i.insertBefore(t,i.firstChild),n.onload=()=>{PR.prettyPrint()},s.onclick=()=>{r=o.innerText,C.setItem("GeasyforkBullshit",r),alert("Saved")},l.onclick=()=>{C.setItem("GeasyforkBullshit",B),alert("Reset over"),location.reload()}}P()});function E(e){var t=e.querySelector("h2>span.name-description-separator"),r=e.querySelector("h2>span.description");if(t){var s=document.createElement("strong");s.style.color="#e09015",s.innerHTML=e.dataset.scriptRatingScore,t.parentNode.insertBefore(s,t)}if(r){_(e);var l=e.querySelector("h2>a").href;let n=e.dataset.scriptVersion,a=e.dataset.scriptLanguage,i=e.dataset.scriptLanguage=="js"?"":`<a class="install-link" data-install-format="css" data-ping-url href="${l.replace(/\.org\/.*\/scripts\//,".org/scripts/")}/code/script.user.css">Install as user style</a>`;r.innerHTML+=`<strong>Ver.${n}</strong>
            <div id="install-area" class="list-install-area">
            <a class="install-link" data-install-format="js" data-ping-url href="${l.replace(/\.org\/.*\/scripts\//,".org/scripts/")}/code/script.user.js">Install</a><a style="cursor:pointer;" class="install-help-link refresh-info" title="Check status" rel="nofollow"></a>
            ${i}
            </div><div id="installation-instructions-modal-js" aria-hidden="true"><p class="installation-instructions-modal-content-bypass"><a href="#"></a></p></div><div id="installation-instructions-modal-css" aria-hidden="true"><p class="installation-instructions-modal-content-bypass"><a href="#"></a></p></div>`;var o=r.querySelector("#install-area");let g=o.querySelector(".install-link"),h=o.querySelector(".install-help-link");e.onmouseenter=p=>{h.appendChild(b)},e.onmouseleave=p=>{b&&b.parentNode&&b.parentNode.removeChild(b)},h.onclick=()=>{M({method:"GET",url:l.replace(/(.*)-.*/,"$1.json"),onload:function(p){var c=null;try{c=JSON.parse(p.responseText)}catch{console.log("parse error")}if(c){let y=d=>{d.installed?(parseFloat(d.version)<parseFloat(n)?g.innerHTML="Update to version "+n:parseFloat(d.version)>parseFloat(n)?g.innerHTML="Downgrade to version "+n:g.innerHTML="Reinstall version "+n,d.enabled?g.style.backgroundColor="":g.style.backgroundColor="#6a6a6a"):g.innerHTML="Install version "+n};window.external.Tampermonkey?window.external.Tampermonkey.isInstalled(c.name,c.namespace,d=>{y(d)}):window.external.Violentmonkey&&window.external.Violentmonkey.isInstalled(c.name,c.namespace).then(d=>{y(d)})}}})},!window.external.Tampermonkey&&!window.external.Violentmonkey&&(h.style.display="none")}}function _(e){var t=e.querySelector("dd.script-list-daily-installs>span");if(t){var r=parseInt(e.querySelector("dd.script-list-ratings>span>.good-rating-count").innerHTML.replace(/[^\d]/g,"")),s=parseInt(e.querySelector("dd.script-list-ratings>span>.ok-rating-count").innerHTML.replace(/[^\d]/g,"")),l=parseInt(e.querySelector("dd.script-list-ratings>span>.bad-rating-count").innerHTML.replace(/[^\d]/g,""));if(l&&l>2&&l>r){let i=e.querySelector(".script-link");if(i){var o=document.createTextNode("\u26A0");i.style.textDecoration="line-through",i.style.color="#67000080",i.title="May be dangerous!",i.parentNode.insertBefore(o,i)}}if(R){var n=parseInt(t.innerHTML.replace(/[^\d\.\-]/g,"")),a=parseInt(e.querySelector("dd.script-list-total-installs>span").innerHTML.replace(/[^\d]/g,""));w.innerHTML=parseInt(w.innerHTML)+r,S.innerHTML=parseInt(S.innerHTML)+s,k.innerHTML=parseInt(k.innerHTML)+l,f.innerHTML=parseInt(f.innerHTML)+a,m.innerHTML=parseInt(m.innerHTML)+n,L.style.display=f.style.display=m.style.display=""}}}q("Configure the Filter",()=>{location.href="https://greasyfork.org/scripts/23840#additional-info"});function P(){var e;I&&C.getItem("disableFilter",t=>{e=!t;var r=document.createElement("div"),s=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,l=new s(function(u){u.map(function(v){for(var F=0;F<v.addedNodes.length;F++){var T=v.addedNodes[F];if(T.className=="script-list"){var N=T.querySelectorAll("li");for(let A=0;A<N.length;A++){let W=N[A];E(W)}e&&c(T)}else T.tagName=="LI"&&(E(T),e&&c(T))}})}),o={childList:!0};l.observe(document.querySelector("body>.width-constraint .sidebarred-main-content"),o);var n=document.querySelector("#browse-script-list,#user-script-list,ol.script-list");n&&l.observe(n,o);var a=document.querySelectorAll("ol.script-list>li");for(let u=0;u<a.length;u++){let v=a[u];E(v)}var i=document.createElement("style");i.textContent=`
                li.filtered {
                     display: none !important;
                }
                .list-option{
                     position: relative;
                }
                #script-list-sort li>span{
                     position: absolute;
                     top: 4px;
                     right: 2px;
                     pointer-events: none;
                     font-weight: 500;
                }
                #script-list-sort li>span:lang(ar), #script-list-sort li>span:lang(he), #script-list-sort li>span:lang(ug){
                     right: unset;
                     left: 2px;
                }
                #script-list-sort li>span>span{
                     margin: 0 0 0 2px;
                }
                .script-list>li .list-install-area{
                     display: none;
                     float: right;
                     position: relative;
                }
                .script-list>li:hover .list-install-area {
                     display: block;
                }
                @-webkit-keyframes spin {
                 from {
                     -webkit-transform: rotate(0deg);
                 }
                 to {
                     -webkit-transform: rotate(360deg);
                 }
                }
                @keyframes spin {
                 from {
                     transform: rotate(0deg);
                 }
                 to {
                     transform: rotate(360deg);
                 }
                }
                .refresh-info:hover>span {
                     display: block;
                     -webkit-animation: spin 1s linear 1s 5 alternate;
                     animation: spin 1s linear infinite;
                }`,i.type="text/css",document.querySelector("head").appendChild(i);var g=new RegExp(G,"i"),h="Enable Filter",p=0,c=function(u){[].forEach.call(u.querySelectorAll("article>h2"),function(v){g.test(v.innerText.replace(`
`," "))&&(v.parentNode.parentNode.classList.add("filtered"),p++)})};e&&c(document),r.innerHTML='<input type="checkBox" name="switchFilter" id="switchFilter"/><label for="switchFilter">'+h+(p?" ("+p+" filtered)":"")+"</label>";var y=r.querySelector("#switchFilter"),d=y.nextSibling;y.checked=e,y.onclick=function(){e?([].forEach.call(document.querySelectorAll("li.filtered"),function(u){u.classList.remove("filtered")}),d.innerHTML=h):(p=0,c(document),d.innerHTML=h+" ("+p+" filtered)"),C.setItem("disableFilter",e),e=!e},I.insertBefore(r,I.firstChild)})}})();
