// ==UserScript==
// @version         19.11.11
// @name            Smart Scroll
// @license         MIT
// @author          S-Marty
// @compatible      firefox
// @compatible      chrome
// @namespace       https://github.com/s-marty/SmartScroll
// @homepageURL     https://github.com/s-marty/SmartScroll
// @supportURL      https://github.com/s-marty/SmartScroll/wiki
// @icon            https://raw.githubusercontent.com/s-marty/SmartScroll/master/images/smartScroll.png
// @contributionURL https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=QHFFSLZ7ENUQN&source=url
// @include         /^https?://.*$/
// @exclude         /[^\s]+\.(jpe?g|png|gif|bmp|svg)(\?[^\s]+)?$/
// @run-at          document-end
// @grant           GM.getValue
// @grant           GM.setValue
// @grant           GM_getValue
// @grant           GM_setValue
// @noframes
// @downloadURL https://raw.githubusercontent.com/FiorenMas/Userscripts/release/release/Smart20Scroll.user.js
// @updateURL https://raw.githubusercontent.com/FiorenMas/Userscripts/release/release/Smart20Scroll.meta.js
// ==/UserScript==
(function(){"use strict";var e={monkey:function(){let i;if(this.user.settings.ignore.indexOf(H)==-1)if(this.body&&this.is_userscript)i=document.createElement("style"),i.setAttribute("id","smartscrollstyle"),i.type="text/css",i.innerHTML=this.buttonCss(),this.head.appendChild(i),this.up_ctn=document.createElement("span"),this.dn_ctn=document.createElement("span"),this.up_ctn.setAttribute("id","up_btn"),this.dn_ctn.setAttribute("id","dn_btn"),this.up_ctn.className="updn_btn",this.dn_ctn.className="updn_btn",this.body.appendChild(this.up_ctn),this.body.appendChild(this.dn_ctn),this.user.settings.crawl_trigger=="middleclick"?(this.up_ctn.addEventListener("mousedown",function(t){t.which==2&&e.creepUp(1)},!1),this.up_ctn.addEventListener("mouseup",function(t){t.which==2&&(e.creep=!1)},!1),this.dn_ctn.addEventListener("mousedown",function(t){t.which==2&&e.creepDn(1)},!1),this.dn_ctn.addEventListener("mouseup",function(t){t.which==2&&(e.creep=!1)},!1)):(this.up_ctn.addEventListener("mouseover",function(t){e.creepUp(1)},!1),this.up_ctn.addEventListener("mouseout",function(t){e.creep=!1},!1),this.dn_ctn.addEventListener("mouseover",function(t){e.creepDn(1)},!1),this.dn_ctn.addEventListener("mouseout",function(t){e.creep=!1},!1)),this.up_ctn.addEventListener("dblclick",function(t){t.which===1&&e.smartScroll_Settings(t)},!1),this.dn_ctn.addEventListener("dblclick",function(t){t.which===1&&e.smartScroll_Settings(t)},!1),this.up_ctn.addEventListener("click",function(t){t.which===1&&e.scrollToTop()},!1),this.dn_ctn.addEventListener("click",function(t){t.which===1&&e.scrollToBottom()},!1),C!==null&&this.user.settings.bottomless_pages&&(this.resize=document.createElement("iframe"),this.resize.setAttribute("name","resize_frame"),this.resize.setAttribute("tabindex","-1"),this.resize.className="resize_frame",C.appendChild(this.resize),this.resize.contentWindow.addEventListener("resize",function(t){e.getDocumentHeight(t)},!1)),window.addEventListener("scroll",e.onScroll,{passive:!0}),window.addEventListener("resize",e.onResize,!1),this.body.addEventListener("mouseleave",e.saveAccrued,!1),window.addEventListener("beforeunload",function(t){e.settings_close("unload")},!1),document.addEventListener("readystatechange",function(t){document.readyState==="complete"&&e.getDocumentHeight(t)},!1),this.user.settings.dimButtons&&setTimeout(e.fadeOut,3e3);else return},areOverVid:function(i){var t=typeof i=="object"&&i.target.tagName=="VIDEO"?i.target:!1;if(t){var o=!1,n=!1,s=t.getBoundingClientRect(),r=e.up_ctn.getBoundingClientRect();return s.right-s.left>window.innerWidth/2?n=!0:n=s.left<window.innerWidth-33&&s.right>window.innerWidth-33,o=s.top<r.top&&s.bottom>r.top,n&&o}else return!1},fadeOut:function(i){var t=e.up_ctn,o=e.dn_ctn;e.fading||(e.areOverVid(i)?(e.opacity_timer&&clearInterval(e.opacity_timer),t.style.visibility="visible",o.style.visibility="visible",t.style.opacity=.65,o.style.opacity=.65,e.fading=setTimeout(function(n){e.fading=null},3e3),setTimeout(function(n){e.opacity_timer=setInterval(function(){t.style.opacity<=0?(clearInterval(e.opacity_timer),e.opacity_timer=null,t.style.visibility="hidden",o.style.visibility="hidden"):(t.style.opacity-=.025,o.style.opacity-=.025)},100)},3e3)):(e.opacity_timer&&(clearInterval(e.opacity_timer),e.opacity_timer=null),t.style.visibility="visible",o.style.visibility="visible",t.style.opacity=.65,o.style.opacity=.65))},reLoadStart:function(i){setTimeout(function(){e.getDocumentHeight(),e.getVideo(),setTimeout(e.fadeOut,3e3)},500)},hideOnFullScreen:function(){document.addEventListener("fullscreenchange",()=>{e.onFullScreen()}),document.addEventListener("mozfullscreenchange",()=>{e.onFullScreen()}),document.addEventListener("webkitfullscreenchange",()=>{e.onFullScreen()})},onFullScreen:function(i){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement?e.body.className=e.body.className+" isfullscreen":(e.body.className=e.body.className.replace(/\sisfullscreen/g,""),window.setTimeout(e.resetButtons,100))},hasScrollbar:function(){let i,t,o,n,s,r,l;return typeof window.innerHeight=="number"?(i=window.innerHeight-document.documentElement.clientHeight,[window.innerHeight>document.documentElement.clientHeight,i+1]):(t=document.documentElement||document.body,typeof t.currentStyle<"u"&&(n=t.currentStyle.overflow),n=n||window.getComputedStyle(t,"").overflow,typeof t.currentStyle<"u"&&(s=t.currentStyle.overflowY),s=s||window.getComputedStyle(t,"").overflowY,r=t.scrollHeight>t.clientHeight,o=/^(visible|auto)$/.test(n)||/^(visible|auto)$/.test(s),l=n==="scroll"||s==="scroll",!!(r&&o||l))},getScrollTop:function(){if(typeof pageYOffset<"u")return e._x=pageXOffset,pageYOffset},getDocumentHeight:function(i){let t=Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)-(e.hasScrollbar()?e.scrollbar:0);if(t>window.innerHeight){if(t-window.innerHeight-e.scrollable<6)return;e.getVideo(),e.scrollable=t-window.innerHeight,e.onScroll()}},scrollToTop:function(i){var t,o=e.scrolled;o>0&&e.animate({duration:1e3,timing:function(n){return Math.pow(n,5)},draw:function(n){t=o-n*o,t<0&&(t=0),n<1?window.scrollTo(e._x,t):(window.scrollTo(e._x,0),e.count_accru+=o,e.getVideo())}})},scrollToBottom:function(i){var t,o=e.scrolled,n=e.scrollable;n>o&&e.animate({duration:1e3,timing:function(s){return Math.pow(s,5)},draw:function(s){t=s*n+(1-s)*o,t>n&&(t=n),s<1?window.scrollTo(e._x,t):(window.scrollTo(e._x,n+2),e.count_accru+=n-o,e.getVideo())}})},creepUp:function(i){i===1&&(e.creep=1,e.killCreeper(),e.creeper=setInterval(e.creepUp,e.crawl_speed_ms)),e.scrolled=e.getScrollTop(),e.creep&&e.scrolled>0?(window.scrollTo(e._x,e.scrolled-e.step),e.count_accru+=e.step):e.killCreeper()},creepDn:function(i){i===1&&(e.creep=1,e.killCreeper(),e.creeper=setInterval(e.creepDn,e.crawl_speed_ms)),e.scrolled=e.getScrollTop(),e.creep&&e.scrollable>e.scrolled?(window.scrollTo(e._x,e.scrolled+e.step),e.count_accru+=e.step):e.killCreeper()},onResize:function(i){e.getDocumentHeight(i),window.setTimeout(e.resetButtons,500)},onScroll:function(i){e.scrolled=e.getScrollTop(),e.scrollable||e.getDocumentHeight(i),e.scrolled>0?e.toggle_up_btn("show"):e.toggle_up_btn("hide"),e.scrollable>e.scrolled?e.toggle_dn_btn("show"):e.toggle_dn_btn("hide")},toggle_up_btn:function(i){i=="show"&&e.up_btn_show!="show"?(e.up_btn_show="show",e.animate({duration:400,timing:function(t){return Math.pow(t,2)},draw:function(t){e.up_ctn.style.right=-33+t*33+"px"}})):i=="hide"&&e.up_btn_show!="hide"&&(e.up_btn_show="hide",e.animate({duration:500,timing:function(o,n){return Math.pow(n,2)*((o+1)*n-o)}.bind(null,2.8),draw:function(t){e.up_ctn.style.right=0-t*33+"px"}}))},toggle_dn_btn:function(i){i=="show"&&e.dn_btn_show!="show"?(e.dn_btn_show="show",e.animate({duration:400,timing:function(t){return Math.pow(t,2)},draw:function(t){e.dn_ctn.style.right=-33+t*33+"px"}})):i=="hide"&&e.dn_btn_show!="hide"&&(e.dn_btn_show="hide",e.animate({duration:500,timing:function(o,n){return Math.pow(n,2)*((o+1)*n-o)}.bind(null,2.8),draw:function(t){e.dn_ctn.style.right=0-t*33+"px"}}))},killCreeper:function(){this.creeper!==null&&(clearInterval(this.creeper),this.creeper=null)},getVideo:function(){if(e.user.settings.dimButtons){var i=document.querySelectorAll("video");if(i.length){for(let t=0;t<i.length;t++)i[t].scrollWidth>100&&i[t].scrollHeight>50&&i[t].addEventListener("mousemove",e.fadeOut,!1);document.addEventListener("keydown",function(t){(t.which==38||t.which==40)&&["INPUT","TEXTAREA"].indexOf(document.activeElement.tagName)<0&&e.fadeOut()},!1)}}},animate:function({timing:i,draw:t,duration:o}){let n=performance.now();requestAnimationFrame(function s(r){let l=(r-n)/o;l>1&&(l=1);let h=i(l);t(h),l<1&&e.allowScroll&&requestAnimationFrame(s)})},smartScroll_Settings:function(i){let t=document.querySelector(".smartScroll_Settings"),o;if(!e.settings_id&&t===null){e.allowScroll=!1,e.killCreeper();var n,s,r,l="",h="",c="",y="";let f=window.location.hostname,v=f.match(/^([\w\-]*\.)?([\w\-]+\.((\w{3,4}$)|(\w{2}\.\w{2}$)))/i);v!==null&&v.length>2&&(typeof v[1]>"u"&&(v[1]=""),f=v[1]+v[2]);let G=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],b=document.createElement("div"),L=b,M="",d="a",S=document.createElement("br").outerHTML.indexOf("/")>0?"XHTML":"HTML";for(r=0;r<16;r++)d+=G[Math.floor(Math.random()*16)];var p=S=="HTML"?"selected":'selected="selected"';let E=document.createElement("input");if(E.setAttribute("type","range"),E=E.type!="text",!E){let a=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,16,17,19,21,23,26,30,36,44,57,80,100];y='<select name="crawl_speed">',a.forEach(function(T){l=T==e.user.settings.crawl_speed?p:"",y+='<option value="'+T+'" '+l+">"+T+"</option>"}),y+="</select>"}h='<select name="top_plus" style="width: 52px;height: 20px;font-size: 12px;">',c='<select name="bot_minus" style="width: 52px;height: 20px;font-size: 12px;margin-left:36px;">',[0,5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,99].forEach(function(a){l=a==e.user.settings.top_plus?p:"",h+='<option value="'+a+'" '+l+">"+a+"</option>",l=a==e.user.settings.bot_minus?p:"",c+='<option value="'+a+'" '+l+">"+a+"</option>"}),h+="</select>",c+="</select>";let g=S=="HTML"?"checked":'checked="checked"',u=S=="HTML"?"":"</input>",N="'",x="\xA0",m="\xB7",Q=S=="HTML"?"":"/*<![CDATA[*/",D=S=="HTML"?"":"/*]]>*/",I="",_=this.user.settings.ignore.split(","),w=[60,40,65],A="That"+N+"s ";switch(!0){case this.user.count>32602522:w=[0,160,5],n=Math.round(this.user.count*8825569e-12)/1e4,A+=(n==1?"The ":n+" ")+"Light Second"+(n==1?"":"s")+".";break;case this.user.count>2676326:w=[20,120,25],n=Math.round(this.user.count*6134495e-12)/100,A+=(n==1?"The ":n+" Times the ")+"Width of the U.S.";break;case this.user.count>669082:w=[30,100,35],n=Math.round(this.user.count*7747293e-11)/100,A+=(n==1?"":n+" times ")+"the Altitude of the ISS.";break;case this.user.count>3041:w=[40,80,45],n=Math.round(this.user.count*.01644)/100,A+=n+" Mile"+(n==1?"":"s")+".";break;default:n=Math.round(this.user.count*8.68)/10,A+=n+" F"+(n==1?"oo":"ee")+"t"}let R=this.user.count.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+",000 Pixels Smart Scrolled.",k=!1;for(r=0;r<_.length;r++)_[r].length<5||(k=k||f==_[r],I+=`<span class="ignores"><button style="padding:0px 3px 1px;margin-right:6px;background-color:#ff3333;color:#fff;border-radius:3px;-webkit-border-radius:3px;-moz-border-radius:3px" onclick="document.forms['sssettings'].remove.value+='`+_[r]+`,';this.disabled='disabled'" title="Mark `+_[r]+' for deletion from this list">x</button><span>'+_[r]+"</span></span><br />");k=k?"":`<span class="addable"><button style="padding:0px 3px 1px;margin-right:6px;background-color:#33ff33;color:#000;font-weight:bold;border-radius:3px;-webkit-border-radius:3px;-moz-border-radius:3px" onclick="document.forms['sssettings'].add.value+='`+f+`';this.disabled='disabled'" title="Mark `+f+' for addition to this list">+</button><span>'+f+"</span></span><br />",M='<div id="'+d+'" style="width:500px;height:400px;margin:auto auto;border-radius:12px 54px 12px 100px;-webkit-border-radius:12px 54px 12px 100px;-moz-border-radius:12px 54px 12px 100px;border:3px solid #CCC;">  <div style="width:500px;height:50px;background-color:#000;border-radius:12px 50px 0px 0px;-webkit-border-radius:12px 50px 0px 0px;-moz-border-radius:12px 50px 0px 0px;">    <div style="width: 380px;height:40px;padding:12px 0 0 65px;color:#eee;font-size: 1.5em;font-weight: bold;background:transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAQAAABLCVATAAAAAmJLR0QA/vCI/CkAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfiDBwSIh99fynEAAAD9klEQVRIx6XWzW9UVRjH8c+dzjBtAfsCUlIsKbSU8hZpijGRRAzhTY0Y4sqgiYQENVEXJiTEVUPQjSgr3Rhd+i+wKAYJSMJb5U2YAkljpSVAUlqgZZjOzHXR28tMKSSkZzKbc879nuc+z+/53RNsCc1oBEKPZCWftWFcTighQBj909NsD5GaDhQIjcups0aHf50yqtZ6dS7rMywlJRCWPZFgKmgC0q5TuwWuOewUeGiv9e7I6JGRknoqsimgx2ptstJ8Tc44oCeaPyrQZa0aba44YkT6eaCsNts1W6jeCV3Ol6wdlfOjVUbVa3JY7xRURUvXE0yHbZZoVeOyPc4pL2i/GzZoUmNcg5wBFXFWH0tM5iarzUYtWlX50y6XJk9SqQIBjtnlikrtmm3Q7nHJMYkJZl6t7ZZYoso/9jofRRN41Q6rozIXnfSpXmmtmm1VI18OCuVs0qxVtR479ShGy20O+F2Xpriqf/ncoCrLNNpsvBw0rt0qDWbhtgsxptX3Nil6x3eaY9RZD1Gp0QrtcUwJyOlUb7YQuSgftPjNuxKKknY6aEFclAJCNWp1yEW7E4yr064xKudanwgltTpovUARRaH3/GSxpCp7LBQKVVukVb2ccEJHOWvUmQ0KXrHfGwKLvSlUiM4rSNqh2oDANrXRS85RZ6mz0pOCXKlRZVSXQKPdRHEEcT8VBLZFgFBREOVpuTNPlL0o7p0g2jidXYiLID4gZVFpsueUbHmxEXqpFJSagbElS0H5GYDKdPRgsuVeeCQ8KAX1y5YYZxD9nrbUJythNPfIf6WvmHHLXJVRNcbcFag0vwyWELotK/CyymjlkVuuPVF2Wp9hDyPTGPGzDut86IKKEh0FLvrAOq/7xVg0/8CIPmnBBChpWK9BWQTO2Oe+ISd8rT+2rgrn7HbKPXftNyAQGHPLDUNR3aLy97hnVIBCFEPBSR+7IIkKJ3wZe1RWEYFhw/6OpROBMq64JYs6DTHquH3OSzrtG6fjbC1VjVGDMjKxjpIToacc0aSoXadffeZmtHxEymtOOl6COaTRmGsGdZdIOTL/CqPuaVBUb7l5etyPGrffOdflo/Qu84MtxmUM6DYgFZt//DlK642spM1HkvYZiDKSjXW0wgHvG5Ux4JirZk3/OUoaMGyeRyp0anDRvTJJtvnWZnfccFO3SzFmSkQwy1WDNrtvnrcNORTrluW+8pZeIzK63S+LZkpEE1FlXXJbQd5qc92IctXqCxtdd9kfjimU+cVERMF096O8nHotVuhx1EO1tmlxTZ8hqacuMIGCYcHW8Hn3o6CsZdPPuE7lPZAsPNXjk+ekn+M+QdkzedWSIzO7+QklVJvlf7qjThcu+vTfAAAAAElFTkSuQmCC) no-repeat 10px center;">    Smart Scroll Settings</div>  </div>  <form id="'+d+'_settings_form" name="sssettings" class="sssettings" action="javascript:void(0)" onsubmit="return false" style="padding:10px;height:330px;border-radius:0px 0px 10px 96px;-webkit-border-radius:0px 0px 10px 96px;-moz-border-radius:0px 0px 10px 96px;">    <div style="width:100%;height:240px;padding-bottom:0px;">      <div style="width:50%;height:100%;padding:0px;float:left;border-radius:0px 0px 0px 96px;-webkit-border-radius:0px 0px 0px 96px;-moz-border-radius:0px 0px 0px 96px;">        <span style="margin-left:30px;">Slow scrolling speed:</span><br />'+(E?'        <input name ="crawl_speed" type="range" min="1" max="100" step="1" value="'+this.user.settings.crawl_speed+`" onchange="document.getElementById('crawl_speed_now').innerHTML=this.value" style="width: 180px;">`+u+' <span id="crawl_speed_now">'+this.user.settings.crawl_speed+'</span><br />        <span style="font-size:11px;">'+x+"Slow "+m+x+m+x+m+x+m+" Fast "+m+x+m+x+m+x+m+" Faster</span><br /><br />":"        "+y+'<br />        <span style="font-size:11px;">1 = Slow thru 100 = Fast</span><br /><br />')+'        <input type="checkbox" name="bottomless_pages" id="bottomless1" '+(this.user.settings.bottomless_pages?g:"")+" >"+u+' <label for="bottomless1" title="Recalculates when pages add content to bottom">Bottomless pages</label><br />        <input type="checkbox" name="refresh" id="refresh1" '+(this.user.settings.refresh?g:"")+" >"+u+' <label for="refresh1" title="Refresh current page upon critical settings changes made here">Auto page refresh</label><br />        <input type="checkbox" name="dimButtons" id="dimButtons1" '+(this.user.settings.dimButtons?g:"")+" >"+u+' <label for="dimButtons1" title="Buttons will disappear when over videos after 3 seconds">Fade out over video</label><br />        <div style="margin: 6px 0 2px 30px;">Slow scroll trigger</div>        <span><input type="radio" name="crawl_trigger" id="trigger1" value="middleclick"'+(this.user.settings.crawl_trigger=="middleclick"?g:"")+" >"+u+' <label for="trigger1" title="Middle mouse button held down">Middleclick</label>               <input type="radio" name="crawl_trigger" id="trigger2" value="hover" '+(this.user.settings.crawl_trigger=="hover"?g:"")+' style="margin-left:10px;">'+u+' <label for="trigger2" title="Mouse pointer held over">Hover</label></span><br />        <div style="margin: 6px 0 2px 30px;">Button Position</div>        <span><input type="radio" name="position" id="position1" value="top" onmouseout="this.blur()" '+(this.user.settings.position=="top"?g:"")+">"+u+' <label for="position1" title="Always at top right">Top</label>              <input type="radio" name="position" id="position2" value="middle" onmouseout="this.blur()" '+(this.user.settings.position=="middle"?g:"")+' style="margin-left:6px;">'+u+' <label for="position2" title="Always at middle right">Middle</label>              <input type="radio" name="position" id="position3" value="bottom" onmouseout="this.blur()" '+(this.user.settings.position=="bottom"?g:"")+' style="margin-left:6px;">'+u+' <label for="position3" title="Always at bottom right">Bottom</label></span><br />        <span>'+h+'<span title="Pixels down from top">:Plus</span>'+c+'<span title="Pixels up from bottom">:Less</span></span><br />      </div>      <div style="width:50%;height:100%;float:left;">        <div style="width:100%;height:20px;text-align:center;" title="(Scroll buttons will not be used)">Ignored Sites</div>        <div id="ssignored" style="width:224px;height:180px;overflow-y: auto;overflow-x: hidden;border: 1px solid #000;padding: 6px;line-height:1.3;border-radius:5px;-webkit-border-radius:5px;-moz-border-radius:5px;">        '+k+I+'</div>        <div style="width:100%;height:12px;text-align:center;font-style: italic;color:blue;font-size: 12px;padding-top: 4px;cursor:help" title="'+A+'">'+R+'</div>      </div>    </div>    <div style="width:100%;height:90px;border-radius:0px 0px 10px 96px;-webkit-border-radius:0px 0px 10px 96px;-moz-border-radius:0px 0px 10px 96px;">      <div style="width:fit-content;width: -moz-fit-content;height:80px;margin:10px auto 0px;background-color:transparent">        <button id="'+d+'_settings_close" style="background-color:#ff3333;padding:30px '+w[0]+'px;border-radius:0px 0px 0px 74px;-webkit-border-radius:0px 0px 0px 74px;-moz-border-radius:0px 0px 0px 74px;">Cancel</button>         <button id="'+d+'_settings_donate" style="background-color:#ffff33;padding:30px '+w[1]+'px;">Donate</button>        <button id="'+d+'_settings_save" style="background-color:#33ff33;padding:30px '+w[2]+'px;">Save</button>      </div>    </div>    <input name ="remove" type="hidden" value="">'+u+'<input name ="add" type="hidden" value="">'+u+'<input name ="'+d+'" type="hidden" value="">'+u+'    <input name ="submit" type="submit" value="" style="width:0px;height:0px;opacity:0;">'+u+'  </form></div><style type="text/css">'+Q+"  #pdus div, #pdus span, #pdus label, #pdus form, #pdus input, #pdus button {margin:0px;padding:0px;border:0px;color:#333;box-sizing:content-box;background-color:#EEE; font: 14px 'Titillium Web', 'Helvetica Neue', Helvetica, Arial, sans-serif; box-shadow: none;min-height:0px;line-height: 1;text-align:left; text-decoration:none;outline:none; }  #pdus div, #pdus form  {display:block;} #pdus span, #pdus label {display:inline;} #pdus input, #pdus button {display:inline-block;}"+D+"</style>",b.setAttribute("id","pdus"),b.className="smartScroll_Settings",b.style="width:100%;height:100%;margin:0;padding:0;position:fixed;top:0px;left:0px;background-color: rgba(0, 0, 0, 0.7);z-index:84000;",b.innerHTML=M,e.body.removeChild=function(){return L},e.body.replaceChild=function(){return L},i&&i=="removed"?e.body.innerHTML+=b.outerHTML:(e.body.appendChild(b),setTimeout(function(){document.querySelector(".smartScroll_Settings")===null&&(e.settings_id="",e.smartScroll_Settings("removed"))},300)),e.settings_id=d,o=document.querySelector("form#"+d+"_settings_form"),o.querySelector("#"+d+"_settings_close").addEventListener("click",function(a){e.settings_close()},!1),o.querySelector("#"+d+"_settings_donate").addEventListener("click",function(a){e.settings_donate()},!1),o.querySelector("#"+d+"_settings_save").addEventListener("click",function(a){e.onSettingsSave()},!1),o.querySelector("#"+d+"_settings_save").addEventListener("change",function(a){e.onSettingsSave()},!1),o.querySelector("#position1").addEventListener("change",function(a){e.updateButtonCss()},!1),o.querySelector("#position2").addEventListener("change",function(a){e.updateButtonCss()},!1),o.querySelector("#position3").addEventListener("change",function(a){e.updateButtonCss()},!1);let B=o.top_plus.options,U=o.bot_minus.options;for(s=0;s<B.length;s++)B[s].addEventListener("mouseup",function(a){e.updateButtonCss(a)},!1),U[s].addEventListener("mouseup",function(a){e.updateButtonCss(a)},!1)}else e.settings_close()},onSettingsSave:function(){var i=document.querySelector("form#"+e.settings_id+"_settings_form"),t=i.querySelectorAll("input, select"),o={ignore:this.user.settings.ignore},n,s,r,l,h=!1,c=!1;if(i.querySelector('input[name="'+e.settings_id+'"]')!==null){for(r=0;r<t.length;r++){switch(s=null,n=t[r],n.type){case"checkbox":s=n.checked,this.user.settings[n.name]!=s&&n.name!="refresh"&&(c=!0);break;case"select":case"select-one":s=parseInt(n[n.selectedIndex].value);break;case"radio":if(n.checked)s=n.value,this.user.settings[n.name]!=s&&(c=!0);else continue;break;case"range":s=parseInt(n.value);break;case"hidden":if(n.name==e.settings_id)continue;if(n.name=="remove"&&n.value!=""){let p=!1,f=n.value.split(",");for(l=0;l<f.length;l++)if(!(f[l].length<5)){f[l].indexOf(window.location.hostname)!=-1&&(p=!0);var y=new RegExp(f[l]+",","gi");o.ignore=o.ignore.replace(y,"")}c=c||p;continue}else if(n.name=="add"&&n.value!=""){o.ignore+=n.value.trim()+",",c=h=!0;continue}else continue;break;default:continue}s!==null&&(o[n.name]=s)}if(h){let p=o.ignore.split(",");p.pop(),p.length>1&&(p.sort(),o.ignore=p.join()+",")}e.saveSettings({name:"user_settings",value:o}),c&&o.refresh?window.location=window.location:this.resetButtons()}e.settings_close()},settings_close:function(i){let t=document.querySelector(".smartScroll_Settings");t!==null&&t.remove(),e.settings_id="",typeof i<"u"&&i=="unload"?(e.toggle_up_btn("hide"),e.toggle_dn_btn("hide")):e.resetButtons()},saveAccrued:function(i){e.count_accru>1e3&&e.initSettings({name:"count"})},saveSettings:function(i){if(typeof i>"u"||typeof i.name>"u"||i.name==""){console.error("saveSettings() input error");return}switch(i.name){case"user_settings":this.GM.setValue("settings",JSON.stringify(i.value));break;case"count":if(this.count_accru>999){let t=Math.round(this.count_accru/1e3)+i.value;this.GM.setValue("count",t),this.user.count=t,this.count_accru=0}else this.user.count=i.value;break}},settings_donate:function(){window.open("https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=QHFFSLZ7ENUQN&source=url","_blank")},updateButtonCss:function(i){let t=document.querySelector("#smartscrollstyle"),o=document.querySelector("form#"+e.settings_id+"_settings_form"),n=o.position2.checked,s=o.position3.checked,r="top";n?r="middle":s&&(r="bottom");let l={position:r,top_plus:parseInt(o.top_plus[o.top_plus.selectedIndex].value),bot_minus:parseInt(o.bot_minus[o.bot_minus.selectedIndex].value),bottomless_pages:e.user.settings.bottomless_pages};t.innerHTML=e.buttonCss(l)},buttonCss:function(i){let t="",o="",n="";return i=typeof i=="object"?i:this.user.settings,i.position=="top"?(n="top:"+i.top_plus+"px;",o="margin-top:33px;"):i.position=="bottom"?(n="bottom:"+(i.bot_minus+33)+"px;",o="margin-bottom:-33px;"):i.position=="middle"&&(n="bottom:50%;",o="margin-bottom:-33px;"),t+="#up_btn { position:fixed; right:-33px; z-index:54000; height:36px; width:33px; display:inline; cursor:pointer; background:url("+V+") no-repeat scroll 50% 50% rgba(0, 0, 0, 0.7); }",t+="#dn_btn { position:fixed; right:-33px; z-index:54000; height:36px; width:33px; display:inline; cursor:pointer; "+o+"background:url("+z+") no-repeat scroll 50% 50% rgba(0, 0, 0, 0.7); }",t+=".updn_btn { "+n+"opacity:0.65; } .isfullscreen > .updn_btn { display:none;}",t+=".sssettings button:hover {opacity:0.85;} .updn_btn:hover { opacity:1; } .sssettings button[disabled], .sssettings button[disabled]:hover { opacity:0.35;} ",t+=".sssettings span button:hover:enabled {line-height: 1.4 !important; width: 10px !important;} .sssettings .ignores button[disabled] + span { opacity:0.5;} .sssettings .addable button + span { opacity:0.5;} .sssettings .addable button[disabled] + span { opacity:1;}",i.bottomless_pages&&(t+="iframe.resize_frame {position: absolute; display: block ;top: 0; bottom: 0; left: 0; height: 100%; opacity: 0; z-index: 0; width: 0; border: 0; background-color: transparent;}","contentType"in document?document.contentType.indexOf("image")==-1&&(t+="body {position:relative !important;} body.isfullscreen {position:initial !important;}"):t+="body {position:relative !important;} body.isfullscreen {position:initial !important;}"),t},scrolledUpdate:function(i){(e.count_accru>1e3||i===!0)&&e.initSettings({name:"count"}),window.setTimeout(e.scrolledUpdate,12e4)},resetButtons:function(i){e.allowScroll=!0,e.up_btn_show="",e.dn_btn_show="",e.getDocumentHeight(i),e.crawl_speed_ms=Math.round(200/e.user.settings.crawl_speed)},syncGM_getValue:function(i){i.detail.setting=="settings"?e.initSettings(i.detail):i.detail.setting=="count"&&i.detail.value&&i.detail.value!="{}"&&e.saveSettings({name:"count",value:JSON.parse(i.detail.value)})},initSettings:function(i){if(typeof i.name<"u")this.GM.getValue(i.name,"{}").then(function(s){var r={detail:{setting:i.name,value:s||"{}"}};try{e.syncGM_getValue(r)}catch(l){console.warn("Smart Scroll: UPDATE Your Browser ",l.name)}});else{var t,o=i.setting,n=i.value;if(!n||n=="{}"?(t=!1,console.warn("Smart Scroll: NO storage database")):t=JSON.parse(n),!t){t=this.user,console.log("Smart Scroll: Installing storage database...");for(let s in t){let r=JSON.stringify(t[s]);this.GM.setValue(s,r),console.log("Smart Scroll: Inserting "+s+": "+r)}t=this.user.settings,console.log("Smart Scroll: dONE")}this.user.settings=t,this.scrolledUpdate(!0),this.monkey(),this.monkey=null}},init:function(){if(typeof GM_info=="object"||typeof GM=="object"){this.is_userscript=!0,typeof GM>"u"?(console.log("Smart Scroll: Legacy GM_setValue enabled"),this.GM={info:GM_info,setValue:GM_setValue,getValue:function(){return new Promise((s,r)=>{try{s(GM_getValue.apply(this,arguments))}catch(l){r(l)}})}}):this.GM=GM;var i=document.createElement("div"),t=document.createElement("div");i.style="position:absolute;top:0px;background-color:transparent;",t.style="height:"+(window.innerHeight-100)+"px;width:100px;overflow:scroll;background-color:transparent;",this.body.appendChild(i),i.appendChild(t);let o=t.scrollHeight;t.style.overflow="hidden";let n=t.scrollHeight;this.scrollbar=n-o,t.remove(),i.remove(),this.initSettings({name:"settings"})}},head:document.head||document.getElementsByTagName("head")[0],body:document.body||document.documentElement,user:{settings:{bottomless_pages:!0,crawl_trigger:"hover",position:"bottom",dimButtons:!0,crawl_speed:21,refresh:!0,bot_minus:30,top_plus:0,ignore:""},count:0},crawl_speed_ms:10,opacity_timer:null,allowScroll:!0,settings_id:"",up_btn_show:"",dn_btn_show:"",count_accru:0,scrollable:0,scrollbar:0,scrolled:0,creeper:null,up_ctn:null,dn_ctn:null,creep:!1,step:5,GM:null,_x:0},O=0,V="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAkCAQAAACtIJtXAAAAAmJLR0QA/vCI/CkAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfiDBkQOCqvuzNgAAABWElEQVRIx6XWO7aDIBCA4V+OWYOaVbiDFGlccopkD/Sp0qiswcJb+ODhgNwjXXh8DpFhLKa558uVVvxmuF8iyi8PcWBkCHoaapmILTdA5fQZDJXIlPHl/vSlX2LKENDCcoCaemdab7Q8Am1kzxuj0d4clQ9sTAtoxiORB0jITgyZgEUGnxgxVJnAglSYNQ5lY2iEqR03bnTCSLPHoVIxdHwA+AiIjUPFY9iAGLLFsW7kGIMLyEi9JoCS/64QiEUSJVzgyfMEUWfAi9cJIhA+AARI1kZ8IEQihHHS5n0AXOTtpKWxyd5gGPbX+mASn/YKfm+nSYUnPrfZE63CE5/b7IlWx8z7XwzOG2mCuygNaCerVPxCSwP2elKpWzEHCG7wmhaNjpQcW2MSRWBB5JITK1FCNXNLjl8QyS2ILuO2KlWWe/HjoM6+z4vffO0DBco7V1sB09xfIv4A9ICG7qoP1KkAAAAASUVORK5CYII=",z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAkCAQAAACtIJtXAAAAAmJLR0QA/vCI/CkAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfiDBkRAC0ngnAPAAABV0lEQVRIx6XWO5KDMAyA4R8PnAHIKbjBFtkiR06TIjdwnyoN4DOkYAsClm2Z8Q4q/fhGgGxRfZaRF2eiei9wOUXUL37UiZkpGunpdCK33QGtGHM4WpWp89vD5eu4xtQxYJXtAB3dzgzBbJ0CQ+aZN8ZigzWmHNiYAbDMKVEGaMhOTIWAR6aQmHG0hcCKtLhvHsbn0P+rJvs9D5Pm8KSh4ZZsutHQ8EzyMGkOvwA8IuTGQ8zKPL4Por0HiWxA/D6iutjimiASuCbrFeIeISFwLyFi5BjIECFyDGSJFMkBO+HEsdEQDZhxnuhFxWuInsFWTbWstE5BcuEr2sQVXxq+ok168kpCniojK94WIuv11McfNb3QjgF/PZmjW7EEiG7wjgGLzbQc32MOmsCK6C0n16KUbiZbTtgQKW2IkpHRHrXlUf056Irv8+q9nPtBgfrC2ajgs4yniD+XioU/GQ3iSgAAAABJRU5ErkJggg==",C=e.body,H=window.location.hostname;if(window.self==window.top)switch(!0){case H.indexOf("youtube")!=-1:e.hideOnFullScreen(),window.addEventListener("yt-navigate-finish",function(i){e.reLoadStart(i)},!1),(C=document.querySelector("ytd-app #content"))?e.init():e.body.addEventListener("yt-page-data-updated",function(i){(C=document.querySelector("ytd-app #content"))&&O++<1&&e.init()},!1);break;default:e.init()}})();
